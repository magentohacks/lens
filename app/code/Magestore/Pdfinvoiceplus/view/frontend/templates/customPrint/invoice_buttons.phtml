<?php

/**
 * Magestore
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magestore.com license that is
 * available through the world-wide-web at this URL:
 * http://www.magestore.com/license-agreement.html
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Magestore
 * @package     Magestore_Pdfinvoiceplus
 * @copyright   Copyright (c) 2012 Magestore (http://www.magestore.com/)
 * @license     http://www.magestore.com/license-agreement.html
 */

/** @var \Magestore\Pdfinvoiceplus\Block\PrintButton\InvoiceButton $block */
// @codingStandardsIgnoreFile

$_order = $block->getOrder();
/** @var \Magestore\Pdfinvoiceplus\Helper\Data $pdfInvoiceHelper */
$pdfInvoiceHelper = $this->helper('Magestore\Pdfinvoiceplus\Helper\Data');
$isDisableCorePrinting = $pdfInvoiceHelper->isDisableCorePrinting();
$isEnabledPdfInvoice = $pdfInvoiceHelper->canshowCustomPrint($_order->getStoreId());
?>
<?php $_order = $block->getOrder() ?>

<style>
    .order-details-items .action.print{
        display: inline;
    }
</style>

<div class="actions-toolbar">
    <?php if(!$isDisableCorePrinting): ?>
    <a href="<?php /* @escapeNotVerified */ echo $block->getPrintAllInvoicesUrl($_order) ?>"
       target="_blank"
       class="action print">
        <span><?php /* @escapeNotVerified */ echo __('Print All Invoices') ?></span>
    </a>
    <?php endif?>
</div>
<?php foreach ($_order->getInvoiceCollection() as $_invoice): ?>
    <?php /** @var \Magento\Sales\Model\Order\Invoice $_invoice */ ?>
    <div class="order-title">
        <strong><?php /* @escapeNotVerified */ echo __('Invoice #') ?><?php /* @escapeNotVerified */ echo $_invoice->getIncrementId(); ?></strong>

        <?php if(!$isDisableCorePrinting): ?>
            <a href="<?php /* @escapeNotVerified */ echo $block->getPrintInvoiceUrl($_invoice) ?>"
               onclick="this.target='_blank'"
               class="action print">
                <span><?php /* @escapeNotVerified */ echo __('Print Invoice') ?></span>
            </a>
        <?php endif?>

        <?php if($isEnabledPdfInvoice): ?>
            <!-- Custom Invoice Pdf Print-->
            <a href="<?php /* @escapeNotVerified */ echo $pdfInvoiceHelper->getCustomPdfPrintInvoiceUrl($_invoice) ?>"
               onclick="this.target='_blank'"
               class="action print">
                <span><?php /* @escapeNotVerified */ echo __('Print Custom PDF Invoice') ?></span>
            </a>
        <?php endif?>
    </div>
    <div class="table-wrapper table-order-items invoice">
        <table class="data table table-order-items invoice" id="my-invoice-table-<?php /* @escapeNotVerified */ echo $_invoice->getId(); ?>">
            <caption class="table-caption"><?php /* @escapeNotVerified */ echo __('Items Invoiced') ?></caption>
            <thead>
            <tr>
                <th class="col name"><?php /* @escapeNotVerified */ echo __('Product Name') ?></th>
                <th class="col sku"><?php /* @escapeNotVerified */ echo __('SKU') ?></th>
                <th class="col price"><?php /* @escapeNotVerified */ echo __('Price') ?></th>
                <th class="col qty"><?php /* @escapeNotVerified */ echo __('Qty Invoiced') ?></th>
                <th class="col subtotal"><?php /* @escapeNotVerified */ echo __('Subtotal') ?></th>
            </tr>
            </thead>
            <?php $_items = $_invoice->getAllItems(); ?>
            <?php $_count = count($_items) ?>
            <?php foreach ($_items as $_item): ?>
                <?php if ($_item->getOrderItem()->getParentItem()) {
                    continue;
                } ?>
                <tbody>
                <?php echo $block->getItemHtml($_item) ?>
                </tbody>
            <?php endforeach; ?>
            <tfoot>
            <?php echo $block->getInvoiceTotalsHtml($_invoice)?>
            </tfoot>
        </table>
    </div>
    <?php echo $block->getInvoiceCommentsHtml($_invoice)?>
<?php endforeach; ?>
