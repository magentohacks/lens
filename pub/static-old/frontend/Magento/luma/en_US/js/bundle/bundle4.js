require.config({"config": {
        "jsbuild":{"Magento_Directory/js/region-updater.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mage/template',\n    'underscore',\n    'jquery-ui-modules/widget',\n    'mage/validation'\n], function ($, mageTemplate, _) {\n    'use strict';\n\n    $.widget('mage.directoryRegionUpdater', {\n        options: {\n            regionTemplate:\n                '<option value=\"<%- data.value %>\" <% if (data.isSelected) { %>selected=\"selected\"<% } %>>' +\n                '<%- data.title %>' +\n                '</option>',\n            isRegionRequired: true,\n            isZipRequired: true,\n            isCountryRequired: true,\n            currentRegion: null,\n            isMultipleCountriesAllowed: true\n        },\n\n        /**\n         *\n         * @private\n         */\n        _create: function () {\n            this._initCountryElement();\n\n            this.currentRegionOption = this.options.currentRegion;\n            this.regionTmpl = mageTemplate(this.options.regionTemplate);\n\n            this._updateRegion(this.element.find('option:selected').val());\n\n            $(this.options.regionListId).on('change', $.proxy(function (e) {\n                this.setOption = false;\n                this.currentRegionOption = $(e.target).val();\n\n                if (!this.currentRegionOption) {\n                    $(this.options.regionListId).add(this.options.regionInputId).val('');\n                }\n            }, this));\n\n            $(this.options.regionInputId).on('focusout', $.proxy(function () {\n                this.setOption = true;\n            }, this));\n        },\n\n        /**\n         *\n         * @private\n         */\n        _initCountryElement: function () {\n\n            if (this.options.isMultipleCountriesAllowed) {\n                this.element.parents('div.field').show();\n                this.element.on('change', $.proxy(function (e) {\n                    // clear region inputs on country change\n                    $(this.options.regionListId).val('');\n                    $(this.options.regionInputId).val('');\n                    this._updateRegion($(e.target).val());\n                }, this));\n\n                if (this.options.isCountryRequired) {\n                    this.element.addClass('required-entry');\n                    this.element.parents('div.field').addClass('required');\n                }\n            } else {\n                this.element.parents('div.field').hide();\n            }\n        },\n\n        /**\n         * Remove options from dropdown list\n         *\n         * @param {Object} selectElement - jQuery object for dropdown list\n         * @private\n         */\n        _removeSelectOptions: function (selectElement) {\n            selectElement.find('option').each(function (index) {\n                if (index) {\n                    $(this).remove();\n                }\n            });\n        },\n\n        /**\n         * Render dropdown list\n         * @param {Object} selectElement - jQuery object for dropdown list\n         * @param {String} key - region code\n         * @param {Object} value - region object\n         * @private\n         */\n        _renderSelectOption: function (selectElement, key, value) {\n            selectElement.append($.proxy(function () {\n                var name = value.name.replace(/[!\"#$%&'()*+,.\\/:;<=>?@[\\\\\\]^`{|}~]/g, '\\\\$&'),\n                    tmplData,\n                    tmpl;\n\n                if (value.code && $(name).is('span')) {\n                    key = value.code;\n                    value.name = $(name).text();\n                }\n\n                tmplData = {\n                    value: key,\n                    title: value.name,\n                    isSelected: false\n                };\n\n                if (this.options.defaultRegion === key) {\n                    tmplData.isSelected = true;\n                }\n\n                tmpl = this.regionTmpl({\n                    data: tmplData\n                });\n\n                return $(tmpl);\n            }, this));\n        },\n\n        /**\n         * Takes clearError callback function as first option\n         * If no form is passed as option, look up the closest form and call clearError method.\n         * @private\n         */\n        _clearError: function () {\n            var args = ['clearError', this.options.regionListId, this.options.regionInputId, this.options.postcodeId];\n\n            if (this.options.clearError && typeof this.options.clearError === 'function') {\n                this.options.clearError.call(this);\n            } else {\n                if (!this.options.form) {\n                    this.options.form = this.element.closest('form').length ? $(this.element.closest('form')[0]) : null;\n                }\n\n                this.options.form = $(this.options.form);\n\n                this.options.form && this.options.form.data('validator') &&\n                this.options.form.validation.apply(this.options.form, _.compact(args));\n\n                // Clean up errors on region & zip fix\n                $(this.options.regionInputId).removeClass('mage-error').parent().find('[generated]').remove();\n                $(this.options.regionListId).removeClass('mage-error').parent().find('[generated]').remove();\n                $(this.options.postcodeId).removeClass('mage-error').parent().find('[generated]').remove();\n            }\n        },\n\n        /**\n         * Update dropdown list based on the country selected\n         *\n         * @param {String} country - 2 uppercase letter for country code\n         * @private\n         */\n        _updateRegion: function (country) {\n            // Clear validation error messages\n            var regionList = $(this.options.regionListId),\n                regionInput = $(this.options.regionInputId),\n                postcode = $(this.options.postcodeId),\n                label = regionList.parent().siblings('label'),\n                container = regionList.parents('div.field'),\n                regionsEntries,\n                regionId,\n                regionData;\n\n            this._clearError();\n            this._checkRegionRequired(country);\n\n            // Populate state/province dropdown list if available or use input box\n            if (this.options.regionJson[country]) {\n                this._removeSelectOptions(regionList);\n                regionsEntries = _.pairs(this.options.regionJson[country]);\n                $.each(regionsEntries, $.proxy(function (key, value) {\n                    regionData = value[1];\n                    regionId = regionData.id;\n                    this._renderSelectOption(regionList, regionId.toString(), regionData);\n                }, this));\n\n                if (this.currentRegionOption) {\n                    regionList.val(this.currentRegionOption);\n                }\n\n                if (this.setOption) {\n                    regionList.find('option').filter(function () {\n                        return this.text === regionInput.val();\n                    }).attr('selected', true);\n                }\n\n                if (this.options.isRegionRequired) {\n                    regionList.addClass('required-entry').removeAttr('disabled');\n                    container.addClass('required').show();\n                } else {\n                    regionList.removeClass('required-entry validate-select').removeAttr('data-validate');\n                    container.removeClass('required');\n\n                    if (!this.options.optionalRegionAllowed) { //eslint-disable-line max-depth\n                        regionList.hide();\n                        container.hide();\n                    } else {\n                        regionList.removeAttr('disabled').show();\n                    }\n                }\n\n                regionList.show();\n                regionInput.hide();\n                label.attr('for', regionList.attr('id'));\n            } else {\n                this._removeSelectOptions(regionList);\n\n                if (this.options.isRegionRequired) {\n                    regionInput.addClass('required-entry').removeAttr('disabled');\n                    container.addClass('required').show();\n                } else {\n                    if (!this.options.optionalRegionAllowed) { //eslint-disable-line max-depth\n                        regionInput.attr('disabled', 'disabled');\n                        container.hide();\n                    }\n                    container.removeClass('required');\n                    regionInput.removeClass('required-entry');\n                }\n\n                regionList.removeClass('required-entry').prop('disabled', 'disabled').hide();\n                regionInput.show();\n                label.attr('for', regionInput.attr('id'));\n            }\n\n            // If country is in optionalzip list, make postcode input not required\n            if (this.options.isZipRequired) {\n                $.inArray(country, this.options.countriesWithOptionalZip) >= 0 ?\n                    postcode.removeClass('required-entry').closest('.field').removeClass('required') :\n                    postcode.addClass('required-entry').closest('.field').addClass('required');\n            }\n\n            // Add defaultvalue attribute to state/province select element\n            regionList.attr('defaultvalue', this.options.defaultRegion);\n            this.options.form.find('[type=\"submit\"]').removeAttr('disabled').show();\n        },\n\n        /**\n         * Check if the selected country has a mandatory region selection\n         *\n         * @param {String} country - Code of the country - 2 uppercase letter for country code\n         * @private\n         */\n        _checkRegionRequired: function (country) {\n            var self = this;\n\n            this.options.isRegionRequired = false;\n            $.each(this.options.regionJson.config['regions_required'], function (index, elem) {\n                if (elem === country) {\n                    self.options.isRegionRequired = true;\n                }\n            });\n        }\n    });\n\n    return $.mage.directoryRegionUpdater;\n});\n","Magento_Variable/js/grid/columns/radioselect.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'underscore',\n    'mage/translate',\n    'Magento_Ui/js/grid/columns/column',\n    'jquery'\n], function (_, $t, Column, jQuery) {\n    'use strict';\n\n    return Column.extend({\n        defaults: {\n            bodyTmpl: 'Magento_Variable/grid/cells/radioselect',\n            draggable: false,\n            sortable: false,\n            selectedVariableCode: null,\n            selectedVariableType: null\n        },\n\n        /**\n         * Calls 'initObservable' of parent\n         *\n         * @returns {Object} Chainable.\n         */\n        initObservable: function () {\n            this._super().observe(['selectedVariableCode']);\n\n            return this;\n        },\n\n        /**\n         * Remove disable class from Insert Variable button after Variable has been chosen.\n         *\n         * @return {Boolean}\n         */\n        selectVariable: function () {\n            if (jQuery('#insert_variable').hasClass('disabled')) {\n                jQuery('#insert_variable').removeClass('disabled');\n            }\n\n            return true;\n        }\n    });\n});\n","Magento_Dhl/js/view/shipping-rates-validation.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'uiComponent',\n    'Magento_Checkout/js/model/shipping-rates-validator',\n    'Magento_Checkout/js/model/shipping-rates-validation-rules',\n    'Magento_Dhl/js/model/shipping-rates-validator',\n    'Magento_Dhl/js/model/shipping-rates-validation-rules'\n], function (\n    Component,\n    defaultShippingRatesValidator,\n    defaultShippingRatesValidationRules,\n    dhlShippingRatesValidator,\n    dhlShippingRatesValidationRules\n) {\n    'use strict';\n\n    defaultShippingRatesValidator.registerValidator('dhl', dhlShippingRatesValidator);\n    defaultShippingRatesValidationRules.registerRules('dhl', dhlShippingRatesValidationRules);\n\n    return Component;\n});\n","Magento_Dhl/js/model/shipping-rates-validator.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mageUtils',\n    'Magento_Dhl/js/model/shipping-rates-validation-rules',\n    'mage/translate'\n], function ($, utils, validationRules, $t) {\n    'use strict';\n\n    return {\n        validationErrors: [],\n\n        /**\n         * @param {Object} address\n         * @return {Boolean}\n         */\n        validate: function (address) {\n            var self = this;\n\n            this.validationErrors = [];\n            $.each(validationRules.getRules(), function (field, rule) {\n                var message;\n\n                if (rule.required && utils.isEmpty(address[field])) {\n                    message = $t('Field ') + field + $t(' is required.');\n\n                    self.validationErrors.push(message);\n                }\n            });\n\n            return !this.validationErrors.length;\n        }\n    };\n});\n","Magento_Dhl/js/model/shipping-rates-validation-rules.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([], function () {\n    'use strict';\n\n    return {\n        /**\n         * @return {Object}\n         */\n        getRules: function () {\n            return {\n                'postcode': {\n                    'required': true\n                },\n                'country_id': {\n                    'required': true\n                },\n                'city': {\n                    'required': true\n                }\n            };\n        }\n    };\n});\n","StripeIntegration_Payments/js/stripe_payments_express.js":"/*global define*/\ndefine(\n    [\n        'jquery',\n        'mage/url',\n        'mage/storage',\n        'Magento_Ui/js/modal/alert',\n        'mage/translate',\n        'Magento_Customer/js/customer-data',\n        'StripeIntegration_Payments/js/stripe',\n        'mage/loader'\n    ],\n    function (\n        jQuery,\n        urlBuilder,\n        storage,\n        alert,\n        $t,\n        customerData,\n        stripe\n    ) {\n        'use strict';\n\n        return {\n            shippingAddress: [],\n            shippingMethod: null,\n            elements: null,\n            expressCheckoutElement: null,\n            expressCheckoutOptions: null,\n            clickResolvePayload: null,\n            resolvePayload: null,\n            pendingActionsQueue: [],\n            isAddToCartPending: false,\n            waitingForNewTotals: false,\n            lastTotal: null,\n            mountElementId: null,\n            mode: null,\n            isLoading: false,\n            debug: false,\n\n            getExpressCheckoutElementParams: function(payload, callback)\n            {\n                var serviceUrl = urlBuilder.build('/rest/V1/stripe/payments/ece_params', {}),\n                    self = this;\n\n                return storage.post(\n                    serviceUrl,\n                    JSON.stringify(payload),\n                    false\n                )\n                .fail(function (xhr, textStatus, errorThrown)\n                {\n                    console.error(\"Could not retrieve initialization params for Express Checkout\");\n                })\n                .done(function (response) {\n                    self.processResponseWithECEParams(response, callback);\n                });\n            },\n\n            processResponseWithECEParams: function(response, callback)\n            {\n                try\n                {\n                    if (typeof response === 'string') {\n                        response = JSON.parse(response);\n                    }\n\n                    if (response && response.resolvePayload)\n                    {\n                        if (response.resolvePayload.allowedShippingCountries)\n                        {\n                            // Convert to object map to array\n                            response.resolvePayload.allowedShippingCountries = Object.keys(response.resolvePayload.allowedShippingCountries).map(function (key) { return response.resolvePayload.allowedShippingCountries[key]; });\n                        }\n\n                        callback(null, response);\n                    }\n                    else\n                    {\n                        callback(null, response);\n                    }\n                }\n                catch (e)\n                {\n                    callback(e.message, response);\n                }\n            },\n\n            /**\n             * Init Stripe Express\n             * @param elementId\n             * @param apiKey\n             * @param paramsType\n             * @param settings\n             * @param callback\n             */\n            initStripeExpress: function (elementId, stripeJsInitParams, locationDetails, expressCheckoutOptions, callback)\n            {\n                // Only one express element is allowed per page\n                if (locationDetails.location == 'minicart')\n                {\n                    if (document.body.classList.contains('catalog-product-view') && // We are on the product page\n                        locationDetails.activeLocations.indexOf('product_page') >= 0) // ECE is enabled on the product page\n                        return;\n\n                    if (document.body.classList.contains('checkout-cart-index') && // We are on the cart page\n                        locationDetails.activeLocations.indexOf('shopping_cart_page') >= 0) // ECE is enabled on the cart page\n                        return;\n                }\n\n                if (this.waitingForNewTotals)\n                {\n                    // This method can be called from cart.subscribe(). In that case, we do not want to re-initialize the widget\n                    // because we are waiting for the addToCart() to finish. We will update the amounts after the addToCart() is done.\n                    return;\n                }\n\n                var self = this;\n                this.mountElementId = elementId;\n                this.stripeJsInitParams = stripeJsInitParams;\n                this.locationDetails = locationDetails;\n                this.expressCheckoutOptions = expressCheckoutOptions;\n\n                this.getExpressCheckoutElementParams(locationDetails, function(err, result)\n                {\n                    if (err)\n                    {\n                        console.warn('Cannot initialize wallets: ' + err);\n                        return;\n                    }\n\n                    if (!result.elementOptions)\n                        return;\n\n                    if (result.elementOptions.mode != 'setup')\n                    {\n                        // if (!result.elementOptions.amount || result.elementOptions.amount == 0)\n                        //     return;\n                    }\n\n                    self.mode = result.elementOptions.mode;\n                    self.clickResolvePayload = result.resolvePayload;\n\n                    stripe.initStripe(stripeJsInitParams, function (err)\n                    {\n                        if (err)\n                        {\n                            self.showError(self.maskError(err));\n                            return;\n                        }\n\n                        self.initElements(result.elementOptions);\n                        self.initExpressCheckoutElement(elementId, expressCheckoutOptions, callback);\n                    });\n                });\n            },\n\n            // Accepts unlimited parameters\n            log: function()\n            {\n                if (!this.debug)\n                    return;\n\n                console.log.apply(console, arguments);\n            },\n\n            initElements: function(elementsOptions)\n            {\n                if (!this.elements)\n                {\n                    this.log('initElements', elementsOptions);\n                    this.elements = stripe.stripeJs.elements(elementsOptions);\n                }\n                else\n                {\n                    this.log('updateElements', elementsOptions);\n                    this.elements.update(elementsOptions);\n                }\n            },\n\n            maskError: function(err)\n            {\n                var errLowercase = err.toLowerCase();\n                var pos1 = errLowercase.indexOf(\"Invalid API key provided\".toLowerCase());\n                var pos2 = errLowercase.indexOf(\"No API key provided\".toLowerCase());\n                if (pos1 === 0 || pos2 === 0)\n                    return 'Invalid Stripe API key provided.';\n\n                return err;\n            },\n\n            initExpressCheckoutElement: function(elementId, expressCheckoutOptions, callback)\n            {\n                if (this.expressCheckoutElement)\n                {\n                    // ECE was already initialized, no need to update it.\n                    return;\n                }\n\n                var DOMElement = jQuery(elementId),\n                    self = this;\n\n                try {\n                    if (typeof expressCheckoutOptions === 'string')\n                        expressCheckoutOptions = JSON.parse(expressCheckoutOptions);\n\n                    this.log('initExpressCheckoutElement', expressCheckoutOptions);\n                    this.expressCheckoutElement = this.elements.create('expressCheckout', expressCheckoutOptions);\n                }\n                catch (e)\n                {\n                    console.warn(e.message);\n                    return;\n                }\n\n                if (document.getElementById(elementId.substr(1)))\n                    this.expressCheckoutElement.mount(elementId);\n\n                this.expressCheckoutElement.on('ready', function (result)\n                {\n                    self.log(\"on.ready\");\n                    if (result.availablePaymentMethods)\n                    {\n                        callback(self.expressCheckoutElement);\n                    }\n                    else\n                    {\n                        DOMElement.hide();\n                    }\n                });\n            },\n\n            getClientSecretFromResponse: function(response)\n            {\n                if (typeof response != \"string\")\n                {\n                    return null;\n                }\n\n                if (response.indexOf(\"Authentication Required: \") >= 0)\n                {\n                    return response.substring(\"Authentication Required: \".length);\n                }\n\n                return null;\n            },\n\n            /**\n             * Place Order\n             * @param result\n             * @param callback\n             */\n            placeOrder: function (result, location, callback) {\n                var serviceUrl = urlBuilder.build('/rest/V1/stripe/payments/place_order', {}),\n                    payload = {\n                        result: result,\n                        location: location\n                    },\n                    self = this;\n\n                return storage.post(\n                    serviceUrl,\n                    JSON.stringify(payload),\n                    false\n                ).fail(function (xhr, textStatus, errorThrown)\n                {\n                    try\n                    {\n                        var response = JSON.parse(xhr.responseText);\n\n                        var clientSecret = self.getClientSecretFromResponse(response.message);\n\n                        if (clientSecret)\n                        {\n                            return stripe.authenticateCustomer(clientSecret, function(err)\n                            {\n                                if (err)\n                                    return callback(err, { message: err }, result);\n\n                                self.placeOrder(result, location, callback);\n                            });\n                        }\n                        else\n                            callback(response.message, response, result);\n                    }\n                    catch (e)\n                    {\n                        return self.showError(xhr.responseText);\n                    }\n                }).done(function (response) { // @todo - this should be success, we dont want to callback() on failure\n                    if (typeof response === 'string')\n                    {\n                        try\n                        {\n                            response = JSON.parse(response);\n                        }\n                        catch (e)\n                        {\n                            return self.showError(response);\n                        }\n                    }\n\n                    callback(null, response, result);\n                });\n            },\n\n            /**\n             * Add Item to Cart\n             * @param params\n             * @param shipping_id\n             * @param callback\n             */\n            addToCart: function(params, shipping_id, callback) {\n                var self = this;\n                this.isAddToCartPending = this.waitingForNewTotals = true;\n                var addToCartPromise = new Promise(function(resolve, reject) {\n                    var serviceUrl = urlBuilder.build('/rest/V1/stripe/payments/addtocart', {}),\n                        payload = {params: params, shipping_id: shipping_id};\n\n                    storage.post(\n                        serviceUrl,\n                        JSON.stringify(payload),\n                        false\n                    ).fail(function(xhr, textStatus, errorThrown) {\n                        self.parseFailedResponse.apply(self, [xhr.responseText, callback]);\n                        self.waitingForNewTotals = false;\n                        reject(); // Reject the promise\n                    }).done(function(response) {\n                        customerData.invalidate(['cart']);\n                        customerData.reload(['cart'], true);\n                        callback(null, response);\n                        resolve(); // Resolve the promise\n                    });\n                });\n\n                addToCartPromise.then(function() {\n                    self.isAddToCartPending = false;\n\n                    // After the promise is resolved, run the functions in the queue\n                    while (self.pendingActionsQueue.length) {\n                        var fn = self.pendingActionsQueue.shift(); // Dequeue the first function\n                        fn(); // Execute the dequeued function\n                    }\n\n                    self.waitingForNewTotals = false;\n\n                    // Invalidate the minicart and display any errors or warnings. The wait is needed so that the server side finishes processing any cart updates\n                    setTimeout(function()\n                    {\n                        customerData.reload(['cart', 'messages'], true);\n                    }, 1000);\n                });\n\n                return addToCartPromise;\n            },\n\n            getShippingAddressFrom: function(eceShippingAddress)\n            {\n                if (!eceShippingAddress)\n                    return null;\n\n                // For some countries like Japan, the ECE does not set the City, only the region\n                if (eceShippingAddress.city.length == 0 && eceShippingAddress.region.length > 0)\n                    eceShippingAddress.city = eceShippingAddress.region;\n\n                return eceShippingAddress;\n            },\n\n            getNewShippingRatesFor: function(address, callback) {\n                var serviceUrl = urlBuilder.build('/rest/V1/stripe/payments/ece_shipping_address_changed', {}),\n                    payload = {newAddress: address, location: this.locationDetails.location},\n                    self = this;\n\n                return storage.post(\n                    serviceUrl,\n                    JSON.stringify(payload),\n                    false\n                ).fail(function (xhr, textStatus, errorThrown)\n                {\n                    self.parseFailedResponse.apply(self, [ xhr.responseText, callback ]);\n                }\n                ).done(function (response) {\n                    self.processResponseWithECEParams(response, callback);\n                });\n            },\n\n            parseFailedResponse: function(responseText, callback)\n            {\n                try\n                {\n                    var response = JSON.parse(responseText);\n                    callback(response.message);\n                }\n                catch (e)\n                {\n                    callback(responseText);\n                }\n            },\n\n            /**\n             * Apply Shipping and Return Totals\n             * @param address\n             * @param shipping_id\n             * @param callback\n             * @returns {*}\n             */\n            updateShippingRate: function(address, shipping_id, callback) {\n                var serviceUrl = urlBuilder.build('/rest/V1/stripe/payments/ece_shipping_rate_changed', {}),\n                    payload = {address: address, shipping_id: shipping_id},\n                    self = this;\n\n                return storage.post(\n                    serviceUrl,\n                    JSON.stringify(payload),\n                    false\n                ).fail(function (xhr, textStatus, errorThrown)\n                {\n                    self.parseFailedResponse.apply(self, [ xhr.responseText, callback ]);\n                }\n                ).done(function (response) {\n                    self.processResponseWithECEParams(response, callback);\n                });\n            },\n\n            onShippingAddressChange: function(event)\n            {\n                this.log(\"onShippingAddressChange\");\n                var executeMethod = this.onShippingAddressChangeAction.bind(this, event);\n\n                if (this.isAddToCartPending) {\n                    this.pendingActionsQueue.push(executeMethod);\n                } else {\n                    executeMethod();\n                }\n            },\n\n            onShippingAddressChangeAction: function(event)\n            {\n                var self = this;\n                this.shippingAddress = this.getShippingAddressFrom(event.address);\n                this.waitingForNewTotals = true;\n                this.getNewShippingRatesFor(this.shippingAddress, function (err, eceResponseParams)\n                {\n                    if (err)\n                    {\n                        event.reject();\n                        self.waitingForNewTotals = false;\n                        return self.showError(err);\n                    }\n\n                    if (!eceResponseParams.resolvePayload.shippingRates)\n                    {\n                        event.reject();\n                        self.waitingForNewTotals = false;\n                        return;\n                    }\n\n                    self.resolveEvent(event, eceResponseParams.resolvePayload);\n                    self.waitingForNewTotals = false;\n                });\n            },\n\n            resolveEvent: function(event, resolvePayload)\n            {\n                if (!event)\n                    return;\n\n                var self = this;\n                var total = this.getLineItemsTotal(resolvePayload.lineItems);\n\n                if (resolvePayload.lineItems && !event.isClick && this.mode != \"setup\")\n                {\n                    if (total > 0)\n                    {\n                        this.log('Updating total to ' + total + ' cents');\n                        var promise = self.elements.update({amount: total});\n                    }\n                    else\n                    {\n                        this.log('Will not update total to ' + total + ' cents');\n                        delete resolvePayload.lineItems;\n                    }\n\n                    // We need this until a promise is implemented by Stripe\n                    setTimeout(function() {\n                        self.log('Resolving event with delay ', resolvePayload);\n                        event.resolve(resolvePayload);\n                    }, 1000);\n                }\n                else\n                {\n                    if (this.mode == \"setup\" && resolvePayload.lineItems)\n                    {\n                        delete resolvePayload.lineItems;\n                    }\n                    this.log('Resolving event with no delay ', resolvePayload, this.isAddToCartPending, total);\n                    event.resolve(resolvePayload);\n                }\n            },\n\n            getLineItemsTotal: function(lineItems)\n            {\n                var total = 0;\n\n                if (!lineItems || !lineItems.length)\n                    return total;\n\n                for (var i = 0; i < lineItems.length; i++) {\n                    total += lineItems[i].amount;\n                }\n\n                return total;\n            },\n\n            onShippingRateChange: function(event)\n            {\n                this.log(\"onShippingRateChange\");\n                var executeMethod = this.onShippingRateChangeAction.bind(this, event);\n\n                if (this.isAddToCartPending) {\n                    this.pendingActionsQueue.push(executeMethod);\n                } else {\n                    executeMethod();\n                }\n            },\n\n            onShippingRateChangeAction: function(event)\n            {\n                var self = this;\n                var shippingMethod = event.shippingRate.hasOwnProperty('id') ? event.shippingRate.id : null;\n                this.waitingForNewTotals = true;\n                this.updateShippingRate(this.shippingAddress, shippingMethod, function (err, response)\n                {\n                    if (err) {\n                        event.reject();\n                        self.waitingForNewTotals = false;\n                        return self.showError(err);\n                    }\n\n                    self.resolveEvent(event, response.resolvePayload);\n                    self.waitingForNewTotals = false;\n                });\n            },\n\n            startLoader: function()\n            {\n                if (this.isLoading)\n                    return;\n\n                this.isLoading = true;\n                jQuery('body').trigger('processStart');\n            },\n\n            stopLoader: function()\n            {\n                if (!this.isLoading)\n                    return;\n\n                this.isLoading = false;\n                jQuery('body').trigger('processStop');\n            },\n\n            onConfirm: function(location, confirmResult)\n            {\n                this.startLoader();\n\n                var onPaymentMethodCreated = this.onPaymentMethodCreated.bind(this, confirmResult, location);\n                var showError = this.showError.bind(this);\n\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {\n                        billing_details: confirmResult.billingDetails\n                    },\n                    shipping: confirmResult.shippingAddress\n                };\n\n                this.elements.submit().then(function()\n                {\n                    stripe.stripeJs.createConfirmationToken(paymentMethodData).then(function(createConfirmationTokenResult)\n                    {\n                        if (createConfirmationTokenResult.error)\n                        {\n                            return showError(createConfirmationTokenResult.error.message);\n                        }\n                        else if (createConfirmationTokenResult.confirmationToken)\n                        {\n                            confirmResult.confirmationToken = createConfirmationTokenResult.confirmationToken;\n                            return onPaymentMethodCreated();\n                        }\n                        else\n                        {\n                            this.stopLoader();\n                            throw new Error('Invalid response from Stripe');\n                        }\n                    }).catch(function(error) {\n                        return showError(error.message);\n                    });\n                }).catch(function(error) {\n                    return showError(error.message);\n                });\n\n            },\n\n            onCancel: function()\n            {\n                this.log(\"onCancel\");\n                this.stopLoader();\n            },\n\n            initCheckoutWidget: function (checkoutValidator)\n            {\n                var self = this;\n                this.expressCheckoutElement.on('click', function(event)\n                {\n                    if (!checkoutValidator())\n                    {\n                        event.preventDefault();\n                        return;\n                    }\n\n                    event.isClick = true;\n                    self.startLoader();\n                    self.resolveEvent(event, self.clickResolvePayload);\n                });\n                this.expressCheckoutElement.on('shippingaddresschange', this.onShippingAddressChange.bind(this));\n                this.expressCheckoutElement.on('shippingratechange', this.onShippingRateChange.bind(this));\n                this.expressCheckoutElement.on('confirm', this.onConfirm.bind(this, 'checkout'));\n                this.expressCheckoutElement.on('cancel', this.onCancel.bind(this));\n            },\n\n            /**\n             * Init Widget for Cart Page\n             */\n            initCartWidget: function ()\n            {\n                var self = this;\n                this.expressCheckoutElement.on('click', function(event) {\n                    event.isClick = true;\n                    self.startLoader();\n                    self.resolveEvent(event, self.clickResolvePayload);\n                });\n                this.expressCheckoutElement.on('shippingaddresschange', this.onShippingAddressChange.bind(this));\n                this.expressCheckoutElement.on('shippingratechange', this.onShippingRateChange.bind(this));\n                this.expressCheckoutElement.on('confirm', this.onConfirm.bind(this, 'cart'));\n                this.expressCheckoutElement.on('cancel', this.onCancel.bind(this));\n            },\n\n            /**\n             * Init Widget for Mini cart\n             */\n            initMiniCartWidget: function ()\n            {\n                var self = this;\n                this.expressCheckoutElement.on('click', function(event) {\n                    event.isClick = true;\n                    self.startLoader();\n                    self.resolveEvent(event, self.clickResolvePayload);\n                });\n                this.expressCheckoutElement.on('shippingaddresschange', this.onShippingAddressChange.bind(this));\n                this.expressCheckoutElement.on('shippingratechange', this.onShippingRateChange.bind(this));\n                this.expressCheckoutElement.on('confirm', this.onConfirm.bind(this, 'minicart'));\n                this.expressCheckoutElement.on('cancel', this.onCancel.bind(this));\n            },\n\n            /**\n             * Init Widget for Single Product Page\n             */\n            initProductWidget: function ()\n            {\n                var self = this;\n                this.expressCheckoutElement.on('click', function(event) {\n                    event.isClick = true;\n                    self.startLoader();\n                    self.onClickAtProductPage(event);\n                });\n                this.expressCheckoutElement.on('shippingaddresschange', this.onShippingAddressChange.bind(this));\n                this.expressCheckoutElement.on('shippingratechange', this.onShippingRateChange.bind(this));\n                this.expressCheckoutElement.on('confirm', this.onConfirm.bind(this, 'product'));\n                this.expressCheckoutElement.on('cancel', this.onCancel.bind(this));\n\n                this.bindConfigurableProductOptions();\n            },\n\n            formToArrayObject: function(data) {\n                var obj = {};\n                for (var i = 0; i < data.length; i++) {\n                    obj[data[i].name] = data[i].value;\n                }\n                return obj;\n            },\n\n            onClickAtProductPage: function(event)\n            {\n                this.log(\"onClickAtProductPage\");\n                var self = this,\n                    form = jQuery('#product_addtocart_form'),\n                    params = [];\n\n                var validator = form.validation({radioCheckboxClosest: '.nested'});\n\n                if (!validator.valid())\n                {\n                    this.stopLoader();\n                    return;\n                }\n\n                // Add to Cart\n                params = this.formToArrayObject(form.serializeArray());\n                this.addToCart(params, this.shippingMethod, function (err)\n                {\n                    if (err)\n                    {\n                        return self.showError(err);\n                    }\n                });\n\n                this.resolveEvent(event, this.clickResolvePayload);\n            },\n\n            showError: function(message)\n            {\n                this.stopLoader();\n\n                alert({\n                    title: $t('Error'),\n                    content: message,\n                    actions: {\n                        always: function (){}\n                    }\n                });\n            },\n\n            onPaymentMethodCreated: function(result, location)\n            {\n                var self = this;\n                this.placeOrder(result, location, function (err, response, result)\n                {\n                    if (err)\n                    {\n                        self.showError(response.message);\n                    }\n                    else if (response.hasOwnProperty('redirect'))\n                    {\n                        customerData.invalidate(['cart']);\n                        window.location = response.redirect;\n                    }\n                    else\n                    {\n                        self.stopLoader();\n                    }\n                });\n            },\n\n            bindConfigurableProductOptions: function()\n            {\n                var self = this;\n                var options = jQuery(\"#product-options-wrapper .configurable select.super-attribute-select\");\n\n                options.each(function(index)\n                {\n                    var onConfigurableProductChanged = self.onConfigurableProductChanged.bind(self, this);\n                    jQuery(this).on(\"change\", onConfigurableProductChanged);\n                });\n            },\n\n            onConfigurableProductChanged: function(element)\n            {\n                var self = this;\n\n                if (element.value)\n                {\n                    var locationDetails = {\n                        location: 'product',\n                        productId: this.locationDetails.productId,\n                        attribute: element.value\n                    };\n                    this.initStripeExpress(\n                        this.mountElementId,\n                        this.stripeJsInitParams,\n                        locationDetails,\n                        self.expressCheckoutOptions,\n                        self.initProductWidget.bind(self)\n                    );\n                }\n            }\n        };\n    }\n);\n","StripeIntegration_Payments/js/stripe.js":"// Copyright \u00a9 Stripe, Inc\n//\n// @package    StripeIntegration_Payments\n// @version    4.4.2\ndefine(\n    [\n        'stripejs'\n    ],\n    function ()\n    {\n        'use strict';\n\n        // Warning: This file should be kept lightweight as it is loaded on nearly all pages.\n\n        return (window.stripe = {\n\n            // Properties\n            version: \"4.4.2\",\n            stripeJs: null,\n\n            initStripe: function(params, callback)\n            {\n                if (typeof callback == \"undefined\")\n                    callback = null;\n\n                var message = null;\n\n                if (!this.stripeJs)\n                {\n                    try\n                    {\n                        var options = {};\n                        if (params.options)\n                        {\n                            options = params.options;\n                        }\n\n                        this.stripeJs = Stripe(params.apiKey, options);\n                    }\n                    catch (e)\n                    {\n                        if (typeof e != \"undefined\" && typeof e.message != \"undefined\")\n                            message = 'Could not initialize Stripe.js: ' + e.message;\n                        else\n                            message = 'Could not initialize Stripe.js';\n                    }\n\n                    if (this.stripeJs && typeof params.appInfo != \"undefined\")\n                    {\n                        try\n                        {\n                            this.stripeJs.registerAppInfo(params.appInfo);\n                        }\n                        catch (e)\n                        {\n                            console.warn(e);\n                        }\n                    }\n                }\n\n                if (callback)\n                    callback(message);\n                else if (message)\n                    console.error(message);\n            },\n\n            authenticateCustomer: function(intentId, done) {\n                try {\n                    var isPaymentIntent = intentId.startsWith('pi_');\n                    var isSetupIntent = intentId.startsWith('seti_');\n\n                    var handleIntent = function(result) {\n                        if (result.error)\n                            return done(result.error);\n\n                        var intent = result.paymentIntent || result.setupIntent;\n                        var requiresActionStatuses = [\"requires_action\", \"requires_source_action\"];\n\n                        if (requiresActionStatuses.includes(intent.status))\n                        {\n                            if (intent.next_action && intent.next_action.type === \"verify_with_microdeposits\")\n                            {\n                                window.location = intent.next_action.verify_with_microdeposits.hosted_verification_url;\n                            }\n                            else\n                            {\n                                stripe.stripeJs.handleNextAction({\n                                    clientSecret: intent.client_secret\n                                })\n                                .then(function(result)\n                                {\n                                    if (result && result.error)\n                                    {\n                                        return done(result.error.message);\n                                    }\n\n                                    return done();\n                                });\n                            }\n                        }\n                        else\n                        {\n                            return done();\n                        }\n                    };\n\n                    if (isPaymentIntent) {\n                        this.stripeJs.retrievePaymentIntent(intentId).then(handleIntent);\n                    } else if (isSetupIntent) {\n                        this.stripeJs.retrieveSetupIntent(intentId).then(handleIntent);\n                    } else {\n                        throw new Error(\"Invalid intent ID\");\n                    }\n                } catch (e) {\n                    done(e.message);\n                }\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/helper/subscriptions.js":"define(\n    [\n        'ko'\n    ],\n    function (\n        ko\n    ) {\n        'use strict';\n\n        return {\n            isSubscriptionUpdate: function()\n            {\n                return !!(window.checkoutConfig &&\n                    window.checkoutConfig.payment &&\n                    window.checkoutConfig.payment.stripe_payments &&\n                    window.checkoutConfig.payment.stripe_payments.subscriptionUpdateDetails);\n            },\n\n            getConfig: function(key)\n            {\n                var config = null;\n\n                if (window.checkoutConfig && window.checkoutConfig.payment && window.checkoutConfig.payment.stripe_payments)\n                {\n                    config = window.checkoutConfig.payment.stripe_payments;\n                }\n\n                if (!config || !config.subscriptionUpdateDetails)\n                {\n                    return null;\n                }\n\n                if (!config.subscriptionUpdateDetails[key])\n                {\n                    return \"--\";\n                }\n\n                return config.subscriptionUpdateDetails[key];\n            },\n\n            getSuccessUrl: function()\n            {\n                return this.getConfig(\"success_url\");\n            },\n\n            getCancelUrl: function()\n            {\n                return this.getConfig(\"cancel_url\");\n            },\n\n            displaySidebar: function()\n            {\n                return this.isSubscriptionUpdate();\n                    // && !window.checkoutConfig.payment.stripe_payments.subscriptionUpdateDetails.is_virtual\n                    // && window.location.href.indexOf('#payment') < 0;\n            }\n        };\n    }\n);\n","StripeIntegration_Payments/js/mixins/messages-mixin.js":"define([], function() {\n    'use strict';\n    return function(target) {\n        return target.extend({\n            isVisible: function () {\n                var msgs = this.messageContainer.errorMessages();\n                for (var i = 0; i < msgs.length; i++)\n                {\n                    if (typeof msgs[i] != 'string')\n                        continue;\n\n                    if (msgs[i].indexOf(\"Authentication Required: \") >= 0)\n                        return false;\n                }\n                return this.isHidden(this.messageContainer.hasMessages());\n            }\n        });\n    };\n});\n","StripeIntegration_Payments/js/mixins/checkout/payment/list.js":"define([\n    'StripeIntegration_Payments/js/helper/subscriptions',\n    'mage/translate',\n],\nfunction(\n    subscriptions,\n    $t\n) {\n    'use strict';\n    return function(target) {\n        return target.extend({\n            /**\n             * Returns payment group title\n             *\n             * @param {Object} group\n             * @returns {String}\n             */\n            getGroupTitle: function (group)\n            {\n                if (subscriptions.isSubscriptionUpdate())\n                    return $t(\"Subscription Update Review\");\n\n                var title = group().title;\n\n                if (group().isDefault() && this.paymentGroupsList().length > 1) {\n                    title = this.defaultGroupTitle;\n                }\n\n                return title;\n            },\n        });\n    };\n});\n","StripeIntegration_Payments/js/view/ui_components/setup_element.js":"define(\n    [\n        'ko',\n        'uiComponent',\n        'StripeIntegration_Payments/js/action/list-payment-methods',\n        'StripeIntegration_Payments/js/action/add-payment-method',\n        'StripeIntegration_Payments/js/action/delete-payment-method',\n        'StripeIntegration_Payments/js/stripe',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Customer/js/model/customer',\n        'mage/translate',\n        'jquery',\n        'mage/storage',\n        'Magento_Customer/js/customer-data',\n        'Magento_Ui/js/model/messages',\n        'uiLayout'\n    ],\n    function (\n        ko,\n        Component,\n        listPaymentMethodsAction,\n        addPaymentMethodAction,\n        deletePaymentMethodAction,\n        stripe,\n        globalMessageList,\n        customer,\n        $t,\n        $,\n        storage,\n        customerData,\n        messagesModel,\n        layout\n    ) {\n        'use strict';\n\n        return Component.extend({\n            externalRedirectUrl: null,\n            defaults: {\n                template: 'StripeIntegration_Payments/setup_element',\n            },\n            elements: null,\n            initParams: null,\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'paymentElement',\n                        'isPaymentFormComplete',\n                        'isPaymentFormVisible',\n                        'isLoading',\n                        'stripePaymentsError',\n                        'permanentError',\n                        'isOrderPlaced',\n                        'isInitialized',\n                        'savedPaymentMethods',\n                        'processingSavedPaymentMethods'\n                    ]);\n\n                var self = this;\n\n                this.isPaymentFormVisible(false);\n                this.isOrderPlaced(false);\n                this.isInitialized(false);\n                this.processingSavedPaymentMethods(false);\n\n                this.hasPaymentMethods = ko.computed(this.hasPaymentMethodsComputed.bind(this));\n\n                this.messageContainer = new messagesModel();\n\n                var messagesComponent = {\n                    parent: this.name,\n                    name: this.name + '.messages',\n                    displayArea: 'messages',\n                    component: 'Magento_Ui/js/view/messages',\n                    config: {\n                        messageContainer: this.messageContainer,\n                        autoHideTimeOut: -1\n                    }\n                };\n\n                layout([messagesComponent]);\n\n                return this;\n            },\n\n            getStripeParam: function(param)\n            {\n                if (typeof window.initParams == \"undefined\")\n                    return null;\n\n                if (typeof window.initParams[param] == \"undefined\")\n                    return null;\n\n                return window.initParams[param];\n            },\n\n            onPaymentElementContainerRendered: function()\n            {\n                var self = this;\n                this.isLoading(true);\n                this.listPaymentMethods();\n                var initParams = window.initParams;\n\n                stripe.initStripe(initParams, function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    self.initSetupElement(initParams);\n                });\n            },\n\n            onContainerRendered: function()\n            {\n                this.onPaymentElementContainerRendered();\n            },\n\n            crash: function(message)\n            {\n                this.isLoading(false);\n                this.permanentError($t(\"Sorry, an error has occurred. Please contact us for assistance.\"));\n                console.error(\"Error: \" + message);\n            },\n\n            softCrash: function(message)\n            {\n                this.showError($t(\"Sorry, an error has occurred. Please contact us for assistance.\"));\n                this.stripePaymentsError(message);\n                console.error(\"Error: \" + message);\n            },\n\n            initSetupElement: function(params)\n            {\n                if (document.getElementById('stripe-setup-element') === null)\n                    return this.crash(\"Cannot initialize Payment Element on a DOM that does not contain a div.stripe-setup-element.\");\n\n                if (!stripe.stripeJs)\n                    return this.crash(\"Stripe.js could not be initialized.\");\n\n                var elements = this.elements = stripe.stripeJs.elements({\n                    mode: \"setup\",\n                    setup_future_usage: \"on_session\",\n                    locale: params.locale,\n                    currency: params.currency,\n                    appearance: this.getStripePaymentElementOptions(),\n                    paymentMethodCreation: \"manual\"\n                });\n\n                this.paymentElement = elements.create('payment');\n                this.paymentElement.mount('#stripe-setup-element');\n                this.paymentElement.on('change', this.onChange.bind(this));\n                this.isLoading(false);\n            },\n\n            onChange: function(event)\n            {\n                this.isLoading(false);\n                this.isPaymentFormComplete(event.complete);\n            },\n\n            getStripePaymentElementOptions: function()\n            {\n                return {\n                  theme: 'stripe',\n                  variables: {\n                    colorText: '#32325d',\n                    fontFamily: '\"Open Sans\",\"Helvetica Neue\", Helvetica, Arial, sans-serif',\n                  },\n                };\n            },\n\n            getAddressField: function(field)\n            {\n                var address = [];\n\n                if (typeof address[field] == \"undefined\")\n                    return null;\n\n                if (typeof address[field] !== \"string\" && typeof address[field] !== \"object\")\n                    return null;\n\n                if (address[field].length == 0)\n                    return null;\n\n                return address[field];\n            },\n\n            getBillingDetails: function()\n            {\n                var details = {};\n                var address = {};\n\n                if (this.getAddressField('city'))\n                    address.city = this.getAddressField('city');\n\n                if (this.getAddressField('countryId'))\n                    address.country = this.getAddressField('countryId');\n\n                if (this.getAddressField('postcode'))\n                    address.postal_code = this.getAddressField('postcode');\n\n                if (this.getAddressField('region'))\n                    address.state = this.getAddressField('region');\n\n                if (this.getAddressField('street'))\n                {\n                    var street = this.getAddressField('street');\n                    address.line1 = street[0];\n\n                    if (street.length > 1)\n                        address.line2 = street[1];\n                }\n\n                if (Object.keys(address).length > 0)\n                    details.address = address;\n\n                if (this.getAddressField('telephone'))\n                    details.phone = this.getAddressField('telephone');\n\n                if (this.getAddressField('firstname'))\n                    details.name = this.getAddressField('firstname') + ' ' + this.getAddressField('lastname');\n\n                if (customerData.email)\n                    details.email = customerData.email;\n\n                if (Object.keys(details).length > 0)\n                    return details;\n\n                return null;\n            },\n\n            config: function()\n            {\n                return self.initParams;\n            },\n\n            onClick: function(result, outcome, response)\n            {\n                if (!this.isPaymentFormComplete())\n                    return this.showError($t('Please complete the payment method details.'));\n\n                this.clearErrors();\n\n                this.isLoading(true);\n                var onPaymentMethodCreated = this.onPaymentMethodCreated.bind(this);\n                var onFail = this.onFail.bind(this);\n\n                this.createPaymentMethod(onPaymentMethodCreated, onFail);\n            },\n\n            createPaymentMethod: function(onPaymentMethodCreated, onFail)\n            {\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {}\n                };\n\n                this.elements.submit().then(function()\n                {\n                    stripe.stripeJs.createPaymentMethod(paymentMethodData).then(onPaymentMethodCreated, onFail);\n                }, onFail);\n\n            },\n\n            setNewPaymentMethods: function(newMethods, isDuplicate)\n            {\n                this.savedPaymentMethods(newMethods);\n\n                if (isDuplicate)\n                {\n                    this.showSuccessMessage($t(\"An existing payment method has been updated.\"));\n                }\n                else\n                {\n                    this.showSuccessMessage($t(\"The payment method has been saved.\"));\n                }\n\n                this.clearFormData();\n            },\n\n            onPaymentMethodCreated: function(result)\n            {\n                var self = this;\n\n                if (result.error)\n                {\n                    this.showError(result.error.message);\n                }\n                else\n                {\n                    addPaymentMethodAction(result.paymentMethod.id, function(response, status, xhr)\n                    {\n                        self.isLoading(false);\n                        if (status == \"success\")\n                        {\n                            try\n                            {\n                                var data = JSON.parse(response);\n\n                                var methods = self.savedPaymentMethods();\n                                if (!methods)\n                                {\n                                    methods = [];\n                                }\n\n                                var isDuplicate = false;\n                                var newMethods = [];\n\n                                for (var i in methods)\n                                {\n                                    if (methods[i].fingerprint != data.fingerprint)\n                                    {\n                                        newMethods.push(methods[i]);\n                                    }\n                                    else\n                                    {\n                                        isDuplicate = true;\n                                    }\n                                }\n\n                                newMethods.push(data);\n\n                                if (data.client_secret)\n                                {\n                                    stripe.authenticateCustomer(data.client_secret, function(err)\n                                    {\n                                        if (err)\n                                        {\n                                            self.showError($t(\"Sorry, the payment method could not be saved: \" + err));\n                                            return;\n                                        }\n\n                                        self.setNewPaymentMethods(newMethods, isDuplicate);\n                                    });\n                                }\n                                else\n                                {\n                                    self.setNewPaymentMethods(newMethods, isDuplicate);\n                                }\n                            }\n                            catch (e)\n                            {\n                                console.warn(e);\n                                self.showError($t(\"The payment method could not be saved: %1\").replace(\"%1\", e.message));\n                            }\n                        }\n                        else if (response && response.responseJSON && response.responseJSON.message)\n                        {\n                            self.showError(response.responseJSON.message);\n                        }\n                        else\n                        {\n                            self.showError(\"Sorry, the payment methods could not be added.\");\n                            console.warn(response);\n                        }\n                    });\n                }\n            },\n\n            clearFormData: function()\n            {\n                this.paymentElement.clear();\n                $('html, body').animate({ scrollTop: $(\"#my-saved-payment-methods-table\").offset().top - 100}, 500);\n            },\n\n            onFail: function(result)\n            {\n                this.showError(\"Could not set up the payment method. Please try again.\");\n                console.error(result);\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n\n            showSuccessMessage: function(message)\n            {\n                this.isLoading(false);\n                this.messageContainer.addSuccessMessage({ \"message\": message });\n            },\n\n            validate: function(elm)\n            {\n                return true;\n            },\n\n            getCode: function()\n            {\n                return 'stripe_payments';\n            },\n\n            clearErrors: function()\n            {\n                this.messageContainer.clear();\n                this.stripePaymentsError(null);\n            },\n\n            hasPaymentMethodsComputed: function()\n            {\n                return this.savedPaymentMethods() && this.savedPaymentMethods().length > 0;\n            },\n\n            removePaymentMethod: function(fingerprint)\n            {\n                var methods = this.savedPaymentMethods();\n                if (!methods)\n                {\n                    methods = [];\n                }\n\n                var newMethods = [];\n\n                for (var i in methods)\n                {\n                    if (methods[i].fingerprint != fingerprint)\n                    {\n                        newMethods.push(methods[i]);\n                    }\n                }\n\n                return newMethods;\n            },\n\n            deletePaymentMethod: function(paymentMethod)\n            {\n                var sure = confirm($t(\"Are you sure you want to delete this payment method?\"));\n\n                if (!sure)\n                    return;\n\n                var self = this;\n                this.processingSavedPaymentMethods(true);\n                deletePaymentMethodAction(paymentMethod.id, paymentMethod.fingerprint, function(response, status, xhr)\n                {\n                    self.processingSavedPaymentMethods(false);\n                    if (status == \"success\")\n                    {\n                        try\n                        {\n                            var data = JSON.parse(response);\n                            self.showSuccessMessage(data);\n\n                            var newMethods = self.removePaymentMethod(paymentMethod.fingerprint);\n                            self.savedPaymentMethods(newMethods);\n                        }\n                        catch (e)\n                        {\n                            self.showError($t(\"The payment methods could not be deleted: %1\").replace(\"%1\", e.message));\n                        }\n                    }\n                    else if (response && response.responseJSON && response.responseJSON.message)\n                    {\n                        self.showError(response.responseJSON.message);\n                    }\n                    else\n                    {\n                        self.showError($t(\"The payment methods could not be deleted: %1\").replace(\"%1\", response));\n                    }\n                });\n            },\n\n            listPaymentMethods: function()\n            {\n                var self = this;\n                this.processingSavedPaymentMethods(true);\n\n                listPaymentMethodsAction(function(response, status, xhr)\n                {\n                    self.processingSavedPaymentMethods(false);\n                    if (status == \"success\")\n                    {\n                        try\n                        {\n                            var data = JSON.parse(response);\n                            var methods = [];\n\n                            for (var fingerprint in data)\n                            {\n                                methods.push(data[fingerprint]);\n                            }\n\n                            self.savedPaymentMethods(methods);\n                        }\n                        catch (e)\n                        {\n                            console.warn(e);\n                            console.warn(response);\n                        }\n                    }\n                });\n            }\n\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/multishipping/method-renderer/payment_element.js":"define(\n    [\n        'ko',\n        'StripeIntegration_Payments/js/view/payment/method-renderer/stripe_payments_multishipping',\n        'StripeIntegration_Payments/js/stripe',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Customer/js/model/customer',\n        'Magento_Checkout/js/action/set-payment-information',\n        'mage/translate',\n        'mage/url',\n        'jquery',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'mage/storage',\n        'mage/url',\n        'Magento_CheckoutAgreements/js/model/agreement-validator',\n        'Magento_Customer/js/customer-data',\n        'Magento_Ui/js/modal/alert',\n        'domReady!'\n    ],\n    function (\n        ko,\n        Component,\n        stripe,\n        globalMessageList,\n        quote,\n        customer,\n        setPaymentInformationAction,\n        $t,\n        url,\n        $,\n        additionalValidators,\n        storage,\n        urlBuilder,\n        agreementValidator,\n        customerData,\n        alert\n    ) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                template: 'StripeIntegration_Payments/multishipping/payment_element',\n                continueSelector: '#payment-continue',\n                cardElement: null,\n                token: ko.observable(null),\n                params: null,\n                captureMethod: 'automatic'\n            },\n\n            initObservable: function ()\n            {\n                this._super();\n\n                $(this.continueSelector).on(\"click\", this.onContinue.bind(this));\n\n                return this;\n            },\n\n            onPaymentElementContainerRendered: function()\n            {\n                var self = this;\n                this.isLoading(true);\n\n                this.params = window.initParams;\n\n                stripe.initStripe(this.params, function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    self.initSavedPaymentMethods.bind(self)();\n                    self.initPaymentForm.bind(self)();\n                });\n            },\n\n            onContainerRendered: function()\n            {\n                this.onPaymentElementContainerRendered();\n                this.isInitialized(true);\n            },\n\n            initPaymentForm: function()\n            {\n                this.isInitializing(false);\n                this.isLoading(false);\n\n                if (this.isCollapsed()) // Don't render PE with a height of 0\n                    return;\n\n                if (document.getElementById('stripe-payment-element') === null)\n                    return this.crash(\"Cannot initialize Card Element on a DOM that does not contain a div.stripe-card-element.\");\n\n                if (!stripe.stripeJs)\n                    return this.crash(\"Stripe.js could not be initialized.\");\n\n                try\n                {\n                    var elementOptions = this.getElementsOptions(true);\n                    elementOptions.setupFutureUsage = 'on_session';\n                    elementOptions.captureMethod = this.captureMethod;\n                    this.elements = stripe.stripeJs.elements(this.getElementsOptions(true));\n                }\n                catch (e)\n                {\n                    console.warn(\"Could not filter Stripe payment method types: \" + e.message);\n                    this.elements = stripe.stripeJs.elements(this.getElementsOptions(false));\n                }\n\n                this.paymentElement = this.elements.create('payment', this.getPaymentElementOptions());\n                this.paymentElement.mount('#stripe-payment-element');\n                this.paymentElement.on('change', this.onChange.bind(this));\n\n            },\n\n            onSetPaymentMethodFail: function(result)\n            {\n                this.token(null);\n                this.isLoading(false);\n                console.error(result);\n            },\n\n            onContinue: function(e)\n            {\n                // If we already have a tokenized payment method, don't do anything\n                if (this.token())\n                    return;\n\n                var self = this;\n\n                if (!this.isStripeMethodSelected())\n                    return;\n\n                e.preventDefault();\n                e.stopPropagation();\n\n                if (!this.validatePaymentMethod())\n                    return;\n\n                this.isLoading(true);\n\n                if (this.getSelectedMethod(\"type\") && this.getSelectedMethod(\"type\") != \"new\")\n                {\n                    self.token(this.getSelectedMethod(\"value\"));\n                    setPaymentInformationAction(this.messageContainer, this.getData()).then(function(){\n                        $(self.continueSelector).trigger(\"click\");\n                    }).fail(self.onSetPaymentMethodFail.bind(self));\n                }\n                else\n                {\n                    this.createPaymentMethod(function(err)\n                    {\n                        if (err)\n                            return self.showError(err);\n\n                        $(self.continueSelector).trigger(\"click\");\n                    });\n                }\n            },\n\n            createPaymentMethod: function(done)\n            {\n                var self = this;\n\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {}\n                };\n\n                var confirmParams = this.getConfirmParams();\n                var billingDetails = null;\n                if (confirmParams &&\n                    confirmParams.confirmParams &&\n                    confirmParams.confirmParams.payment_method_data &&\n                    confirmParams.confirmParams.payment_method_data.billing_details\n                )\n                {\n                    billingDetails = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n\n                if (billingDetails)\n                {\n                    paymentMethodData.params.billing_details = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n                else\n                {\n                    return this.showError($t(\"Please specify a billing address.\"));\n                }\n\n                this.elements.submit().then(function() {\n                    stripe.stripeJs.createPaymentMethod(paymentMethodData).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                            console.error(result.error.message);\n                        }\n                        else\n                        {\n                            self.token(result.paymentMethod.id);\n\n                            setPaymentInformationAction(self.messageContainer, self.getData()).then(function()\n                            {\n                                done();\n                            }).fail(self.onSetPaymentMethodFail.bind(self));\n                        }\n                    });\n                });\n\n            },\n\n            getData: function()\n            {\n                var data = {\n                    'method': this.item.method,\n                    'additional_data': {\n                        'payment_method': this.token()\n                    }\n                };\n\n                return data;\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                alert({ content: message });\n            },\n\n            validatePaymentMethod: function ()\n            {\n                var methods = $('[name^=\"payment[\"]'), isValid = false;\n\n                if (methods.length === 0)\n                    this.showError( $.mage.__('We can\\'t complete your order because you don\\'t have a payment method set up.') );\n                else if (methods.filter('input:radio:checked').length)\n                    return true;\n                else\n                    this.showError( $.mage.__('Please choose a payment method.') );\n\n                return isValid;\n            },\n\n            isStripeMethodSelected: function()\n            {\n                var methods = $('[name^=\"payment[\"]');\n\n                if (methods.length === 0)\n                    return false;\n\n                var stripe = methods.filter(function(index, value)\n                {\n                    if (value.id == \"p_method_stripe_payments\")\n                        return value;\n                });\n\n                if (stripe.length == 0)\n                    return false;\n\n                return stripe[0].checked;\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/subscription_update/sidebar.js":"define([\n    'ko',\n    'uiComponent',\n    'Magento_Checkout/js/model/totals',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Customer/js/customer-data',\n    'StripeIntegration_Payments/js/helper/subscriptions',\n    'mage/translate',\n    'jquery'\n],\nfunction (\n    ko,\n    Component,\n    totals,\n    quote,\n    customerData,\n    subscriptions,\n    $t,\n    $\n)\n{\n    'use strict';\n\n    return Component.extend({\n        isDisplayed: ko.observable(false),\n        isLoading: totals.isLoading,\n\n        initialize: function()\n        {\n            this._super();\n\n            this.isDisplayed(subscriptions.displaySidebar());\n\n            // var self = this;\n\n            // window.addEventListener('hashchange', function()\n            // {\n            //     self.isDisplayed(subscriptions.displaySidebar());\n            // });\n        },\n\n        getConfig: function(key)\n        {\n            return subscriptions.getConfig(key);\n        },\n\n        cancelUpdate: function()\n        {\n            var cancelUrl = subscriptions.getCancelUrl();\n            var yes = confirm($t(\"Are you sure you want to cancel the subscription update?\"));\n            if (yes)\n            {\n                $.mage.redirect(cancelUrl);\n            }\n        },\n\n    });\n});\n","StripeIntegration_Payments/js/view/subscription_update/review.js":"define(\n    [\n        'ko',\n        'Magento_Checkout/js/view/payment/default',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Customer/js/model/customer',\n        'StripeIntegration_Payments/js/helper/subscriptions',\n        'StripeIntegration_Payments/js/model/upcomingInvoice',\n        'mage/translate',\n        'jquery',\n        'Magento_Checkout/js/action/place-order',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_CheckoutAgreements/js/model/agreement-validator',\n        'Magento_CheckoutAgreements/js/model/agreements-assigner'\n    ],\n    function (\n        ko,\n        Component,\n        globalMessageList,\n        quote,\n        customer,\n        subscriptions,\n        upcomingInvoice,\n        $t,\n        $,\n        placeOrderAction,\n        additionalValidators,\n        agreementValidator,\n        agreementsAssigner\n    ) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                template: 'StripeIntegration_Payments/subscription_update/review',\n            },\n            currentTotals: null,\n            newPrice: ko.observable(\"--\"),\n            isPlaceOrderEnabled: ko.observable(false),\n            credit: ko.observable(null),\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'isLoading',\n                        'stripePaymentsError',\n                        'permanentError',\n                        'userError'\n                    ]);\n\n                var self = this;\n\n                this.initParams = window.checkoutConfig.payment.stripe_payments.initParams;\n\n                upcomingInvoice.initialize();\n                var onUpcomingInvoiceChanged = this.onUpcomingInvoiceChanged.bind(this);\n                upcomingInvoice.onChange(onUpcomingInvoiceChanged);\n\n                return this;\n            },\n\n            getConfig: function(key)\n            {\n                return subscriptions.getConfig(key);\n            },\n\n            crash: function(message)\n            {\n                this.isLoading(false);\n                if (this.userError())\n                    this.showError(this.userError());\n                else\n                    this.permanentError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            softCrash: function(message)\n            {\n                this.isLoading(false);\n                if (this.userError())\n                    this.showError(this.userError());\n                else\n                    this.showError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            onChange: function(event)\n            {\n                this.isLoading(false);\n            },\n\n            placeOrder: function()\n            {\n                if (!this.validate())\n                    return;\n\n                var self = this;\n                this.isPlaceOrderEnabled(false);\n                this.isLoading(true);\n\n                this.getPlaceOrderDeferredObject()\n                    .fail(this.handlePlaceOrderErrors.bind(this))\n                    .done(this.onOrderPlaced.bind(this))\n                    .always(function(){\n                        self.isLoading(false);\n                        self.isPlaceOrderEnabled(true);\n                    });\n            },\n\n            getPlaceOrderDeferredObject: function()\n            {\n                return placeOrderAction(this.getData(), this.messageContainer);\n            },\n\n            handlePlaceOrderErrors: function (result)\n            {\n                if (result && result.responseJSON && result.responseJSON.message)\n                    this.showError(result.responseJSON.message);\n                else\n                {\n                    this.showError($t(\"Sorry, the subscription could not be updated. Please contact us for assistance.\"));\n\n                    if (result && result.responseText)\n                        console.error(result.responseText);\n                    else\n                        console.error(result);\n                }\n            },\n\n            onOrderPlaced: function(result, outcome, response)\n            {\n                if (result && !isNaN(result))\n                {\n                    $.mage.redirect(subscriptions.getSuccessUrl());\n                    return;\n                }\n\n                try\n                {\n                    var jsonResponse = JSON.parse(result);\n                    if (jsonResponse && jsonResponse.error)\n                    {\n                        return this.showError(jsonResponse.error);\n                    }\n                    else\n                    {\n                        console.warn(\"The order could not be placed. The server response was: \" + result);\n                        return this.showError($t(\"Sorry, the subscription could not be updated. Please contact us for assistance.\"));\n                    }\n                }\n                catch (e)\n                {\n                    console.warn(\"The order could not be placed. The error was: \" + e);\n                        return this.showError($t(\"Sorry, the subscription could not be updated. Please contact us for assistance.\"));\n                }\n            },\n\n            getData: function()\n            {\n                var data = {\n                    'method': \"stripe_payments\",\n                    'additional_data': {\n                        'is_subscription_update': true\n                    }\n                };\n\n                agreementsAssigner(data);\n\n                return data;\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n\n            validate: function(elm)\n            {\n                return agreementValidator.validate() && additionalValidators.validate();\n            },\n\n            getCode: function()\n            {\n                return 'stripe_payments';\n            },\n\n            clearErrors: function()\n            {\n                this.stripePaymentsError(null);\n            },\n\n            onUpcomingInvoiceChanged: function(result, outcome, response)\n            {\n                try\n                {\n                    var params = JSON.parse(result);\n\n                    this.resetTotals();\n\n                    if (params && params.error)\n                    {\n                        this.userError(params.error);\n                        return this.softCrash(params.error);\n                    }\n\n                    if (!params || !params.upcomingInvoice)\n                        return this.softCrash(\"Could not retrieve upcoming invoice\");\n\n                    if (params.upcomingInvoice.new_price &&\n                        params.upcomingInvoice.new_price.label &&\n                        params.upcomingInvoice.new_price.label.length > 0)\n                    {\n                        this.newPrice(params.upcomingInvoice.new_price.label);\n                    }\n\n                    if (params.upcomingInvoice.credit)\n                    {\n                        this.credit(params.upcomingInvoice.credit);\n                    }\n\n                    this.isPlaceOrderEnabled(true);\n                }\n                catch (e)\n                {\n                    console.warn(\"Could not calculate subscription update prices\");\n                    console.warn(e);\n                }\n            },\n\n            resetTotals: function()\n            {\n                this.newPrice(\"--\");\n            },\n\n            getCancelUrl: function()\n            {\n                return subscriptions.getCancelUrl();\n            }\n\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/checkout/future_subscriptions.js":"define(\n    [\n        'ko',\n        'Magento_Checkout/js/view/summary/abstract-total',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Catalog/js/price-utils',\n        'Magento_Checkout/js/model/totals',\n        'mage/translate',\n        'StripeIntegration_Payments/js/action/get-future-subscriptions',\n        'Magento_Customer/js/customer-data'\n    ],\n    function (ko, Component, quote, priceUtils, totals, $t, getFutureSubscriptions, customerData) {\n        \"use strict\";\n        return Component.extend({\n            defaults: {\n                isFullTaxSummaryDisplayed: window.checkoutConfig.isFullTaxSummaryDisplayed || false,\n                template: 'StripeIntegration_Payments/checkout/future_subscriptions',\n                futureSubscriptions: ko.observable(window.checkoutConfig.payment.stripe_payments.futureSubscriptions),\n                hasFutureSubscriptions: ko.observable(window.checkoutConfig.payment.stripe_payments.hasFutureSubscriptions),\n                fetching: ko.observable(false)\n            },\n            totals: quote.getTotals(),\n            isTaxDisplayedInGrandTotal: window.checkoutConfig.includeTaxInGrandTotal || false,\n\n            initialize: function ()\n            {\n                this._super();\n\n                this.observe(['futureSubscriptions', 'hasFutureSubscriptions']);\n                this.futureSubscriptions(window.checkoutConfig.payment.stripe_payments.futureSubscriptions);\n                this.hasFutureSubscriptions(window.checkoutConfig.payment.stripe_payments.hasFutureSubscriptions);\n\n                this.canDisplay = ko.computed(function()\n                {\n                    return this.hasFutureSubscriptions();\n                }, this);\n\n                this.getTitle = ko.computed(function()\n                {\n                    return this.getData('title');\n                }, this);\n\n                this.getStartDateLabel = ko.computed(function()\n                {\n                    return this.getData('start_date_label');\n                }, this);\n\n                this.getFrequencyLabel = ko.computed(function()\n                {\n                    return this.getData('frequency_label');\n                }, this);\n\n                this.getFormattedAmount = ko.computed(function()\n                {\n                    return this.getData('formatted_amount');\n                }, this);\n\n                this.futureSubscriptions(this.getFutureSubscriptions());\n\n                var grandTotal = quote.totals().grand_total;\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (grandTotal == quote.totals().grand_total)\n                        return;\n\n                    grandTotal = quote.totals().grand_total;\n\n                    this.refresh(quote);\n                }, this);\n\n                if (quote.isVirtual()) {\n                    quote.billingAddress.subscribe(function (billingAddress) {\n                        if (this.hasFutureSubscriptions()) {\n                            this.refresh(quote);\n                        }\n                    }, this);\n                } else {\n                    quote.shippingAddress.subscribe(function (shippingAddress) {\n                        if (this.hasFutureSubscriptions()) {\n                            this.refresh(quote);\n                        }\n                    }, this);\n                }\n            },\n\n            getFutureSubscriptions: function()\n            {\n                if (\n                    window.checkoutConfig &&\n                    window.checkoutConfig.payment &&\n                    window.checkoutConfig.payment.stripe_payments &&\n                    window.checkoutConfig.payment.stripe_payments.hasFutureSubscriptions &&\n                    window.checkoutConfig.payment.stripe_payments.futureSubscriptions\n                )\n                {\n                    return window.checkoutConfig.payment.stripe_payments.futureSubscriptions;\n                }\n\n                return null;\n            },\n\n            refresh: function(quote)\n            {\n                if (!this.getFutureSubscriptions())\n                    return;\n\n                if (this.fetching())\n                    return;\n\n                var self = this;\n                this.fetching(true);\n\n                getFutureSubscriptions(quote)\n                    .always(function()\n                    {\n                        self.fetching(false);\n                    })\n                    .done(function (subscriptions)\n                    {\n                        try {\n                            var data = JSON.parse(subscriptions);\n                            window.checkoutConfig.payment.stripe_payments.futureSubscriptions = data;\n                            self.futureSubscriptions(data);\n                        } catch (e) {\n                            console.warn('Could not retrieve future subscriptions details: ' + e.message);\n                            self.futureSubscriptions(window.checkoutConfig.payment.stripe_payments.futureSubscriptions);\n                        }\n                    })\n                    .fail(function (xhr, textStatus, errorThrown)\n                    {\n                        console.warn(console.warn('Could not retrieve future subscriptions details: ' + xhr.responseText));\n                    });\n            },\n\n            getData: function(key)\n            {\n                var config = this.futureSubscriptions();\n\n                if (config == null)\n                    return '';\n\n                if ((key in config))\n                    return config[key];\n\n                return '';\n            },\n\n            config: function()\n            {\n                return window.checkoutConfig.payment.stripe_payments;\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/checkout/cart/totals/initial_fee.js":"define(\n    [\n        'StripeIntegration_Payments/js/view/checkout/summary/initial_fee'\n    ],\n    function (Component) {\n        'use strict';\n\n        return Component.extend(\n        {\n            isDisplayed: function ()\n            {\n                return this.getPureValue() !== 0;\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/checkout/summary/initial_fee.js":"define(\n    [\n        'Magento_Checkout/js/view/summary/abstract-total',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Catalog/js/price-utils',\n        'Magento_Checkout/js/model/totals'\n    ],\n    function (Component, quote, priceUtils, totals) {\n        \"use strict\";\n        return Component.extend({\n            defaults: {\n                isFullTaxSummaryDisplayed: window.checkoutConfig.isFullTaxSummaryDisplayed || false,\n                template: 'StripeIntegration_Payments/checkout/summary/initial_fee'\n            },\n            totals: quote.getTotals(),\n            isTaxDisplayedInGrandTotal: window.checkoutConfig.includeTaxInGrandTotal || false,\n\n            isDisplayed: function() {\n                return this.isFullMode() && this.getPureValue() !== 0;\n            },\n\n            getValue: function() {\n                var price = 0;\n                if (this.totals() && totals.getSegment('initial_fee')) {\n                    price = totals.getSegment('initial_fee').value;\n                }\n                return this.getFormattedPrice(price);\n            },\n            getPureValue: function() {\n                var price = 0;\n                if (this.totals() && totals.getSegment('initial_fee')) {\n                    price = totals.getSegment('initial_fee').value;\n                }\n                return price;\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/payment/stripe_payments.js":"define(\n    [\n        'uiComponent',\n        'Magento_Checkout/js/model/payment/renderer-list',\n        'Magento_Checkout/js/model/payment/method-group',\n        'StripeIntegration_Payments/js/helper/subscriptions'\n    ],\n    function (\n        Component,\n        rendererList,\n        methodGroup,\n        subscriptions\n    ) {\n        'use strict';\n\n        var subscriptionUpdateComponent = null;\n        if (subscriptions.isSubscriptionUpdate())\n        {\n            subscriptionUpdateComponent = 'StripeIntegration_Payments/js/view/subscription_update/review';\n        }\n\n        rendererList.push(\n            {\n                type: 'stripe_payments',\n                component: subscriptionUpdateComponent || 'StripeIntegration_Payments/js/view/payment/method-renderer/stripe_payments'\n            },\n            {\n                type: 'stripe_payments_checkout',\n                component: subscriptionUpdateComponent || 'StripeIntegration_Payments/js/view/payment/method-renderer/checkout'\n            },\n            {\n                type: 'stripe_payments_bank_transfers',\n                component: subscriptionUpdateComponent || 'StripeIntegration_Payments/js/view/payment/method-renderer/bank_transfers'\n            }\n        );\n\n        // Add view logic here if needed\n        return Component.extend({});\n    }\n);\n","StripeIntegration_Payments/js/view/payment/express_checkout.js":"// This file can only be loaded at the checkout page because it injects Magento_Checkout/js/model/quote\ndefine(\n    [\n        'jquery',\n        'uiComponent',\n        'StripeIntegration_Payments/js/helper/subscriptions',\n        'stripe_payments_express',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Ui/js/model/messageList'\n    ],\n    function (\n        $,\n        Component,\n        subscriptions,\n        stripeExpress,\n        quote,\n        globalMessageList\n    ) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                // template: 'StripeIntegration_Payments/payment/express_checkout',\n                stripePaymentsShowExpressCheckoutSection: false,\n                isECErendered: false\n            },\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'stripePaymentsShowExpressCheckoutSection',\n                        'isExpressCheckoutElementSupported'\n                    ]);\n\n                if (subscriptions.isSubscriptionUpdate())\n                    return this;\n\n                var self = this;\n                var currentTotals = quote.totals();\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (JSON.stringify(totals.total_segments) == JSON.stringify(currentTotals.total_segments))\n                        return;\n\n                    currentTotals = totals;\n\n                    if (!self.isECErendered)\n                        return;\n\n                    self.initECE();\n                }, this);\n\n                quote.paymentMethod.subscribe(function(method)\n                {\n                    if (method != null)\n                    {\n                        $(\".payment-method.stripe-payments.mobile\").removeClass(\"_active\");\n                    }\n                }, null, 'change');\n\n                return this;\n            },\n\n            initECE: function()\n            {\n                if (!this.config().enabled)\n                    return;\n\n                var self = this;\n                var params = self.config().initParams;\n                var payload = {\n                    location: 'checkout'\n                };\n                stripeExpress.initStripeExpress('#payment-request-button', params, payload, self.config().buttonConfig,\n                    function () {\n                        self.isExpressCheckoutElementSupported(true);\n                        self.stripePaymentsShowExpressCheckoutSection(true);\n                        stripeExpress.initCheckoutWidget(self.validate.bind(self));\n                        self.isECErendered = true;\n                    }\n                );\n            },\n\n            config: function()\n            {\n                return window.checkoutConfig.payment.express_checkout;\n            },\n\n            validate: function()\n            {\n                var agreementsConfig = window.checkoutConfig ? window.checkoutConfig.checkoutAgreements : {},\n                    agreementsInputPath = '.payment-method.stripe-payments.mobile div.checkout-agreements input';\n                var isValid = true;\n\n                if (!agreementsConfig.isEnabled || $(agreementsInputPath).length === 0) {\n                    return true;\n                }\n\n                $(agreementsInputPath).each(function (index, element)\n                {\n                    if (!$.validator.validateSingleElement(element, {\n                        errorElement: 'div',\n                        hideError: false\n                    })) {\n                        isValid = false;\n                    }\n                });\n\n                return isValid;\n            },\n\n            showError: function(message)\n            {\n                document.getElementById('checkout').scrollIntoView(true);\n                globalMessageList.addErrorMessage({ \"message\": message });\n            }\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/payment/method-renderer/stripe_payments_multishipping.js":"define(\n    [\n        'ko',\n        'Magento_Checkout/js/view/payment/default',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Customer/js/model/customer',\n        'StripeIntegration_Payments/js/action/post-update-cart',\n        'StripeIntegration_Payments/js/action/post-restore-quote',\n        'StripeIntegration_Payments/js/action/get-requires-action',\n        'StripeIntegration_Payments/js/view/checkout/future_subscriptions',\n        'StripeIntegration_Payments/js/stripe',\n        'stripe_payments_express',\n        'mage/translate',\n        'mage/url',\n        'jquery',\n        'Magento_Checkout/js/action/place-order',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Checkout/js/action/redirect-on-success',\n        'mage/storage',\n        'mage/url',\n        'Magento_CheckoutAgreements/js/model/agreement-validator',\n        'Magento_Customer/js/customer-data',\n        'Magento_Checkout/js/model/payment-service'\n    ],\n    function (\n        ko,\n        Component,\n        globalMessageList,\n        quote,\n        customer,\n        updateCartAction,\n        restoreQuoteAction,\n        getRequiresAction,\n        futureSubscriptions,\n        stripe,\n        stripeExpress,\n        $t,\n        url,\n        $,\n        placeOrderAction,\n        additionalValidators,\n        redirectOnSuccessAction,\n        storage,\n        urlBuilder,\n        agreementValidator,\n        customerData,\n        paymentService\n    ) {\n        'use strict';\n\n        return Component.extend({\n            externalRedirectUrl: null,\n            defaults: {\n                template: 'StripeIntegration_Payments/payment/element',\n                stripePaymentsShowApplePaySection: false\n            },\n            redirectAfterPlaceOrder: false,\n            elements: null,\n            initParams: null,\n            paymentElement: null,\n            zeroDecimalCurrencies: ['BIF','CLP','DJF','GNF','JPY','KMF','KRW','MGA','PYG','RWF','UGX','VND','VUV','XAF','XOF','XPF'],\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'paymentElement',\n                        'isPaymentFormComplete',\n                        'isPaymentFormVisible',\n                        'isLoading',\n                        'stripePaymentsError',\n                        'permanentError',\n                        'isOrderPlaced',\n                        'isInitializing',\n                        'isInitialized',\n                        'useQuoteBillingAddress',\n                        'cvcToken',\n                        'paymentElementPaymentMethod',\n\n                        // Saved payment methods dropdown\n                        'dropdownOptions',\n                        'selection',\n                        'isDropdownOpen'\n                    ]);\n\n                var self = this;\n\n                this.isPaymentFormVisible(false);\n                this.isOrderPlaced(false);\n                this.isInitializing(true);\n                this.isInitialized(false);\n                this.useQuoteBillingAddress(false);\n                this.cvcToken(null);\n                this.collectCvc = ko.computed(this.shouldCollectCvc.bind(this));\n                this.isAmex = ko.computed(this.isAmexSelected.bind(this));\n                this.cardCvcElement = null;\n\n                var currentTotals = quote.totals();\n                var currentShippingAddress = quote.shippingAddress();\n                var currentBillingAddress = quote.billingAddress();\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (!totals || !totals.grand_total || !totals.quote_currency_code)\n                    {\n                        return;\n                    }\n\n                    if (!currentTotals || !currentTotals.grand_total || !currentTotals.quote_currency_code)\n                    {\n                        currentTotals = totals;\n                        return;\n                    }\n\n                    var amount1 = totals.grand_total;\n                    var amount2 = currentTotals.grand_total;\n                    var currency1 = totals.quote_currency_code;\n                    var currency2 = currentTotals.quote_currency_code;\n\n                    if (amount1 === amount2 && currency1 === currency2)\n                    {\n                        return;\n                    }\n\n                    currentTotals = totals;\n\n                    self.onQuoteTotalsChanged.bind(self)();\n                    self.isOrderPlaced(false);\n                }, this);\n\n                quote.paymentMethod.subscribe(function (method)\n                {\n                    if (method.method == this.getCode() && !this.isInitializing())\n                    {\n                        // We intentionally re-create the element because its container element may have changed\n                        this.initPaymentForm();\n                    }\n                }, this);\n\n                quote.billingAddress.subscribe(function(address)\n                {\n                    if (address && self.paymentElement && self.paymentElement.update && !self.isPaymentFormComplete())\n                    {\n                        // Remove the postcode & country fields if a billing address has been specified\n                        self.paymentElement.update(self.getPaymentElementUpdateOptions());\n                    }\n                });\n\n                return this;\n            },\n\n            initSavedPaymentMethods: function()\n            {\n                // If it is already initialized, do not re-initialize\n                if (this.dropdownOptions())\n                {\n                    return;\n                }\n\n                var options = [];\n                var methods = this.getStripeParam(\"savedMethods\");\n                if (methods)\n                {\n                    for (var i in methods)\n                    {\n                        if (methods.hasOwnProperty(i))\n                        {\n                            // We do this because some themes and libraries extend all objects with their own methods\n                            options.push(methods[i]);\n                        }\n                    }\n                }\n\n                if (options.length > 0)\n                {\n                    this.isPaymentFormVisible(false);\n                    this.selection(options[0]);\n                }\n                else\n                {\n                    this.isPaymentFormVisible(true);\n                    this.selection(false);\n                }\n\n                this.dropdownOptions(options);\n            },\n\n            shouldCollectCvc: function()\n            {\n                var selection = this.selection();\n\n                if (!selection)\n                    return false;\n\n                if (selection.type != 'card')\n                    return false;\n\n                return !!selection.cvc;\n            },\n\n            isAmexSelected: function()\n            {\n                var selection = this.selection();\n\n                if (!selection)\n                    return false;\n\n                if (selection.type != 'card')\n                    return false;\n\n                return (selection.brand == \"amex\");\n            },\n\n            newPaymentMethod: function()\n            {\n                this.messageContainer.clear();\n\n                this.selection({\n                    type: 'new',\n                    value: 'new',\n                    icon: false,\n                    label: $t('New payment method')\n                });\n                this.isDropdownOpen(false);\n                this.isPaymentFormVisible(true);\n                if (!this.isInitialized())\n                {\n                    this.onContainerRendered();\n                    this.isInitialized(true);\n                }\n            },\n\n            getPaymentMethodId: function()\n            {\n                var selection = this.selection();\n\n                if (selection && typeof selection.value != \"undefined\" && selection.value != \"new\")\n                {\n                    return selection.value;\n                }\n\n                var paymentMethod = this.paymentElementPaymentMethod();\n                if (paymentMethod && paymentMethod.id)\n                {\n                    return paymentMethod.id;\n                }\n\n                return null;\n            },\n\n            toggleDropdown: function()\n            {\n                this.isDropdownOpen(!this.isDropdownOpen());\n            },\n\n            getStripeParam: function(param)\n            {\n                var params = this.getInitParams();\n\n                if (!params)\n                {\n                    return null;\n                }\n\n                if (typeof params[param] != \"undefined\")\n                {\n                    return params[param];\n                }\n\n                return null;\n            },\n\n            onQuoteTotalsChanged: function()\n            {\n                if (!this.elements || !this.elements.update)\n                {\n                    return;\n                }\n\n                try\n                {\n                    this.elements.update(this.getElementsOptions(true));\n                }\n                catch (e)\n                {\n                    this.elements.update(this.getElementsOptions(false));\n                }\n            },\n\n            getInitParams: function()\n            {\n                return window.checkoutConfig.payment.stripe_payments.initParams;\n            },\n\n            onPaymentElementContainerRendered: function()\n            {\n                var self = this;\n                this.isLoading(true);\n                stripe.initStripe(this.getInitParams(), function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    self.initSavedPaymentMethods();\n                    self.initPaymentForm();\n                });\n            },\n\n            onContainerRendered: function()\n            {\n                this.onPaymentElementContainerRendered();\n            },\n\n            getCardCVCOptions: function()\n            {\n                return {\n                  style: {\n                    base: {\n                  //     iconColor: '#c4f0ff',\n                  //     color: '#fff',\n                  //     fontWeight: '500',\n                  //     fontFamily: 'Roboto, Open Sans, Segoe UI, sans-serif',\n                      fontSize: '16px',\n                  //     fontSmoothing: 'antialiased',\n                  //     ':-webkit-autofill': {\n                  //       color: '#fce883',\n                  //     },\n                  //     '::placeholder': {\n                  //       color: '#87BBFD',\n                  //     },\n                  //   },\n                  //   invalid: {\n                  //     iconColor: '#FFC7EE',\n                  //     color: '#FFC7EE',\n                    },\n                  },\n                };\n            },\n\n            onCvcContainerRendered: function()\n            {\n                var self = this;\n                var params = this.getInitParams();\n\n                stripe.initStripe(params, function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    var options = {};\n                    if (params && params.locale)\n                    {\n                        options.locale = params.locale;\n                    }\n\n                    try\n                    {\n                        var elements = stripe.stripeJs.elements(options);\n                        self.cardCvcElement = elements.create('cardCvc', self.getCardCVCOptions());\n                        self.cardCvcElement.mount('#stripe-card-cvc-element');\n                        self.cardCvcElement.on('change', self.onCvcChange.bind(self));\n                    }\n                    catch (e)\n                    {\n                        this.crash(e.message);\n                    }\n                });\n            },\n\n            onCvcChange: function(event)\n            {\n                if (event.error)\n                    this.selection().cvcError = event.error.message;\n                else\n                    this.selection().cvcError = null;\n            },\n\n            crash: function(message)\n            {\n                this.isLoading(false);\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.permanentError(userError);\n                else\n                    this.permanentError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            softCrash: function(message)\n            {\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.showError(userError);\n                else\n                    this.showError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            isCollapsed: function()\n            {\n                if (this.isChecked() == this.getCode())\n                {\n                    return false;\n                }\n                else\n                {\n                    return true;\n                }\n            },\n\n            initPaymentForm: function()\n            {\n                this.isInitializing(false);\n                this.isLoading(false);\n\n                if (this.isCollapsed()) // Don't render PE with a height of 0\n                    return;\n\n                if (document.getElementById('stripe-payment-element') === null)\n                    return this.crash(\"Cannot initialize Payment Element on a DOM that does not contain a div.stripe-payment-element.\");\n\n                if (!stripe.stripeJs)\n                    return this.crash(\"Stripe.js could not be initialized.\");\n\n                if (this.getStripeParam(\"isOrderPlaced\"))\n                    this.isOrderPlaced(true);\n\n                try\n                {\n                    try\n                    {\n                        this.elements = stripe.stripeJs.elements(this.getElementsOptions(true));\n                    }\n                    catch (e)\n                    {\n                        console.warn(\"Could not filter Stripe payment method types: \" + e.message);\n                        this.elements = stripe.stripeJs.elements(this.getElementsOptions(false));\n                    }\n                    this.paymentElement = this.elements.create('payment', this.getPaymentElementOptions());\n                    this.paymentElement.mount('#stripe-payment-element');\n                    this.paymentElement.on('change', this.onChange.bind(this));\n                }\n                catch (e)\n                {\n                    this.crash(e.message);\n                }\n            },\n\n            getElementsOptions: function(filterPaymentMethods)\n            {\n                var options = window.checkoutConfig.payment.stripe_payments.elementOptions;\n\n                if (!filterPaymentMethods && options.payment_method_types)\n                    delete options.payment_method_types;\n\n                if (options.mode != \"setup\")\n                {\n                    options.amount = this.getElementsAmount();\n                    options.currency = this.getElementsCurrency();\n                }\n\n                return options;\n            },\n\n            getPaymentElementOptions: function()\n            {\n                var options = {};\n\n                var params = this.getInitParams();\n                if (params && typeof params.wallets != \"undefined\" && params.wallets)\n                    options.wallets = params.wallets;\n\n                var billingAddress = quote.billingAddress();\n\n                if (billingAddress)\n                {\n                    try\n                    {\n                        this.useQuoteBillingAddress(true);\n\n                        var hasState = (billingAddress.region || billingAddress.regionCode || billingAddress.regionId);\n\n                        options.fields = {\n                            billingDetails: {\n                                name: 'never',\n                                email: 'never',\n                                phone: (billingAddress.telephone ? 'never' : 'auto'),\n                                address: {\n                                    line1: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    line2: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    city: billingAddress.city ? 'never' : 'auto',\n                                    state: hasState ? 'never' : 'auto',\n                                    country: billingAddress.countryId ? 'never' : 'auto',\n                                    postalCode: billingAddress.postcode ? 'never' : 'auto'\n                                }\n                            }\n                        };\n                    }\n                    catch (e)\n                    {\n                        this.useQuoteBillingAddress(false);\n\n                        options.fields = {};\n                        console.warn('Could not retrieve billing address: '  + e.message);\n                    }\n\n                    // Set the default billing address in order to enable the Link payment method\n                    var billingDetails = this.getBillingDetails();\n\n                    if (billingDetails)\n                    {\n                        options.defaultValues = {\n                            billingDetails: billingDetails\n                        };\n                    }\n                }\n                else\n                {\n                    this.useQuoteBillingAddress(false);\n                }\n\n                if (params.layout)\n                {\n                    options.layout = params.layout;\n                }\n\n                return options;\n            },\n\n            getPaymentElementUpdateOptions: function()\n            {\n                var options = this.getPaymentElementOptions();\n\n                if (options.wallets)\n                {\n                    delete options.wallets;\n                }\n\n                return options;\n            },\n\n            onChange: function(event)\n            {\n                this.isLoading(false);\n                this.isPaymentFormComplete(event.complete);\n            },\n\n            getElementsAmount: function()\n            {\n                var totals = quote.totals();\n\n                if (totals && totals.grand_total)\n                {\n                    var amount = totals.grand_total;\n                    return this.convertToStripeAmount(amount, this.getElementsCurrency());\n                }\n\n                return 0;\n            },\n\n            getElementsCurrency: function()\n            {\n                var totals = quote.totals();\n                if (totals && totals.quote_currency_code)\n                {\n                    var currency = totals.quote_currency_code;\n                    return currency.toLowerCase();\n                }\n\n                return 'USD';\n            },\n\n            isBillingAddressSet: function()\n            {\n                return quote.billingAddress() && quote.billingAddress().canUseForBilling();\n            },\n\n            convertToStripeAmount: function(amount, currencyCode)\n            {\n                var code = currencyCode.toUpperCase();\n\n                if (this.zeroDecimalCurrencies.indexOf(code) >= 0)\n                {\n                    return Math.round(amount);\n                }\n                else\n                {\n                    return Math.round(amount * 100);\n                }\n            },\n\n            isPlaceOrderEnabled: function()\n            {\n                if (this.stripePaymentsError())\n                    return false;\n\n                if (this.permanentError())\n                    return false;\n\n                return this.isBillingAddressSet();\n            },\n\n            getAddressField: function(field)\n            {\n                if (!quote.billingAddress())\n                    return null;\n\n                var address = quote.billingAddress();\n\n                if (!address[field] || address[field].length == 0)\n                    return null;\n\n                return address[field];\n            },\n\n            getBillingDetails: function()\n            {\n                var details = {};\n                var address = {};\n\n                if (this.getAddressField('city'))\n                    address.city = this.getAddressField('city');\n\n                if (this.getAddressField('countryId'))\n                    address.country = this.getAddressField('countryId');\n\n                if (this.getAddressField('postcode'))\n                    address.postal_code = this.getAddressField('postcode');\n\n                if (this.getAddressField('region'))\n                    address.state = this.getAddressField('region');\n\n                if (this.getAddressField('street'))\n                {\n                    var street = this.getAddressField('street');\n                    address.line1 = street[0];\n\n                    if (street.length > 1)\n                        address.line2 = street[1];\n                }\n\n                if (Object.keys(address).length > 0)\n                    details.address = address;\n\n                if (this.getAddressField('telephone'))\n                    details.phone = this.getAddressField('telephone');\n\n                if (this.getAddressField('firstname'))\n                    details.name = this.getAddressField('firstname') + ' ' + this.getAddressField('lastname');\n\n                if (quote.guestEmail)\n                    details.email = quote.guestEmail;\n                else if (customerData.email)\n                    details.email = customerData.email;\n\n                if (Object.keys(details).length > 0)\n                    return details;\n\n                return null;\n            },\n\n            config: function()\n            {\n                return window.checkoutConfig.payment[this.getCode()];\n            },\n\n            isActive: function(parents)\n            {\n                return true;\n            },\n\n            placeOrder: function()\n            {\n                this.messageContainer.clear();\n\n                if (!this.isPaymentFormComplete() && !this.getPaymentMethodId())\n                    return this.showError($t('Please complete your payment details.'));\n\n                if (!this.validate())\n                    return;\n\n                this.clearErrors();\n                this.isPlaceOrderActionAllowed(false);\n                this.isLoading(true);\n                this.cvcToken(null);\n\n                var params = { };\n\n                if (this.useQuoteBillingAddress())\n                {\n                    params.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                if (this.hasShipping())\n                {\n                    params.shipping = {\n                        address: this.getStripeFormattedAddress(quote.shippingAddress()),\n                        name: this.getNameFromAddress(quote.shippingAddress())\n                    };\n                }\n\n                var self = this;\n\n                if (this.isSavedCardSelected() && this.selection().cvc)\n                {\n                    stripe.stripeJs.createToken('cvc_update', this.cardCvcElement).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                        }\n                        else if (result.token)\n                        {\n                            self.cvcToken(result.token.id);\n                            self.placeOrderWithSavedPaymentMethod.bind(self)();\n                        }\n                        else\n                        {\n                            self.showError('Could not perform CVC check.');\n                        }\n                    });\n                }\n                else if (this.isSavedPaymentMethodSelected())\n                {\n                    this.placeOrderWithSavedPaymentMethod();\n                }\n                else\n                {\n                    this.createPaymentMethod(this.onPaymentMethodCreatedForOrderPlacement.bind(this));\n                }\n\n                return false;\n            },\n\n            hasShipping: function()\n            {\n                return (quote && quote.shippingMethod() && quote.shippingMethod().method_code);\n            },\n\n            createPaymentMethod: function(callback)\n            {\n                this.paymentElementPaymentMethod(null);\n\n                var self = this;\n\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {}\n                };\n\n                var confirmParams = this.getConfirmParams();\n                var billingDetails = null;\n                if (confirmParams &&\n                    confirmParams.confirmParams &&\n                    confirmParams.confirmParams.payment_method_data &&\n                    confirmParams.confirmParams.payment_method_data.billing_details\n                )\n                {\n                    billingDetails = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n\n                if (billingDetails)\n                {\n                    paymentMethodData.params.billing_details = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n                else\n                {\n                    return this.showError($t(\"Please specify a billing address.\"));\n                }\n\n                this.elements.submit().then(function()\n                {\n                    stripe.stripeJs.createPaymentMethod(paymentMethodData).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                            console.error(result.error.message);\n                        }\n                        else\n                        {\n                            self.paymentElementPaymentMethod(result.paymentMethod);\n                            callback(result.paymentMethod);\n                        }\n                    });\n                },\n                function(result)\n                {\n                    if (result.error)\n                    {\n                        self.showError(result.error.message);\n                        console.error(result.error.message);\n                    }\n                    else\n                    {\n                        self.showError(\"A payment submission error has occurred.\");\n                        console.error(result);\n                    }\n                });\n            },\n\n            isSavedPaymentMethodSelected: function()\n            {\n                var selectedMethodType = this.getSelectedMethod(\"type\");\n\n                if (!selectedMethodType) // There is no saved PMs dropdown\n                    return false;\n\n                if (selectedMethodType != 'new') // A saved PMs is selected\n                    return true;\n\n                return false; // New PM is selected\n            },\n\n            isSavedCardSelected: function()\n            {\n                var selectedMethodType = this.getSelectedMethod(\"type\");\n\n                if (!selectedMethodType) // There is no saved PMs dropdown\n                    return false;\n\n                if (selectedMethodType == 'card') // A saved PMs is selected\n                    return true;\n\n                return false; // New PM is selected\n            },\n\n            placeOrderWithSavedPaymentMethod: function()\n            {\n                var self = this;\n                var placeNewOrder = this.placeNewOrder.bind(this);\n\n                if (this.isOrderPlaced()) // The order was already placed but either 3D Secure failed or the customer pressed the back button from an external payment page\n                {\n                    updateCartAction(this.getData(), this.onCartUpdated.bind(this));\n                }\n                else\n                {\n                    try\n                    {\n                        placeNewOrder();\n                    }\n                    catch (e)\n                    {\n                        this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(e.message);\n                    }\n                }\n            },\n\n            onPaymentMethodCreatedForOrderPlacement: function(paymentMethod)\n            {\n                var placeNewOrder = this.placeNewOrder.bind(this);\n                var self = this;\n\n                if (self.isOrderPlaced()) // The order was already placed but either 3D Secure failed or the customer pressed the back button from an external payment page\n                {\n                    updateCartAction(this.getData(), this.onCartUpdated.bind(this));\n                }\n                else\n                {\n                    try\n                    {\n                        placeNewOrder();\n                    }\n                    catch (e)\n                    {\n                        self.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(e.message);\n                    }\n                }\n            },\n\n            onCartUpdated: function(result, outcome, response)\n            {\n                var placeNewOrder = this.placeNewOrder.bind(this);\n                var onOrderPlaced = this.onOrderPlaced.bind(this);\n                try\n                {\n                    var data = JSON.parse(result);\n                    if (data.error)\n                    {\n                        this.showError(data.error);\n                    }\n                    else if (data.redirect)\n                    {\n                        $.mage.redirect(data.redirect);\n                    }\n                    else if (data.placeNewOrder)\n                    {\n                        placeNewOrder();\n                    }\n                    else\n                    {\n                        onOrderPlaced();\n                    }\n                }\n                catch (e)\n                {\n                    this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                    console.error(e.message);\n                }\n            },\n\n            placeNewOrder: function()\n            {\n                var self = this;\n\n                this.isLoading(false); // Needed for the terms and conditions checkbox\n                this.getPlaceOrderDeferredObject()\n                    .fail(this.handlePlaceOrderErrors.bind(this))\n                    .done(this.onOrderPlaced.bind(this))\n                    .always(function(response, status, xhr)\n                    {\n                        if (status != \"success\")\n                        {\n                            self.isLoading(false);\n                            self.isPlaceOrderEnabled(true);\n                        }\n                    });\n            },\n\n            getSelectedMethod: function(param)\n            {\n                var selection = this.selection();\n                if (!selection)\n                    return null;\n\n                if (typeof selection[param] == \"undefined\")\n                    return null;\n\n                return selection[param];\n            },\n\n            // Called when:\n            // - A brand new order has just been placed\n            // - After updateCartAction() with placeNewOrder == false\n            onOrderPlaced: function(result, outcome, response)\n            {\n                if (!this.isOrderPlaced() && isNaN(result))\n                {\n                    return this.softCrash(\"The order was placed but the response from the server did not include a numeric order ID.\");\n                }\n                else\n                {\n                    this.isOrderPlaced(true);\n                }\n\n                this.isLoading(true);\n                var self = this;\n                var handleNextActions = this.handleNextActions.bind(this);\n                getRequiresAction(function(clientSecret)\n                {\n                    try\n                    {\n                        if (clientSecret && clientSecret.length)\n                        {\n                            stripe.stripeJs.handleNextAction({\n                              clientSecret: clientSecret\n                            }).then(self.onConfirm.bind(self));\n                        }\n                        else\n                        {\n                            // No further actions are needed\n                            self.onConfirm(null);\n                        }\n                    }\n                    catch (e)\n                    {\n                        restoreQuoteAction();\n                        self.showError(\"The order was placed but we could not confirm if the payment was successful.\");\n                        console.error(e);\n                    }\n\n                });\n            },\n\n            isSuccessful: function(stripeObject)\n            {\n\n                if (stripeObject.status == \"requires_action\" &&\n                    stripeObject.next_action &&\n                    stripeObject.next_action.type &&\n                    stripeObject.next_action.type != \"use_stripe_sdk\"\n                )\n                {\n                    // This is the case for vouchers, where an offline payment is required\n                    return true;\n                }\n\n\n                return (['processing', 'requires_capture', 'succeeded'].indexOf(stripeObject.status) >= 0);\n            },\n\n            // Called when:\n            // - A brand new order has just been placed\n            // - After updateCartAction() with placeNewOrder == false\n            handleNextActions: function(stripeObject)\n            {\n                if (!this.isOrderPlaced())\n                {\n                    return this.softCrash(\"Cannot handleNextActions without placing the order first\");\n                }\n\n                var self = this;\n\n                if (this.isSuccessful(stripeObject))\n                {\n                    this.onConfirm(null);\n                }\n                else if (stripeObject.status == \"requires_action\")\n                {\n                    // Non-card based confirms may redirect the customer externally. We restore the quote just before it in case the\n                    // customer clicks the back button on the browser before authenticating the payment.\n                    restoreQuoteAction(function()\n                    {\n                        stripe.stripeJs.handleNextAction({\n                          clientSecret: stripeObject.client_secret\n                        }).then(self.onConfirm.bind(self));\n                    });\n                }\n                else if (stripeObject.status == \"requires_confirmation\")\n                {\n                    // This should only hit when a payment failed with a saved PM, and then the customer switched to PaymentElement to enter a new payment method\n                    restoreQuoteAction(function()\n                    {\n                        // We pass null because we do not want to update the PM. It has already been updated with stripe.updatePaymentIntent\n                        updateCartAction(self.getData(), self.onCartUpdated.bind(self));\n                    });\n                }\n                else if (stripeObject.status == \"requires_payment_method\")\n                {\n                    restoreQuoteAction(function()\n                    {\n                        updateCartAction(self.getData(), self.onCartUpdated.bind(self));\n                    });\n                }\n                else\n                {\n                    restoreQuoteAction(function()\n                    {\n                        self.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(\"Could not finalize order bacause the payment intent is in status \" + stripeObject.status);\n                    });\n                }\n            },\n\n            getConfirmParams: function()\n            {\n                var params = {\n                    elements: this.elements,\n                    confirmParams: {\n                        return_url: this.getStripeParam(\"successUrl\")\n                    }\n                };\n\n                this.getPaymentElementOptions();\n                if (this.useQuoteBillingAddress())\n                {\n                    params.confirmParams.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                return params;\n            },\n\n            getStripeFormattedAddress: function(address)\n            {\n                var stripeAddress = {};\n\n                stripeAddress.state = address.region ? address.region : null;\n                stripeAddress.postal_code = address.postcode ? address.postcode : null;\n                stripeAddress.country = address.countryId ? address.countryId : null;\n                stripeAddress.city = address.city ? address.city : null;\n\n                if (address.street && address.street.length > 0)\n                {\n                    stripeAddress.line1 = address.street[0];\n\n                    if (address.street.length > 1)\n                    {\n                        stripeAddress.line2 = address.street[1];\n                    }\n                    else\n                    {\n                        stripeAddress.line2 = null;\n                    }\n                }\n                else\n                {\n                    stripeAddress.line1 = null;\n                    stripeAddress.line2 = null;\n                }\n\n                return stripeAddress;\n            },\n\n            getBillingEmail: function()\n            {\n                if (quote.guestEmail)\n                {\n                    return quote.guestEmail;\n                }\n                else if (window.checkoutConfig.customerData && window.checkoutConfig.customerData.email)\n                {\n                    return window.checkoutConfig.customerData.email;\n                }\n\n                return null;\n            },\n\n            getNameFromAddress: function(address)\n            {\n                if (!address)\n                    return null;\n\n                var parts = [];\n                if (address.firstname)\n                    parts.push(address.firstname);\n\n                if (address.middlename)\n                    parts.push(address.middlename);\n\n                if (address.lastname)\n                    parts.push(address.lastname);\n\n                return parts.join(\" \");\n            },\n\n            getBillingPhone: function()\n            {\n                var billingAddress = quote.billingAddress();\n                if (!billingAddress)\n                    return null;\n\n                if (billingAddress.telephone)\n                    return billingAddress.telephone;\n\n                return null;\n            },\n\n            onConfirm: function(result)\n            {\n                this.isLoading(false);\n                if (result && result.error)\n                {\n                    this.showError(result.error.message);\n                }\n                else\n                {\n                    customerData.invalidate(['cart']);\n                    var successUrl = this.getStripeParam(\"successUrl\");\n                    $.mage.redirect(successUrl);\n                }\n            },\n\n            /**\n             * @return {*}\n             */\n            getPlaceOrderDeferredObject: function()\n            {\n                return placeOrderAction(this.getData(), this.messageContainer);\n            },\n\n            getClientSecretFromResponse: function(response)\n            {\n                if (typeof response != \"string\")\n                {\n                    return null;\n                }\n\n                if (response.indexOf(\"Authentication Required: \") >= 0)\n                {\n                    return response.substring(\"Authentication Required: \".length);\n                }\n\n                return null;\n            },\n\n            handlePlaceOrderErrors: function (result)\n            {\n                if (result && result.responseJSON && result.responseJSON.message)\n                {\n                    var clientSecret = this.getClientSecretFromResponse(result.responseJSON.message);\n\n                    if (clientSecret)\n                    {\n                        var self = this;\n                        return stripe.authenticateCustomer(clientSecret, function(err)\n                        {\n                            if (err)\n                                return self.showError(err);\n\n                            self.placeNewOrder.bind(self)();\n                        });\n                    }\n                    else\n                    {\n                        this.showError(result.responseJSON.message);\n                    }\n                }\n                else\n                {\n                    this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n\n                    if (result && result.responseText)\n                        console.error(result.responseText);\n                    else\n                        console.error(result);\n                }\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                this.isPlaceOrderEnabled(true);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n\n            validate: function(elm)\n            {\n                return this.validateCvc() && agreementValidator.validate() && additionalValidators.validate();\n            },\n\n            validateCvc: function()\n            {\n                if (!this.selection())\n                    return true;\n\n                if (this.selection().type != \"card\")\n                    return true;\n\n                if (this.selection().cvc != 1)\n                    return true;\n\n                if (typeof this.selection().cvcError == \"undefined\")\n                {\n                    this.showError($t(\"Please enter your card's security code.\"));\n                    return false;\n                }\n                else if (!this.selection().cvcError)\n                {\n                    return true;\n                }\n                else\n                {\n                    this.showError(this.selection().cvcError);\n                    return false;\n                }\n\n                return true;\n            },\n\n            getCode: function()\n            {\n                return 'stripe_payments';\n            },\n\n            getData: function()\n            {\n                var data = {\n                    'method': this.item.method,\n                    'additional_data': {\n                        'payment_method': this.getPaymentMethodId()\n                    }\n                };\n\n                if (this.cvcToken())\n                {\n                    data.additional_data.cvc_token = this.cvcToken();\n                }\n\n                return data;\n            },\n\n            clearErrors: function()\n            {\n                this.stripePaymentsError(null);\n            }\n\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/payment/method-renderer/bank_transfers.js":"define(\n    [\n        'Magento_Checkout/js/view/payment/default',\n        'Magento_Checkout/js/model/quote',\n        'StripeIntegration_Payments/js/action/post-restore-quote',\n        'StripeIntegration_Payments/js/action/get-requires-action',\n        'StripeIntegration_Payments/js/stripe',\n        'mage/translate',\n        'Magento_Checkout/js/action/place-order',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Checkout/js/action/redirect-on-success',\n        'Magento_CheckoutAgreements/js/model/agreement-validator',\n        'Magento_Customer/js/customer-data',\n    ],\n    function (\n        Component,\n        quote,\n        restoreQuoteAction,\n        getRequiresAction,\n        stripe,\n        $t,\n        placeOrderAction,\n        additionalValidators,\n        redirectOnSuccessAction,\n        agreementValidator,\n        customerData\n    ) {\n        'use strict';\n\n        return Component.extend({\n            externalRedirectUrl: null,\n            defaults: {\n                template: 'StripeIntegration_Payments/payment/bank_transfers'\n            },\n            redirectAfterPlaceOrder: false,\n            elements: null,\n            initParams: null,\n            paymentElement: null,\n            zeroDecimalCurrencies: ['BIF','CLP','DJF','GNF','JPY','KMF','KRW','MGA','PYG','RWF','UGX','VND','VUV','XAF','XOF','XPF'],\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'paymentElement',\n                        'isPaymentFormComplete',\n                        'isLoading',\n                        'stripePaymentsError',\n                        'permanentError',\n                        'isInitializing',\n                        'isInitialized',\n                        'useQuoteBillingAddress',\n                        'paymentElementPaymentMethod',\n                    ]);\n\n                var self = this;\n\n                this.isInitializing(true);\n                this.isInitialized(false);\n                this.useQuoteBillingAddress(false);\n\n                quote.paymentMethod.subscribe(function (method)\n                {\n                    if (method && method.method == this.getCode() && !this.isInitializing())\n                    {\n                        // We intentionally re-create the element because its container element may have changed\n                        this.initPaymentForm();\n                    }\n                }, this);\n\n                quote.billingAddress.subscribe(function(address)\n                {\n                    if (address && self.paymentElement && self.paymentElement.update && !self.isPaymentFormComplete())\n                    {\n                        // Remove the postcode & country fields if a billing address has been specified\n                        self.paymentElement.update(self.getPaymentElementUpdateOptions());\n                    }\n                });\n\n                return this;\n            },\n\n\n            getPaymentMethodId: function()\n            {\n                var paymentMethod = this.paymentElementPaymentMethod();\n                if (paymentMethod && paymentMethod.id)\n                {\n                    return paymentMethod.id;\n                }\n\n                return null;\n            },\n\n            getStripeParam: function(param)\n            {\n                var params = this.getInitParams();\n\n                if (!params)\n                {\n                    return null;\n                }\n\n                if (typeof params[param] != \"undefined\")\n                {\n                    return params[param];\n                }\n\n                return null;\n            },\n\n            getInitParams: function()\n            {\n                return window.checkoutConfig.payment.stripe_payments_bank_transfers.initParams;\n            },\n\n            onPaymentElementContainerRendered: function()\n            {\n                var self = this;\n                this.isLoading(true);\n                stripe.initStripe(this.getInitParams(), function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    self.initPaymentForm();\n                });\n            },\n\n            onContainerRendered: function()\n            {\n                this.onPaymentElementContainerRendered();\n            },\n\n            crash: function(message)\n            {\n                this.isLoading(false);\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.permanentError(userError);\n                else\n                    this.permanentError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            softCrash: function(message)\n            {\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.showError(userError);\n                else\n                    this.showError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \" + message);\n            },\n\n            isCollapsed: function()\n            {\n                if (this.isChecked() == this.getCode())\n                {\n                    return false;\n                }\n                else\n                {\n                    return true;\n                }\n            },\n\n            initPaymentForm: function()\n            {\n                this.isInitializing(false);\n                this.isLoading(false);\n\n                if (this.isCollapsed()) // Don't render PE with a height of 0\n                    return;\n\n                if (document.getElementById('stripe-payment-element-bank-transfers') === null)\n                    return this.crash(\"Cannot initialize Payment Element on a DOM that does not contain a div.stripe-payment-element-bank-transfers.\");\n\n                if (!stripe.stripeJs)\n                    return this.crash(\"Stripe.js could not be initialized.\");\n\n                try\n                {\n                    this.elements = stripe.stripeJs.elements(this.getElementsOptions());\n                    this.paymentElement = this.elements.create('payment', this.getPaymentElementOptions());\n                    this.paymentElement.mount('#stripe-payment-element-bank-transfers');\n                    this.paymentElement.on('change', this.onChange.bind(this));\n                }\n                catch (e)\n                {\n                    this.crash(e.message);\n                }\n            },\n\n            getElementsOptions: function()\n            {\n                var options = window.checkoutConfig.payment.stripe_payments_bank_transfers.elementOptions;\n\n                options.amount = this.getElementsAmount();\n                options.currency = this.getElementsCurrency();\n\n                return options;\n            },\n\n            getPaymentElementOptions: function()\n            {\n                var options = {};\n\n                var billingAddress = quote.billingAddress();\n\n                if (billingAddress)\n                {\n                    try\n                    {\n                        this.useQuoteBillingAddress(true);\n\n                        var hasState = (billingAddress.region || billingAddress.regionCode || billingAddress.regionId);\n\n                        options.fields = {\n                            billingDetails: {\n                                name: 'never',\n                                email: 'never',\n                                phone: (billingAddress.telephone ? 'never' : 'auto'),\n                                address: {\n                                    line1: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    line2: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    city: billingAddress.city ? 'never' : 'auto',\n                                    state: hasState ? 'never' : 'auto',\n                                    country: billingAddress.countryId ? 'never' : 'auto',\n                                    postalCode: billingAddress.postcode ? 'never' : 'auto'\n                                }\n                            }\n                        };\n                    }\n                    catch (e)\n                    {\n                        this.useQuoteBillingAddress(false);\n\n                        options.fields = {};\n                        console.warn('Could not retrieve billing address: '  + e.message);\n                    }\n\n                    // Set the default billing address in order to enable the Link payment method\n                    var billingDetails = this.getBillingDetails();\n\n                    if (billingDetails)\n                    {\n                        options.defaultValues = {\n                            billingDetails: billingDetails\n                        };\n                    }\n                }\n                else\n                {\n                    this.useQuoteBillingAddress(false);\n                }\n\n                return options;\n            },\n\n            getPaymentElementUpdateOptions: function()\n            {\n                var options = this.getPaymentElementOptions();\n\n                if (options.wallets)\n                {\n                    delete options.wallets;\n                }\n\n                return options;\n            },\n\n            onChange: function(event)\n            {\n                this.isLoading(false);\n                this.isPaymentFormComplete(event.complete);\n            },\n\n            getElementsAmount: function()\n            {\n                var totals = quote.totals();\n\n                if (totals && totals.grand_total)\n                {\n                    var amount = totals.grand_total;\n                    return this.convertToStripeAmount(amount, this.getElementsCurrency());\n                }\n\n                return 0;\n            },\n\n            getElementsCurrency: function()\n            {\n                var totals = quote.totals();\n                if (totals && totals.quote_currency_code)\n                {\n                    var currency = totals.quote_currency_code;\n                    return currency.toLowerCase();\n                }\n\n                return 'USD';\n            },\n\n            isBillingAddressSet: function()\n            {\n                return quote.billingAddress() && quote.billingAddress().canUseForBilling();\n            },\n\n            convertToStripeAmount: function(amount, currencyCode)\n            {\n                var code = currencyCode.toUpperCase();\n\n                if (this.zeroDecimalCurrencies.indexOf(code) >= 0)\n                {\n                    return Math.round(amount);\n                }\n                else\n                {\n                    return Math.round(amount * 100);\n                }\n            },\n\n            isPlaceOrderEnabled: function()\n            {\n                if (this.stripePaymentsError())\n                    return false;\n\n                if (this.permanentError())\n                    return false;\n\n                return this.isBillingAddressSet();\n            },\n\n            getAddressField: function(field)\n            {\n                if (!quote.billingAddress())\n                    return null;\n\n                var address = quote.billingAddress();\n\n                if (!address[field] || address[field].length == 0)\n                    return null;\n\n                return address[field];\n            },\n\n            getBillingDetails: function()\n            {\n                var details = {};\n                var address = {};\n\n                if (this.getAddressField('city'))\n                    address.city = this.getAddressField('city');\n\n                if (this.getAddressField('countryId'))\n                    address.country = this.getAddressField('countryId');\n\n                if (this.getAddressField('postcode'))\n                    address.postal_code = this.getAddressField('postcode');\n\n                if (this.getAddressField('region'))\n                    address.state = this.getAddressField('region');\n\n                if (this.getAddressField('street'))\n                {\n                    var street = this.getAddressField('street');\n                    address.line1 = street[0];\n\n                    if (street.length > 1)\n                        address.line2 = street[1];\n                }\n\n                if (Object.keys(address).length > 0)\n                    details.address = address;\n\n                if (this.getAddressField('telephone'))\n                    details.phone = this.getAddressField('telephone');\n\n                if (this.getAddressField('firstname'))\n                    details.name = this.getAddressField('firstname') + ' ' + this.getAddressField('lastname');\n\n                if (quote.guestEmail)\n                    details.email = quote.guestEmail;\n                else if (customerData.email)\n                    details.email = customerData.email;\n\n                if (Object.keys(details).length > 0)\n                    return details;\n\n                return null;\n            },\n\n            config: function()\n            {\n                return window.checkoutConfig.payment[this.getCode()];\n            },\n\n            placeOrder: function()\n            {\n                this.messageContainer.clear();\n\n                if (!this.isPaymentFormComplete() && !this.getPaymentMethodId())\n                    return this.showError($t('Please complete your payment details.'));\n\n                if (!this.validate())\n                    return;\n\n                this.clearErrors();\n                this.isPlaceOrderActionAllowed(false);\n                this.isLoading(true);\n\n                var params = { };\n\n                if (this.useQuoteBillingAddress())\n                {\n                    params.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                if (this.hasShipping())\n                {\n                    params.shipping = {\n                        address: this.getStripeFormattedAddress(quote.shippingAddress()),\n                        name: this.getNameFromAddress(quote.shippingAddress())\n                    };\n                }\n\n                this.createPaymentMethod(this.onPaymentMethodCreatedForOrderPlacement.bind(this));\n\n                return false;\n            },\n\n            hasShipping: function()\n            {\n                return (quote && quote.shippingMethod() && quote.shippingMethod().method_code);\n            },\n\n            createPaymentMethod: function(callback)\n            {\n                this.paymentElementPaymentMethod(null);\n\n                var self = this;\n\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {}\n                };\n\n                var confirmParams = this.getConfirmParams();\n                var billingDetails = null;\n                if (confirmParams &&\n                    confirmParams.confirmParams &&\n                    confirmParams.confirmParams.payment_method_data &&\n                    confirmParams.confirmParams.payment_method_data.billing_details\n                )\n                {\n                    billingDetails = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n\n                if (billingDetails)\n                {\n                    paymentMethodData.params.billing_details = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n                else\n                {\n                    return this.showError($t(\"Please specify a billing address.\"));\n                }\n\n                this.elements.submit().then(function()\n                {\n                    stripe.stripeJs.createPaymentMethod(paymentMethodData).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                            console.error(result.error.message);\n                        }\n                        else\n                        {\n                            self.paymentElementPaymentMethod(result.paymentMethod);\n                            callback(result.paymentMethod);\n                        }\n                    });\n                },\n                function(result)\n                {\n                    if (result.error)\n                    {\n                        self.showError(result.error.message);\n                        console.error(result.error.message);\n                    }\n                    else\n                    {\n                        self.showError(\"A payment submission error has occurred.\");\n                        console.error(result);\n                    }\n                });\n            },\n\n            onPaymentMethodCreatedForOrderPlacement: function(paymentMethod)\n            {\n                var placeNewOrder = this.placeNewOrder.bind(this);\n                var self = this;\n\n                try\n                {\n                    placeNewOrder();\n                }\n                catch (e)\n                {\n                    self.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                    console.error(e.message);\n                }\n            },\n\n            placeNewOrder: function()\n            {\n                var self = this;\n\n                this.isLoading(false); // Needed for the terms and conditions checkbox\n                this.getPlaceOrderDeferredObject()\n                    .fail(this.handlePlaceOrderErrors.bind(this))\n                    .done(this.onOrderPlaced.bind(this))\n                    .always(function(response, status, xhr)\n                    {\n                        if (status != \"success\")\n                        {\n                            self.isLoading(false);\n                            self.isPlaceOrderEnabled(true);\n                        }\n                    });\n            },\n\n            onOrderPlaced: function(result, outcome, response)\n            {\n                this.isLoading(true);\n                var self = this;\n                getRequiresAction(function(clientSecret)\n                {\n                    try\n                    {\n                        if (clientSecret && clientSecret.length)\n                        {\n                            stripe.stripeJs.handleNextAction({\n                              clientSecret: clientSecret\n                            }).then(self.onConfirm.bind(self));\n                        }\n                        else\n                        {\n                            // No further actions are needed\n                            self.onConfirm(null);\n                        }\n                    }\n                    catch (e)\n                    {\n                        restoreQuoteAction();\n                        self.showError(\"The order was placed but we could not confirm if the payment was successful.\");\n                        console.error(e);\n                    }\n\n                });\n            },\n\n            isSuccessful: function(stripeObject)\n            {\n\n                if (stripeObject.status == \"requires_action\" &&\n                    stripeObject.next_action &&\n                    stripeObject.next_action.type &&\n                    stripeObject.next_action.type != \"use_stripe_sdk\"\n                )\n                {\n                    // This is the case for vouchers, where an offline payment is required\n                    return true;\n                }\n\n                return (['processing', 'requires_capture', 'succeeded'].indexOf(stripeObject.status) >= 0);\n            },\n\n            getConfirmParams: function()\n            {\n                var params = {\n                    elements: this.elements,\n                    confirmParams: {\n                        return_url: this.getStripeParam(\"successUrl\")\n                    }\n                };\n\n                this.getPaymentElementOptions();\n                if (this.useQuoteBillingAddress())\n                {\n                    params.confirmParams.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                return params;\n            },\n\n            getStripeFormattedAddress: function(address)\n            {\n                var stripeAddress = {};\n\n                stripeAddress.state = address.region ? address.region : null;\n                stripeAddress.postal_code = address.postcode ? address.postcode : null;\n                stripeAddress.country = address.countryId ? address.countryId : null;\n                stripeAddress.city = address.city ? address.city : null;\n\n                if (address.street && address.street.length > 0)\n                {\n                    stripeAddress.line1 = address.street[0];\n\n                    if (address.street.length > 1)\n                    {\n                        stripeAddress.line2 = address.street[1];\n                    }\n                    else\n                    {\n                        stripeAddress.line2 = null;\n                    }\n                }\n                else\n                {\n                    stripeAddress.line1 = null;\n                    stripeAddress.line2 = null;\n                }\n\n                return stripeAddress;\n            },\n\n            getBillingEmail: function()\n            {\n                if (quote.guestEmail)\n                {\n                    return quote.guestEmail;\n                }\n                else if (window.checkoutConfig.customerData && window.checkoutConfig.customerData.email)\n                {\n                    return window.checkoutConfig.customerData.email;\n                }\n\n                return null;\n            },\n\n            getNameFromAddress: function(address)\n            {\n                if (!address)\n                    return null;\n\n                var parts = [];\n                if (address.firstname)\n                    parts.push(address.firstname);\n\n                if (address.middlename)\n                    parts.push(address.middlename);\n\n                if (address.lastname)\n                    parts.push(address.lastname);\n\n                return parts.join(\" \");\n            },\n\n            getBillingPhone: function()\n            {\n                var billingAddress = quote.billingAddress();\n                if (!billingAddress)\n                    return null;\n\n                if (billingAddress.telephone)\n                    return billingAddress.telephone;\n\n                return null;\n            },\n\n            onConfirm: function(result)\n            {\n                this.isLoading(false);\n                if (result && result.error)\n                {\n                    this.showError(result.error.message);\n                }\n                else\n                {\n                    customerData.invalidate(['cart']);\n                    redirectOnSuccessAction.execute();\n                }\n            },\n\n            /**\n             * @return {*}\n             */\n            getPlaceOrderDeferredObject: function()\n            {\n                return placeOrderAction(this.getData(), this.messageContainer);\n            },\n\n            getClientSecretFromResponse: function(response)\n            {\n                if (typeof response != \"string\")\n                {\n                    return null;\n                }\n\n                if (response.indexOf(\"Authentication Required: \") >= 0)\n                {\n                    return response.substring(\"Authentication Required: \".length);\n                }\n\n                return null;\n            },\n\n            handlePlaceOrderErrors: function (result)\n            {\n                if (result && result.responseJSON && result.responseJSON.message)\n                {\n                    var clientSecret = this.getClientSecretFromResponse(result.responseJSON.message);\n\n                    if (clientSecret)\n                    {\n                        var self = this;\n                        return stripe.authenticateCustomer(clientSecret, function(err)\n                        {\n                            if (err)\n                                return self.showError(err);\n\n                            self.placeNewOrder.bind(self)();\n                        });\n                    }\n                    else\n                    {\n                        this.showError(result.responseJSON.message);\n                    }\n                }\n                else\n                {\n                    this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n\n                    if (result && result.responseText)\n                        console.error(result.responseText);\n                    else\n                        console.error(result);\n                }\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                this.isPlaceOrderEnabled(true);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n\n            validate: function(elm)\n            {\n                return agreementValidator.validate() && additionalValidators.validate();\n            },\n\n            getCode: function()\n            {\n                return 'stripe_payments_bank_transfers';\n            },\n\n            getData: function()\n            {\n                var data = {\n                    'method': this.item.method,\n                    'additional_data': {\n                        'payment_method': this.getPaymentMethodId(),\n                    }\n                };\n\n                return data;\n            },\n\n            clearErrors: function()\n            {\n                this.stripePaymentsError(null);\n            }\n\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/payment/method-renderer/stripe_payments.js":"define(\n    [\n        'ko',\n        'Magento_Checkout/js/view/payment/default',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Customer/js/model/customer',\n        'StripeIntegration_Payments/js/action/post-update-cart',\n        'StripeIntegration_Payments/js/action/post-restore-quote',\n        'StripeIntegration_Payments/js/action/post-cancel-order',\n        'StripeIntegration_Payments/js/action/get-requires-action',\n        'StripeIntegration_Payments/js/view/checkout/future_subscriptions',\n        'StripeIntegration_Payments/js/stripe',\n        'stripe_payments_express',\n        'mage/translate',\n        'mage/url',\n        'jquery',\n        'Magento_Checkout/js/action/place-order',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Checkout/js/action/redirect-on-success',\n        'mage/storage',\n        'mage/url',\n        'Magento_CheckoutAgreements/js/model/agreement-validator',\n        'Magento_Customer/js/customer-data',\n        'Magento_Checkout/js/model/payment-service'\n    ],\n    function (\n        ko,\n        Component,\n        globalMessageList,\n        quote,\n        customer,\n        updateCartAction,\n        restoreQuoteAction,\n        cancelLastOrderAction,\n        getRequiresAction,\n        futureSubscriptions,\n        stripe,\n        stripeExpress,\n        $t,\n        url,\n        $,\n        placeOrderAction,\n        additionalValidators,\n        redirectOnSuccessAction,\n        storage,\n        urlBuilder,\n        agreementValidator,\n        customerData,\n        paymentService\n    ) {\n        'use strict';\n\n        return Component.extend({\n            externalRedirectUrl: null,\n            defaults: {\n                template: 'StripeIntegration_Payments/payment/element',\n                stripePaymentsShowExpressCheckoutSection: false\n            },\n            redirectAfterPlaceOrder: false,\n            elements: null,\n            initParams: null,\n            paymentElement: null,\n            zeroDecimalCurrencies: ['BIF','CLP','DJF','GNF','JPY','KMF','KRW','MGA','PYG','RWF','UGX','VND','VUV','XAF','XOF','XPF'],\n            threeDecimalCurrencies: ['BHD','JOD','KWD','OMR','TND'],\n            selectedPaymentMethodCode: null,\n\n            initObservable: function ()\n            {\n                this._super()\n                    .observe([\n                        'paymentElement',\n                        'isPaymentFormComplete',\n                        'isPaymentFormVisible',\n                        'isLoading',\n                        'stripePaymentsError',\n                        'permanentError',\n                        'isOrderPlaced',\n                        'isInitializing',\n                        'isInitialized',\n                        'useQuoteBillingAddress',\n                        'cvcToken',\n                        'paymentElementPaymentMethod',\n\n                        // Saved payment methods dropdown\n                        'dropdownOptions',\n                        'selection',\n                        'isDropdownOpen'\n                    ]);\n\n                var self = this;\n\n                this.isPaymentFormVisible(false);\n                this.isOrderPlaced(false);\n                this.isInitializing(true);\n                this.isInitialized(false);\n                this.useQuoteBillingAddress(false);\n                this.cvcToken(null);\n                this.collectCvc = ko.computed(this.shouldCollectCvc.bind(this));\n                this.isAmex = ko.computed(this.isAmexSelected.bind(this));\n                this.cardCvcElement = null;\n\n                var currentTotals = quote.totals();\n                var currentShippingAddress = quote.shippingAddress();\n                var currentBillingAddress = quote.billingAddress();\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (!totals || !totals.grand_total || !totals.quote_currency_code)\n                    {\n                        return;\n                    }\n\n                    if (!currentTotals || !currentTotals.grand_total || !currentTotals.quote_currency_code)\n                    {\n                        currentTotals = totals;\n                        return;\n                    }\n\n                    var amount1 = totals.grand_total;\n                    var amount2 = currentTotals.grand_total;\n                    var currency1 = totals.quote_currency_code;\n                    var currency2 = currentTotals.quote_currency_code;\n\n                    if (amount1 === amount2 && currency1 === currency2)\n                    {\n                        return;\n                    }\n\n                    currentTotals = totals;\n\n                    self.onQuoteTotalsChanged.bind(self)();\n                    self.isOrderPlaced(false);\n                }, this);\n\n                quote.paymentMethod.subscribe(function (method)\n                {\n                    if (method && method.method == this.getCode() && !this.isInitializing())\n                    {\n                        // We intentionally re-create the element because its container element may have changed\n                        this.initPaymentForm();\n                    }\n                }, this);\n\n                quote.billingAddress.subscribe(function(address)\n                {\n                    if (address && self.paymentElement && self.paymentElement.update && !self.isPaymentFormComplete())\n                    {\n                        // Remove the postcode & country fields if a billing address has been specified\n                        self.paymentElement.update(self.getPaymentElementUpdateOptions());\n                    }\n                });\n\n                return this;\n            },\n\n            initSavedPaymentMethods: function()\n            {\n                // If it is already initialized, do not re-initialize\n                if (this.dropdownOptions())\n                {\n                    return;\n                }\n\n                var options = [];\n                var methods = this.getStripeParam(\"savedMethods\");\n                if (methods)\n                {\n                    for (var i in methods)\n                    {\n                        if (methods.hasOwnProperty(i))\n                        {\n                            // We do this because some themes and libraries extend all objects with their own methods\n                            options.push(methods[i]);\n                        }\n                    }\n                }\n\n                if (options.length > 0)\n                {\n                    this.isPaymentFormVisible(false);\n                    this.selection(options[0]);\n                }\n                else\n                {\n                    this.isPaymentFormVisible(true);\n                    this.selection(false);\n                }\n\n                this.dropdownOptions(options);\n            },\n\n            shouldCollectCvc: function()\n            {\n                var selection = this.selection();\n\n                if (!selection)\n                    return false;\n\n                if (selection.type != 'card')\n                    return false;\n\n                return !!selection.cvc;\n            },\n\n            isAmexSelected: function()\n            {\n                var selection = this.selection();\n\n                if (!selection)\n                    return false;\n\n                if (selection.type != 'card')\n                    return false;\n\n                return (selection.brand == \"amex\");\n            },\n\n            newPaymentMethod: function()\n            {\n                this.messageContainer.clear();\n\n                this.selection({\n                    type: 'new',\n                    value: 'new',\n                    icon: false,\n                    label: $t('New payment method')\n                });\n                this.isDropdownOpen(false);\n                this.isPaymentFormVisible(true);\n                if (!this.isInitialized())\n                {\n                    this.onContainerRendered();\n                    this.isInitialized(true);\n                }\n            },\n\n            getPaymentMethodId: function()\n            {\n                if (this.isExternalPaymentMethodCode(this.selectedPaymentMethodCode))\n                {\n                    return this.selectedPaymentMethodCode;\n                }\n\n                var selection = this.selection();\n\n                if (selection && typeof selection.value != \"undefined\" && selection.value != \"new\")\n                {\n                    return selection.value;\n                }\n\n                var paymentMethod = this.paymentElementPaymentMethod();\n                if (paymentMethod && paymentMethod.id)\n                {\n                    return paymentMethod.id;\n                }\n\n                return null;\n            },\n\n            toggleDropdown: function()\n            {\n                this.isDropdownOpen(!this.isDropdownOpen());\n            },\n\n            getStripeParam: function(param)\n            {\n                var params = this.getInitParams();\n\n                if (!params)\n                {\n                    return null;\n                }\n\n                if (typeof params[param] != \"undefined\")\n                {\n                    return params[param];\n                }\n\n                return null;\n            },\n\n            onQuoteTotalsChanged: function()\n            {\n                if (!this.elements || !this.elements.update)\n                {\n                    return;\n                }\n\n                try\n                {\n                    this.elements.update(this.getElementsOptions(true));\n                }\n                catch (e)\n                {\n                    this.elements.update(this.getElementsOptions(false));\n                }\n            },\n\n            getInitParams: function()\n            {\n                return window.checkoutConfig.payment.stripe_payments.initParams;\n            },\n\n            isWalletEnabled: function(walletName)\n            {\n                if (window.checkoutConfig &&\n                    window.checkoutConfig.payment &&\n                    window.checkoutConfig.payment.express_checkout &&\n                    window.checkoutConfig.payment.express_checkout.buttonConfig &&\n                    window.checkoutConfig.payment.express_checkout.buttonConfig.paymentMethods &&\n                    window.checkoutConfig.payment.express_checkout.buttonConfig.paymentMethods[walletName]\n                )\n                {\n                    var value = window.checkoutConfig.payment.express_checkout.buttonConfig.paymentMethods[walletName];\n                    return (value == \"always\" || value == \"auto\");\n                }\n\n                return false;\n            },\n\n            onPaymentElementContainerRendered: function()\n            {\n                var self = this;\n                this.isLoading(true);\n                stripe.initStripe(this.getInitParams(), function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    self.initSavedPaymentMethods();\n                    self.initPaymentForm();\n                });\n            },\n\n            onContainerRendered: function()\n            {\n                this.onPaymentElementContainerRendered();\n            },\n\n            getCardCVCOptions: function()\n            {\n                return {\n                  style: {\n                    base: {\n                  //     iconColor: '#c4f0ff',\n                  //     color: '#fff',\n                  //     fontWeight: '500',\n                  //     fontFamily: 'Roboto, Open Sans, Segoe UI, sans-serif',\n                      fontSize: '16px',\n                  //     fontSmoothing: 'antialiased',\n                  //     ':-webkit-autofill': {\n                  //       color: '#fce883',\n                  //     },\n                  //     '::placeholder': {\n                  //       color: '#87BBFD',\n                  //     },\n                  //   },\n                  //   invalid: {\n                  //     iconColor: '#FFC7EE',\n                  //     color: '#FFC7EE',\n                    },\n                  },\n                };\n            },\n\n            onCvcContainerRendered: function()\n            {\n                var self = this;\n                var params = this.getInitParams();\n\n                stripe.initStripe(params, function(err)\n                {\n                    if (err)\n                        return self.crash(err);\n\n                    var options = {};\n                    if (params && params.locale)\n                    {\n                        options.locale = params.locale;\n                    }\n\n                    try\n                    {\n                        var elements = stripe.stripeJs.elements(options);\n                        self.cardCvcElement = elements.create('cardCvc', self.getCardCVCOptions());\n                        self.cardCvcElement.mount('#stripe-card-cvc-element');\n                        self.cardCvcElement.on('change', self.onCvcChange.bind(self));\n                        self.cardCvcElement.on('loaderror', self.onLoadError.bind(self));\n                    }\n                    catch (e)\n                    {\n                        this.crash(e.message);\n                    }\n                });\n            },\n\n            onCvcChange: function(event)\n            {\n                if (event.error)\n                    this.selection().cvcError = event.error.message;\n                else\n                    this.selection().cvcError = null;\n            },\n\n            crash: function(message)\n            {\n                this.isLoading(false);\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.permanentError(userError);\n                else\n                    this.permanentError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \", message);\n            },\n\n            softCrash: function(message)\n            {\n                var userError = this.getStripeParam(\"userError\");\n                if (userError)\n                    this.showError(userError);\n                else\n                    this.showError($t(\"Sorry, this payment method is not available. Please contact us for assistance.\"));\n\n                console.error(\"Error: \", message);\n            },\n\n            isCollapsed: function()\n            {\n                if (this.isChecked() == this.getCode())\n                {\n                    return false;\n                }\n                else\n                {\n                    return true;\n                }\n            },\n\n            initPaymentForm: function()\n            {\n                this.isInitializing(false);\n                this.isLoading(false);\n\n                if (this.isCollapsed()) // Don't render PE with a height of 0\n                    return;\n\n                if (document.getElementById('stripe-payment-element') === null)\n                    return this.crash(\"Cannot initialize Payment Element on a DOM that does not contain a div.stripe-payment-element.\");\n\n                if (!stripe.stripeJs)\n                    return this.crash(\"Stripe.js could not be initialized.\");\n\n                if (this.getStripeParam(\"isOrderPlaced\"))\n                    this.isOrderPlaced(true);\n\n                try\n                {\n                    try\n                    {\n                        this.elements = stripe.stripeJs.elements(this.getElementsOptions(true));\n                    }\n                    catch (e)\n                    {\n                        console.warn(\"Could not filter Stripe payment method types: \" + e.message);\n                        this.elements = stripe.stripeJs.elements(this.getElementsOptions(false));\n                    }\n                    this.paymentElement = this.elements.create('payment', this.getPaymentElementOptions());\n                    this.paymentElement.mount('#stripe-payment-element');\n                    this.paymentElement.on('change', this.onChange.bind(this));\n                    this.paymentElement.on('loaderror', this.onLoadError.bind(this));\n                }\n                catch (e)\n                {\n                    this.crash(e.message);\n                }\n            },\n\n            onLoadError: function(event)\n            {\n                if (event && event.error && event.error.message)\n                {\n                    this.permanentError(event.error.message);\n                }\n                else\n                {\n                    this.crash(event);\n                }\n            },\n\n            shouldHideRedirectBasedPaymentMethods: function()\n            {\n                var totals = quote.totals();\n                if (!totals || !totals.total_segments || !totals.total_segments.length)\n                {\n                    return false;\n                }\n\n                var targetSegments = [\"giftcardaccount\", \"customerbalance\", \"reward\"];\n\n                for (var i = 0; i < totals.total_segments.length; i++)\n                {\n                    var segment = totals.total_segments[i];\n                    if (targetSegments.indexOf(segment.code) >= 0 && !isNaN(segment.value) && segment.value != 0)\n                    {\n                        return true;\n                    }\n                }\n\n                return false;\n            },\n\n            getElementsOptions: function(filterPaymentMethods)\n            {\n                var options = Object.assign({}, window.checkoutConfig.payment.stripe_payments.elementOptions);\n\n                if (this.shouldHideRedirectBasedPaymentMethods())\n                {\n                    options.paymentMethodTypes = ['card'];\n\n                    if (this.isWalletEnabled(\"link\"))\n                    {\n                        options.paymentMethodTypes.push('link');\n                    }\n                }\n                else if (options.paymentMethodTypes)\n                {\n                    // Case where paymentMethodOptions were passed from the server side\n                }\n                else\n                {\n                    // Unset any previously set paymentMethodTypes in case a gift card was removed etc\n                    options.paymentMethodTypes = null;\n                }\n\n                if (!filterPaymentMethods && options.paymentMethodTypes)\n                    delete options.paymentMethodTypes;\n\n                if (options.mode != \"setup\")\n                {\n                    options.amount = this.getElementsAmount();\n                }\n\n                var externalPaymentMethods = this.getExternalPaymentMethods();\n                if (externalPaymentMethods)\n                {\n                    options.externalPaymentMethodTypes = externalPaymentMethods.map(function(method)\n                    {\n                        return method.code;\n                    });\n                }\n\n                return options;\n            },\n\n            getExternalPaymentMethods: function()\n            {\n                var initParams = this.getInitParams();\n\n                if (initParams &&\n                    initParams.externalPaymentMethods &&\n                    initParams.externalPaymentMethods.length > 0 &&\n                    initParams.externalPaymentMethods[0].code &&\n                    initParams.externalPaymentMethods[0].redirect_url\n                )\n                {\n                    return initParams.externalPaymentMethods;\n                }\n\n                return null;\n            },\n\n            getPaymentElementOptions: function()\n            {\n                var options = {};\n\n                var params = this.getInitParams();\n                if (params)\n                {\n                    if (params.wallets)\n                        options.wallets = params.wallets;\n\n                    if (params.layout)\n                        options.layout = params.layout;\n\n                    if (params.terms)\n                        options.terms = params.terms;\n                }\n\n                var billingAddress = quote.billingAddress();\n\n                if (billingAddress)\n                {\n                    try\n                    {\n                        this.useQuoteBillingAddress(true);\n\n                        var hasState = (billingAddress.region || billingAddress.regionCode || billingAddress.regionId);\n\n                        options.fields = {\n                            billingDetails: {\n                                name: 'never',\n                                email: 'never',\n                                phone: (billingAddress.telephone ? 'never' : 'auto'),\n                                address: {\n                                    line1: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    line2: ((billingAddress.street.length > 0) ? 'never' : 'auto'),\n                                    city: billingAddress.city ? 'never' : 'auto',\n                                    state: hasState ? 'never' : 'auto',\n                                    country: billingAddress.countryId ? 'never' : 'auto',\n                                    postalCode: billingAddress.postcode ? 'never' : 'auto'\n                                }\n                            }\n                        };\n                    }\n                    catch (e)\n                    {\n                        this.useQuoteBillingAddress(false);\n\n                        options.fields = {};\n                        console.warn('Could not retrieve billing address: '  + e.message);\n                    }\n\n                    // Set the default billing address in order to enable the Link payment method\n                    var billingDetails = this.getBillingDetails();\n\n                    if (billingDetails)\n                    {\n                        options.defaultValues = {\n                            billingDetails: billingDetails\n                        };\n                    }\n                }\n                else\n                {\n                    this.useQuoteBillingAddress(false);\n                }\n\n                return options;\n            },\n\n            getPaymentElementUpdateOptions: function()\n            {\n                var options = this.getPaymentElementOptions();\n\n                if (options.wallets)\n                {\n                    delete options.wallets;\n                }\n\n                return options;\n            },\n\n            onChange: function(event)\n            {\n                this.isLoading(false);\n                this.isPaymentFormComplete(event.complete);\n\n                if (event.value && event.value.type)\n                {\n                    this.selectedPaymentMethodCode = event.value.type;\n                }\n                else\n                {\n                    this.selectedPaymentMethodCode = null;\n                }\n            },\n\n            isExternalPaymentMethodCode: function(code)\n            {\n                var methods = this.getExternalPaymentMethods();\n                if (!methods)\n                    return false;\n\n                for (var i = 0; i < methods.length; i++)\n                {\n                    if (methods[i].code == code)\n                        return true;\n                }\n\n                return false;\n            },\n\n            getExternalPaymentMethodRedirectUrl: function(code)\n            {\n                var methods = this.getExternalPaymentMethods();\n                if (!methods)\n                    return null;\n\n                for (var i = 0; i < methods.length; i++)\n                {\n                    if (methods[i].code == code)\n                        return methods[i].redirect_url;\n                }\n\n                return null;\n            },\n\n            getElementsAmount: function()\n            {\n                var totals = quote.totals();\n\n                if (totals && totals.grand_total)\n                {\n                    // If total_segments includes a grand_total, we use that instead\n                    if (totals.total_segments && totals.total_segments.length > 0)\n                    {\n                        for (var i = 0; i < totals.total_segments.length; i++)\n                        {\n                            var segment = totals.total_segments[i];\n                            if (segment.code == \"grand_total\")\n                            {\n                                return this.convertToStripeAmount(segment.value, this.getElementsCurrency());\n                            }\n                        }\n                    }\n\n                    // Othewise use the quote grand total\n                    var amount = totals.grand_total;\n                    return this.convertToStripeAmount(amount, this.getElementsCurrency());\n                }\n\n                return 0;\n            },\n\n            getElementsCurrency: function()\n            {\n                var totals = quote.totals();\n                if (totals && totals.quote_currency_code)\n                {\n                    var currency = totals.quote_currency_code;\n                    return currency.toLowerCase();\n                }\n\n                return 'USD';\n            },\n\n            isBillingAddressSet: function()\n            {\n                return quote.billingAddress() && quote.billingAddress().canUseForBilling();\n            },\n\n            convertToStripeAmount: function(amount, currencyCode)\n            {\n                var code = currencyCode.toUpperCase();\n\n                if (this.zeroDecimalCurrencies.indexOf(code) >= 0)\n                {\n                    return Math.round(amount);\n                }\n                else if (this.threeDecimalCurrencies.indexOf(code) >= 0)\n                {\n                    return Math.round(amount * 100) * 10;\n                }\n                else\n                {\n                    return Math.round(amount * 100);\n                }\n            },\n\n            isPlaceOrderEnabled: function()\n            {\n                if (this.stripePaymentsError())\n                    return false;\n\n                if (this.permanentError())\n                    return false;\n\n                return this.isBillingAddressSet();\n            },\n\n            getAddressField: function(field)\n            {\n                if (!quote.billingAddress())\n                    return null;\n\n                var address = quote.billingAddress();\n\n                if (!address[field] || address[field].length == 0)\n                    return null;\n\n                return address[field];\n            },\n\n            getBillingDetails: function()\n            {\n                var details = {};\n                var address = {};\n\n                if (this.getAddressField('city'))\n                    address.city = this.getAddressField('city');\n\n                if (this.getAddressField('countryId'))\n                    address.country = this.getAddressField('countryId');\n\n                if (this.getAddressField('postcode'))\n                    address.postal_code = this.getAddressField('postcode');\n\n                if (this.getAddressField('region'))\n                    address.state = this.getAddressField('region');\n\n                if (this.getAddressField('street'))\n                {\n                    var street = this.getAddressField('street');\n                    address.line1 = street[0];\n\n                    if (street.length > 1)\n                        address.line2 = street[1];\n                }\n\n                if (Object.keys(address).length > 0)\n                    details.address = address;\n\n                if (this.getAddressField('telephone'))\n                    details.phone = this.getAddressField('telephone');\n\n                if (this.getAddressField('firstname'))\n                    details.name = this.getAddressField('firstname') + ' ' + this.getAddressField('lastname');\n\n                if (quote.guestEmail)\n                    details.email = quote.guestEmail;\n                else if (customerData.email)\n                    details.email = customerData.email;\n\n                if (Object.keys(details).length > 0)\n                    return details;\n\n                return null;\n            },\n\n            config: function()\n            {\n                return window.checkoutConfig.payment[this.getCode()];\n            },\n\n            isActive: function(parents)\n            {\n                return true;\n            },\n\n            placeOrder: function()\n            {\n                this.messageContainer.clear();\n\n                if (!this.isPaymentFormComplete() && !this.getPaymentMethodId())\n                    return this.showError($t('Please complete your payment details.'));\n\n                if (!this.validate())\n                    return;\n\n                this.clearErrors();\n                this.isPlaceOrderActionAllowed(false);\n                this.isLoading(true);\n                this.cvcToken(null);\n\n                var params = { };\n\n                if (this.useQuoteBillingAddress())\n                {\n                    params.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                if (this.hasShipping())\n                {\n                    params.shipping = {\n                        address: this.getStripeFormattedAddress(quote.shippingAddress()),\n                        name: this.getNameFromAddress(quote.shippingAddress())\n                    };\n                }\n\n                var self = this;\n\n                if (this.isSavedCardSelected() && this.selection().cvc)\n                {\n                    stripe.stripeJs.createToken('cvc_update', this.cardCvcElement).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                        }\n                        else if (result.token)\n                        {\n                            self.cvcToken(result.token.id);\n                            self.placeOrderWithSavedPaymentMethod.bind(self)();\n                        }\n                        else\n                        {\n                            self.showError('Could not perform CVC check.');\n                        }\n                    });\n                }\n                else if (this.isSavedPaymentMethodSelected())\n                {\n                    this.placeOrderWithSavedPaymentMethod();\n                }\n                else if (this.isExternalPaymentMethodCode(this.selectedPaymentMethodCode))\n                {\n                    this.onPaymentMethodCreatedForOrderPlacement();\n                }\n                else\n                {\n                    this.createPaymentMethod(this.onPaymentMethodCreatedForOrderPlacement.bind(this));\n                }\n\n                return false;\n            },\n\n            hasShipping: function()\n            {\n                return (quote && quote.shippingMethod() && quote.shippingMethod().method_code);\n            },\n\n            createPaymentMethod: function(callback)\n            {\n                this.paymentElementPaymentMethod(null);\n\n                var self = this;\n\n                var paymentMethodData = {\n                    elements: this.elements,\n                    params: {}\n                };\n\n                var confirmParams = this.getConfirmParams();\n                var billingDetails = null;\n                if (confirmParams &&\n                    confirmParams.confirmParams &&\n                    confirmParams.confirmParams.payment_method_data &&\n                    confirmParams.confirmParams.payment_method_data.billing_details\n                )\n                {\n                    billingDetails = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n\n                if (billingDetails)\n                {\n                    paymentMethodData.params.billing_details = confirmParams.confirmParams.payment_method_data.billing_details;\n                }\n                else\n                {\n                    return this.showError($t(\"Please specify a billing address.\"));\n                }\n\n                setTimeout(function(){\n                    // The loading mask is disabled so that the MFTF tests can continue running\n                    self.isLoading(false);\n                }, 4000);\n                this.elements.submit().then(function()\n                {\n                    stripe.stripeJs.createPaymentMethod(paymentMethodData).then(function(result)\n                    {\n                        if (result.error)\n                        {\n                            self.showError(result.error.message);\n                            console.error(result.error.message);\n                        }\n                        else\n                        {\n                            self.paymentElementPaymentMethod(result.paymentMethod);\n                            callback(result.paymentMethod);\n                        }\n                    });\n                },\n                function(result)\n                {\n                    if (result.error)\n                    {\n                        self.showError(result.error.message);\n                        console.error(result.error.message);\n                    }\n                    else\n                    {\n                        self.showError(\"A payment submission error has occurred.\");\n                        console.error(result);\n                    }\n                });\n            },\n\n            isSavedPaymentMethodSelected: function()\n            {\n                var selectedMethodType = this.getSelectedMethod(\"type\");\n\n                if (!selectedMethodType) // There is no saved PMs dropdown\n                    return false;\n\n                if (selectedMethodType != 'new') // A saved PMs is selected\n                    return true;\n\n                return false; // New PM is selected\n            },\n\n            isSavedCardSelected: function()\n            {\n                var selectedMethodType = this.getSelectedMethod(\"type\");\n\n                if (!selectedMethodType) // There is no saved PMs dropdown\n                    return false;\n\n                if (selectedMethodType == 'card') // A saved PMs is selected\n                    return true;\n\n                return false; // New PM is selected\n            },\n\n            placeOrderWithSavedPaymentMethod: function()\n            {\n                var self = this;\n                var placeNewOrder = this.placeNewOrder.bind(this);\n\n                if (this.isOrderPlaced()) // The order was already placed but either 3D Secure failed or the customer pressed the back button from an external payment page\n                {\n                    updateCartAction(this.getData(), this.onCartUpdated.bind(this));\n                }\n                else\n                {\n                    try\n                    {\n                        placeNewOrder();\n                    }\n                    catch (e)\n                    {\n                        this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(e.message);\n                    }\n                }\n            },\n\n            onPaymentMethodCreatedForOrderPlacement: function(paymentMethod)\n            {\n                var placeNewOrder = this.placeNewOrder.bind(this);\n                var self = this;\n\n                if (self.isOrderPlaced()) // The order was already placed but either 3D Secure failed or the customer pressed the back button from an external payment page\n                {\n                    updateCartAction(this.getData(), this.onCartUpdated.bind(this));\n                }\n                else\n                {\n                    try\n                    {\n                        placeNewOrder();\n                    }\n                    catch (e)\n                    {\n                        self.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(e.message);\n                    }\n                }\n            },\n\n            onCartUpdated: function(result, outcome, response)\n            {\n                var placeNewOrder = this.placeNewOrder.bind(this);\n                var onOrderPlaced = this.onOrderPlaced.bind(this);\n                try\n                {\n                    var data = JSON.parse(result);\n                    if (data.error)\n                    {\n                        this.showError(data.error);\n                    }\n                    else if (data.redirect)\n                    {\n                        $.mage.redirect(data.redirect);\n                    }\n                    else if (data.placeNewOrder)\n                    {\n                        placeNewOrder();\n                    }\n                    else\n                    {\n                        onOrderPlaced();\n                    }\n                }\n                catch (e)\n                {\n                    this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                    console.error(e.message);\n                }\n            },\n\n            placeNewOrder: function()\n            {\n                var self = this;\n\n                this.isLoading(false); // Needed for the terms and conditions checkbox\n                this.getPlaceOrderDeferredObject()\n                    .fail(this.handlePlaceOrderErrors.bind(this))\n                    .done(this.onOrderPlaced.bind(this))\n                    .always(function(response, status, xhr)\n                    {\n                        if (status != \"success\")\n                        {\n                            self.isLoading(false);\n                        }\n                    });\n            },\n\n            getSelectedMethod: function(param)\n            {\n                var selection = this.selection();\n                if (!selection)\n                    return null;\n\n                if (typeof selection[param] == \"undefined\")\n                    return null;\n\n                return selection[param];\n            },\n\n            // Called when:\n            // - A brand new order has just been placed\n            // - After updateCartAction() with placeNewOrder == false\n            onOrderPlaced: function(result, outcome, response)\n            {\n                if (!this.isOrderPlaced() && isNaN(result))\n                {\n                    return this.softCrash(\"The order was placed but the response from the server did not include a numeric order ID.\");\n                }\n                else\n                {\n                    this.isOrderPlaced(true);\n                }\n\n                this.isLoading(true);\n\n                if (this.isExternalPaymentMethodCode(this.selectedPaymentMethodCode))\n                {\n                    window.location.href = this.getExternalPaymentMethodRedirectUrl(this.selectedPaymentMethodCode);\n                    return;\n                }\n\n                var self = this;\n                var handleNextActions = this.handleNextActions.bind(this);\n                getRequiresAction(function(clientSecret)\n                {\n                    try\n                    {\n                        if (clientSecret && clientSecret.length)\n                        {\n                            stripe.authenticateCustomer(clientSecret, function(err)\n                            {\n                                if (err)\n                                    return self.showError(err);\n\n                                self.onConfirm.bind(self)();\n                            });\n                        }\n                        else\n                        {\n                            // No further actions are needed\n                            self.onConfirm(null);\n                        }\n                    }\n                    catch (e)\n                    {\n                        restoreQuoteAction();\n                        self.showError(\"The order was placed but we could not confirm if the payment was successful.\");\n                        console.error(e);\n                    }\n\n                })\n                .fail(function(result)\n                {\n                    restoreQuoteAction();\n                    self.showError(\"The order was placed but we could not confirm if the payment was successful.\");\n                    console.error(result);\n                });\n            },\n\n            isSuccessful: function(stripeObject)\n            {\n\n                if (stripeObject.status == \"requires_action\" &&\n                    stripeObject.next_action &&\n                    stripeObject.next_action.type &&\n                    stripeObject.next_action.type != \"use_stripe_sdk\"\n                )\n                {\n                    // This is the case for vouchers, where an offline payment is required\n                    return true;\n                }\n\n\n                return (['processing', 'requires_capture', 'succeeded'].indexOf(stripeObject.status) >= 0);\n            },\n\n            // Called when:\n            // - A brand new order has just been placed\n            // - After updateCartAction() with placeNewOrder == false\n            handleNextActions: function(stripeObject)\n            {\n                if (!this.isOrderPlaced())\n                {\n                    return this.softCrash(\"Cannot handleNextActions without placing the order first\");\n                }\n\n                var self = this;\n\n                if (this.isSuccessful(stripeObject))\n                {\n                    this.onConfirm(null);\n                }\n                else if (stripeObject.status == \"requires_action\")\n                {\n                    // Non-card based confirms may redirect the customer externally. We restore the quote just before it in case the\n                    // customer clicks the back button on the browser before authenticating the payment.\n                    restoreQuoteAction(function()\n                    {\n                        stripe.stripeJs.handleNextAction({\n                          clientSecret: stripeObject.client_secret\n                        }).then(self.onConfirm.bind(self));\n                    });\n                }\n                else if (stripeObject.status == \"requires_confirmation\")\n                {\n                    // This should only hit when a payment failed with a saved PM, and then the customer switched to PaymentElement to enter a new payment method\n                    restoreQuoteAction(function()\n                    {\n                        // We pass null because we do not want to update the PM. It has already been updated with stripe.updatePaymentIntent\n                        updateCartAction(self.getData(), self.onCartUpdated.bind(self));\n                    });\n                }\n                else if (stripeObject.status == \"requires_payment_method\")\n                {\n                    restoreQuoteAction(function()\n                    {\n                        updateCartAction(self.getData(), self.onCartUpdated.bind(self));\n                    });\n                }\n                else\n                {\n                    restoreQuoteAction(function()\n                    {\n                        self.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n                        console.error(\"Could not finalize order bacause the payment intent is in status \" + stripeObject.status);\n                    });\n                }\n            },\n\n            getConfirmParams: function()\n            {\n                var params = {\n                    elements: this.elements,\n                    confirmParams: {\n                        return_url: this.getStripeParam(\"successUrl\")\n                    }\n                };\n\n                this.getPaymentElementOptions();\n                if (this.useQuoteBillingAddress())\n                {\n                    params.confirmParams.payment_method_data = {\n                        billing_details: {\n                            address: this.getStripeFormattedAddress(quote.billingAddress()),\n                            email: this.getBillingEmail(),\n                            name: this.getNameFromAddress(quote.billingAddress()),\n                            phone: this.getBillingPhone()\n                        }\n                    };\n                }\n\n                return params;\n            },\n\n            getStripeFormattedAddress: function(address)\n            {\n                var stripeAddress = {};\n\n                if (address.regionCode)\n                    stripeAddress.state = address.regionCode;\n                else\n                    stripeAddress.state = address.region ? address.region : null;\n\n                stripeAddress.postal_code = address.postcode ? address.postcode : null;\n                stripeAddress.country = address.countryId ? address.countryId : null;\n                stripeAddress.city = address.city ? address.city : null;\n\n                if (address.street && address.street.length > 0)\n                {\n                    stripeAddress.line1 = address.street[0];\n\n                    if (address.street.length > 1)\n                    {\n                        stripeAddress.line2 = address.street[1];\n                    }\n                    else\n                    {\n                        stripeAddress.line2 = null;\n                    }\n                }\n                else\n                {\n                    stripeAddress.line1 = null;\n                    stripeAddress.line2 = null;\n                }\n\n                return stripeAddress;\n            },\n\n            getBillingEmail: function()\n            {\n                if (quote.guestEmail)\n                {\n                    return quote.guestEmail;\n                }\n                else if (window.checkoutConfig.customerData && window.checkoutConfig.customerData.email)\n                {\n                    return window.checkoutConfig.customerData.email;\n                }\n\n                return null;\n            },\n\n            getNameFromAddress: function(address)\n            {\n                if (!address)\n                    return null;\n\n                var parts = [];\n                if (address.firstname)\n                    parts.push(address.firstname);\n\n                if (address.middlename)\n                    parts.push(address.middlename);\n\n                if (address.lastname)\n                    parts.push(address.lastname);\n\n                return parts.join(\" \");\n            },\n\n            getBillingPhone: function()\n            {\n                var billingAddress = quote.billingAddress();\n                if (!billingAddress)\n                    return null;\n\n                if (billingAddress.telephone)\n                    return billingAddress.telephone;\n\n                return null;\n            },\n\n            onConfirm: function(result)\n            {\n                if (result && result.error)\n                {\n                    this.showError(result.error.message);\n\n                    if (this.isOrderPlaced())\n                    {\n                        cancelLastOrderAction(result.error.message);\n                        this.isOrderPlaced(false);\n                    }\n                }\n                else\n                {\n                    customerData.invalidate(['cart']);\n                    // In the case of a 3DS, we redirect to stripe/payment/index so that the quote is de-activated\n                    var successUrl = this.getStripeParam(\"successUrl\");\n                    $.mage.redirect(successUrl);\n                }\n            },\n\n            /**\n             * @return {*}\n             */\n            getPlaceOrderDeferredObject: function()\n            {\n                return placeOrderAction(this.getData(), this.messageContainer);\n            },\n\n            getClientSecretFromResponse: function(response)\n            {\n                if (typeof response != \"string\")\n                {\n                    return null;\n                }\n\n                if (response.indexOf(\"Authentication Required: \") >= 0)\n                {\n                    return response.substring(\"Authentication Required: \".length);\n                }\n\n                return null;\n            },\n\n            handlePlaceOrderErrors: function (result)\n            {\n                if (result && result.responseJSON && result.responseJSON.message)\n                {\n                    var clientSecret = this.getClientSecretFromResponse(result.responseJSON.message);\n\n                    if (clientSecret)\n                    {\n                        var self = this;\n                        return stripe.authenticateCustomer(clientSecret, function(err)\n                        {\n                            if (err)\n                                return self.showError(err);\n\n                            self.placeNewOrder.bind(self)();\n                        });\n                    }\n                    else\n                    {\n                        this.showError(result.responseJSON.message);\n                    }\n                }\n                else\n                {\n                    this.showError($t(\"The order could not be placed. Please contact us for assistance.\"));\n\n                    if (result && result.responseText)\n                        console.error(result.responseText);\n                    else\n                        console.error(result);\n                }\n            },\n\n            showError: function(message)\n            {\n                this.isLoading(false);\n                this.isPlaceOrderEnabled(true);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n\n            validate: function(elm)\n            {\n                return this.validateCvc() && agreementValidator.validate() && additionalValidators.validate();\n            },\n\n            validateCvc: function()\n            {\n                if (!this.selection())\n                    return true;\n\n                if (this.selection().type != \"card\")\n                    return true;\n\n                if (this.selection().cvc != 1)\n                    return true;\n\n                if (typeof this.selection().cvcError == \"undefined\")\n                {\n                    this.showError($t(\"Please enter your card's security code.\"));\n                    return false;\n                }\n                else if (!this.selection().cvcError)\n                {\n                    return true;\n                }\n                else\n                {\n                    this.showError(this.selection().cvcError);\n                    return false;\n                }\n\n                return true;\n            },\n\n            getCode: function()\n            {\n                return 'stripe_payments';\n            },\n\n            getData: function()\n            {\n                var data = {\n                    'method': this.item.method,\n                    'additional_data': {\n                        'payment_method': this.getPaymentMethodId()\n                    }\n                };\n\n                if (this.cvcToken())\n                {\n                    data.additional_data.cvc_token = this.cvcToken();\n                }\n\n                return data;\n            },\n\n            clearErrors: function()\n            {\n                this.stripePaymentsError(null);\n            }\n\n        });\n    }\n);\n","StripeIntegration_Payments/js/view/payment/method-renderer/checkout.js":"/*browser:true*/\n/*global define*/\ndefine(\n    [\n        'ko',\n        'jquery',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Checkout/js/action/place-order',\n        'Magento_Checkout/js/model/full-screen-loader',\n        'Magento_Customer/js/customer-data',\n        'StripeIntegration_Payments/js/stripe',\n        'StripeIntegration_Payments/js/action/get-checkout-methods',\n        'StripeIntegration_Payments/js/action/get-checkout-session-id',\n        'Magento_Checkout/js/view/payment/default',\n        'mage/translate',\n        'stripejs',\n        'domReady!'\n    ],\n    function (\n        ko,\n        $,\n        quote,\n        additionalValidators,\n        placeOrderAction,\n        fullScreenLoader,\n        customerData,\n        stripe,\n        getCheckoutMethods,\n        getCheckoutSessionId,\n        Component,\n        $t\n    ) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                self: this,\n                template: 'StripeIntegration_Payments/payment/checkout',\n                code: \"stripe_checkout\",\n                customRedirect: true,\n                guestEmail: null,\n                methodIcons: ko.observableArray([])\n            },\n            redirectAfterPlaceOrder: false,\n\n            initObservable: function()\n            {\n                this._super().observe([\n                    'methodIcons',\n                    'permanentError'\n                ]);\n\n                var params = window.checkoutConfig.payment.stripe_payments.initParams;\n\n                stripe.initStripe(params);\n\n                var self = this;\n                var currentTotals = quote.totals();\n                var currentBillingAddress = quote.billingAddress();\n                var currentShippingAddress = quote.shippingAddress();\n                this.guestEmail = quote.guestEmail;\n\n                getCheckoutMethods(quote, self.setPaymentMethods.bind(self));\n\n                quote.billingAddress.subscribe(function(address)\n                {\n                    if (!address)\n                        return;\n\n                    if (self.isAddressSame(address, currentBillingAddress))\n                        return;\n\n                    currentBillingAddress = address;\n\n                    getCheckoutMethods(quote, self.setPaymentMethods.bind(self));\n                }, this);\n\n                quote.shippingAddress.subscribe(function(address)\n                {\n                    if (!address)\n                        return;\n\n                    if (self.isAddressSame(address, currentShippingAddress))\n                        return;\n\n                    currentShippingAddress = address;\n\n                    getCheckoutMethods(quote, self.setPaymentMethods.bind(self));\n                }, this);\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (JSON.stringify(totals.total_segments) == JSON.stringify(currentTotals.total_segments))\n                        return;\n\n                    currentTotals = totals;\n\n                    getCheckoutMethods(quote, self.setPaymentMethods.bind(self));\n                }, this);\n\n                return this;\n            },\n\n            isAddressSame: function(address1, address2)\n            {\n                var a = this.stringifyAddress(address1);\n                var b = this.stringifyAddress(address2);\n\n                return a == b;\n            },\n\n            stringifyAddress: function(address)\n            {\n                if (typeof address == \"undefined\" || !address)\n                    return null;\n\n                return JSON.stringify({\n                    \"countryId\": (typeof address.countryId != \"undefined\") ? address.countryId : \"\",\n                    \"region\": (typeof address.region != \"undefined\") ? address.region : \"\",\n                    \"city\": (typeof address.city != \"undefined\") ? address.city : \"\",\n                    \"postcode\": (typeof address.postcode != \"undefined\") ? address.postcode : \"\"\n                });\n            },\n\n            setPaymentMethods: function(response)\n            {\n                var methods = [];\n\n                if (typeof response == \"string\")\n                    response = JSON.parse(response);\n\n                if (typeof response.error != \"undefined\")\n                {\n                    this.permanentError(response.error);\n                }\n\n                if (typeof response.methods != \"undefined\" && response.methods.length > 0)\n                    methods = response.methods;\n\n                var icons = window.checkoutConfig.payment.stripe_payments.icons;\n                var self = this;\n\n                methods.forEach(function(method)\n                {\n                    if (self.hasPaymentMethod(icons, method))\n                        return;\n\n                    if (typeof window.checkoutConfig.payment.stripe_payments.pmIcons[method] != \"undefined\")\n                    {\n                        icons.push({\n                            \"code\": method,\n                            \"path\": window.checkoutConfig.payment.stripe_payments.pmIcons[method].icon,\n                            \"name\": window.checkoutConfig.payment.stripe_payments.pmIcons[method].name\n                        });\n                    }\n                    else if (method != \"card\")\n                    {\n                        icons.push({\n                            \"code\": method,\n                            \"path\": window.checkoutConfig.payment.stripe_payments.pmIcons.bank.icon,\n                            \"name\": self.methodName(method)\n                        });\n                    }\n                });\n\n                this.methodIcons(icons);\n            },\n\n            hasPaymentMethod: function(collection, code)\n            {\n                var exists = collection.filter(function (o)\n                {\n                  return o.hasOwnProperty(\"code\") && o.code == code;\n                }).length > 0;\n\n                return exists;\n            },\n\n            performRedirect: function()\n            {\n                var self = this;\n\n                getCheckoutSessionId().then(function (response)\n                {\n                    if (response && response.length && response.indexOf(\"cs_\") === 0)\n                    {\n                        self.redirect.bind(self)(response);\n                    }\n                    else\n                    {\n                        self.showError($t('Could not redirect to Stripe Checkout.'));\n                    }\n                },\n                function (e)\n                {\n                    if (e.responseJSON && e.responseJSON.message)\n                    {\n                        self.showError(e.responseJSON.message);\n                    }\n                    else\n                    {\n                        self.showError($t('An error has occurred on the server. Could not redirect to Stripe Checkout.'));\n                    }\n                    console.error(e.responseJSON.message);\n                });\n            },\n\n            checkoutPlaceOrder: function()\n            {\n                var self = this;\n\n                if (additionalValidators.validate())\n                {\n                    fullScreenLoader.startLoader();\n                    getCheckoutSessionId().then(function (response)\n                    {\n                        if (response && response.length && response.indexOf(\"cs_\") === 0)\n                        {\n                            self.redirect.bind(self)(response);\n                        }\n                        else\n                        {\n                            self.placeOrder.bind(self)(self.performRedirect.bind(self));\n                        }\n                    },\n                    function (e)\n                    {\n                        if (e.responseJSON && e.responseJSON.message)\n                        {\n                            self.showError(e.responseJSON.message);\n                        }\n                        else\n                        {\n                            self.showError($t('An error has occurred on the server. Could not redirect to Stripe Checkout.'));\n                        }\n                        console.error(e.responseJSON.message);\n                    });\n                }\n\n                return false;\n            },\n\n            placeOrder: function()\n            {\n                var self = this;\n\n                placeOrderAction(self.getData(), self.messageContainer)\n                .then(\n                    this.performRedirect.bind(this),\n                    function (e)\n                    {\n                        if (e.responseJSON && e.responseJSON.message)\n                        {\n                            self.showError(e.responseJSON.message);\n                        }\n                        else\n                        {\n                            self.showError($t('An error has occurred. Could not redirect to Stripe Checkout.'));\n                        }\n                        console.error(e.responseJSON.message);\n                    }\n                );\n\n                return false;\n            },\n\n            redirectToURL: function(url)\n            {\n                try\n                {\n                    customerData.invalidate(['cart']);\n                    $.mage.redirect(url);\n                }\n                catch (e)\n                {\n                    console.error(e);\n                }\n            },\n\n            redirect: function(sessionId)\n            {\n                try\n                {\n                    customerData.invalidate(['cart']);\n                    stripe.stripeJs.redirectToCheckout({ sessionId: sessionId }, this.onRedirectFailure.bind(this));\n                }\n                catch (e)\n                {\n                    fullScreenLoader.stopLoader();\n                    console.error(e);\n                }\n            },\n\n            onRedirectFailure: function(result)\n            {\n                if (result.error)\n                {\n                    this.showError(result.error.message);\n                }\n                else\n                {\n                    this.showError($(\"A redirect error has occurred.\"));\n                    console.error(result);\n                }\n            },\n\n            methodName: function(code)\n            {\n                if (typeof code == 'undefined')\n                    return '';\n\n                return code.charAt(0).toUpperCase() + Array.from(code).splice(1).join('');\n            },\n\n            showError: function(message)\n            {\n                fullScreenLoader.stopLoader();\n                document.getElementById('stripe-checkout-actions-toolbar').scrollIntoView(true);\n                this.messageContainer.addErrorMessage({ \"message\": message });\n            },\n        });\n    }\n);\n","StripeIntegration_Payments/js/action/get-checkout-methods.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Checkout/js/model/full-screen-loader',\n        'Magento_Checkout/js/model/quote'\n    ],\n    function (urlBuilder, storage, errorProcessor, fullScreenLoader, quote) {\n        'use strict';\n\n        var timesRequested = 0;\n\n        return function (quote, onDoneCallback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/get_checkout_payment_methods', {});\n\n            var payload = {\n                billingAddress: quote.billingAddress()\n            };\n\n            if (quote.shippingAddress())\n                payload.shippingAddress = quote.shippingAddress();\n\n            if (quote.shippingMethod())\n                payload.shippingMethod = quote.shippingMethod();\n\n            var totals = quote.totals();\n            if (typeof totals.coupon_code != \"undefined\" && totals.coupon_code && totals.coupon_code.length > 0)\n                payload.couponCode = totals.coupon_code;\n\n            try\n            {\n                if (!payload.billingAddress.countryId.length)\n                    return;\n\n                if (!quote.isVirtual())\n                {\n                    if (!payload.shippingAddress.countryId.length)\n                        return;\n                }\n\n                if (timesRequested > 0)\n                    return;\n            }\n            catch (e)\n            {\n                return;\n            }\n\n            timesRequested++;\n            return storage.post(serviceUrl, JSON.stringify(payload)).done(onDoneCallback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/delete-payment-method.js":"define(\n    [\n        'mage/url',\n        'mage/storage'\n    ],\n    function (\n        urlBuilder,\n        storage\n    ) {\n        'use strict';\n        return function (paymentMethodId, fingerprint, callback)\n        {\n            var serviceUrl = urlBuilder.build('rest/V1/stripe/payments/delete_payment_method');\n\n            var payload = {\n                paymentMethodId: paymentMethodId\n            };\n\n            if (fingerprint)\n            {\n                payload.fingerprint = fingerprint;\n            }\n\n            return storage.post(serviceUrl, JSON.stringify(payload)).always(callback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/get-future-subscriptions.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Checkout/js/model/full-screen-loader',\n        'Magento_Checkout/js/model/quote'\n    ],\n    function (urlBuilder, storage, errorProcessor, fullScreenLoader, quote) {\n        'use strict';\n        return function (quote)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/get_future_subscriptions', {});\n\n            var payload = {\n                billingAddress: quote.billingAddress()\n            };\n\n            if (quote.shippingAddress())\n                payload.shippingAddress = quote.shippingAddress();\n\n            if (quote.shippingMethod())\n                payload.shippingMethod = quote.shippingMethod();\n\n            var totals = quote.totals();\n            if (typeof totals.coupon_code != \"undefined\" && totals.coupon_code && totals.coupon_code.length > 0)\n                payload.couponCode = totals.coupon_code;\n\n            return storage.post(serviceUrl, JSON.stringify(payload));\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/post-update-cart.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Customer/js/customer-data'\n    ],\n    function (urlBuilder, storage, customerData) {\n        'use strict';\n        return function (data, callback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/update_cart', {});\n\n            // This API call may inactivate the customer cart\n            customerData.invalidate(['cart']);\n\n            if (data)\n            {\n                return storage.post(\n                    serviceUrl,\n                    JSON.stringify({ data: data })\n                ).always(callback);\n            }\n            else\n            {\n\n                return storage.post(serviceUrl).always(callback);\n            }\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/get-requires-action.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'Magento_Customer/js/customer-data',\n        'mage/storage'\n    ],\n    function (urlBuilder, customerData, storage) {\n        'use strict';\n\n        var promise = null; // If this is set, the promise is not resolved\n\n        return function (callback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/get_requires_action', {});\n\n            customerData.invalidate(['cart']);\n\n            if (!promise)\n                promise = storage.get(serviceUrl);\n            else\n                return promise.always(callback); // Stack multiple callbacks onto the promise\n\n            return promise.always(function(result, outcome, response)\n            {\n                promise = null; // Marks it as resolved\n                callback(result, outcome, response);\n            });\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/get-checkout-session-id.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage'\n    ],\n    function (urlBuilder, storage) {\n        'use strict';\n\n        return function ()\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/get_checkout_session_id', {});\n\n            return storage.get(serviceUrl);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/add-payment-method.js":"define(\n    [\n        'mage/url',\n        'mage/storage'\n    ],\n    function (\n        urlBuilder,\n        storage\n    ) {\n        'use strict';\n        return function (paymentMethodId, callback)\n        {\n            var serviceUrl = urlBuilder.build('rest/V1/stripe/payments/add_payment_method');\n\n            var payload = {\n                paymentMethodId: paymentMethodId\n            };\n\n            return storage.post(serviceUrl, JSON.stringify(payload)).always(callback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/post-cancel-order.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'Magento_Customer/js/customer-data',\n        'mage/storage'\n    ],\n    function (urlBuilder, customerData, storage) {\n        'use strict';\n\n        var promise = null; // If this is set, the promise is not resolved\n\n        return function (errorMessage, callback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/cancel_last_order', {});\n\n            var payload = {\n                errorMessage: errorMessage\n            };\n\n            customerData.invalidate(['cart']);\n\n            if (!promise)\n                promise = storage.post(serviceUrl, JSON.stringify(payload));\n            else\n                return promise.always(callback); // Stack multiple callbacks onto the promise\n\n            return promise.always(function(result, outcome, response)\n            {\n                promise = null; // Marks it as resolved\n                callback(result, outcome, response);\n            });\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/list-payment-methods.js":"define(\n    [\n        'mage/url',\n        'mage/storage'\n    ],\n    function (\n        urlBuilder,\n        storage\n    ) {\n        'use strict';\n        return function (callback)\n        {\n            var serviceUrl = urlBuilder.build('rest/V1/stripe/payments/list_payment_methods');\n\n            return storage.get(serviceUrl).always(callback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/finalize-multishipping-order.js":"define(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Customer/js/customer-data',\n        'Magento_Ui/js/modal/alert'\n    ],\n    function ($, urlBuilder, storage, customerData, alert) {\n        'use strict';\n\n        var showError = function(message, e)\n        {\n            alert( { content: message });\n\n            if (typeof e != \"undefined\")\n                console.error(e);\n        };\n\n        return function (error)\n        {\n            customerData.invalidate(['cart']);\n\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/finalize_multishipping_order', {});\n            var payload = { error: error };\n\n            return storage.post(serviceUrl, JSON.stringify(payload))\n            .then(function(result, b, c)\n            {\n                var response = null;\n\n                try\n                {\n                    response = JSON.parse(result);\n                }\n                catch (e)\n                {\n                    return showError(\"Sorry, a server side error has occurred.\", e);\n                }\n\n                if (response.error)\n                    return showError(response.error, response.error);\n\n                if (response.redirect)\n                    return $.mage.redirect(response.redirect);\n\n                return showError(response, response);\n            })\n            .fail(function(result)\n            {\n                return showError(\"Sorry, a server side error has occurred.\", result);\n            });\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/post-restore-quote.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Customer/js/customer-data',\n        'Magento_Checkout/js/model/quote'\n    ],\n    function (\n        urlBuilder,\n        storage,\n        customerData,\n        quote\n    ) {\n        'use strict';\n        return function (callback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/restore_quote', {});\n\n            customerData.invalidate(['cart']);\n\n            return storage.post(serviceUrl).always(callback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/place-multishipping-order.js":"define(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage',\n        'Magento_Customer/js/customer-data',\n        'Magento_Ui/js/modal/alert'\n    ],\n    function ($, urlBuilder, storage, customerData, alert) {\n        'use strict';\n\n        var showError = function(message, e)\n        {\n            alert( { content: message });\n\n            if (typeof e != \"undefined\")\n                console.error(e);\n        };\n\n        return function (callback, onAuthenticationRequired)\n        {\n            customerData.invalidate(['cart']);\n\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/place_multishipping_order', {});\n\n            return storage.post(serviceUrl)\n            .then(function(result, b, c)\n            {\n                var response = null;\n\n                try\n                {\n                    response = JSON.parse(result);\n                }\n                catch (e)\n                {\n                    return showError(\"Sorry, a server side error has occurred.\", e);\n                }\n\n                if (response.error)\n                    return showError(response.error, response.error);\n\n                if (response.redirect)\n                    return $.mage.redirect(response.redirect);\n\n                if (response.authenticate)\n                    return onAuthenticationRequired(response.authenticate);\n\n                return showError(response, response);\n            })\n            .fail(function(result)\n            {\n                return showError(\"Sorry, a server side error has occurred.\", result);\n            })\n            .always(callback);\n        };\n    }\n);\n","StripeIntegration_Payments/js/action/get-upcoming-invoice.js":"define(\n    [\n        'Magento_Checkout/js/model/url-builder',\n        'mage/storage'\n    ],\n    function (urlBuilder, storage) {\n        'use strict';\n\n        var promise = null; // If this is set, the promise is not resolved\n\n        return function (callback)\n        {\n            var serviceUrl = urlBuilder.createUrl('/stripe/payments/get_upcoming_invoice', {});\n\n            if (!promise)\n                promise = storage.get(serviceUrl);\n            else\n                return promise.always(callback); // Stack multiple callbacks onto the promise\n\n            return promise.always(function(result, outcome, response)\n            {\n                promise = null; // Marks it as resolved\n                callback(result, outcome, response);\n            });\n        };\n    }\n);\n","StripeIntegration_Payments/js/model/upcomingInvoice.js":"define(\n    [\n        'ko',\n        'Magento_Checkout/js/model/quote',\n        'StripeIntegration_Payments/js/action/get-upcoming-invoice',\n    ],\n    function (\n        ko,\n        quote,\n        getUpcomingInvoiceAction\n    ) {\n        'use strict';\n\n        return {\n            upcomingInvoiceRequest: null,\n            initialized: false,\n            currentTotals: null,\n            callbacks: [],\n\n            initialize: function()\n            {\n                if (this.initialized)\n                    return;\n\n                this.initialized = true;\n\n                this.watchTotals();\n                getUpcomingInvoiceAction(this.upcomingInvoiceChanged.bind(this));\n            },\n\n            watchTotals: function()\n            {\n                this.currentTotals = quote.totals();\n                var upcomingInvoiceChanged = this.upcomingInvoiceChanged.bind(this);\n                var self = this;\n\n                quote.totals.subscribe(function (totals)\n                {\n                    if (JSON.stringify(totals.total_segments) == JSON.stringify(self.currentTotals.total_segments))\n                        return;\n\n                    self.currentTotals = totals;\n\n                    getUpcomingInvoiceAction(upcomingInvoiceChanged);\n                }, self);\n            },\n\n            upcomingInvoiceChanged: function(result, outcome, response)\n            {\n                this.upcomingInvoiceRequest = {\n                    result: result,\n                    outcome: outcome,\n                    response: response\n                };\n\n                for (var i = 0; i < this.callbacks.length; i++)\n                {\n                    this.callbacks[i](result, outcome, response);\n                }\n            },\n\n            onChange: function(callback)\n            {\n                this.callbacks.push(callback);\n\n                if (this.upcominInvoiceRequest)\n                {\n                    callback(this.upcominInvoiceRequest.result, this.upcominInvoiceRequest.outcome, this.upcominInvoiceRequest.response);\n                }\n            }\n        };\n    }\n);\n","Mageplaza_Barclaycard/js/action/process-payment.js":"/**\r\n * Mageplaza\r\n *\r\n * NOTICE OF LICENSE\r\n *\r\n * This source file is subject to the Mageplaza.com license that is\r\n * available through the world-wide-web at this URL:\r\n * https://www.mageplaza.com/LICENSE.txt\r\n *\r\n * DISCLAIMER\r\n *\r\n * Do not edit or add to this file if you wish to upgrade this extension to newer\r\n * version in the future.\r\n *\r\n * @category    Mageplaza\r\n * @package     Mageplaza_Barclaycard\r\n * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)\r\n * @license     https://www.mageplaza.com/LICENSE.txt\r\n */\r\n\r\ndefine([\r\n    'mage/storage',\r\n    'Magento_Checkout/js/model/quote',\r\n    'Magento_Checkout/js/model/full-screen-loader',\r\n    'Magento_Checkout/js/model/error-processor',\r\n    'Mageplaza_Barclaycard/js/model/resource-url-manager'\r\n], function (storage, quote, fullScreenLoader, errorProcessor, resourceUrlManager) {\r\n    'use strict';\r\n\r\n    return function (messageContainer, action) {\r\n        fullScreenLoader.startLoader();\r\n        return storage.post(\r\n            action === 'hosted'\r\n                ? resourceUrlManager.getUrlForGetHostedUrl(quote)\r\n                : resourceUrlManager.getUrlForProcess3ds(quote)\r\n        ).fail(function (response) {\r\n            errorProcessor.process(response, messageContainer);\r\n        }).always(function () {\r\n            fullScreenLoader.stopLoader();\r\n        });\r\n    };\r\n});\r\n","Mageplaza_Barclaycard/js/view/payment/render.js":"/**\r\n * Mageplaza\r\n *\r\n * NOTICE OF LICENSE\r\n *\r\n * This source file is subject to the Mageplaza.com license that is\r\n * available through the world-wide-web at this URL:\r\n * https://www.mageplaza.com/LICENSE.txt\r\n *\r\n * DISCLAIMER\r\n *\r\n * Do not edit or add to this file if you wish to upgrade this extension to newer\r\n * version in the future.\r\n *\r\n * @category    Mageplaza\r\n * @package     Mageplaza_Barclaycard\r\n * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)\r\n * @license     https://www.mageplaza.com/LICENSE.txt\r\n */\r\n\r\ndefine([\r\n    'uiComponent',\r\n    'Magento_Checkout/js/model/payment/renderer-list'\r\n], function (Component, rendererList) {\r\n    'use strict';\r\n\r\n    rendererList.push(\r\n        {\r\n            type: 'mpbarclaycard_direct',\r\n            component: 'Mageplaza_Barclaycard/js/view/payment/method-renderer/direct'\r\n        },\r\n        {\r\n            type: 'mpbarclaycard_hosted',\r\n            component: 'Mageplaza_Barclaycard/js/view/payment/method-renderer/hosted'\r\n        }\r\n    );\r\n\r\n    return Component.extend({});\r\n});\r\n","Mageplaza_Barclaycard/js/view/payment/method-renderer/hosted.js":"/**\r\n * Mageplaza\r\n *\r\n * NOTICE OF LICENSE\r\n *\r\n * This source file is subject to the Mageplaza.com license that is\r\n * available through the world-wide-web at this URL:\r\n * https://www.mageplaza.com/LICENSE.txt\r\n *\r\n * DISCLAIMER\r\n *\r\n * Do not edit or add to this file if you wish to upgrade this extension to newer\r\n * version in the future.\r\n *\r\n * @category    Mageplaza\r\n * @package     Mageplaza_Barclaycard\r\n * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)\r\n * @license     https://www.mageplaza.com/LICENSE.txt\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'Magento_Checkout/js/view/payment/default',\r\n    'Magento_Checkout/js/model/payment/additional-validators',\r\n    'Magento_Checkout/js/action/set-payment-information',\r\n    'Mageplaza_Barclaycard/js/action/process-payment',\r\n    'Magento_Customer/js/customer-data',\r\n    'mage/dataPost'\r\n], function ($, Component, additionalValidators, setPaymentInformationAction, processPaymentAction, customerData) {\r\n    'use strict';\r\n\r\n    return Component.extend({\r\n        defaults: {\r\n            template: 'Mageplaza_Barclaycard/payment/hosted'\r\n        },\r\n\r\n        /**\r\n         * @returns {String}\r\n         */\r\n        getCode: function () {\r\n            return this.index;\r\n        },\r\n\r\n        getConfig: function (key) {\r\n            if (window.checkoutConfig.payment[this.getCode()].hasOwnProperty(key)) {\r\n                return window.checkoutConfig.payment[this.getCode()][key];\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        isActive: function () {\r\n            return this.getCode() === this.isChecked();\r\n        },\r\n\r\n        checkout: function (data, event) {\r\n            var self = this;\r\n\r\n            if (event) {\r\n                event.preventDefault();\r\n            }\r\n\r\n            if (!this.validate() || !additionalValidators.validate()) {\r\n                return;\r\n            }\r\n\r\n            setPaymentInformationAction(this.messageContainer, this.getData()).done(function () {\r\n                processPaymentAction(self.messageContainer, 'hosted').done(function (response) {\r\n                    customerData.invalidate(['cart', 'checkout-data']);\r\n\r\n                    $.mage.dataPost().postData(JSON.parse(response));\r\n                });\r\n            });\r\n        }\r\n    });\r\n});\r\n","Mageplaza_Barclaycard/js/view/payment/method-renderer/direct.js":"/**\r\n * Mageplaza\r\n *\r\n * NOTICE OF LICENSE\r\n *\r\n * This source file is subject to the Mageplaza.com license that is\r\n * available through the world-wide-web at this URL:\r\n * https://www.mageplaza.com/LICENSE.txt\r\n *\r\n * DISCLAIMER\r\n *\r\n * Do not edit or add to this file if you wish to upgrade this extension to newer\r\n * version in the future.\r\n *\r\n * @category    Mageplaza\r\n * @package     Mageplaza_Barclaycard\r\n * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)\r\n * @license     https://www.mageplaza.com/LICENSE.txt\r\n */\r\n\r\ndefine([\r\n    'ko',\r\n    'jquery',\r\n    'Magento_Payment/js/view/payment/cc-form',\r\n    'Magento_Checkout/js/model/payment/additional-validators',\r\n    'Magento_Checkout/js/action/set-payment-information',\r\n    'Mageplaza_Barclaycard/js/action/process-payment',\r\n    'Magento_Customer/js/customer-data'\r\n], function (ko, $, Component, additionalValidators, setPaymentInformationAction, processPaymentAction, customerData) {\r\n    'use strict';\r\n\r\n    return Component.extend({\r\n        defaults: {\r\n            template: 'Mageplaza_Barclaycard/payment/direct',\r\n            isValidated: ko.observable(false),\r\n            form3ds: ko.observable()\r\n        },\r\n\r\n        initialize: function () {\r\n            this._super();\r\n\r\n            if (window.checkoutConfig && window.checkoutConfig.hasOwnProperty('oscConfig')) {\r\n                additionalValidators.registerValidator(this);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * @return {Boolean}\r\n         */\r\n        selectPaymentMethod: function () {\r\n            this.isValidated(false);\r\n\r\n            return this._super();\r\n        },\r\n\r\n        /**\r\n         * @returns {String}\r\n         */\r\n        getCode: function () {\r\n            return this.index;\r\n        },\r\n\r\n        /**\r\n         * @returns {Object}\r\n         */\r\n        getData: function () {\r\n            var data = this._super();\r\n\r\n            if (!data.hasOwnProperty('additional_data') || !data.additional_data) {\r\n                data.additional_data = {};\r\n            }\r\n\r\n            data.additional_data.is_frontend = 1;\r\n\r\n            return data;\r\n        },\r\n\r\n        getConfig: function (key) {\r\n            if (window.checkoutConfig.payment[this.getCode()].hasOwnProperty(key)) {\r\n                return window.checkoutConfig.payment[this.getCode()][key];\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        isActive: function () {\r\n            return this.getCode() === this.isChecked();\r\n        },\r\n\r\n        isProvided: function () {\r\n            if (this.hasVerification() && !this.creditCardVerificationNumber()) {\r\n                return false;\r\n            }\r\n\r\n            return !!(this.creditCardNumber() && this.creditCardExpMonth() && this.creditCardExpYear());\r\n        },\r\n\r\n        validate: function () {\r\n            if (!this.isActive()) {\r\n                return true;\r\n            }\r\n\r\n            this.isValidated(true);\r\n\r\n            return this._super() && this.isProvided();\r\n        },\r\n\r\n        checkout: function (data, event) {\r\n            if (event) {\r\n                event.preventDefault();\r\n            }\r\n\r\n            if (!this.validate() || !additionalValidators.validate()) {\r\n                $('body, html').animate({scrollTop: $('#' + this.getCode()).offset().top}, 'slow');\r\n\r\n                return false;\r\n            }\r\n\r\n            if (this.getConfig('use3ds')) {\r\n                return this.process3ds(data, event);\r\n            }\r\n\r\n            return this.placeOrder(data, event);\r\n        },\r\n\r\n        process3ds: function (data, event) {\r\n            var self = this;\r\n\r\n            setPaymentInformationAction(this.messageContainer, this.getData()).done(function () {\r\n                processPaymentAction(self.messageContainer, '3ds').done(function (response) {\r\n                    if (response) {\r\n                        customerData.invalidate(['cart', 'checkout-data']);\r\n\r\n                        self.form3ds(response);\r\n                    } else {\r\n                        self.placeOrder(data, event);\r\n                    }\r\n                });\r\n            });\r\n\r\n            return true;\r\n        }\r\n    });\r\n});\r\n","Mageplaza_Barclaycard/js/model/resource-url-manager.js":"/**\r\n * Mageplaza\r\n *\r\n * NOTICE OF LICENSE\r\n *\r\n * This source file is subject to the Mageplaza.com license that is\r\n * available through the world-wide-web at this URL:\r\n * https://www.mageplaza.com/LICENSE.txt\r\n *\r\n * DISCLAIMER\r\n *\r\n * Do not edit or add to this file if you wish to upgrade this extension to newer\r\n * version in the future.\r\n *\r\n * @category    Mageplaza\r\n * @package     Mageplaza_Barclaycard\r\n * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)\r\n * @license     https://www.mageplaza.com/LICENSE.txt\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'Magento_Checkout/js/model/resource-url-manager'\r\n], function ($, resourceUrlManager) {\r\n    'use strict';\r\n\r\n    return $.extend(resourceUrlManager, {\r\n        getUrlForGetHostedUrl: function (quote) {\r\n            var params = this.getCheckoutMethod() === 'guest' ? {cartId: quote.getQuoteId()} : {},\r\n                urls   = {\r\n                    'guest': '/guest-carts/:cartId/mpbarclaycard-get-hosted-url',\r\n                    'customer': '/carts/mine/mpbarclaycard-get-hosted-url'\r\n                };\r\n\r\n            return this.getUrl(urls, params);\r\n        },\r\n\r\n        getUrlForProcess3ds: function (quote) {\r\n            var params = this.getCheckoutMethod() === 'guest' ? {cartId: quote.getQuoteId()} : {},\r\n                urls   = {\r\n                    'guest': '/guest-carts/:cartId/mpbarclaycard-process-3ds',\r\n                    'customer': '/carts/mine/mpbarclaycard-process-3ds'\r\n                };\r\n\r\n            return this.getUrl(urls, params);\r\n        }\r\n    });\r\n});\r\n","Magepow_Productzoom/js/zoom.js":"class MageZoom {\n    constructor() {\n        this.minHeight = 200;\n        this.minWindow = 350;\n        this.maxWindow = 900;\n        this.tryTime = 200;\n        this.preload = true;\n        this.touchDevices = false;\n        this.zoomIgnore = 'zoom-ignore';\n        this.zoomInit = 'zoom-init';\n        this.imgSource = ['data-original', 'data-original-src', 'srcset', 'data-srcset', 'data-src', 'src'];\n        this.options = {\n            debugger: false,\n            /* shopify-section-template not exist in old theme so incompatible old theme */\n            section: 'shopify-section',\n            sectionSelector: '[id^=\"shopify-section\"]:not(\".header-section, .section-header, .footer-section, .section-footer, #shopify-section-header, #shopify-section-footer, #shopify-section-footer-promotions, #shopify-section-newsletter-popup\")',\n            sectionExclude: 'header, product-modal, quick-order-list, .fancybox__container, .mfp-container, .pswp__container, .popup, .description, .product__description, .thumbnail-slider, product-recommendations, [id*=\"recommendations\"], [class*=\"recommendations\"], [id*=\"related\"], [class*=\"related\"], [id*=\"recently\"], footer, product-tab, m-product-details-tabs, .t4s-product-tabs-wrapper, .tab-content',\n            container: '[id^=\"shopify-section-template\"][id*=\"main\"], media-gallery, modal-opener, product-gallery, gallery-product, product-media, product-images',\n            pages: 'product',\n            Init: '',\n            ZoomInit: '',\n            ZoomIn: '',\n            ZoomOut: '',\n            zoomFactor: 1,\n            ZoomIgnore: '.zoom-ignore',\n            effectDuration: 600,\n            sourceAttribute: 'data-zoom',\n            originalImage: true,\n            zoomType: 'window',\n            marginWindow: 10\n        };\n        this.controller = new AbortController();\n        this.signal = this.controller.signal;\n        var self = this;\n        document.addEventListener(\"domReady\", function () {\n            if (window.matchMedia(\"(pointer: coarse)\").matches) {\n                self.touchDevices = true;\n                document.documentElement.classList.add('touchscreen');\n            }\n            var options = self.options,\n                settings = document.querySelector('#magepowapps-zoom-settings');\n            self.debugger = options.debugger;\n            if (settings) {\n                if (document.currentScript && document.currentScript.src) {\n                    self.getAppVersion(document.currentScript.src.split('/js/')[0].split('/').pop(), 'https://magepow.com/magento-2-product-zoom.html');\n                }\n                self.settings = JSON.parse(settings.innerHTML);\n                if (typeof self.settings === \"object\") {\n                    var requires = ['container'];\n                    requires.forEach(function (val) {\n                        if (self.settings[val] == '') delete self.settings[val];\n                    });\n                    Object.assign(self.options, self.settings);\n                }\n            } else {\n                self.logMsg(' ProductZoom Disabled!');\n                return;\n            }\n            /* Disable zoom in mobile */\n            if (self.options.zoomTouch == 'off' && self.touchDevices) return;\n\n            const zoomType = new URLSearchParams(window.location.search).get('zoomType');\n            if (zoomType) {\n                Object.assign(self.options, { zoomType: zoomType });\n            }\n            if (document.body.classList.contains('rtl') || document.documentElement.classList.contains('rtl') || document.body.dir == \"rtl\") {\n                self.RTL = true;\n            }\n            if (self.debugger) {\n                self.logger(self.options);\n            }\n\n            if (options.hasOwnProperty('Init') && typeof options.Init === 'function') {\n                options.Init();\n            }\n\n            document.body.addEventListener(\"MageZoom:ZoomInit\", function (event) {\n                var img = event.detail;\n                if (options.hasOwnProperty('ZoomInit') && typeof options.Init === 'function') {\n                    options.ZoomIn();\n                }\n            });\n\n            document.body.addEventListener(\"MageZoom:ZoomIn\", function (event) {\n                var img = event.detail;\n                if (options.hasOwnProperty('ZoomIn') && typeof options.Init === 'function') {\n                    options.ZoomIn();\n                }\n            });\n\n            document.body.addEventListener(\"MageZoom:ZoomOut\", function (event) {\n                var img = event.detail;\n                if (options.hasOwnProperty('ZoomOut') && typeof options.Init === 'function') {\n                    options.ZoomOut();\n                }\n            });\n\n            self.initZoom();\n            const debscanImage = self.debounce(() => {\n                var images = self.scanImage();\n                images.forEach((img) => {\n                    self.zoomImage(img);\n                });\n            }, 0);\n            var observer = new MutationObserver(function (mutations) {\n                mutations.forEach(function (mutation) {\n                    var element = mutation.target;\n                    if (!(element instanceof Element)) {\n                        element = element.parentElement;\n                    }\n                    if (element.drift && mutation.type == 'attributes' && self.imgSource.includes(mutation.attributeName)) {\n                        if (!element.complete) {\n                            element.onload = function () {\n                                var imgx = element.getAttribute(mutation.attributeName),\n                                    currentSrc = element.currentSrc.replace(/^https?:/, '').trim();\n                                if (imgx.includes(currentSrc)) {\n                                    var imageUrl = self.getImageUrl(imgx);\n                                    element.drift.setZoomImageURL(imageUrl);\n                                    element.setAttribute(self.options.sourceAttribute, imageUrl);\n                                }\n                            }\n                        } else {\n                            var imgx = element.getAttribute(mutation.attributeName),\n                                currentSrc = element.currentSrc.replace(/^https?:/, '').trim();\n                            if (imgx.includes(currentSrc)) {\n                                var imageUrl = self.getImageUrl(imgx);\n                                element.drift.setZoomImageURL(imageUrl);\n                                element.setAttribute(self.options.sourceAttribute, imageUrl);\n                            }\n                        }\n                    } else if (element.closest('.drift-pane') || element.closest(self.options.sectionExclude) || element.closest(self.options.ZoomIgnore)) {\n                        return;\n                    }\n                    // debscanImage();\n                    var images = self.scanImage();\n                    // var images = self.getImages(element);\n                    images.forEach((img) => {\n                        self.zoomImage(img);\n                    });\n                })\n            });\n            observer.observe(document.querySelector('main') || document.body, { attributes: true, childList: true, subtree: true });\n        });\n        if (/complete|interactive|loaded/.test(document.readyState)) {\n            document.dispatchEvent(new Event('domReady'));\n        } else {\n            document.addEventListener('DOMContentLoaded', function () {\n                document.dispatchEvent(new Event('domReady'));\n            }, false);\n        }\n    }\n\n    logMsg(msg) {\n        console.log(`%c ${msg} `, \"background: #44cc11; padding: 1px; margin-bottom: 2px; border-radius: 6px; color: #fff\");\n    }\n\n    getAppVersion(appName, href) {\n        // this expression is to get the version string\n        let regx = new RegExp('.*\\/(.*?)\\/assets\\/', 'i');\n        let result = regx.exec(href);\n        let version = result ? result[1].replace(/\\D/g, '') : '1.0.0';\n        console.log(`%c ${appName} %c v${version}  %c`, \"background: #555555; padding: 1px; margin-bottom: 2px; border-radius: 3px 0 0 3px; color: #fff\", \"background: #44cc11; padding: 1px; margin-bottom: 2px; border-radius: 0 3px 3px 0; color: #fff\", \"background:transparent\", `\ud83d\ude80 ${href}`);\n\n        return version;\n    }\n\n    is(selector, element) {\n        if (element instanceof NodeList || Array.isArray(element)) {\n            return Array.from(element).some(function (item) {\n                return item.matches(selector);\n            });\n        }\n        return this.isElement(element) ? element.matches(selector) : false;\n    }\n\n    isElement(element) {\n        // return element instanceof Element || element instanceof HTMLDocument;  \n        return element instanceof Element;\n    }\n\n    scanImage() {\n        var self = this,\n            elements,\n            images = [],\n            selector = self.options.container;\n        if (selector) {\n            elements = document.querySelectorAll(selector);\n            images = self.getImages(elements);\n        }\n        if (!images.length) {\n            elements = self.detectProductGallery();\n            images = self.getImages(elements);\n            if (!images.length) {\n                images = self.getImages(elements.previousElementSibling);\n                if (!images.length) {\n                    images = self.getImages(elements.nextElementSibling);\n                }\n            }\n        }\n        return images;\n    }\n\n    initZoom() {\n        var self = this,\n            elements,\n            images = [];\n        document.querySelector('html').classList.add('magezoom-init', 'magezoom-' + this.options.zoomType);\n        images = self.scanImage();\n        if (!images.length) {\n            console.warn('Images does not exist!');\n            return;\n        }\n        if (this.debugger) {\n            console.log(elements);\n        }\n        images.forEach((img) => {\n            self.zoomImage(img);\n        });\n        document.body.addEventListener('ZoomCreate', function (event) {\n            var img = event.detail;\n            if (img) self.zoomImage(img);\n        });\n        self.lightZoom();\n    }\n    lightZoom() {\n        var self = this;\n        document.querySelectorAll('modal-opener').forEach(element => {\n            element.addEventListener('click', function (event) {\n                if (event.target.matches('img') || event.target.closest('.motion-reduce, .product__media-icon')) {\n                    var lightbox = element.querySelector('[aria-haspopup=\"dialog\"]');\n                    if (lightbox) lightbox.click();\n                }\n            });\n        });\n        document.body.addEventListener('ZoomImgClick', function (event) {\n            var img = event.detail;\n            if (img) {\n                var next = img.nextElementSibling;\n                if (next && self.is('button', next)) {\n                    next.click();\n                } else {\n                    var lightbox = img.parentElement.parentElement.parentElement.querySelector('.js-photoswipe__zoom, a[rel=\"lightbox\"], modal-trigger, button[x-ref=\"galleryFullscreenBtn\"]');\n                    if (lightbox) lightbox.click();\n                }\n            }\n        });\n    }\n    tryAgain(time) {\n        var self = this,\n            time = time || 100;\n        if (this.tryTime < 0) return;\n        this.tryTime--;\n        setTimeout(function () {\n            {\n                self.initZoom();\n            }\n        }, time);\n    }\n    zoomImage(img) {\n        if (img.drift ||\n            img.classList.contains('zoom-ignore') ||\n            img.classList.contains(\"pswp__img\") ||\n            img.classList.contains(\"fancybox-image\") ||\n            img.classList.contains(\"fancybox-img\") ||\n            img.classList.contains(\"mfp-img\") ||\n            img.classList.contains(\"fslightbox-source\") ||\n            img.classList.contains(\"js-zoom-item\") ||\n            img.closest(\".drift-zoom-pane\")\n        ) return;\n        if (img.classList.contains('lazyload') || !this.isVisible(img) || !this.validateImage(img)) {\n            this.watchImg(img);\n            return;\n        }\n        var self = this,\n            dataSource = self.options.sourceAttribute;\n        if (!img.getAttribute(dataSource)) {\n            img = self.prepareDataZoom(img);\n            if (!img || !img.getAttribute(dataSource)) return;\n        }\n        img.classList.add(self.zoomInit);\n        var pointerEvents = window.getComputedStyle(img, null).getPropertyValue('pointer-events');\n        if (pointerEvents == 'none') {\n            img.style.setProperty('pointer-events', 'auto', 'important');\n        }\n        if (self.preload) {\n            self.preload = false;\n            new Image().src = img.getAttribute(self.options.sourceAttribute);\n        }\n        img.addEventListener('click', function (event) {\n            if (self.debugger) {\n                self.logger('ZoomImgClick');\n            }\n            document.body.dispatchEvent(new CustomEvent('ZoomImgClick', { detail: event.target }));\n        });\n        var options = self.options;\n        if (self.touchDevices) {\n            if (!options.zoomTouch) options.zoomTouch = options.zoomType;\n            options = (options.zoomTouch == 'lens') ? self.getZoomLens(img) : self.getZoomInner(img)\n        } else {\n            switch (options.zoomType) {\n                case 'lens':\n                    options = self.getZoomLens(img);\n                    break;\n                case 'inner':\n                    options = self.getZoomInner(img);\n                    break;\n                default:\n                    options = self.getZoomWindow(img);\n            }\n        }\n        var drift = new Drift(img, options);\n        img.drift = drift;\n    }\n\n    getPaneContainer() {\n        if (!self.paneContainer) {\n            var div = document.createElement('div');\n            div.setAttribute('class', 'drift-pane');\n            var appendZoom = document.querySelector('product-gallery-disable');\n            if (appendZoom) {\n                appendZoom.appendChild(div);\n            } else {\n                document.body.appendChild(div);\n            }\n            self.paneContainer = document.querySelector('.drift-pane');\n        }\n        return self.paneContainer;\n    }\n\n    getZoomLens(img) {\n        var self = this,\n            options = self.options;\n        return Object.assign(options, {\n            namespace: 'magezoom-lens',\n            inlinePane: true,\n            hoverBoundingBox: false\n        });\n    }\n\n    getZoomInner(img) {\n        var self = this,\n            options = self.options,\n            pane = self.getPaneContainer(),\n            effect = self.options.zoomEffect,\n            timing = { duration: parseInt(self.options.effectDuration), iterations: 0.5 };\n        effect = effect ? self.zoomEffect() : self.zoomEffect('flyOutWindow');\n        return Object.assign(options, {\n            namespace: 'magezoom-inner',\n            inlinePane: (self.touchDevices && self.zoomTouch == 'lens') ? true : 1,\n            hoverBoundingBox: false,\n            paneContainer: pane,\n            onShow: function () {\n                if (img.clientHeight < self.minHeight || img.clientWidth < self.minHeight) {\n                    pane.style.display = 'none';\n                    return;\n                }\n                self.setPositionInner(img);\n                window.addEventListener(\"scroll\", function () {\n                    self.setPositionInner(img);\n                }, { signal: self.signal });\n                pane.animate(effect, timing);\n                pane.style.position = 'absolute';\n                pane.style.display = 'block';\n            }\n        });\n    }\n\n    getZoomWindow(img) {\n        var self = this,\n            options = self.options,\n            pane = self.getPaneContainer(),\n            effect = self.options.zoomEffect,\n            timing = { duration: parseInt(self.options.effectDuration), iterations: 0.5 };\n        return Object.assign(options, {\n            namespace: 'magezoom-window',\n            inlinePane: false,\n            containInline: true,\n            paneContainer: pane,\n            onShow: function () {\n                if (img.clientHeight < self.minHeight || img.clientWidth < self.minHeight) {\n                    pane.style.display = 'none';\n                    return;\n                }\n                self.setPositionWindow(img);\n                window.addEventListener(\"scroll\", function () {\n                    self.setPositionWindow(img);\n                }, { signal: self.signal });\n                effect = effect ? self.zoomEffect() : self.zoomEffect('flyOutImageToWindow');\n                pane.animate(effect, timing);\n                pane.style.position = 'absolute';\n                // pane.style.zIndex=99999;\n                pane.style.display = 'block';\n            },\n            onHide: function () {\n                // self.controller.abort();\n                pane.style.display = 'none';\n            }\n        }\n        );\n    }\n\n    setPositionInner(img) {\n        var self = this,\n            options = self.options,\n            pane = self.getPaneContainer();\n        const scrollX = window.pageXOffset;\n        const scrollY = window.pageYOffset;\n        var triggerRect = img.getBoundingClientRect();\n        let inlineLeft = triggerRect.left + scrollX;\n        let inlineTop = triggerRect.top + scrollY;\n        if (inlineLeft < triggerRect.left + scrollX) {\n            inlineLeft = triggerRect.left + scrollX;\n        }\n        if (inlineTop < triggerRect.top + scrollY) {\n            inlineTop = triggerRect.top + scrollY;\n        }\n        pane.style.top = `${inlineTop}px`;\n        pane.style.left = `${inlineLeft}px`;\n        pane.style.width = `${img.clientWidth}px`;\n        pane.style.height = `${img.clientHeight}px`;\n    }\n\n    setPositionWindow(img) {\n        var self = this,\n            options = self.options,\n            pane = self.getPaneContainer();\n        const scrollX = window.pageXOffset;\n        const scrollY = window.pageYOffset;\n        var windowWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0),\n            zoomWidth = options.zoomWidth ? options.zoomWidth : img.clientWidth,\n            zoomHeight = options.zoomHeight ? options.zoomHeight : img.clientHeight,\n            aspectRatio = zoomWidth / zoomHeight,\n            triggerRect = img.getBoundingClientRect(),\n            left = triggerRect.left,\n            right = windowWidth - triggerRect.right;\n\n        let inlineLeft = triggerRect.left + scrollX;\n        let inlineTop = triggerRect.top + scrollY;\n        if (inlineLeft < triggerRect.left + scrollX) {\n            inlineLeft = triggerRect.left + scrollX;\n        }\n        if (inlineTop < triggerRect.top + scrollY) {\n            inlineTop = triggerRect.top + scrollY;\n        }\n\n        self.RTL = (left > right);\n        if (aspectRatio > 2 || aspectRatio < 0.5) {\n            self.minWindow = 600\n        }\n        if (zoomWidth < self.minWindow) {\n            zoomWidth = self.minWindow;\n        }\n        if (zoomHeight < self.minWindow) {\n            zoomHeight = self.minWindow;\n        }\n        if (zoomWidth > self.maxWindow) {\n            zoomWidth = self.maxWindow;\n        }\n        if (zoomHeight > self.maxWindow) {\n            zoomHeight = self.maxWindow;\n        }\n        if (self.RTL) {\n            pane.style.removeProperty('right');\n            var negative = (left < zoomWidth + options.marginWindow),\n                leftPanel = negative ? options.marginWindow : left - (zoomWidth + options.marginWindow);\n            pane.style.left = `${leftPanel}px`;\n            if (negative) zoomWidth = zoomWidth - (zoomWidth - left) - 2 * options.marginWindow;\n        } else {\n            pane.style.removeProperty('left');\n            var negative = (right < zoomWidth + options.marginWindow),\n                rightPanel = negative ? options.marginWindow : right - (zoomWidth + options.marginWindow);\n            pane.style.right = `${rightPanel}px`;\n            if (negative) zoomWidth = zoomWidth - (zoomWidth - right) - 2 * options.marginWindow;\n        }\n        pane.style.top = `${inlineTop}px`;\n        pane.style.width = `${zoomWidth}px`;\n        pane.style.height = `${zoomHeight}px`;\n    }\n\n    prepareDataZoom(img) {\n        var self = this,\n            src,\n            isZoom,\n            dataSource = self.options.sourceAttribute;\n        if (img.drift || img.getAttribute(dataSource)) return img;\n        self.imgSource.every((data) => {\n            src = img.getAttribute(data);\n            if (src && src.includes('//')) {\n                return false;\n            } else {\n                return true;\n            }\n        });\n        if (!src && img.currentSrc) {\n            src = img.currentSrc;\n        }\n        if (!src) {\n            console.warn('Not found src in tag img');\n            // self.tryAgain();\n            return;\n        }\n        src = self.getImageUrl(src);\n        /* Only create zoom source when image match condition */\n        isZoom = (img.classList.contains('zoom') || src.includes('/catalog/product/') || !src.includes(window.location.hostname));\n        if (src && isZoom) {\n            if (src.includes('{') && src.includes('}')) {\n                self.watchImg(img);\n                return;\n            }\n            img.setAttribute(dataSource, src);\n        } else {\n            img.classList.add(self.zoomIgnore);\n        }\n        return img;\n    }\n\n    watchImg(img) {\n        var self = this;\n        if (!img.matches('img') || img.follow) return;\n        img.follow = true;\n        img.classList.add('zoom-watch');\n        const observer = new MutationObserver((changes) => {\n            changes.forEach(change => {\n                if (change.attributeName.includes('src')) {\n                    // const newValue = change.target.getAttribute(change.attributeName);\n                    if (img.clientHeight == 0) return;\n                    if (img.clientHeight >= self.minHeight) {\n                        self.prepareDataZoom(img);\n                        document.body.dispatchEvent(new CustomEvent('ZoomCreate', { detail: img }));\n                    } else {\n                        /* ignore image small & keep hidden image */\n                        img.classList.add(self.zoomIgnore);\n                    }\n                    observer.disconnect();\n                }\n            });\n        });\n        observer.observe(img, { attributeFilter: ['src'] });\n    }\n\n    detectProductGallery() {\n        var self = this,\n            form = document.querySelector('main') || document.body;\n        [\n            'form[action=\"/cart/add\"] [name=\"form_type\"]',\n            'form[action=\"/cart/add\"] [name=\"quantity\"]',\n            'form[action=\"/cart/add\"] [name=\"id\"]',\n            'form[action=\"/cart/add\"]',\n            '[name=\"id\"]',\n            'button[name=\"addd\"]',\n            'button[type=\"submit\"]'\n        ].every((selector) => {\n            form = document.querySelector(selector);\n            if (self.debugger) {\n                console.log(form);\n            }\n            if (form) {\n                return false;\n            } else {\n                return true;\n            }\n        });\n        var section = this.getSection(form);\n        if (section) return section;\n    }\n\n    getSection(element) {\n        var tagName = element.tagName.toLowerCase();\n        if (element.classList.contains('shopify-section') || element.classList.contains('section') || tagName === \"html\" || tagName === \"body\" || tagName === \"section\") {\n            if (element.querySelector('img')) {\n                return element;\n            } else if (tagName === \"section\") {\n                element = this.getSection(element.parentElement);\n            }\n        } else {\n            element = this.getSection(element.parentElement);\n        }\n        return element;\n    }\n\n    getImages(elements) {\n        var self = this,\n            images = [];\n        if (!elements) return images;\n        if (!(elements instanceof NodeList)) {\n            elements = [elements];\n        }\n        elements.forEach((element) => {\n            if (!(element instanceof Element)) return;\n            if (element instanceof HTMLImageElement) {\n                images.push(element);\n            } else {\n                var imgs = element.querySelectorAll('img:not(.' + self.zoomIgnore + ')');\n                if (imgs) {\n                    imgs.forEach((img) => {\n                        if (!self.excludeImage(img)) {\n                            images.push(img);\n                        }\n                    });\n                }\n            }\n        });\n        return images;\n    }\n\n    getImageUrl(src) {\n        const breakpoint = / \\d*\\w/g;\n        const tags = Array.from(src.matchAll(breakpoint));\n        if (tags.length) {\n            const splitted = src.split(breakpoint)\n            var size = 0;\n            tags.forEach((screen, index) => {\n                var image = splitted[index].replace(/^\\,/, '');\n                screen = screen[0].replace(/\\D/g, '');\n                if (screen > size && image.includes('//')) {\n                    src = image;\n                }\n            });\n        }\n        const isWebP = /\\.webp$/i.test(src);\n        if (this.options.originalImage && !isWebP){\n            src = src.replace(/\\?width=\\d+\\&/, '?').replace(/\\?width=\\d+/, '').replace(/\\&width=\\d+/, '');\n            src = src.replace(/\\?height=\\d+\\&/, '?').replace(/\\?height=\\d+/, '').replace(/\\&height=\\d+/, '');\n            src = src.replace(/\\/cache\\/\\b[a-fA-F0-9]{32}\\b/g, '');\n        }\n        if (this.debugger) {\n            this.logger(src);\n        }\n        return src;\n    }\n\n    excludeImage(img) {\n        return (\n            !!img.drift ||\n            !this.isVisible(img) ||\n            !!img.closest(this.options.ZoomIgnore) ||\n            !!img.closest(this.options.sectionExclude)\n        );\n    }\n\n    validateImage(img) {\n        if (this.isVisible(img) && img.clientHeight < this.minHeight) {\n            return false;\n        }\n        return true;\n    }\n\n    isVisible(element) {\n        return element.offsetWidth > 0 || element.offsetHeight > 0 || element.getClientRects().length > 0;\n    }\n\n    getErrorObject() {\n        try { throw Error('') } catch (err) { return err; }\n    }\n    /* Funtion logger use console.log and console.group */\n    logger(msg, group = true) {\n        console.logger = function (msg, group = true) {\n            if (group) {\n                if (typeof group == 'boolean') {\n                    console.group('console.logger >>');\n                } else {\n                    console.group(group);\n                }\n            }\n            switch (typeof msg) {\n                case 'object':\n                    for (const [key, value] of Object.entries(msg)) {\n                        console.log(`${key} :`, value);\n                    }\n                    break;\n                default:\n                    console.log(msg);\n            }\n            if (group) console.groupEnd();\n        }\n        console.logger(msg, group);\n        var inLogger = this.getErrorObject();\n        console.log(inLogger.stack);\n    }\n\n    zoomEffect(type) {\n        var self = this;\n        if (self.effect) return self.effect;\n        type = type || self.options.zoomEffect;\n        switch (type) {\n            case 'flyOutWindow':\n                self.effect = [\n                    { transform: 'translate3d(0%, 0, 0) scale(0)' },\n                    { transform: 'translate3d(0, 0, 0) scale(1)' },\n                    { transition: 'all .8s linear both' }\n                ];\n                break;\n            case 'flySpinningWindow':\n                self.effect = [\n                    { transform: 'scale(0) rotateZ(0)' },\n                    { transform: 'scale(1) rotateZ(-360deg)' },\n                    { transition: 'all 0.5s linear both' }\n                ];\n                break;\n            case 'flySpinningImageToWindow':\n                self.effect = [\n                    { transform: self.RTL ? 'translate3d(100%, 0, 0) scale(0) rotateZ(0)' : 'translate3d(-100%, 0, 0) scale(0) rotateZ(0)' },\n                    { transform: 'translate3d(0, 0, 0) scale(1) rotateZ(360deg)' },\n                    { transition: 'all 0.5s linear both' }\n                ];\n                break;\n            default:\n                /* Default flyOutImageToWindow */\n                self.effect = [\n                    { transform: self.RTL ? 'translate3d(100%, 0, 0) scale(0)' : 'translate3d(-100%, 0, 0) scale(0)' },\n                    { transform: 'translate3d(0, 0, 0) scale(1)' },\n                    { transition: 'all 0.8s linear both' }\n                ];\n        }\n        return self.effect;\n    }\n    debounce(fn, wait) {\n        let t;\n        return (...args) => {\n            clearTimeout(t);\n            t = setTimeout(() => fn.apply(this, args), wait);\n        };\n    }\n    throttle(fn, delay) {\n        let lastCall = 0;\n        return function (...args) {\n            const now = new Date().getTime();\n            if (now - lastCall < delay) {\n                return;\n            }\n            lastCall = now;\n            return fn(...args);\n        };\n    }\n}\n(function (__wpcc) {\n    __wpcc.d = __wpcc.d || {};\n    __wpcc.d.scope = {};\n    __wpcc.d.createTemplateTagFirstArg = function (a) {\n        return a.raw = a\n    };\n    __wpcc.d.createTemplateTagFirstArgWithRaw = function (a, b) {\n        a.raw = b;\n        return a\n    };\n    __wpcc.d.getGlobal = function (a) {\n        a = [\"object\" == typeof globalThis && globalThis, a, \"object\" == typeof window && window, \"object\" == typeof self && self, \"object\" == typeof global && global];\n        for (var b = 0; b < a.length; ++b) {\n            var c = a[b];\n            if (c && c.Math == Math) return c\n        }\n        throw Error(\"Cannot find global object\");\n    };\n    __wpcc.d.global = __wpcc.d.getGlobal(this);\n    var g;\n    \"undefined\" === typeof g && (g = function () { });\n    g.p = \"\";\n}).call(this || window, (window.__wpcc = window.__wpcc || {}));\n\n(function (__wpcc) {\n    var r = function (a) {\n        return h ? a instanceof HTMLElement : a && \"object\" === typeof a && null !== a && 1 === a.nodeType && \"string\" === typeof a.nodeName\n    },\n        t = function (a, b) {\n            b.forEach(function (c) {\n                a.classList.add(c)\n            })\n        },\n        u = function (a, b) {\n            b.forEach(function (c) {\n                a.classList.remove(c)\n            })\n        },\n        x = function () {\n            throw Error(\"Missing parameter\");\n        },\n        y = function (a) {\n            this.isShowing = !1;\n            var b = void 0 === a.namespace ? null : a.namespace,\n                c = void 0 === a.zoomFactor ? x() : a.zoomFactor;\n            a = void 0 === a.containerEl ? x() : a.containerEl;\n            this.settings = {\n                namespace: b,\n                zoomFactor: c,\n                containerEl: a\n            };\n            this.openClasses = this._buildClasses(\"open\");\n            this._buildElement()\n        },\n        z = function (a) {\n            a = void 0 === a ? {} : a;\n            this._show = this._show.bind(this);\n            this._hide = this._hide.bind(this);\n            this._handleEntry = this._handleEntry.bind(this);\n            this._handleMovement = this._handleMovement.bind(this);\n            var b = void 0 === a.el ? x() : a.el,\n                c = void 0 === a.zoomPane ? x() : a.zoomPane,\n                e = void 0 === a.sourceAttribute ? x() : a.sourceAttribute,\n                f = void 0 === a.handleTouch ? x() : a.handleTouch,\n                q = void 0 === a.onShow ? null : a.onShow,\n                k = void 0 === a.onHide ? null : a.onHide,\n                v = void 0 === a.hoverDelay ? 0 : a.hoverDelay,\n                w = void 0 === a.touchDelay ? 0 : a.touchDelay,\n                l = void 0 === a.hoverBoundingBox ? x() : a.hoverBoundingBox,\n                m = void 0 === a.touchBoundingBox ? x() : a.touchBoundingBox,\n                n = void 0 === a.namespace ? null : a.namespace,\n                p = void 0 === a.zoomFactor ? x() : a.zoomFactor,\n                B = void 0 === a.boundingBoxContainer ? x() : a.boundingBoxContainer;\n            this.settings = {\n                el: b,\n                zoomPane: c,\n                sourceAttribute: e,\n                handleTouch: f,\n                onShow: q,\n                onHide: k,\n                hoverDelay: v,\n                touchDelay: w,\n                hoverBoundingBox: l,\n                touchBoundingBox: m,\n                namespace: n,\n                zoomFactor: p,\n                boundingBoxContainer: B,\n                passive: void 0 === a.passive ? !1 : a.passive\n            };\n            if (this.settings.hoverBoundingBox || this.settings.touchBoundingBox) this.boundingBox = new y({\n                namespace: this.settings.namespace,\n                zoomFactor: this.settings.zoomFactor,\n                containerEl: this.settings.boundingBoxContainer\n            });\n            this.enabled = !0;\n            this._bindEvents()\n        },\n        A = function (a) {\n            a = void 0 === a ? {} : a;\n            this.HAS_ANIMATION = !1;\n            if (\"undefined\" !== typeof document) {\n                var b = document.createElement(\"div\").style;\n                this.HAS_ANIMATION = \"animation\" in b || \"webkitAnimation\" in b\n            }\n            this._completeShow = this._completeShow.bind(this);\n            this._completeHide = this._completeHide.bind(this);\n            this._handleLoad = this._handleLoad.bind(this);\n            this.isShowing = !1;\n            b = void 0 === a.container ? null : a.container;\n            var c = void 0 === a.zoomFactor ? x() : a.zoomFactor,\n                e = void 0 === a.inline ? x() : a.inline,\n                f = void 0 === a.namespace ? null : a.namespace,\n                q = void 0 === a.showWhitespaceAtEdges ? x() : a.showWhitespaceAtEdges,\n                k = void 0 === a.containInline ? x() : a.containInline;\n            this.settings = {\n                container: b,\n                zoomFactor: c,\n                inline: e,\n                namespace: f,\n                showWhitespaceAtEdges: q,\n                containInline: k,\n                inlineOffsetX: void 0 ===\n                    a.inlineOffsetX ? 0 : a.inlineOffsetX,\n                inlineOffsetY: void 0 === a.inlineOffsetY ? 0 : a.inlineOffsetY,\n                inlineContainer: void 0 === a.inlineContainer ? document.body : a.inlineContainer\n            };\n            this.openClasses = this._buildClasses(\"open\");\n            this.openingClasses = this._buildClasses(\"opening\");\n            this.closingClasses = this._buildClasses(\"closing\");\n            this.inlineClasses = this._buildClasses(\"inline\");\n            this.loadingClasses = this._buildClasses(\"loading\");\n            this._buildElement()\n        },\n        C = function (a, b) {\n            b = void 0 === b ? {} : b;\n            this.VERSION = \"1.5.0\";\n            this.triggerEl =\n                a;\n            this.destroy = this.destroy.bind(this);\n            if (!r(this.triggerEl)) throw new TypeError(\"`new Drift` requires a DOM element as its first argument.\");\n            a = b.namespace || null;\n            var c = b.showWhitespaceAtEdges || !1,\n                e = b.containInline || !1,\n                f = b.inlineOffsetX || 0,\n                q = b.inlineOffsetY || 0,\n                k = b.inlineContainer || document.body,\n                v = b.sourceAttribute || \"data-zoom\",\n                w = b.zoomFactor || 3,\n                l = void 0 === b.paneContainer ? document.body : b.paneContainer,\n                m = b.inlinePane || 375,\n                n = \"handleTouch\" in b ? !!b.handleTouch : !0,\n                p = b.onShow || null,\n                B = b.onHide || null,\n                D = \"injectBaseStyles\" in\n                    b ? !!b.injectBaseStyles : !0,\n                E = b.hoverDelay || 0,\n                F = b.touchDelay || 0,\n                G = b.hoverBoundingBox || !1,\n                H = b.touchBoundingBox || !1,\n                I = b.boundingBoxContainer || document.body;\n            b = b.passive || !1;\n            if (!0 !== m && !r(l)) throw new TypeError(\"`paneContainer` must be a DOM element when `inlinePane !== true`\");\n            if (!r(k)) throw new TypeError(\"`inlineContainer` must be a DOM element\");\n            this.settings = {\n                namespace: a,\n                showWhitespaceAtEdges: c,\n                containInline: e,\n                inlineOffsetX: f,\n                inlineOffsetY: q,\n                inlineContainer: k,\n                sourceAttribute: v,\n                zoomFactor: w,\n                paneContainer: l,\n                inlinePane: m,\n                handleTouch: n,\n                onShow: p,\n                onHide: B,\n                injectBaseStyles: D,\n                hoverDelay: E,\n                touchDelay: F,\n                hoverBoundingBox: G,\n                touchBoundingBox: H,\n                boundingBoxContainer: I,\n                passive: b\n            };\n            this.settings.injectBaseStyles && !document.querySelector(\".drift-base-styles\") && (b = document.createElement(\"style\"), b.type = \"text/css\", b.classList.add(\"drift-base-styles\"), b.appendChild(document.createTextNode(\".drift-bounding-box,.drift-zoom-pane{position:absolute;pointer-events:none}@keyframes noop{0%{zoom:1}}@-webkit-keyframes noop{0%{zoom:1}}.drift-zoom-pane.drift-open{display:block}.drift-zoom-pane.drift-closing,.drift-zoom-pane.drift-opening{animation:noop 1ms;-webkit-animation:noop 1ms}.drift-zoom-pane{overflow:hidden;width:100%;height:100%;top:0;left:0}.drift-zoom-pane-loader{display:none}.drift-zoom-pane img{position:absolute;display:block;max-width:none;max-height:none}\")),\n                a = document.head, a.insertBefore(b, a.firstChild));\n            this._buildZoomPane();\n            this._buildTrigger()\n        },\n        h = \"object\" === typeof HTMLElement;\n    y.prototype._buildClasses = function (a) {\n        var b = [\"drift-\" + a],\n            c = this.settings.namespace;\n        c && b.push(c + \"-\" + a);\n        return b\n    };\n    y.prototype._buildElement = function () {\n        this.el = document.createElement(\"div\");\n        t(this.el, this._buildClasses(\"bounding-box\"))\n    };\n    y.prototype.show = function (a, b) {\n        this.isShowing = !0;\n        this.settings.containerEl.appendChild(this.el);\n        var c = this.el.style;\n        c.width = Math.round(a / this.settings.zoomFactor) + \"px\";\n        c.height = Math.round(b / this.settings.zoomFactor) + \"px\";\n        t(this.el, this.openClasses)\n    };\n    y.prototype.hide = function () {\n        this.isShowing && this.settings.containerEl.removeChild(this.el);\n        this.isShowing = !1;\n        u(this.el, this.openClasses)\n    };\n    y.prototype.setPosition = function (a, b, c) {\n        var e = window.pageXOffset,\n            f = window.pageYOffset;\n        a = c.left + a * c.width - this.el.clientWidth / 2 + e;\n        b = c.top + b * c.height - this.el.clientHeight / 2 + f;\n        a < c.left + e ? a = c.left + e : a + this.el.clientWidth > c.left + c.width + e && (a = c.left + c.width - this.el.clientWidth + e);\n        b < c.top + f ? b = c.top + f : b + this.el.clientHeight > c.top + c.height + f && (b = c.top + c.height - this.el.clientHeight + f);\n        this.el.style.left = a + \"px\";\n        this.el.style.top = b + \"px\"\n    };\n    z.prototype._preventDefault = function (a) {\n        a.preventDefault()\n    };\n    z.prototype._preventDefaultAllowTouchScroll = function (a) {\n        this.settings.touchDelay && this._isTouchEvent(a) && !this.isShowing || a.preventDefault()\n    };\n    z.prototype._isTouchEvent = function (a) {\n        return !!a.touches\n    };\n    z.prototype._bindEvents = function () {\n        this.settings.el.addEventListener(\"mouseenter\", this._handleEntry);\n        this.settings.el.addEventListener(\"mouseleave\", this._hide);\n        this.settings.el.addEventListener(\"mousemove\", this._handleMovement);\n        var a = {\n            passive: this.settings.passive\n        };\n        this.settings.handleTouch ? (this.settings.el.addEventListener(\"touchstart\", this._handleEntry, a), this.settings.el.addEventListener(\"touchend\", this._hide), this.settings.el.addEventListener(\"touchmove\", this._handleMovement, a)) : (this.settings.el.addEventListener(\"touchstart\",\n            this._preventDefault, a), this.settings.el.addEventListener(\"touchend\", this._preventDefault), this.settings.el.addEventListener(\"touchmove\", this._preventDefault, a))\n    };\n    z.prototype._unbindEvents = function () {\n        this.settings.el.removeEventListener(\"mouseenter\", this._handleEntry);\n        this.settings.el.removeEventListener(\"mouseleave\", this._hide);\n        this.settings.el.removeEventListener(\"mousemove\", this._handleMovement);\n        this.settings.handleTouch ? (this.settings.el.removeEventListener(\"touchstart\", this._handleEntry), this.settings.el.removeEventListener(\"touchend\", this._hide), this.settings.el.removeEventListener(\"touchmove\", this._handleMovement)) : (this.settings.el.removeEventListener(\"touchstart\",\n            this._preventDefault), this.settings.el.removeEventListener(\"touchend\", this._preventDefault), this.settings.el.removeEventListener(\"touchmove\", this._preventDefault))\n    };\n    z.prototype._handleEntry = function (a) {\n        this._preventDefaultAllowTouchScroll(a);\n        this._lastMovement = a;\n        \"mouseenter\" == a.type && this.settings.hoverDelay ? this.entryTimeout = setTimeout(this._show, this.settings.hoverDelay) : this.settings.touchDelay ? this.entryTimeout = setTimeout(this._show, this.settings.touchDelay) : this._show()\n    };\n    z.prototype._show = function () {\n        if (this.enabled) {\n            var a = this.settings.onShow;\n            a && \"function\" === typeof a && a();\n            this.settings.zoomPane.show(this.settings.el.getAttribute(this.settings.sourceAttribute), this.settings.el.clientWidth, this.settings.el.clientHeight);\n            this._lastMovement && ((a = this._lastMovement.touches) && this.settings.touchBoundingBox || !a && this.settings.hoverBoundingBox) && this.boundingBox.show(this.settings.zoomPane.el.clientWidth, this.settings.zoomPane.el.clientHeight);\n            this._handleMovement()\n        }\n    };\n    z.prototype._hide = function (a) {\n        a && this._preventDefaultAllowTouchScroll(a);\n        this._lastMovement = null;\n        this.entryTimeout && clearTimeout(this.entryTimeout);\n        this.boundingBox && this.boundingBox.hide();\n        (a = this.settings.onHide) && \"function\" === typeof a && a();\n        this.settings.zoomPane.hide()\n    };\n    z.prototype._handleMovement = function (a) {\n        if (a) this._preventDefaultAllowTouchScroll(a), this._lastMovement = a;\n        else if (this._lastMovement) a = this._lastMovement;\n        else return;\n        if (a.touches) {\n            a = a.touches[0];\n            var b = a.clientX;\n            var c = a.clientY\n        } else b = a.clientX, c = a.clientY;\n        a = this.settings.el.getBoundingClientRect();\n        b = (b - a.left) / this.settings.el.clientWidth;\n        c = (c - a.top) / this.settings.el.clientHeight;\n        this.boundingBox && this.boundingBox.setPosition(b, c, a);\n        var self = this;\n        const image = new Promise((resolve, reject) => {\n            try {\n                var imgx = new Image();\n                imgx.onload = function () {\n                    resolve(imgx);\n                }\n                imgx.onerror = function (error) {\n                    reject(error);\n                }\n                imgx.src = self.settings.el.getAttribute(self.settings.sourceAttribute);\n            } catch (error) {\n                reject(error);\n            }\n        }).then((imgx) => {\n            self.settings.zoomPane.setPosition(b, c, a)\n        }).catch(function (error) {\n            console.warn(\"Load image fail: \", error);\n        });\n    };\n    __wpcc.d.global.Object.defineProperties(z.prototype, {\n        isShowing: {\n            configurable: !0,\n            enumerable: !0,\n            get: function () {\n                return this.settings.zoomPane.isShowing\n            }\n        }\n    });\n    A.prototype._buildClasses = function (a) {\n        var b = [\"drift-\" + a],\n            c = this.settings.namespace;\n        c && b.push(c + \"-\" + a);\n        return b\n    };\n    A.prototype._buildElement = function () {\n        this.el = document.createElement(\"div\");\n        t(this.el, this._buildClasses(\"zoom-pane\"));\n        var a = document.createElement(\"div\");\n        t(a, this._buildClasses(\"zoom-pane-loader\"));\n        this.el.appendChild(a);\n        this.imgEl = document.createElement(\"img\");\n        this.el.appendChild(this.imgEl)\n    };\n    A.prototype._setImageURL = function (a) {\n        this.imgEl.setAttribute(\"src\", a)\n    };\n    A.prototype._setImageSize = function (a, b) {\n        var self = this;\n        const image = new Promise((resolve, reject) => {\n            try {\n                var imgx = new Image();\n                imgx.onload = function () {\n                    resolve(imgx);\n                }\n                imgx.onerror = function (error) {\n                    reject(error);\n                }\n                imgx.src = self.imgEl.src;\n            } catch (error) {\n                reject(error);\n            }\n        }).then((imgx) => {\n            if (self.settings.zoomFactor > 1) {\n                var level = self.settings.zoomFactor;\n                var width = level * a,\n                    height = level * b;\n                // var width = level*imgx.naturalWidth,\n                //     height = level*imgx.naturalHeight;\n            } else {\n                var level = (imgx.naturalWidth > a * 1.5) ? 1 : 2,\n                    width = level * imgx.naturalWidth,\n                    height = level * imgx.naturalHeight;\n            }\n            self.imgEl.style.width = `${width}px`;\n            self.imgEl.style.height = `${height}px`;\n            self.imgEl.style.setProperty(\"max-width\", `${width}px`, \"important\");\n            self.imgEl.style.setProperty(\"max-height\", `${height}px`, \"important\");\n        }).catch(function (error) {\n            console.warn(\"Load image fail: \", error);\n        });\n    };\n    A.prototype.setPosition = function (a, b, c) {\n        var e = this.imgEl.offsetWidth,\n            f = this.imgEl.offsetHeight,\n            q = this.el.offsetWidth,\n            k = this.el.offsetHeight,\n            v = q / 2 - e * a,\n            w = k / 2 - f * b,\n            l = q - e,\n            m = k - f,\n            n = 0 < l,\n            p = 0 < m;\n        f = n ? l / 2 : 0;\n        e = p ? m / 2 : 0;\n        l = n ? l / 2 : l;\n        m = p ? m / 2 : m;\n        this.el.parentElement === this.settings.inlineContainer && (p = window.pageXOffset, n = window.pageYOffset, a = c.left + a * c.width - q / 2 + this.settings.inlineOffsetX + p, b = c.top + b * c.height - k / 2 + this.settings.inlineOffsetY + n, this.settings.containInline && (a < c.left + p ? a = c.left + p : a + q > c.left + c.width + p &&\n            (a = c.left + c.width - q + p), b < c.top + n ? b = c.top + n : b + k > c.top + c.height + n && (b = c.top + c.height - k + n)), this.el.style.left = a + \"px\", this.el.style.top = b + \"px\");\n        this.settings.showWhitespaceAtEdges || (v > f ? v = f : v < l && (v = l), w > e ? w = e : w < m && (w = m));\n        this.imgEl.style.transform = \"translate(\" + v + \"px, \" + w + \"px)\";\n        this.imgEl.style.webkitTransform = \"translate(\" + v + \"px, \" + w + \"px)\"\n    };\n    A.prototype._removeListenersAndResetClasses = function () {\n        this.el.removeEventListener(\"animationend\", this._completeShow);\n        this.el.removeEventListener(\"animationend\", this._completeHide);\n        this.el.removeEventListener(\"webkitAnimationEnd\", this._completeShow);\n        this.el.removeEventListener(\"webkitAnimationEnd\", this._completeHide);\n        u(this.el, this.openClasses);\n        u(this.el, this.closingClasses)\n    };\n    A.prototype.show = function (a, b, c) {\n        this._removeListenersAndResetClasses();\n        this.isShowing = !0;\n        t(this.el, this.openClasses);\n        this.imgEl.getAttribute(\"src\") != a && (t(this.el, this.loadingClasses), this.imgEl.addEventListener(\"load\", this._handleLoad), this._setImageURL(a));\n        this._setImageSize(b, c);\n        this._isInline ? this._showInline() : this._showInContainer();\n        this.HAS_ANIMATION && (this.el.addEventListener(\"animationend\", this._completeShow), this.el.addEventListener(\"webkitAnimationEnd\", this._completeShow), t(this.el, this.openingClasses))\n    };\n    A.prototype._showInline = function () {\n        this.settings.inlineContainer.appendChild(this.el);\n        t(this.el, this.inlineClasses)\n    };\n    A.prototype._showInContainer = function () {\n        this.settings.container.appendChild(this.el)\n    };\n    A.prototype.hide = function () {\n        this._removeListenersAndResetClasses();\n        this.isShowing = !1;\n        this.HAS_ANIMATION ? (this.el.addEventListener(\"animationend\", this._completeHide), this.el.addEventListener(\"webkitAnimationEnd\", this._completeHide), t(this.el, this.closingClasses)) : (u(this.el, this.openClasses), u(this.el, this.inlineClasses))\n    };\n    A.prototype._completeShow = function () {\n        this.el.removeEventListener(\"animationend\", this._completeShow);\n        this.el.removeEventListener(\"webkitAnimationEnd\", this._completeShow);\n        u(this.el, this.openingClasses)\n    };\n    A.prototype._completeHide = function () {\n        this.el.removeEventListener(\"animationend\", this._completeHide);\n        this.el.removeEventListener(\"webkitAnimationEnd\", this._completeHide);\n        u(this.el, this.openClasses);\n        u(this.el, this.closingClasses);\n        u(this.el, this.inlineClasses);\n        this.el.style.left = \"\";\n        this.el.style.top = \"\";\n        this.el.parentElement === this.settings.container ? this.settings.container.removeChild(this.el) : this.el.parentElement === this.settings.inlineContainer && this.settings.inlineContainer.removeChild(this.el)\n    };\n    A.prototype._handleLoad = function () {\n        this.imgEl.removeEventListener(\"load\", this._handleLoad);\n        u(this.el, this.loadingClasses)\n    };\n    __wpcc.d.global.Object.defineProperties(A.prototype, {\n        _isInline: {\n            configurable: !0,\n            enumerable: !0,\n            get: function () {\n                var a = this.settings.inline;\n                return !0 === a || \"number\" === typeof a && window.innerWidth <= a\n            }\n        }\n    });\n    C.prototype._buildZoomPane = function () {\n        this.zoomPane = new A({\n            container: this.settings.paneContainer,\n            zoomFactor: this.settings.zoomFactor,\n            showWhitespaceAtEdges: this.settings.showWhitespaceAtEdges,\n            containInline: this.settings.containInline,\n            inline: this.settings.inlinePane,\n            namespace: this.settings.namespace,\n            inlineOffsetX: this.settings.inlineOffsetX,\n            inlineOffsetY: this.settings.inlineOffsetY,\n            inlineContainer: this.settings.inlineContainer\n        })\n    };\n    C.prototype._buildTrigger = function () {\n        this.trigger = new z({\n            el: this.triggerEl,\n            zoomPane: this.zoomPane,\n            handleTouch: this.settings.handleTouch,\n            onShow: this.settings.onShow,\n            onHide: this.settings.onHide,\n            sourceAttribute: this.settings.sourceAttribute,\n            hoverDelay: this.settings.hoverDelay,\n            touchDelay: this.settings.touchDelay,\n            hoverBoundingBox: this.settings.hoverBoundingBox,\n            touchBoundingBox: this.settings.touchBoundingBox,\n            namespace: this.settings.namespace,\n            zoomFactor: this.settings.zoomFactor,\n            boundingBoxContainer: this.settings.boundingBoxContainer,\n            passive: this.settings.passive\n        })\n    };\n    C.prototype.setZoomImageURL = function (a) {\n        this.zoomPane._setImageURL(a)\n    };\n    C.prototype.disable = function () {\n        this.trigger.enabled = !1\n    };\n    C.prototype.enable = function () {\n        this.trigger.enabled = !0\n    };\n    C.prototype.destroy = function () {\n        this.trigger._hide();\n        this.trigger._unbindEvents()\n    };\n    __wpcc.d.global.Object.defineProperties(C.prototype, {\n        isShowing: {\n            configurable: !0,\n            enumerable: !0,\n            get: function () {\n                return this.zoomPane.isShowing\n            }\n        },\n        zoomFactor: {\n            configurable: !0,\n            enumerable: !0,\n            get: function () {\n                return this.settings.zoomFactor\n            },\n            set: function (a) {\n                this.settings.zoomFactor = a;\n                this.zoomPane.settings.zoomFactor = a;\n                this.trigger.settings.zoomFactor = a;\n                this.boundingBox.settings.zoomFactor = a\n            }\n        }\n    });\n    Object.defineProperty(C.prototype, \"isShowing\", {\n        get: function () {\n            return this.isShowing\n        }\n    });\n    Object.defineProperty(C.prototype, \"zoomFactor\", {\n        get: function () {\n            return this.zoomFactor\n        },\n        set: function (a) {\n            this.zoomFactor = a\n        }\n    });\n    C.prototype.setZoomImageURL = C.prototype.setZoomImageURL;\n    C.prototype.disable = C.prototype.disable;\n    C.prototype.enable = C.prototype.enable;\n    C.prototype.destroy = C.prototype.destroy;\n    window.Drift = C;\n}).call(this || window, (window.__wpcc = window.__wpcc || {}));\n\nnew MageZoom();","Magepow_Productzoom/js/plugin/jquery.elevatezoom.js":"/*\n *\tjQuery elevateZoom 3.0.8\n *\tDemo's and documentation:\n *\twww.elevateweb.co.uk/image-zoom\n *\n *\tCopyright (c) 2012 Andrew Eades\n *\twww.elevateweb.co.uk\n *\n *\tDual licensed under the GPL and MIT licenses.\n *\thttp://en.wikipedia.org/wiki/MIT_License\n *\thttp://en.wikipedia.org/wiki/GNU_General_Public_License\n *\n\n/*\n *\tjQuery elevateZoom 3.0.3\n *\tDemo's and documentation:\n *\twww.elevateweb.co.uk/image-zoom\n *\n *\tCopyright (c) 2012 Andrew Eades\n *\twww.elevateweb.co.uk\n *\n *\tDual licensed under the GPL and MIT licenses.\n *\thttp://en.wikipedia.org/wiki/MIT_License\n *\thttp://en.wikipedia.org/wiki/GNU_General_Public_License\n */\n\n\nif ( typeof Object.create !== 'function' ) {\n\tObject.create = function( obj ) {\n\t\tfunction F() {};\n\t\tF.prototype = obj;\n\t\treturn new F();\n\t};\n}\n\n(function( $, window, document, undefined ) {\n\tvar ElevateZoom = {\n\t\t\tinit: function( options, elem ) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tself.elem = elem;\n\t\t\t\tself.$elem = $( elem );\n\n\t\t\t\tself.imageSrc = self.$elem.data(\"zoom-image\") ? self.$elem.data(\"zoom-image\") : self.$elem.attr(\"src\");\n\n\t\t\t\tself.options = $.extend( {}, $.fn.elevateZoom.options, options );\n\n\t\t\t\t//TINT OVERRIDE SETTINGS\n\t\t\t\tif(self.options.tint) {\n\t\t\t\t\tself.options.lensColour = \"none\", //colour of the lens background\n\t\t\t\t\tself.options.lensOpacity =  \"1\" //opacity of the lens\n\t\t\t\t}\n\t\t\t\t//INNER OVERRIDE SETTINGS\n\t\t\t\tif(self.options.zoomType == \"inner\") {self.options.showLens = false;}\n\n\n\t\t\t\t//Remove alt on hover\n\n\t\t\t\tself.$elem.parent().removeAttr('title').removeAttr('alt');\n\n\t\t\t\tself.zoomImage = self.imageSrc;\n\n\t\t\t\tself.refresh( 1 );\n\n\n\n\t\t\t\t//Create the image swap from the gallery \n\t\t\t\t$('#'+self.options.gallery + ' a').click( function(e) { \n\n\t\t\t\t\t//Set a class on the currently active gallery image\n\t\t\t\t\tif(self.options.galleryActiveClass){\n\t\t\t\t\t\t$('#'+self.options.gallery + ' a').removeClass(self.options.galleryActiveClass);\n\t\t\t\t\t\t$(this).addClass(self.options.galleryActiveClass);\n\t\t\t\t\t}\n\t\t\t\t\t//stop any link on the a tag from working\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t//call the swap image function            \n\t\t\t\t\tif($(this).data(\"zoom-image\")){self.zoomImagePre = $(this).data(\"zoom-image\")}\n\t\t\t\t\telse{self.zoomImagePre = $(this).data(\"image\");}\n\t\t\t\t\tself.swaptheimage($(this).data(\"image\"), self.zoomImagePre);\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\trefresh: function( length ) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.fetch(self.imageSrc);\n\n\t\t\t\t}, length || self.options.refresh );\n\t\t\t},\n\n\t\t\tfetch: function(imgsrc) {\n\t\t\t\t//get the image\n\t\t\t\tvar self = this;\n\t\t\t\tvar newImg = new Image();\n\t\t\t\tnewImg.onload = function() {\n\t\t\t\t\t//set the large image dimensions - used to calculte ratio's\n\t\t\t\t\tself.largeWidth = newImg.width;\n\t\t\t\t\tself.largeHeight = newImg.height;\n\t\t\t\t\t//once image is loaded start the calls\n\t\t\t\t\tself.startZoom();\n\t\t\t\t\tself.currentImage = self.imageSrc;\n\t\t\t\t\t//let caller know image has been loaded\n\t\t\t\t\tself.options.onZoomedImageLoaded(self.$elem);\n\t\t\t\t}\n\t\t\t\tnewImg.src = imgsrc; // this must be done AFTER setting onload\n\n\t\t\t\treturn;\n\n\t\t\t},\n\n\t\t\tstartZoom: function( ) {\n\t\t\t\tvar self = this;\n\t\t\t\t//get dimensions of the non zoomed image\n\t\t\t\tself.nzWidth = self.$elem.width();\n\t\t\t\tself.nzHeight = self.$elem.height();\n\n\t\t\t\t//activated elements\n\t\t\t\tself.isWindowActive = false;\n\t\t\t\tself.isLensActive = false;\n\t\t\t\tself.isTintActive = false;\n\t\t\t\tself.overWindow = false;    \n\n\t\t\t\t//CrossFade Wrappe\n\t\t\t\tif(self.options.imageCrossfade){\n\t\t\t\t\tself.zoomWrap = self.$elem.wrap('<div style=\"height:'+self.nzHeight+'px;width:'+self.nzWidth+'px;\" class=\"zoomWrapper\" />');        \n\t\t\t\t\tself.$elem.css('position', 'absolute'); \n\t\t\t\t}\n\n\t\t\t\tself.zoomLock = 1;\n\t\t\t\tself.scrollingLock = false;\n\t\t\t\tself.changeBgSize = false;\n\t\t\t\tself.currentZoomLevel = self.options.zoomLevel;\n\n\n\t\t\t\t//get offset of the non zoomed image\n\t\t\t\tself.nzOffset = self.$elem.offset();\n\t\t\t\t//calculate the width ratio of the large/small image\n\t\t\t\tself.widthRatio = (self.largeWidth/self.currentZoomLevel) / self.nzWidth;\n\t\t\t\tself.heightRatio = (self.largeHeight/self.currentZoomLevel) / self.nzHeight; \n\n\n\t\t\t\t//if window zoom        \n\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\tself.zoomWindowStyle = \"overflow: hidden;\"\n\t\t\t\t\t\t+ \"background-position: 0px 0px;text-align:center;\"  \n\t\t\t\t\t\t+ \"background-color: \" + String(self.options.zoomWindowBgColour)            \n\t\t\t\t\t\t+ \";width: \" + String(self.options.zoomWindowWidth) + \"px;\"\n\t\t\t\t\t\t+ \"height: \" + String(self.options.zoomWindowHeight)\n\t\t\t\t\t\t+ \"px;float: left;\"\n\t\t\t\t\t\t+ \"background-size: \"+ self.largeWidth/self.currentZoomLevel+ \"px \" +self.largeHeight/self.currentZoomLevel + \"px;\"\n\t\t\t\t\t\t+ \"display: none;z-index:100;\"\n\t\t\t\t\t\t+ \"border: \" + String(self.options.borderSize) \n\t\t\t\t\t\t+ \"px solid \" + self.options.borderColour \n\t\t\t\t\t\t+ \";background-repeat: no-repeat;\"\n\t\t\t\t\t\t+ \"position: absolute;\";\n\t\t\t\t}    \n\n\n\t\t\t\t//if inner  zoom    \n\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\t//has a border been put on the image? Lets cater for this\n\n\t\t\t\t\tvar borderWidth = self.$elem.css(\"border-left-width\");\n\n\t\t\t\t\tself.zoomWindowStyle = \"overflow: hidden;\"\n\t\t\t\t\t\t+ \"margin-left: \" + String(borderWidth) + \";\" \n\t\t\t\t\t\t+ \"margin-top: \" + String(borderWidth) + \";\"         \n\t\t\t\t\t\t+ \"background-position: 0px 0px;\"\n\t\t\t\t\t\t+ \"width: \" + String(self.nzWidth) + \"px;\"\n\t\t\t\t\t\t+ \"height: \" + String(self.nzHeight)\n\t\t\t\t\t\t+ \"px;float: left;\"\n\t\t\t\t\t\t+ \"display: none;\"\n\t\t\t\t\t\t+ \"cursor:\"+(self.options.cursor)+\";\"\n\t\t\t\t\t\t+ \"px solid \" + self.options.borderColour \n\t\t\t\t\t\t+ \";background-repeat: no-repeat;\"\n\t\t\t\t\t\t+ \"position: absolute;\";\n\t\t\t\t}    \n\n\n\n\t\t\t\t//lens style for window zoom\n\t\t\t\tif(self.options.zoomType == \"window\") {\n\n\n\t\t\t\t\t// adjust images less than the window height\n\n\t\t\t\t\tif(self.nzHeight < self.options.zoomWindowWidth/self.widthRatio){\n\t\t\t\t\t\tlensHeight = self.nzHeight;              \n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlensHeight = String((self.options.zoomWindowHeight/self.heightRatio))\n\t\t\t\t\t}\n\t\t\t\t\tif(self.largeWidth < self.options.zoomWindowWidth){\n\t\t\t\t\t\tlensWidth = self.nzWidth;\n\t\t\t\t\t}       \n\t\t\t\t\telse{\n\t\t\t\t\t\tlensWidth =  (self.options.zoomWindowWidth/self.widthRatio);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tself.lensStyle = \"background-position: 0px 0px;width: \" + String((self.options.zoomWindowWidth)/self.widthRatio) + \"px;height: \" + String((self.options.zoomWindowHeight)/self.heightRatio)\n\t\t\t\t\t+ \"px;float: right;display: none;\"\n\t\t\t\t\t+ \"overflow: hidden;\"\n\t\t\t\t\t+ \"z-index: 999;\"   \n\t\t\t\t\t+ \"-webkit-transform: translateZ(0);\"               \n\t\t\t\t\t+ \"opacity:\"+(self.options.lensOpacity)+\";filter: alpha(opacity = \"+(self.options.lensOpacity*100)+\"); zoom:1;\"\n\t\t\t\t\t+ \"width:\"+lensWidth+\"px;\"\n\t\t\t\t\t+ \"height:\"+lensHeight+\"px;\"\n\t\t\t\t\t+ \"background-color:\"+(self.options.lensColour)+\";\"\t\t\t\t\t\n\t\t\t\t\t+ \"cursor:\"+(self.options.cursor)+\";\"\n\t\t\t\t\t+ \"border: \"+(self.options.lensBorderSize)+\"px\" +\n\t\t\t\t\t\" solid \"+(self.options.lensBorderColour)+\";background-repeat: no-repeat;position: absolute;\";\n\t\t\t\t} \n\n\n\t\t\t\t//tint style\n\t\t\t\tself.tintStyle = \"display: block;\"\n\t\t\t\t\t+ \"position: absolute;\"\n\t\t\t\t\t+ \"background-color: \"+self.options.tintColour+\";\"\t\n\t\t\t\t\t+ \"filter:alpha(opacity=0);\"\t\t\n\t\t\t\t\t+ \"opacity: 0;\"\t\n\t\t\t\t\t+ \"width: \" + self.nzWidth + \"px;\"\n\t\t\t\t\t+ \"height: \" + self.nzHeight + \"px;\"\n\n\t\t\t\t\t;\n\n\t\t\t\t//lens style for lens zoom with optional round for modern browsers\n\t\t\t\tself.lensRound = '';\n\n\t\t\t\tif(self.options.zoomType == \"lens\") {\n\n\t\t\t\t\tself.lensStyle = \"background-position: 0px 0px;\"\n\t\t\t\t\t\t+ \"float: left;display: none;\"\n\t\t\t\t\t\t+ \"border: \" + String(self.options.borderSize) + \"px solid \" + self.options.borderColour+\";\"\n\t\t\t\t\t\t+ \"width:\"+ String(self.options.lensSize) +\"px;\"\n\t\t\t\t\t\t+ \"height:\"+ String(self.options.lensSize)+\"px;\"\n\t\t\t\t\t\t+ \"background-repeat: no-repeat;position: absolute;\";\n\n\n\t\t\t\t}\n\n\n\t\t\t\t//does not round in all browsers\n\t\t\t\tif(self.options.lensShape == \"round\") {\n\t\t\t\t\tself.lensRound = \"border-top-left-radius: \" + String(self.options.lensSize / 2 + self.options.borderSize) + \"px;\"\n\t\t\t\t\t+ \"border-top-right-radius: \" + String(self.options.lensSize / 2 + self.options.borderSize) + \"px;\"\n\t\t\t\t\t+ \"border-bottom-left-radius: \" + String(self.options.lensSize / 2 + self.options.borderSize) + \"px;\"\n\t\t\t\t\t+ \"border-bottom-right-radius: \" + String(self.options.lensSize / 2 + self.options.borderSize) + \"px;\";\n\n\t\t\t\t}\n\n\t\t\t\t//create the div's                                                + \"\"\n\t\t\t\t//self.zoomContainer = $('<div/>').addClass('zoomContainer').css({\"position\":\"relative\", \"height\":self.nzHeight, \"width\":self.nzWidth});\n\n\t\t\t\tself.zoomContainer = $('<div class=\"zoomContainer\" style=\"-webkit-transform: translateZ(0);position:absolute;left:'+self.nzOffset.left+'px;top:'+self.nzOffset.top+'px;height:'+self.nzHeight+'px;width:'+self.nzWidth+'px;\"></div>');\n\t\t\t\t$('body').append(self.zoomContainer);\t\n\n\n\t\t\t\t//this will add overflow hidden and contrain the lens on lens mode       \n\t\t\t\tif(self.options.containLensZoom && self.options.zoomType == \"lens\"){\n\t\t\t\t\tself.zoomContainer.css(\"overflow\", \"hidden\");\n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType != \"inner\") {\n\t\t\t\t\tself.zoomLens = $(\"<div class='zoomLens' style='\" + self.lensStyle + self.lensRound +\"'>&nbsp;</div>\")\n\t\t\t\t\t.appendTo(self.zoomContainer)\n\t\t\t\t\t.click(function () {\n\t\t\t\t\t\tself.$elem.trigger('click');\n\t\t\t\t\t});\n\n\n\t\t\t\t\tif(self.options.tint) {\n\t\t\t\t\t\tself.tintContainer = $('<div/>').addClass('tintContainer');\t\n\t\t\t\t\t\tself.zoomTint = $(\"<div class='zoomTint' style='\"+self.tintStyle+\"'></div>\");\n\n\n\t\t\t\t\t\tself.zoomLens.wrap(self.tintContainer);\n\n\n\t\t\t\t\t\tself.zoomTintcss = self.zoomLens.after(self.zoomTint);\t\n\n\t\t\t\t\t\t//if tint enabled - set an image to show over the tint\n\n\t\t\t\t\t\tself.zoomTintImage = $('<img style=\"position: absolute; left: 0px; top: 0px; max-width: none; width: '+self.nzWidth+'px; height: '+self.nzHeight+'px;\" src=\"'+self.imageSrc+'\">')\n\t\t\t\t\t\t.appendTo(self.zoomLens)\n\t\t\t\t\t\t.click(function () {\n\n\t\t\t\t\t\t\tself.$elem.trigger('click');\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}          \n\n\t\t\t\t}\n\n\n\n\n\n\n\n\t\t\t\t//create zoom window \n\t\t\t\tif(isNaN(self.options.zoomWindowPosition)){\n\t\t\t\t\tself.zoomWindow = $(\"<div style='z-index:999;left:\"+(self.windowOffsetLeft)+\"px;top:\"+(self.windowOffsetTop)+\"px;\" + self.zoomWindowStyle + \"' class='zoomWindow'>&nbsp;</div>\")\n\t\t\t\t\t.appendTo('body')\n\t\t\t\t\t.click(function () {\n\t\t\t\t\t\tself.$elem.trigger('click');\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tself.zoomWindow = $(\"<div style='z-index:999;left:\"+(self.windowOffsetLeft)+\"px;top:\"+(self.windowOffsetTop)+\"px;\" + self.zoomWindowStyle + \"' class='zoomWindow'>&nbsp;</div>\")\n\t\t\t\t\t.appendTo(self.zoomContainer)\n\t\t\t\t\t.click(function () {\n\t\t\t\t\t\tself.$elem.trigger('click');\n\t\t\t\t\t});\n\t\t\t\t}              \n\t\t\t\tself.zoomWindowContainer = $('<div/>').addClass('zoomWindowContainer').css(\"width\",self.options.zoomWindowWidth);\n\t\t\t\tself.zoomWindow.wrap(self.zoomWindowContainer);\n\n\n\t\t\t\t//  self.captionStyle = \"text-align: left;background-color: black;color: white;font-weight: bold;padding: 10px;font-family: sans-serif;font-size: 11px\";                                                                                                                                                                                                                                          \n\t\t\t\t// self.zoomCaption = $('<div class=\"elevatezoom-caption\" style=\"'+self.captionStyle+'display: block; width: 280px;\">INSERT ALT TAG</div>').appendTo(self.zoomWindow.parent());\n\n\t\t\t\tif(self.options.zoomType == \"lens\") {\n\t\t\t\t\tself.zoomLens.css({ backgroundImage: \"url('\" + self.imageSrc + \"')\" }); \n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\tself.zoomWindow.css({ backgroundImage: \"url('\" + self.imageSrc + \"')\" }); \n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\tself.zoomWindow.css({ backgroundImage: \"url('\" + self.imageSrc + \"')\" }); \n\t\t\t\t}\n\t\t\t\t/*-------------------END THE ZOOM WINDOW AND LENS----------------------------------*/\n\t\t\t\t//touch events\n\t\t\t\tself.$elem.bind('touchmove', function(e){    \n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];  \n\t\t\t\t\tself.setPosition(touch);\n\n\t\t\t\t});  \n\t\t\t\tself.zoomContainer.bind('touchmove', function(e){ \n\t\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\t\tself.showHideWindow(\"show\");\n\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];  \n\t\t\t\t\tself.setPosition(touch); \n\n\t\t\t\t});  \t\n\t\t\t\tself.zoomContainer.bind('touchend', function(e){ \n\t\t\t\t\tself.showHideWindow(\"hide\");\n\t\t\t\t\tif(self.options.showLens) {self.showHideLens(\"hide\");}\n\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {self.showHideTint(\"hide\");}\n\t\t\t\t});  \t\n\n\t\t\t\tself.$elem.bind('touchend', function(e){ \n\t\t\t\t\tself.showHideWindow(\"hide\");\n\t\t\t\t\tif(self.options.showLens) {self.showHideLens(\"hide\");}\n\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {self.showHideTint(\"hide\");}\n\t\t\t\t});  \t\n\t\t\t\tif(self.options.showLens) {\n\t\t\t\t\tself.zoomLens.bind('touchmove', function(e){ \n\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tvar touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];  \n\t\t\t\t\t\tself.setPosition(touch); \n\t\t\t\t\t});    \n\n\n\t\t\t\t\tself.zoomLens.bind('touchend', function(e){ \n\t\t\t\t\t\tself.showHideWindow(\"hide\");\n\t\t\t\t\t\tif(self.options.showLens) {self.showHideLens(\"hide\");}\n\t\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {self.showHideTint(\"hide\");}\n\t\t\t\t\t});  \n\t\t\t\t}\n\t\t\t\t//Needed to work in IE\n\t\t\t\tself.$elem.bind('mousemove', function(e){   \n\t\t\t\t\tif(self.overWindow == false){self.setElements(\"show\");}\n\t\t\t\t\t//make sure on orientation change the setposition is not fired\n\t\t\t\t\tif(self.lastX !== e.clientX || self.lastY !== e.clientY){\n\t\t\t\t\t\tself.setPosition(e);\n\t\t\t\t\t\tself.currentLoc = e;\n\t\t\t\t\t}   \n\t\t\t\t\tself.lastX = e.clientX;\n\t\t\t\t\tself.lastY = e.clientY;    \n\n\t\t\t\t});  \t\n\n\t\t\t\tself.zoomContainer.bind('mousemove', function(e){ \n\n\t\t\t\t\tif(self.overWindow == false){self.setElements(\"show\");} \n\n\t\t\t\t\t//make sure on orientation change the setposition is not fired \n\t\t\t\t\tif(self.lastX !== e.clientX || self.lastY !== e.clientY){\n\t\t\t\t\t\tself.setPosition(e);\n\t\t\t\t\t\tself.currentLoc = e;\n\t\t\t\t\t}   \n\t\t\t\t\tself.lastX = e.clientX;\n\t\t\t\t\tself.lastY = e.clientY;    \n\t\t\t\t});  \t\n\t\t\t\tif(self.options.zoomType != \"inner\") {\n\t\t\t\t\tself.zoomLens.bind('mousemove', function(e){      \n\t\t\t\t\t\t//make sure on orientation change the setposition is not fired\n\t\t\t\t\t\tif(self.lastX !== e.clientX || self.lastY !== e.clientY){\n\t\t\t\t\t\t\tself.setPosition(e);\n\t\t\t\t\t\t\tself.currentLoc = e;\n\t\t\t\t\t\t}   \n\t\t\t\t\t\tself.lastX = e.clientX;\n\t\t\t\t\t\tself.lastY = e.clientY;    \n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {\n\t\t\t\t\tself.zoomTint.bind('mousemove', function(e){ \n\t\t\t\t\t\t//make sure on orientation change the setposition is not fired\n\t\t\t\t\t\tif(self.lastX !== e.clientX || self.lastY !== e.clientY){\n\t\t\t\t\t\t\tself.setPosition(e);\n\t\t\t\t\t\t\tself.currentLoc = e;\n\t\t\t\t\t\t}   \n\t\t\t\t\t\tself.lastX = e.clientX;\n\t\t\t\t\t\tself.lastY = e.clientY;    \n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\tself.zoomWindow.bind('mousemove', function(e) {\n\t\t\t\t\t\t//self.overWindow = true;\n\t\t\t\t\t\t//make sure on orientation change the setposition is not fired\n\t\t\t\t\t\tif(self.lastX !== e.clientX || self.lastY !== e.clientY){\n\t\t\t\t\t\t\tself.setPosition(e);\n\t\t\t\t\t\t\tself.currentLoc = e;\n\t\t\t\t\t\t}   \n\t\t\t\t\t\tself.lastX = e.clientX;\n\t\t\t\t\t\tself.lastY = e.clientY;    \n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\n\t\t\t\t//  lensFadeOut: 500,  zoomTintFadeIn\n\t\t\t\tself.zoomContainer.add(self.$elem).mouseenter(function(){\n\n\t\t\t\t\tif(self.overWindow == false){self.setElements(\"show\");} \n\n\n\t\t\t\t}).mouseleave(function(){\n\t\t\t\t\tif(!self.scrollLock){\n\t\t\t\t\t\tself.setElements(\"hide\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//end ove image\n\n\n\n\n\n\t\t\t\tif(self.options.zoomType != \"inner\") {\n\t\t\t\t\tself.zoomWindow.mouseenter(function(){\n\t\t\t\t\t\tself.overWindow = true;   \n\t\t\t\t\t\tself.setElements(\"hide\");                  \n\t\t\t\t\t}).mouseleave(function(){\n\n\t\t\t\t\t\tself.overWindow = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//end ove image\n\n\n\n//\t\t\t\tvar delta = parseInt(e.originalEvent.wheelDelta || -e.originalEvent.detail);\n\n\t\t\t\t//      $(this).empty();    \n\t\t\t\t//    return false;\n\n\t\t\t\t//fix for initial zoom setting\n\t\t\t\tif (self.options.zoomLevel != 1){\n\t\t\t\t\t//\tself.changeZoomLevel(self.currentZoomLevel);\n\t\t\t\t}\n\t\t\t\t//set the min zoomlevel\n\t\t\t\tif(self.options.minZoomLevel){\n\t\t\t\t\tself.minZoomLevel = self.options.minZoomLevel;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tself.minZoomLevel = self.options.scrollZoomIncrement * 2;\n\t\t\t\t}\n\n\n\t\t\t\tif(self.options.scrollZoom){\n\n\n\t\t\t\t\tself.zoomContainer.add(self.$elem).bind('mousewheel DOMMouseScroll MozMousePixelScroll', function(e){\n\n\n//\t\t\t\t\t\tin IE there is issue with firing of mouseleave - So check whether still scrolling\n//\t\t\t\t\t\tand on mouseleave check if scrolllock          \n\t\t\t\t\t\tself.scrollLock = true;\n\t\t\t\t\t\tclearTimeout($.data(this, 'timer'));\n\t\t\t\t\t\t$.data(this, 'timer', setTimeout(function() {\n\t\t\t\t\t\t\tself.scrollLock = false;\n\t\t\t\t\t\t\t//do something\n\t\t\t\t\t\t}, 250));\n\n\t\t\t\t\t\tvar theEvent = e.originalEvent.wheelDelta || e.originalEvent.detail*-1\n\n\n\t\t\t\t\t\t//this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;\n\t\t\t\t\t\t//   e.preventDefault();\n\n\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\n\t\t\t\t\t\tif(theEvent /120 > 0) {\n\t\t\t\t\t\t\t//scrolling up\n\t\t\t\t\t\t\tif(self.currentZoomLevel >= self.minZoomLevel){ \n\t\t\t\t\t\t\t\tself.changeZoomLevel(self.currentZoomLevel-self.options.scrollZoomIncrement);        \n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t//scrolling down\n\n\n\t\t\t\t\t\t\tif(self.options.maxZoomLevel){\n\t\t\t\t\t\t\t\tif(self.currentZoomLevel <= self.options.maxZoomLevel){           \n\t\t\t\t\t\t\t\t\tself.changeZoomLevel(parseFloat(self.currentZoomLevel)+self.options.scrollZoomIncrement);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t//andy \n\n\t\t\t\t\t\t\t\tself.changeZoomLevel(parseFloat(self.currentZoomLevel)+self.options.scrollZoomIncrement);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t},\n\t\t\tsetElements: function(type) {\n\t\t\t\tvar self = this;\n        if(!self.options.zoomEnabled){return false;}\n\t\t\t\tif(type==\"show\"){\n\t\t\t\t\tif(self.isWindowSet){\n\t\t\t\t\t\tif(self.options.zoomType == \"inner\") {self.showHideWindow(\"show\");}\n\t\t\t\t\t\tif(self.options.zoomType == \"window\") {self.showHideWindow(\"show\");}\n\t\t\t\t\t\tif(self.options.showLens) {self.showHideLens(\"show\");}\n\t\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {self.showHideTint(\"show\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(type==\"hide\"){\n\t\t\t\t\tif(self.options.zoomType == \"window\") {self.showHideWindow(\"hide\");}\n\t\t\t\t\tif(!self.options.tint) {self.showHideWindow(\"hide\");}\n\t\t\t\t\tif(self.options.showLens) {self.showHideLens(\"hide\");}\n\t\t\t\t\tif(self.options.tint) {\tself.showHideTint(\"hide\");}\n\t\t\t\t}   \n\t\t\t},\n\t\t\tsetPosition: function(e) {\n      \n\t\t\t\tif (typeof e == 'undefined') return;\n\t\t\t\tvar self = this;\n        \n        \t\tif(!self.options.zoomEnabled){return false;}\n\n\t\t\t\t//recaclc offset each time in case the image moves\n\t\t\t\t//this can be caused by other on page elements\n\t\t\t\tself.nzHeight = self.$elem.height();\n\t\t\t\tself.nzWidth = self.$elem.width();\n\t\t\t\tself.nzOffset = self.$elem.offset();\n\n\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {\n\t\t\t\t\tself.zoomTint.css({ top: 0});\n\t\t\t\t\tself.zoomTint.css({ left: 0});\n\t\t\t\t}\n\t\t\t\t//set responsive       \n\t\t\t\t//will checking if the image needs changing before running this code work faster?\n\t\t\t\tif(self.options.responsive && !self.options.scrollZoom){\n\t\t\t\t\tif(self.options.showLens){ \n\t\t\t\t\t\tif(self.nzHeight < self.options.zoomWindowWidth/self.widthRatio){\n\t\t\t\t\t\t\tlensHeight = self.nzHeight;              \n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tlensHeight = String((self.options.zoomWindowHeight/self.heightRatio))\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(self.largeWidth < self.options.zoomWindowWidth){\n\t\t\t\t\t\t\tlensWidth = self.nzWidth;\n\t\t\t\t\t\t}       \n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tlensWidth =  (self.options.zoomWindowWidth/self.widthRatio);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.widthRatio = self.largeWidth / self.nzWidth;\n\t\t\t\t\t\tself.heightRatio = self.largeHeight / self.nzHeight;        \n\t\t\t\t\t\tif(self.options.zoomType != \"lens\") {\n\n\n\t\t\t\t\t\t\t//possibly dont need to keep recalcalculating\n\t\t\t\t\t\t\t//if the lens is heigher than the image, then set lens size to image size\n\t\t\t\t\t\t\tif(self.nzHeight < self.options.zoomWindowWidth/self.widthRatio){\n\t\t\t\t\t\t\t\tlensHeight = self.nzHeight;  \n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tlensHeight = String((self.options.zoomWindowHeight/self.heightRatio))\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(self.options.zoomWindowWidth < self.options.zoomWindowWidth){\n\t\t\t\t\t\t\t\tlensWidth = self.nzWidth;\n\t\t\t\t\t\t\t}       \n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tlensWidth =  (self.options.zoomWindowWidth/self.widthRatio);\n\t\t\t\t\t\t\t}            \n\n\t\t\t\t\t\t\tself.zoomLens.css('width', lensWidth);    \n\t\t\t\t\t\t\tself.zoomLens.css('height', lensHeight); \n\n\t\t\t\t\t\t\tif(self.options.tint){    \n\t\t\t\t\t\t\t\tself.zoomTintImage.css('width', self.nzWidth);    \n\t\t\t\t\t\t\t\tself.zoomTintImage.css('height', self.nzHeight); \n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}                     \n\t\t\t\t\t\tif(self.options.zoomType == \"lens\") {  \n\n\t\t\t\t\t\t\tself.zoomLens.css({ width: String(self.options.lensSize) + 'px', height: String(self.options.lensSize) + 'px' })      \n\n\n\t\t\t\t\t\t}        \n\t\t\t\t\t\t//end responsive image change\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//container fix\n\t\t\t\tself.zoomContainer.css({ top: self.nzOffset.top});\n\t\t\t\tself.zoomContainer.css({ left: self.nzOffset.left});\n\t\t\t\tself.mouseLeft = parseInt(e.pageX - self.nzOffset.left);\n\t\t\t\tself.mouseTop = parseInt(e.pageY - self.nzOffset.top);\n\t\t\t\t//calculate the Location of the Lens\n\n\t\t\t\t//calculate the bound regions - but only if zoom window\n\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\tself.Etoppos = (self.mouseTop < (self.zoomLens.height()/2));\n\t\t\t\t\tself.Eboppos = (self.mouseTop > self.nzHeight - (self.zoomLens.height()/2)-(self.options.lensBorderSize*2));\n\t\t\t\t\tself.Eloppos = (self.mouseLeft < 0+((self.zoomLens.width()/2))); \n\t\t\t\t\tself.Eroppos = (self.mouseLeft > (self.nzWidth - (self.zoomLens.width()/2)-(self.options.lensBorderSize*2)));  \n\t\t\t\t}\n\t\t\t\t//calculate the bound regions - but only for inner zoom\n\t\t\t\tif(self.options.zoomType == \"inner\"){ \n\t\t\t\t\tself.Etoppos = (self.mouseTop < ((self.nzHeight/2)/self.heightRatio) );\n\t\t\t\t\tself.Eboppos = (self.mouseTop > (self.nzHeight - ((self.nzHeight/2)/self.heightRatio)));\n\t\t\t\t\tself.Eloppos = (self.mouseLeft < 0+(((self.nzWidth/2)/self.widthRatio)));\n\t\t\t\t\tself.Eroppos = (self.mouseLeft > (self.nzWidth - (self.nzWidth/2)/self.widthRatio-(self.options.lensBorderSize*2)));  \n\t\t\t\t}\n\n\t\t\t\t// if the mouse position of the slider is one of the outerbounds, then hide  window and lens\n\t\t\t\tif (self.mouseLeft <= 0 || self.mouseTop < 0 || self.mouseLeft > self.nzWidth || self.mouseTop > self.nzHeight ) {\t\t\t\t          \n\t\t\t\t\tself.setElements(\"hide\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//else continue with operations\n\t\t\t\telse {\n\n\n\t\t\t\t\t//lens options\n\t\t\t\t\tif(self.options.showLens) {\n\t\t\t\t\t\t//\t\tself.showHideLens(\"show\");\n\t\t\t\t\t\t//set background position of lens\n\t\t\t\t\t\tself.lensLeftPos = String(self.mouseLeft - self.zoomLens.width() / 2);\n\t\t\t\t\t\tself.lensTopPos = String(self.mouseTop - self.zoomLens.height() / 2);\n\n\n\t\t\t\t\t}\n\t\t\t\t\t//adjust the background position if the mouse is in one of the outer regions \n\n\t\t\t\t\t//Top region\n\t\t\t\t\tif(self.Etoppos){\n\t\t\t\t\t\tself.lensTopPos = 0;\n\t\t\t\t\t}\n\t\t\t\t\t//Left Region\n\t\t\t\t\tif(self.Eloppos){\n\t\t\t\t\t\tself.windowLeftPos = 0;\n\t\t\t\t\t\tself.lensLeftPos = 0;\n\t\t\t\t\t\tself.tintpos=0;\n\t\t\t\t\t}     \n\t\t\t\t\t//Set bottom and right region for window mode\n\t\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\t\tif(self.Eboppos){\n\t\t\t\t\t\t\tself.lensTopPos = Math.max( (self.nzHeight)-self.zoomLens.height()-(self.options.lensBorderSize*2), 0 );\n\t\t\t\t\t\t} \n\t\t\t\t\t\tif(self.Eroppos){\n\t\t\t\t\t\t\tself.lensLeftPos = (self.nzWidth-(self.zoomLens.width())-(self.options.lensBorderSize*2));\n\t\t\t\t\t\t}  \n\t\t\t\t\t}  \n\t\t\t\t\t//Set bottom and right region for inner mode\n\t\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\t\tif(self.Eboppos){\n\t\t\t\t\t\t\tself.lensTopPos = Math.max( ((self.nzHeight)-(self.options.lensBorderSize*2)), 0 );\n\t\t\t\t\t\t} \n\t\t\t\t\t\tif(self.Eroppos){\n\t\t\t\t\t\t\tself.lensLeftPos = (self.nzWidth-(self.nzWidth)-(self.options.lensBorderSize*2));\n\t\t\t\t\t\t}  \n\n\t\t\t\t\t}\n\t\t\t\t\t//if lens zoom\n\t\t\t\t\tif(self.options.zoomType == \"lens\") {  \n\t\t\t\t\t\tself.windowLeftPos = String(((e.pageX - self.nzOffset.left) * self.widthRatio - self.zoomLens.width() / 2) * (-1));   \n\t\t\t\t\t\tself.windowTopPos = String(((e.pageY - self.nzOffset.top) * self.heightRatio - self.zoomLens.height() / 2) * (-1));\n\n\t\t\t\t\t\tself.zoomLens.css({ backgroundPosition: self.windowLeftPos + 'px ' + self.windowTopPos + 'px' });\n\n\t\t\t\t\t\tif(self.changeBgSize){  \n\n\t\t\t\t\t\t\tif(self.nzHeight>self.nzWidth){  \n\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){       \n\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t}   \n\n\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{     \n\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){       \n\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });\n\t\t\t\t\t\t\t\t}   \n\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });            \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.changeBgSize = false;\n\t\t\t\t\t\t}    \n\n\t\t\t\t\t\tself.setWindowPostition(e);  \n\t\t\t\t\t}\n\t\t\t\t\t//if tint zoom   \n\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {\n\t\t\t\t\t\tself.setTintPosition(e);\n\n\t\t\t\t\t}\n\t\t\t\t\t//set the css background position \n\t\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\t\tself.setWindowPostition(e);   \n\t\t\t\t\t}\n\t\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\t\tself.setWindowPostition(e);   \n\t\t\t\t\t}\n\t\t\t\t\tif(self.options.showLens) {\n\n\t\t\t\t\t\tif(self.fullwidth && self.options.zoomType != \"lens\"){\n\t\t\t\t\t\t\tself.lensLeftPos = 0;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.zoomLens.css({ left: self.lensLeftPos + 'px', top: self.lensTopPos + 'px' })  \n\t\t\t\t\t}\n\n\t\t\t\t} //end else\n\n\n\n\t\t\t},\n\t\t\tshowHideWindow: function(change) {\n\t\t\t\tvar self = this;              \n\t\t\t\tif(change == \"show\"){     \n\t\t\t\t\tif(!self.isWindowActive){\n\t\t\t\t\t\tif(self.options.zoomWindowFadeIn){\n\t\t\t\t\t\t\tself.zoomWindow.stop(true, true, false).fadeIn(self.options.zoomWindowFadeIn);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tself.zoomWindow.closest('.zoomContainer').first().siblings('.zoomContainer').remove();\n\t\t\t\t\t\t\tself.zoomWindow.show();\n\t\t\t\t\t\t\tif(self.options.zoomWindowEffect){\n\t\t\t\t\t            /* default effect flyOutImageToWindow */\n\t\t\t\t\t            var effect = [\n\t\t\t\t\t                { transform: $('body, html').hasClass('rtl') ? 'translate3d(100%, 0, 0) scale(0)' : 'translate3d(-100%, 0, 0) scale(0)' },\n\t\t\t\t\t                { transform: 'translate3d(0, 0, 0) scale(1)' },\n\t\t\t\t\t                { transition: 'all 0.8s linear both' }\n\t\t\t\t\t            ],\n\t\t\t\t\t            timing = { duration: parseInt(self.options.zoomWindowEffectDuration), iterations: 0.5 };\n\t\t\t\t\t            switch (self.options.zoomWindowEffect) {\n\t\t\t\t\t                case 'flyOutWindow':\n\t\t\t\t\t                    effect = [\n\t\t\t\t\t                      { transform: 'translate3d(0%, 0, 0) scale(0)' },\n\t\t\t\t\t                      { transform: 'translate3d(0, 0, 0) scale(1)' },\n\t\t\t\t\t                      { transition: 'all .8s linear both' }\n\t\t\t\t\t                    ];\n\t\t\t\t\t                    break;\n\t\t\t\t\t                case 'flySpinningWindow':\n\t\t\t\t\t                    effect = [\n\t\t\t\t\t                      { transform: 'scale(0) rotateZ(0)' },\n\t\t\t\t\t                      { transform: 'scale(1) rotateZ(-360deg)' },\n\t\t\t\t\t                      { transition: 'all 0.5s linear both' }\n\t\t\t\t\t                    ];\n\t\t\t\t\t                    break;\n\t\t\t\t\t                case 'flySpinningImageToWindow':\n\t\t\t\t\t                    effect = [\n\t\t\t\t\t                      { transform: $('body, html').hasClass('rtl') ? 'translate3d(100%, 0, 0) scale(0) rotateZ(0)' : 'translate3d(-100%, 0, 0) scale(0) rotateZ(0)' },\n\t\t\t\t\t                      { transform: 'translate3d(0, 0, 0) scale(1) rotateZ(360deg)' },\n\t\t\t\t\t                      { transition: 'all 0.5s linear both' }\n\t\t\t\t\t                    ];\n\t\t\t\t\t                    break;\n\t\t\t\t\t                default:\n\t\t\t\t\t            }\n                                var zoomWindow = document.querySelector(\".zoomWindow\");\n                                if(zoomWindow){\n                                    if(window.AloZoom){\n                                        window.AloZoom.cancel();\n                                    }\n                                    window.AloZoom = zoomWindow.animate(effect, timing);\n                                }\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.isWindowActive = true;\n\t\t\t\t\t}            \n\t\t\t\t}\n\t\t\t\tif(change == \"hide\"){\n\t\t\t\t\tif(self.isWindowActive){\n\t\t\t\t\t\tif(self.options.zoomWindowFadeOut){\n\t\t\t\t\t\t\tself.zoomWindow.stop(true, true).fadeOut(self.options.zoomWindowFadeOut);\n\t\t\t\t\t\t}else{\n                            if(window.AloZoom){\n                              \twindow.AloZoom.cancel();\n                              \twindow.AloZoom.reverse();\n                              \twindow.AloZoom.onfinish = (e) => {\n                                  \tself.zoomWindow.hide();\n                              \t};\n                            }else {\n                               \tself.zoomWindow.hide();\n                            }\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.isWindowActive = false;        \n\t\t\t\t\t}      \n\t\t\t\t}\n\t\t\t},\n\t\t\tshowHideLens: function(change) {\n\t\t\t\tvar self = this;              \n\t\t\t\tif(change == \"show\"){      \n\t\t\t\t\tif(!self.isLensActive){\n\t\t\t\t\t\tif(self.options.lensFadeIn){\n\t\t\t\t\t\t\tself.zoomLens.stop(true, true, false).fadeIn(self.options.lensFadeIn);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{self.zoomLens.show();}\n\t\t\t\t\t\tself.isLensActive = true;\n\t\t\t\t\t}            \n\t\t\t\t}\n\t\t\t\tif(change == \"hide\"){\n\t\t\t\t\tif(self.isLensActive){\n\t\t\t\t\t\tif(self.options.lensFadeOut){\n\t\t\t\t\t\t\tself.zoomLens.stop(true, true).fadeOut(self.options.lensFadeOut);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{self.zoomLens.hide();}\n\t\t\t\t\t\tself.isLensActive = false;        \n\t\t\t\t\t}      \n\t\t\t\t}\n\t\t\t},\n\t\t\tshowHideTint: function(change) {\n\t\t\t\tvar self = this;              \n\t\t\t\tif(change == \"show\"){      \n\t\t\t\t\tif(!self.isTintActive){\n\n\t\t\t\t\t\tif(self.options.zoomTintFadeIn){\n\t\t\t\t\t\t\tself.zoomTint.css({opacity:self.options.tintOpacity}).animate().stop(true, true).fadeIn(\"slow\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tself.zoomTint.css({opacity:self.options.tintOpacity}).animate();\n\t\t\t\t\t\t\tself.zoomTint.show();\n\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.isTintActive = true;\n\t\t\t\t\t}            \n\t\t\t\t}\n\t\t\t\tif(change == \"hide\"){      \n\t\t\t\t\tif(self.isTintActive){ \n\n\t\t\t\t\t\tif(self.options.zoomTintFadeOut){\n\t\t\t\t\t\t\tself.zoomTint.stop(true, true).fadeOut(self.options.zoomTintFadeOut);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{self.zoomTint.hide();}\n\t\t\t\t\t\tself.isTintActive = false;        \n\t\t\t\t\t}      \n\t\t\t\t}\n\t\t\t},\n\t\t\tsetLensPostition: function( e ) {\n\n\n\t\t\t},\n\t\t\tsetWindowPostition: function( e ) {\n\t\t\t\t//return obj.slice( 0, count );\n\t\t\t\tvar self = this;\n\n\t\t\t\tif(!isNaN(self.options.zoomWindowPosition)){\n\n\t\t\t\t\tswitch (self.options.zoomWindowPosition) { \n\t\t\t\t\tcase 1: //done         \n\t\t\t\t\t\tself.windowOffsetTop = (self.options.zoomWindowOffety);//DONE - 1\n\t\t\t\t\t\tif(!$('body').hasClass('rtl')){\n\t\t\t\t\t\t\tself.windowOffsetLeft =(+self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.windowOffsetLeft =(-self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tif(self.options.zoomWindowHeight > self.nzHeight){ //positive margin\n\n\t\t\t\t\t\t\tself.windowOffsetTop = ((self.options.zoomWindowHeight/2)-(self.nzHeight/2))*(-1);\n\t\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{ //negative margin\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3: //done        \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight - self.zoomWindow.height() - (self.options.borderSize*2)); //DONE 3,9\n\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\tbreak;      \n\t\t\t\t\tcase 4: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight); //DONE - 4,5,6,7,8\n\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 5: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight); //DONE - 4,5,6,7,8\n\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth-self.zoomWindow.width()-(self.options.borderSize*2)); //DONE - 5,15\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 6: \n\t\t\t\t\t\tif(self.options.zoomWindowHeight > self.nzHeight){ //positive margin\n\t\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight);  //DONE - 4,5,6,7,8\n\n\t\t\t\t\t\t\tself.windowOffsetLeft =((self.options.zoomWindowWidth/2)-(self.nzWidth/2)+(self.options.borderSize*2))*(-1);  \n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{ //negative margin\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 7: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight);  //DONE - 4,5,6,7,8\n\t\t\t\t\t\tself.windowOffsetLeft = 0; //DONE 7, 13\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight); //DONE - 4,5,6,7,8\n\t\t\t\t\t\tself.windowOffsetLeft =(self.zoomWindow.width()+(self.options.borderSize*2) )* (-1);  //DONE 8,9,10,11,12\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 9:  //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.nzHeight - self.zoomWindow.height() - (self.options.borderSize*2)); //DONE 3,9\n\t\t\t\t\t\tself.windowOffsetLeft =(self.zoomWindow.width()+(self.options.borderSize*2) )* (-1);  //DONE 8,9,10,11,12\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 10: \n\t\t\t\t\t\tif(self.options.zoomWindowHeight > self.nzHeight){ //positive margin\n\n\t\t\t\t\t\t\tself.windowOffsetTop = ((self.options.zoomWindowHeight/2)-(self.nzHeight/2))*(-1);\n\t\t\t\t\t\t\tself.windowOffsetLeft =(self.zoomWindow.width()+(self.options.borderSize*2) )* (-1);  //DONE 8,9,10,11,12\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{ //negative margin\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 11: \n\t\t\t\t\t\tself.windowOffsetTop = (self.options.zoomWindowOffety);\n\t\t\t\t\t\tself.windowOffsetLeft =(self.zoomWindow.width()+(self.options.borderSize*2) )* (-1);  //DONE 8,9,10,11,12\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 12: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.zoomWindow.height()+(self.options.borderSize*2))*(-1); //DONE 12,13,14,15,16\n\t\t\t\t\t\tself.windowOffsetLeft =(self.zoomWindow.width()+(self.options.borderSize*2) )* (-1);  //DONE 8,9,10,11,12\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 13: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.zoomWindow.height()+(self.options.borderSize*2))*(-1); //DONE 12,13,14,15,16\n\t\t\t\t\t\tself.windowOffsetLeft =(0); //DONE 7, 13\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 14: \n\t\t\t\t\t\tif(self.options.zoomWindowHeight > self.nzHeight){ //positive margin\n\t\t\t\t\t\t\tself.windowOffsetTop = (self.zoomWindow.height()+(self.options.borderSize*2))*(-1); //DONE 12,13,14,15,16\n\n\t\t\t\t\t\t\tself.windowOffsetLeft =((self.options.zoomWindowWidth/2)-(self.nzWidth/2)+(self.options.borderSize*2))*(-1);  \n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{ //negative margin\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 15://done   \n\t\t\t\t\t\tself.windowOffsetTop = (self.zoomWindow.height()+(self.options.borderSize*2))*(-1); //DONE 12,13,14,15,16\n\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth-self.zoomWindow.width()-(self.options.borderSize*2)); //DONE - 5,15\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 16:  //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.zoomWindow.height()+(self.options.borderSize*2))*(-1); //DONE 12,13,14,15,16\n\t\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t\tbreak;            \n\t\t\t\t\tdefault: //done  \n\t\t\t\t\t\tself.windowOffsetTop = (self.options.zoomWindowOffety);//DONE - 1\n\t\t\t\t\tself.windowOffsetLeft =(self.nzWidth); //DONE 1, 2, 3, 4, 16\n\t\t\t\t\t} \n\t\t\t\t} //end isNAN\n\t\t\t\telse{\n\t\t\t\t\t//WE CAN POSITION IN A CLASS - ASSUME THAT ANY STRING PASSED IS\n\t\t\t\t\tself.externalContainer = $('#'+self.options.zoomWindowPosition);\n\t\t\t\t\tself.externalContainerWidth = self.externalContainer.width();\n\t\t\t\t\tself.externalContainerHeight = self.externalContainer.height();\n\t\t\t\t\tself.externalContainerOffset = self.externalContainer.offset();\n\n\t\t\t\t\tself.windowOffsetTop = self.externalContainerOffset.top;//DONE - 1\n\t\t\t\t\tself.windowOffsetLeft =self.externalContainerOffset.left; //DONE 1, 2, 3, 4, 16\n\n\t\t\t\t}\n\t\t\t\tself.isWindowSet = true;\n\t\t\t\tself.windowOffsetTop = self.windowOffsetTop + self.options.zoomWindowOffety;\n\t\t\t\tself.windowOffsetLeft = self.windowOffsetLeft + self.options.zoomWindowOffetx;\n\n\t\t\t\tself.zoomWindow.css({ top: self.windowOffsetTop});\n\t\t\t\tself.zoomWindow.css({ left: self.windowOffsetLeft});\n\n\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\tself.zoomWindow.css({ top: 0});\n\t\t\t\t\tself.zoomWindow.css({ left: 0});\n\n\t\t\t\t}   \n\n\n\t\t\t\tself.windowLeftPos = String(((e.pageX - self.nzOffset.left) * self.widthRatio - self.zoomWindow.width() / 2) * (-1));   \n\t\t\t\tself.windowTopPos = String(((e.pageY - self.nzOffset.top) * self.heightRatio - self.zoomWindow.height() / 2) * (-1));\n\t\t\t\tif(self.Etoppos){self.windowTopPos = 0;}\n\t\t\t\tif(self.Eloppos){self.windowLeftPos = 0;}     \n\t\t\t\tif(self.Eboppos){self.windowTopPos = (self.largeHeight/self.currentZoomLevel-self.zoomWindow.height())*(-1);  } \n\t\t\t\tif(self.Eroppos){self.windowLeftPos = ((self.largeWidth/self.currentZoomLevel-self.zoomWindow.width())*(-1));}    \n\n\t\t\t\t//stops micro movements\n\t\t\t\tif(self.fullheight){\n\t\t\t\t\tself.windowTopPos = 0;\n\n\t\t\t\t}\n\t\t\t\tif(self.fullwidth){\n\t\t\t\t\tself.windowLeftPos = 0;\n\n\t\t\t\t}\n\t\t\t\t//set the css background position \n\n\n\t\t\t\tif(self.options.zoomType == \"window\" || self.options.zoomType == \"inner\") {\n\n\t\t\t\t\tif(self.zoomLock == 1){\n\t\t\t\t\t\t//overrides for images not zoomable\n\t\t\t\t\t\tif(self.widthRatio <= 1){\n\n\t\t\t\t\t\t\tself.windowLeftPos = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(self.heightRatio <= 1){ \n\t\t\t\t\t\t\tself.windowTopPos = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// adjust images less than the window height\n\n\t\t\t\t\tif(self.largeHeight < self.options.zoomWindowHeight){\n\n\t\t\t\t\t\tself.windowTopPos = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(self.largeWidth < self.options.zoomWindowWidth){\n\t\t\t\t\t\tself.windowLeftPos = 0;\n\t\t\t\t\t}       \n\n\t\t\t\t\t//set the zoomwindow background position\n\t\t\t\t\tif (self.options.easing){\n\n\t\t\t\t\t\t//     if(self.changeZoom){\n\t\t\t\t\t\t//           clearInterval(self.loop);\n\t\t\t\t\t\t//           self.changeZoom = false;\n\t\t\t\t\t\t//           self.loop = false;\n\n\t\t\t\t\t\t//            }\n\t\t\t\t\t\t//set the pos to 0 if not set\n\t\t\t\t\t\tif(!self.xp){self.xp = 0;}\n\t\t\t\t\t\tif(!self.yp){self.yp = 0;}  \n\t\t\t\t\t\t//if loop not already started, then run it \n\t\t\t\t\t\tif (!self.loop){           \n\t\t\t\t\t\t\tself.loop = setInterval(function(){                \n\t\t\t\t\t\t\t\t//using zeno's paradox    \n\n\t\t\t\t\t\t\t\tself.xp += (self.windowLeftPos  - self.xp) / self.options.easingAmount; \n\t\t\t\t\t\t\t\tself.yp += (self.windowTopPos  - self.yp) / self.options.easingAmount;\n\t\t\t\t\t\t\t\tif(self.scrollingLock){\n\n\n\t\t\t\t\t\t\t\t\tclearInterval(self.loop);\n\t\t\t\t\t\t\t\t\tself.xp = self.windowLeftPos;\n\t\t\t\t\t\t\t\t\tself.yp = self.windowTopPos            \n\n\t\t\t\t\t\t\t\t\tself.xp = ((e.pageX - self.nzOffset.left) * self.widthRatio - self.zoomWindow.width() / 2) * (-1);\n\t\t\t\t\t\t\t\t\tself.yp = (((e.pageY - self.nzOffset.top) * self.heightRatio - self.zoomWindow.height() / 2) * (-1));                         \n\n\t\t\t\t\t\t\t\t\tif(self.changeBgSize){    \n\t\t\t\t\t\t\t\t\t\tif(self.nzHeight>self.nzWidth){  \n\t\t\t\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){      \n\t\t\t\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t\t\t\t}   \n\t\t\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse{   \n\t\t\t\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){      \n\t\t\t\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t\t\t\t}            \n\t\t\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });            \n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t/*\n             if(!self.bgxp){self.bgxp = self.largeWidth/self.newvalue;}\n\t\t\t\t\t\tif(!self.bgyp){self.bgyp = self.largeHeight/self.newvalue ;}  \n                 if (!self.bgloop){   \n                 \tself.bgloop = setInterval(function(){   \n\n                 self.bgxp += (self.largeWidth/self.newvalue  - self.bgxp) / self.options.easingAmount; \n\t\t\t\t\t\t\t\tself.bgyp += (self.largeHeight/self.newvalue  - self.bgyp) / self.options.easingAmount;\n\n           self.zoomWindow.css({ \"background-size\": self.bgxp + 'px ' + self.bgyp + 'px' });\n\n\n                  }, 16);\n\n                 }\n\t\t\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\t\t\tself.changeBgSize = false;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ backgroundPosition: self.windowLeftPos + 'px ' + self.windowTopPos + 'px' });\n\t\t\t\t\t\t\t\t\tself.scrollingLock = false;\n\t\t\t\t\t\t\t\t\tself.loop = false;\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tif(self.changeBgSize){    \n\t\t\t\t\t\t\t\t\t\tif(self.nzHeight>self.nzWidth){ \n\t\t\t\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){      \n\t\t\t\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t\t\t\t}         \n\t\t\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse{                 \n\t\t\t\t\t\t\t\t\t\t\tif(self.options.zoomType != \"lens\"){     \n\t\t\t\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });\n\t\t\t\t\t\t\t\t\t\t\t}      \n\t\t\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });            \n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tself.changeBgSize = false;\n\t\t\t\t\t\t\t\t\t}                   \n\n\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ backgroundPosition: self.xp + 'px ' + self.yp + 'px' });\n\t\t\t\t\t\t\t\t}       \n\t\t\t\t\t\t\t}, 16);\n\t\t\t\t\t\t}\n\t\t\t\t\t}   \n\t\t\t\t\telse{    \n\t\t\t\t\t\tif(self.changeBgSize){  \n\t\t\t\t\t\t\tif(self.nzHeight>self.nzWidth){  \n\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){      \n\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t\t} \n\n\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{     \n\t\t\t\t\t\t\t\tif(self.options.zoomType == \"lens\"){      \n\t\t\t\t\t\t\t\t\tself.zoomLens.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t\tif((self.largeHeight/self.newvaluewidth) < self.options.zoomWindowHeight){ \n\n\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvaluewidth + 'px ' + self.largeHeight/self.newvaluewidth + 'px' });            \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\n\t\t\t\t\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth/self.newvalueheight + 'px ' + self.largeHeight/self.newvalueheight + 'px' });   \n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.changeBgSize = false;\n\t\t\t\t\t\t}     \n\n\t\t\t\t\t\tself.zoomWindow.css({ backgroundPosition: self.windowLeftPos + 'px ' + self.windowTopPos + 'px' });       \n\t\t\t\t\t}\n\t\t\t\t} \n\t\t\t},\n\t\t\tsetTintPosition: function(e){\n\t\t\t\tvar self = this;\n\t\t\t\tself.nzOffset = self.$elem.offset();\n\t\t\t\tself.tintpos = String(((e.pageX - self.nzOffset.left)-(self.zoomLens.width() / 2)) * (-1)); \n\t\t\t\tself.tintposy = String(((e.pageY - self.nzOffset.top) - self.zoomLens.height() / 2) * (-1));\t\n\t\t\t\tif(self.Etoppos){\n\t\t\t\t\tself.tintposy = 0;\n\t\t\t\t}\n\t\t\t\tif(self.Eloppos){\n\t\t\t\t\tself.tintpos=0;\n\t\t\t\t}     \n\t\t\t\tif(self.Eboppos){\n\t\t\t\t\tself.tintposy = (self.nzHeight-self.zoomLens.height()-(self.options.lensBorderSize*2))*(-1);\n\t\t\t\t} \n\t\t\t\tif(self.Eroppos){\n\t\t\t\t\tself.tintpos = ((self.nzWidth-self.zoomLens.width()-(self.options.lensBorderSize*2))*(-1));\n\t\t\t\t}    \n\t\t\t\tif(self.options.tint) {\n\t\t\t\t\t//stops micro movements\n\t\t\t\t\tif(self.fullheight){\n\t\t\t\t\t\tself.tintposy = 0;\n\n\t\t\t\t\t}\n\t\t\t\t\tif(self.fullwidth){ \n\t\t\t\t\t\tself.tintpos = 0;\n\n\t\t\t\t\t}   \n\t\t\t\t\tself.zoomTintImage.css({'left': self.tintpos+'px'});\n\t\t\t\t\tself.zoomTintImage.css({'top': self.tintposy+'px'});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tswaptheimage: function(smallimage, largeimage){\n\t\t\t\tvar self = this;\n\t\t\t\tvar newImg = new Image(); \n\n\t\t\t\tif(self.options.loadingIcon){\n\t\t\t\t\tself.spinner = $('<div style=\"background: url(\\''+self.options.loadingIcon+'\\') no-repeat center;height:'+self.nzHeight+'px;width:'+self.nzWidth+'px;z-index: 2000;position: absolute; background-position: center center;\"></div>');\n\t\t\t\t\tself.$elem.after(self.spinner);\n\t\t\t\t}\n\n\t\t\t\tself.options.onImageSwap(self.$elem);\n\n\t\t\t\tnewImg.onload = function() {\n\t\t\t\t\tself.largeWidth = newImg.width;\n\t\t\t\t\tself.largeHeight = newImg.height;\n\t\t\t\t\tself.zoomImage = largeimage;\n\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth + 'px ' + self.largeHeight + 'px' });\n\t\t\t\t\tself.zoomWindow.css({ \"background-size\": self.largeWidth + 'px ' + self.largeHeight + 'px' });\n\n\n\t\t\t\t\tself.swapAction(smallimage, largeimage);\n\t\t\t\t\treturn;              \n\t\t\t\t}          \n\t\t\t\tnewImg.src = largeimage; // this must be done AFTER setting onload\n\n\t\t\t},\n\t\t\tswapAction: function(smallimage, largeimage){\n\n\n\t\t\t\tvar self = this;    \n\n\t\t\t\tvar newImg2 = new Image(); \n\t\t\t\tnewImg2.onload = function() {\n\t\t\t\t\t//re-calculate values\n\t\t\t\t\tself.nzHeight = newImg2.height;\n\t\t\t\t\tself.nzWidth = newImg2.width;\n\t\t\t\t\tself.options.onImageSwapComplete(self.$elem);\n\n\t\t\t\t\tself.doneCallback();  \n\t\t\t\t\treturn;      \n\t\t\t\t}          \n\t\t\t\tnewImg2.src = smallimage; \n\n\t\t\t\t//reset the zoomlevel to that initially set in options\n\t\t\t\tself.currentZoomLevel = self.options.zoomLevel;\n\t\t\t\tself.options.maxZoomLevel = false;\n\n\t\t\t\t//swaps the main image\n\t\t\t\t//self.$elem.attr(\"src\",smallimage);\n\t\t\t\t//swaps the zoom image     \n\t\t\t\tif(self.options.zoomType == \"lens\") {\n\t\t\t\t\tself.zoomLens.css({ backgroundImage: \"url('\" + largeimage + \"')\" }); \n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType == \"window\") {\n\t\t\t\t\tself.zoomWindow.css({ backgroundImage: \"url('\" + largeimage + \"')\" }); \n\t\t\t\t}\n\t\t\t\tif(self.options.zoomType == \"inner\") {\n\t\t\t\t\tself.zoomWindow.css({ backgroundImage: \"url('\" + largeimage + \"')\" }); \n\t\t\t\t} \n\n\n\n\t\t\t\tself.currentImage = largeimage;\n\n\t\t\t\tif(self.options.imageCrossfade){\n\t\t\t\t\tvar oldImg = self.$elem;\n\t\t\t\t\tvar newImg = oldImg.clone();         \n\t\t\t\t\tself.$elem.attr(\"src\",smallimage)\n\t\t\t\t\tself.$elem.after(newImg);\n\t\t\t\t\tnewImg.stop(true).fadeOut(self.options.imageCrossfade, function() {\n\t\t\t\t\t\t$(this).remove();         \n\t\t\t\t\t});\n\n\t\t\t\t\t//       \t\t\t\tif(self.options.zoomType == \"inner\"){\n\t\t\t\t\t//remove any attributes on the cloned image so we can resize later\n\t\t\t\t\tself.$elem.width(\"auto\").removeAttr(\"width\");\n\t\t\t\t\tself.$elem.height(\"auto\").removeAttr(\"height\");\n\t\t\t\t\t//   }\n\n\t\t\t\t\toldImg.fadeIn(self.options.imageCrossfade);\n\n\t\t\t\t\tif(self.options.tint && self.options.zoomType != \"inner\") {\n\n\t\t\t\t\t\tvar oldImgTint = self.zoomTintImage;\n\t\t\t\t\t\tvar newImgTint = oldImgTint.clone();         \n\t\t\t\t\t\tself.zoomTintImage.attr(\"src\",largeimage)\n\t\t\t\t\t\tself.zoomTintImage.after(newImgTint);\n\t\t\t\t\t\tnewImgTint.stop(true).fadeOut(self.options.imageCrossfade, function() {\n\t\t\t\t\t\t\t$(this).remove();         \n\t\t\t\t\t\t});\n\n\n\n\t\t\t\t\t\toldImgTint.fadeIn(self.options.imageCrossfade);\n\n\n\t\t\t\t\t\t//self.zoomTintImage.attr(\"width\",elem.data(\"image\"));\n\n\t\t\t\t\t\t//resize the tint window\n\t\t\t\t\t\tself.zoomTint.css({ height: self.$elem.height()});\n\t\t\t\t\t\tself.zoomTint.css({ width: self.$elem.width()});\n\t\t\t\t\t}    \n\n\t\t\t\t\tself.zoomContainer.css(\"height\", self.$elem.height());\n\t\t\t\t\tself.zoomContainer.css(\"width\", self.$elem.width());\n\n\t\t\t\t\tif(self.options.zoomType == \"inner\"){ \n\t\t\t\t\t\tif(!self.options.constrainType){\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"height\", self.$elem.height());\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"width\", self.$elem.width());\n\n\t\t\t\t\t\t\tself.zoomWindow.css(\"height\", self.$elem.height());\n\t\t\t\t\t\t\tself.zoomWindow.css(\"width\", self.$elem.width());\n\t\t\t\t\t\t}\n\t\t\t\t\t} \n\n\t\t\t\t\tif(self.options.imageCrossfade){  \n\t\t\t\t\t\tself.zoomWrap.css(\"height\", self.$elem.height());\n\t\t\t\t\t\tself.zoomWrap.css(\"width\", self.$elem.width());\n\t\t\t\t\t} \n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tself.$elem.attr(\"src\",smallimage); \n\t\t\t\t\tif(self.options.tint) {\n\t\t\t\t\t\tself.zoomTintImage.attr(\"src\",largeimage);\n\t\t\t\t\t\t//self.zoomTintImage.attr(\"width\",elem.data(\"image\"));\n\t\t\t\t\t\tself.zoomTintImage.attr(\"height\",self.$elem.height());\n\t\t\t\t\t\t//self.zoomTintImage.attr('src') = elem.data(\"image\");\n\t\t\t\t\t\tself.zoomTintImage.css({ height: self.$elem.height()}); \n\t\t\t\t\t\tself.zoomTint.css({ height: self.$elem.height()});\n\n\t\t\t\t\t}\n\t\t\t\t\tself.zoomContainer.css(\"height\", self.$elem.height());\n\t\t\t\t\tself.zoomContainer.css(\"width\", self.$elem.width());\n\n\t\t\t\t\tif(self.options.imageCrossfade){  \n\t\t\t\t\t\tself.zoomWrap.css(\"height\", self.$elem.height());\n\t\t\t\t\t\tself.zoomWrap.css(\"width\", self.$elem.width());\n\t\t\t\t\t} \n\t\t\t\t}              \n\t\t\t\tif(self.options.constrainType){     \n\n\t\t\t\t\t//This will contrain the image proportions\n\t\t\t\t\tif(self.options.constrainType == \"height\"){ \n\n\t\t\t\t\t\tself.zoomContainer.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\tself.zoomContainer.css(\"width\", \"auto\");\n\n\t\t\t\t\t\tif(self.options.imageCrossfade){  \n\t\t\t\t\t\t\tself.zoomWrap.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomWrap.css(\"width\", \"auto\"); \n\t\t\t\t\t\t\tself.constwidth = self.zoomWrap.width();\n\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{                  \n\t\t\t\t\t\t\tself.$elem.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.$elem.css(\"width\", \"auto\");\n\t\t\t\t\t\t\tself.constwidth = self.$elem.width();\n\t\t\t\t\t\t} \n\n\t\t\t\t\t\tif(self.options.zoomType == \"inner\"){\n\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"width\", self.constwidth);   \n\t\t\t\t\t\t\tself.zoomWindow.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomWindow.css(\"width\", self.constwidth);    \n\t\t\t\t\t\t}        \n\t\t\t\t\t\tif(self.options.tint){\n\t\t\t\t\t\t\tself.tintContainer.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.tintContainer.css(\"width\", self.constwidth);\n\t\t\t\t\t\t\tself.zoomTint.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomTint.css(\"width\", self.constwidth);\n\t\t\t\t\t\t\tself.zoomTintImage.css(\"height\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomTintImage.css(\"width\", self.constwidth); \n\t\t\t\t\t\t} \n\n\t\t\t\t\t}\n\t\t\t\t\tif(self.options.constrainType == \"width\"){       \n\t\t\t\t\t\tself.zoomContainer.css(\"height\", \"auto\");\n\t\t\t\t\t\tself.zoomContainer.css(\"width\", self.options.constrainSize);\n\n\t\t\t\t\t\tif(self.options.imageCrossfade){\n\t\t\t\t\t\t\tself.zoomWrap.css(\"height\", \"auto\");\n\t\t\t\t\t\t\tself.zoomWrap.css(\"width\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.constheight = self.zoomWrap.height();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{            \n\t\t\t\t\t\t\tself.$elem.css(\"height\", \"auto\");\n\t\t\t\t\t\t\tself.$elem.css(\"width\", self.options.constrainSize); \n\t\t\t\t\t\t\tself.constheight = self.$elem.height();              \n\t\t\t\t\t\t} \n\t\t\t\t\t\tif(self.options.zoomType == \"inner\"){\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"height\", self.constheight);\n\t\t\t\t\t\t\tself.zoomWrap.parent().css(\"width\", self.options.constrainSize);   \n\t\t\t\t\t\t\tself.zoomWindow.css(\"height\", self.constheight);\n\t\t\t\t\t\t\tself.zoomWindow.css(\"width\", self.options.constrainSize);    \n\t\t\t\t\t\t} \n\t\t\t\t\t\tif(self.options.tint){\n\t\t\t\t\t\t\tself.tintContainer.css(\"height\", self.constheight);\n\t\t\t\t\t\t\tself.tintContainer.css(\"width\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomTint.css(\"height\", self.constheight);\n\t\t\t\t\t\t\tself.zoomTint.css(\"width\", self.options.constrainSize);\n\t\t\t\t\t\t\tself.zoomTintImage.css(\"height\", self.constheight);\n\t\t\t\t\t\t\tself.zoomTintImage.css(\"width\", self.options.constrainSize); \n\t\t\t\t\t\t}   \n\n\t\t\t\t\t}        \n\n\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tdoneCallback: function(){\n\n\t\t\t\tvar self = this;\n\t\t\t\tif(self.options.loadingIcon){\n\t\t\t\t\tself.spinner.hide();     \n\t\t\t\t}   \n\n\t\t\t\tself.nzOffset = self.$elem.offset();\n\t\t\t\tself.nzWidth = self.$elem.width();\n\t\t\t\tself.nzHeight = self.$elem.height();\n\n\t\t\t\t// reset the zoomlevel back to default\n\t\t\t\tself.currentZoomLevel = self.options.zoomLevel;\n\n\t\t\t\t//ratio of the large to small image\n\t\t\t\tself.widthRatio = self.largeWidth / self.nzWidth;\n\t\t\t\tself.heightRatio = self.largeHeight / self.nzHeight; \n\n\t\t\t\t//NEED TO ADD THE LENS SIZE FOR ROUND\n\t\t\t\t// adjust images less than the window height\n\t\t\t\tif(self.options.zoomType == \"window\") {\n\n\t\t\t\t\tif(self.nzHeight < self.options.zoomWindowWidth/self.widthRatio){\n\t\t\t\t\t\tlensHeight = self.nzHeight;  \n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlensHeight = String((self.options.zoomWindowHeight/self.heightRatio))\n\t\t\t\t\t}\n\n\t\t\t\t\tif(self.options.zoomWindowWidth < self.options.zoomWindowWidth){\n\t\t\t\t\t\tlensWidth = self.nzWidth;\n\t\t\t\t\t}       \n\t\t\t\t\telse{\n\t\t\t\t\t\tlensWidth =  (self.options.zoomWindowWidth/self.widthRatio);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif(self.zoomLens){\n\n\t\t\t\t\t\tself.zoomLens.css('width', lensWidth);    \n\t\t\t\t\t\tself.zoomLens.css('height', lensHeight); \n\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetCurrentImage: function(){\n\t\t\t\tvar self = this;  \n\t\t\t\treturn self.zoomImage; \n\t\t\t}, \n\t\t\tgetGalleryList: function(){\n\t\t\t\tvar self = this;   \n\t\t\t\t//loop through the gallery options and set them in list for fancybox\n\t\t\t\tself.gallerylist = [];\n\t\t\t\tif (self.options.gallery){ \n\n\n\t\t\t\t\t$('#'+self.options.gallery + ' a').each(function() {\n\n\t\t\t\t\t\tvar img_src = '';\n\t\t\t\t\t\tif($(this).data(\"zoom-image\")){\n\t\t\t\t\t\t\timg_src = $(this).data(\"zoom-image\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if($(this).data(\"image\")){\n\t\t\t\t\t\t\timg_src = $(this).data(\"image\");\n\t\t\t\t\t\t}\t\t\t\n\t\t\t\t\t\t//put the current image at the start\n\t\t\t\t\t\tif(img_src == self.zoomImage){\n\t\t\t\t\t\t\tself.gallerylist.unshift({\n\t\t\t\t\t\t\t\thref: ''+img_src+'',\n\t\t\t\t\t\t\t\ttitle: $(this).find('img').attr(\"title\")\n\t\t\t\t\t\t\t});\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tself.gallerylist.push({\n\t\t\t\t\t\t\t\thref: ''+img_src+'',\n\t\t\t\t\t\t\t\ttitle: $(this).find('img').attr(\"title\")\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t});\n\t\t\t\t}                                                       \n\t\t\t\t//if no gallery - return current image\n\t\t\t\telse{\n\t\t\t\t\tself.gallerylist.push({\n\t\t\t\t\t\thref: ''+self.zoomImage+'',\n\t\t\t\t\t\ttitle: $(this).find('img').attr(\"title\")\n\t\t\t\t\t}); \n\t\t\t\t}\n\t\t\t\treturn self.gallerylist;\n\n\t\t\t},\n\t\t\tchangeZoomLevel: function(value){\n\t\t\t\tvar self = this;   \n\n\t\t\t\t//flag a zoom, so can adjust the easing during setPosition     \n\t\t\t\tself.scrollingLock = true;   \n\n\t\t\t\t//round to two decimal places\n\t\t\t\tself.newvalue = parseFloat(value).toFixed(2);\n\t\t\t\tnewvalue = parseFloat(value).toFixed(2);\n\n\n\n\n\t\t\t\t//maxwidth & Maxheight of the image\n\t\t\t\tmaxheightnewvalue = self.largeHeight/((self.options.zoomWindowHeight / self.nzHeight) * self.nzHeight);     \n\t\t\t\tmaxwidthtnewvalue = self.largeWidth/((self.options.zoomWindowWidth / self.nzWidth) * self.nzWidth);   \t\n\n\n\n\n\t\t\t\t//calculate new heightratio\n\t\t\t\tif(self.options.zoomType != \"inner\")\n\t\t\t\t{\n\t\t\t\t\tif(maxheightnewvalue <= newvalue){\n\t\t\t\t\t\tself.heightRatio = (self.largeHeight/maxheightnewvalue) / self.nzHeight;\n\t\t\t\t\t\tself.newvalueheight = maxheightnewvalue;\n\t\t\t\t\t\tself.fullheight = true;\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tself.heightRatio = (self.largeHeight/newvalue) / self.nzHeight; \n\t\t\t\t\t\tself.newvalueheight = newvalue;\n\t\t\t\t\t\tself.fullheight = false;\n\n\t\t\t\t\t}\n\n\n//\t\t\t\t\tcalculate new width ratio\n\n\t\t\t\t\tif(maxwidthtnewvalue <= newvalue){\n\t\t\t\t\t\tself.widthRatio = (self.largeWidth/maxwidthtnewvalue) / self.nzWidth;\n\t\t\t\t\t\tself.newvaluewidth = maxwidthtnewvalue;\n\t\t\t\t\t\tself.fullwidth = true;\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tself.widthRatio = (self.largeWidth/newvalue) / self.nzWidth; \n\t\t\t\t\t\tself.newvaluewidth = newvalue;\n\t\t\t\t\t\tself.fullwidth = false;\n\n\t\t\t\t\t}\n\t\t\t\t\tif(self.options.zoomType == \"lens\"){\n\t\t\t\t\t\tif(maxheightnewvalue <= newvalue){\n\t\t\t\t\t\t\tself.fullwidth = true;\n\t\t\t\t\t\t\tself.newvaluewidth = maxheightnewvalue;\n\n\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\tself.widthRatio = (self.largeWidth/newvalue) / self.nzWidth; \n\t\t\t\t\t\t\tself.newvaluewidth = newvalue;\n\n\t\t\t\t\t\t\tself.fullwidth = false;\n\t\t\t\t\t\t}}\n\t\t\t\t}\n\n\n\n\t\t\t\tif(self.options.zoomType == \"inner\")\n\t\t\t\t{\n\t\t\t\t\tmaxheightnewvalue = parseFloat(self.largeHeight/self.nzHeight).toFixed(2);     \n\t\t\t\t\tmaxwidthtnewvalue = parseFloat(self.largeWidth/self.nzWidth).toFixed(2);      \n\t\t\t\t\tif(newvalue > maxheightnewvalue){\n\t\t\t\t\t\tnewvalue = maxheightnewvalue;\n\t\t\t\t\t}\n\t\t\t\t\tif(newvalue > maxwidthtnewvalue){\n\t\t\t\t\t\tnewvalue = maxwidthtnewvalue;\n\t\t\t\t\t}      \n\n\n\t\t\t\t\tif(maxheightnewvalue <= newvalue){\n\n\n\t\t\t\t\t\tself.heightRatio = (self.largeHeight/newvalue) / self.nzHeight; \n\t\t\t\t\t\tif(newvalue > maxheightnewvalue){\n\t\t\t\t\t\t\tself.newvalueheight = maxheightnewvalue;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tself.newvalueheight = newvalue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.fullheight = true;\n\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\n\n\n\t\t\t\t\t\tself.heightRatio = (self.largeHeight/newvalue) / self.nzHeight; \n\n\t\t\t\t\t\tif(newvalue > maxheightnewvalue){\n\n\t\t\t\t\t\t\tself.newvalueheight = maxheightnewvalue;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tself.newvalueheight = newvalue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.fullheight = false;\n\t\t\t\t\t}\n\n\n\n\n\t\t\t\t\tif(maxwidthtnewvalue <= newvalue){   \n\n\t\t\t\t\t\tself.widthRatio = (self.largeWidth/newvalue) / self.nzWidth; \n\t\t\t\t\t\tif(newvalue > maxwidthtnewvalue){\n\n\t\t\t\t\t\t\tself.newvaluewidth = maxwidthtnewvalue;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tself.newvaluewidth = newvalue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.fullwidth = true;\n\n\n\t\t\t\t\t}\n\t\t\t\t\telse{  \n\n\t\t\t\t\t\tself.widthRatio = (self.largeWidth/newvalue) / self.nzWidth; \n\t\t\t\t\t\tself.newvaluewidth = newvalue;\n\t\t\t\t\t\tself.fullwidth = false;\n\t\t\t\t\t}        \n\n\n\t\t\t\t} //end inner\n\t\t\t\tscrcontinue = false;\n\n\t\t\t\tif(self.options.zoomType == \"inner\"){\n\n\t\t\t\t\tif(self.nzWidth >= self.nzHeight){\n\t\t\t\t\t\tif( self.newvaluewidth <= maxwidthtnewvalue){\n\t\t\t\t\t\t\tscrcontinue = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\n\t\t\t\t\t\t\tscrcontinue = false;\n\t\t\t\t\t\t\tself.fullheight = true;\n\t\t\t\t\t\t\tself.fullwidth = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(self.nzHeight > self.nzWidth){     \n\t\t\t\t\t\tif( self.newvaluewidth <= maxwidthtnewvalue){\n\t\t\t\t\t\t\tscrcontinue = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tscrcontinue = false;  \n\n\t\t\t\t\t\t\tself.fullheight = true;\n\t\t\t\t\t\t\tself.fullwidth = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(self.options.zoomType != \"inner\"){\n\t\t\t\t\tscrcontinue = true;\n\t\t\t\t}\n\n\t\t\t\tif(scrcontinue){\n\n\n\n\t\t\t\t\tself.zoomLock = 0;\n\t\t\t\t\tself.changeZoom = true;\n\n\t\t\t\t\t//if lens height is less than image height\n\n\n\t\t\t\t\tif(((self.options.zoomWindowHeight)/self.heightRatio) <= self.nzHeight){\n\n\n\t\t\t\t\t\tself.currentZoomLevel = self.newvalueheight; \n\t\t\t\t\t\tif(self.options.zoomType != \"lens\" && self.options.zoomType != \"inner\") {\n\t\t\t\t\t\t\tself.changeBgSize = true;\n\n\t\t\t\t\t\t\tself.zoomLens.css({height: String((self.options.zoomWindowHeight)/self.heightRatio) + 'px' }) \n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(self.options.zoomType == \"lens\" || self.options.zoomType == \"inner\") {  \n\t\t\t\t\t\t\tself.changeBgSize = true;  \n\t\t\t\t\t\t}\t\n\n\n\t\t\t\t\t} \n\n\n\n\n\t\t\t\t\tif((self.options.zoomWindowWidth/self.widthRatio) <= self.nzWidth){\n\n\n\n\t\t\t\t\t\tif(self.options.zoomType != \"inner\"){\n\t\t\t\t\t\t\tif(self.newvaluewidth > self.newvalueheight)   {\n\t\t\t\t\t\t\t\tself.currentZoomLevel = self.newvaluewidth;                 \n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(self.options.zoomType != \"lens\" && self.options.zoomType != \"inner\") {\n\t\t\t\t\t\t\tself.changeBgSize = true;\n\n\t\t\t\t\t\t\tself.zoomLens.css({width: String((self.options.zoomWindowWidth)/self.widthRatio) + 'px' })\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(self.options.zoomType == \"lens\" || self.options.zoomType == \"inner\") {  \n\t\t\t\t\t\t\tself.changeBgSize = true;\n\t\t\t\t\t\t}\t\n\n\t\t\t\t\t}\n\t\t\t\t\tif(self.options.zoomType == \"inner\"){\n\t\t\t\t\t\tself.changeBgSize = true;  \n\n\t\t\t\t\t\tif(self.nzWidth > self.nzHeight){\n\t\t\t\t\t\t\tself.currentZoomLevel = self.newvaluewidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(self.nzHeight > self.nzWidth){\n\t\t\t\t\t\t\tself.currentZoomLevel = self.newvaluewidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}      //under\n\n\t\t\t\t//sets the boundry change, called in setWindowPos\n\t\t\t\tself.setPosition(self.currentLoc);\n\t\t\t\t//\n\t\t\t},\n\t\t\tcloseAll: function(){\n\t\t\t\tif(self.zoomWindow){self.zoomWindow.hide();}\n\t\t\t\tif(self.zoomLens){self.zoomLens.hide();}\n\t\t\t\tif(self.zoomTint){self.zoomTint.hide();}\n\t\t\t},\n\t\t\tchangeState: function(value){\n      \tvar self = this;\n\t\t\t\tif(value == 'enable'){self.options.zoomEnabled = true;}\n\t\t\t\tif(value == 'disable'){self.options.zoomEnabled = false;}\n\n\t\t\t}\n\n\t};\n\n\n\n\n\t$.fn.elevateZoom = function( options ) {\n\t\treturn this.each(function() {\n\t\t\tvar elevate = Object.create( ElevateZoom );\n\n\t\t\televate.init( options, this );\n\n\t\t\t$.data( this, 'elevateZoom', elevate );\n\n\t\t});\n\t};\n\n\t$.fn.elevateZoom.options = {\n\t\t\tzoomActivation: \"hover\", // Can also be click (PLACEHOLDER FOR NEXT VERSION)\n      \t\tzoomEnabled: true, //false disables zoomwindow from showing\n\t\t\tpreloading: 1, //by default, load all the images, if 0, then only load images after activated (PLACEHOLDER FOR NEXT VERSION)\n\t\t\tzoomLevel: 1, //default zoom level of image\n\t\t\tscrollZoom: false, //allow zoom on mousewheel, true to activate\n\t\t\tscrollZoomIncrement: 0.1,  //steps of the scrollzoom\n\t\t\tminZoomLevel: false,\n\t\t\tmaxZoomLevel: false,\n\t\t\teasing: false,\n\t\t\teasingAmount: 12,\n\t\t\tlensSize: 200,\n\t\t\tzoomWindowWidth: 400,\n\t\t\tzoomWindowHeight: 400,\n\t\t\tzoomWindowOffetx: 0,\n\t\t\tzoomWindowOffety: 0,\n\t\t\tzoomWindowPosition: 1,\n\t\t\tzoomWindowBgColour: \"#fff\",\n\t\t\tlensFadeIn: false,\n\t\t\tlensFadeOut: false,\n\t\t\tdebug: false,\n\t\t\tzoomWindowFadeIn: false,\n\t\t\tzoomWindowFadeOut: false,\n\t\t\tzoomWindowAlwaysShow: false,\n\t\t\tzoomTintFadeIn: false,\n\t\t\tzoomTintFadeOut: false,\n\t\t\tborderSize: 4,\n\t\t\tshowLens: true,\n\t\t\tborderColour: \"#888\",\n\t\t\tlensBorderSize: 1,\n\t\t\tlensBorderColour: \"#000\",\n\t\t\tlensShape: \"square\", //can be \"round\"\n\t\t\tzoomType: \"window\", //window is default,  also \"lens\" available -\n\t\t\tcontainLensZoom: false,\n\t\t\tlensColour: \"white\", //colour of the lens background\n\t\t\tlensOpacity: 0.4, //opacity of the lens\n\t\t\tlenszoom: false,\n\t\t\ttint: false, //enable the tinting\n\t\t\ttintColour: \"#333\", //default tint color, can be anything, red, #ccc, rgb(0,0,0)\n\t\t\ttintOpacity: 0.4, //opacity of the tint\n\t\t\tgallery: false,\n\t\t\tgalleryActiveClass: \"zoomGalleryActive\",\n\t\t\timageCrossfade: false,\n\t\t\tconstrainType: false,  //width or height\n\t\t\tconstrainSize: false,  //in pixels the dimensions you want to constrain on\n\t\t\tloadingIcon: false, //http://www.example.com/spinner.gif\n\t\t\tcursor:\"default\", // user should set to what they want the cursor as, if they have set a click function\n\t\t\tresponsive:true,\n\t\t\tonComplete: $.noop,\n\t\t\tonZoomedImageLoaded: function() {},\n\t\t\tonImageSwap: $.noop,\n\t\t\tonImageSwapComplete: $.noop\n\t};\n\n})( jQuery, window, document );","Craftyclicks_Ukpostcodelookup/crafty_postcode.class.js":"/*\n// This is a collection of JavaScript code to allow easy integration of\n// postcode / address finder functionality into any website\n//\n// Provided by www.CraftyClicks.co.uk\n//\n// Version - 4.9.5 (26/11/2018)\n//\n// Feel free to copy/use/modify this code any way you see fit. Please keep this\n// comment header in place when you do.\n//\n// To integrate UK postcode / address lookup on your website, please visit www.craftyclicks.co.uk for\n// details of how to sign up for an account.\n//\n**********************************************************************************/\nif(!_cp_js_included){var _cp_js_included=1;var _cp_instances=[],_cp_instance_idx=0,_cp_pl=[\"FLAT\",\"SHOP\",\"UNIT\",\"BLOCK\",\"STALL\",\"SUITE\",\"APARTMENT\",\"MAISONETTE\",\"HOUSE NUMBER\"];function CraftyPostcodeCreate(){_cp_instance_idx++;_cp_instances[_cp_instance_idx]=new CraftyPostcodeClass();_cp_instances[_cp_instance_idx].obj_idx=_cp_instance_idx;return _cp_instances[_cp_instance_idx]}function _cp_sp(b){var d=\"\",c;for(c=0;c<_cp_pl.length;c++){d=_cp_pl[c];if(d==b.substr(0,d.length).toUpperCase()){return(b.substr(d.length))}}return(\"\")}function _cp_eh(a){var b=\"\";while(b=a.shift()){if(!isNaN(parseInt(b))){return(parseInt(b))}}return\"\"}function _cp_kp(a){var b;if(!a){a=window.event}if(a.keyCode){b=a.keyCode}else{if(a.which){b=a.which}}if(b==13){this.onclick()}}function CraftyPostcodeClass(){this.config={lookup_url:\"pcls1.craftyclicks.co.uk/js/\",access_token:\"\",basic_address:0,traditional_county:0,busy_img_url:\"crafty_postcode_busy.gif\",hide_result:0,org_uppercase:1,town_uppercase:1,county_uppercase:0,addr_uppercase:0,delimiter:\", \",msg1:\"Please wait while we find the address\",err_msg1:\"This postcode could not be found, please try again or enter your address manually\",err_msg2:\"This postcode is not valid, please try again or enter your address manually\",err_msg3:\"Unable to connect to address lookup server, please enter your address manually.\",err_msg4:\"An unexpected error occured, please enter your address manually.\",res_autoselect:1,res_select_on_change:1,debug_mode:0,lookup_timeout:10000,form:\"\",elements:\"\",max_width:\"400px\",max_lines:1,first_res_line:\"---- please select your address ----\",result_elem_id:\"\",on_result_ready:null,on_result_selected:null,on_error:null,pre_populate_common_address_parts:0,elem_company:\"crafty_out_company\",elem_house_num:\"\",elem_street1:\"crafty_out_street1\",elem_street2:\"crafty_out_street2\",elem_street3:\"crafty_out_street3\",elem_town:\"crafty_out_town\",elem_county:\"crafty_out_county\",elem_postcode:\"crafty_in_out_postcode\",elem_udprn:\"crafty_out_udprn\",single_res_autoselect:0,single_res_notice:\"---- address found, see below ----\",elem_search_house:\"crafty_in_search_house\",elem_search_street:\"crafty_in_search_street\",elem_search_town:\"crafty_in_search_town\",max_results:25,err_msg5:\"The house name/number could not be found, please try again.\",err_msg6:\"No results found, please modify your search and try again.\",err_msg7:\"Too many results, please modify your search and try again.\",err_msg9:\"Please provide more data and try again.\",err_msg8:\"Trial account limit reached, please use AA11AA, AA11AB, AA11AD or AA11AE.\"};this.xmlhttp=null;this.res_arr=null;this.disp_arr=null;this.res_arr_idx=0;this.dummy_1st_line=0;this.cc=0;this.flexi_search=0;this.lookup_timeout=null;this.obj_name=\"\";this.house_search=0;this.set=function(a,b){this.config[a]=b};this.res_clicked=function(a){this.cc++;if(this.res_selected(a)){if(0!=this.config.hide_result&&((2>=this.config.max_lines&&1<this.cc)||(2<this.config.max_lines))){this.update_res(null);this.cc=0}}};this.res_selected=function(a){if(1==this.dummy_1st_line){if(0==a){return 0}else{a--}}a=this.disp_arr[a][\"index\"];this.populate_form_fields(this.res_arr[a]);if(this.config.on_result_selected){this.config.on_result_selected(a)}return 1};this.populate_form_fields=function(l){var d=[];var p=this.config.delimiter;for(var g=0;g<8;g++){d[g]=this.get_elem(g)}d[11]=this.get_elem(11);if(d[11]){d[11].value=l.udprn}var c=null;if(d[0]){if(d[0]==d[1]&&\"\"!=l.org){d[1].value=l.org;c=d[1];d[1]=d[2];d[2]=d[3];d[3]=null}else{d[0].value=l.org}}var o=l.housename2;if(\"\"!=o&&\"\"!=l.housename1){o+=p}o+=l.housename1;var m=l.housenumber;if(d[7]){d[7].value=o;if(\"\"!=o&&\"\"!=m){d[7].value+=p}d[7].value+=m;o=\"\";m=\"\"}var f=l.street1;var e=l.street2;if(\"\"!=m){if(\"\"!=e){e=m+\" \"+e}else{if(\"\"!=f){f=m+\" \"+f}else{f=m}}}var j=e+(e==\"\"?\"\":(f==\"\"?\"\":p))+f;var n=l.locality_dep;var k=l.locality;if(\"\"!=j&&parseInt(j)==j){if(\"\"!=n){n=parseInt(j)+\" \"+n}else{k=parseInt(j)+\" \"+k}j=\"\";f=\"\"}var h=n+(n==\"\"||k==\"\"?\"\":p)+k;var a=j+(j==\"\"||h==\"\"?\"\":p)+h;if(d[1]&&d[2]&&d[3]){if(\"\"!=l.pobox||\"\"!=o){if(\"\"!=l.pobox){d[1].value=l.pobox}else{d[1].value=o}if(\"\"==h){if(\"\"==e){d[2].value=f;d[3].value=\"\"}else{d[2].value=e;d[3].value=f}}else{if(\"\"==j){if(\"\"==n){d[2].value=k;d[3].value=\"\"}else{d[2].value=n;d[3].value=k}}else{d[2].value=j;d[3].value=h}}}else{if(\"\"==j){if(\"\"==n){d[1].value=k;d[2].value=\"\";d[3].value=\"\"}else{d[1].value=n;d[2].value=k;d[3].value=\"\"}}else{if(\"\"==h){if(\"\"==e){d[1].value=f;d[2].value=\"\";d[3].value=\"\"}else{d[1].value=e;d[2].value=f;d[3].value=\"\"}}else{if(\"\"==e){d[1].value=f;if(\"\"==n){d[2].value=k;d[3].value=\"\"}else{d[2].value=n;d[3].value=k}}else{if(\"\"==n){d[1].value=e;d[2].value=f;d[3].value=k}else{if(j.length<h.length){d[1].value=j;d[2].value=n;d[3].value=k}else{d[1].value=e;d[2].value=f;d[3].value=h}}}}}}}else{if(d[1]&&d[2]){if(\"\"!=l.pobox){d[1].value=l.pobox;d[2].value=a}else{if(\"\"!=o&&\"\"!=j&&\"\"!=h){if((o.length+j.length)<(j.length+h.length)){d[1].value=o+(o==\"\"?\"\":p)+j;d[2].value=h}else{d[1].value=o;d[2].value=j+(j==\"\"?\"\":p)+h}}else{if(\"\"!=o&&\"\"!=j){d[1].value=o;d[2].value=j}else{if(\"\"==o&&\"\"!=j){if(\"\"==h){if(\"\"!=e){d[1].value=e;d[2].value=f}else{d[1].value=j;d[2].value=\"\"}}else{d[1].value=j;d[2].value=h}}else{if(\"\"==j&&\"\"!=o){d[1].value=o;d[2].value=h}else{d[1].value=h;d[2].value=\"\"}}}}}}else{var b=\"\";if(\"\"!=l.pobox){b=l.pobox+p+h}else{b=o+(o==\"\"||a==\"\"?\"\":p)+a}if(d[1]){d[1].value=b}else{if(d[2]){d[2].value=b}else{if(d[3]){d[3].value=b}else{if(c){c.value=l.org+p+b}else{}}}}}}if(d[4]){d[4].value=l.town}if(d[5]){d[5].value=l.county}if(d[6]){d[6].value=l.postcode}return 1};this.show_busy=function(){if(this.config.busy_img_url&&\"\"!=this.config.busy_img_url){var b=document.createElement(\"img\");var a=document.createAttribute(\"src\");a.value=this.config.busy_img_url;b.setAttributeNode(a);a=document.createAttribute(\"title\");a.value=this.config.msg1;b.setAttributeNode(a);this.update_res(b)}else{this.update_res(null)}};this.disp_err=function(d,b){var a=null;var e=\"\";if(\"\"!=d){switch(d){case\"0001\":e=this.config.err_msg1;break;case\"0002\":e=this.config.err_msg2;break;case\"9001\":e=this.config.err_msg3;break;case\"0003\":e=this.config.err_msg9;break;case\"0004\":e=this.config.err_msg6;break;case\"0005\":e=this.config.err_msg7;break;case\"7001\":e=this.config.err_msg8;break;default:e=\"(\"+d+\") \"+this.config.err_msg4;break}if(this.config.debug_mode){var c=\"\";switch(d){case\"8000\":c=\" :: No Access Token \";break;case\"8001\":c=\" :: Invalid Token Format \";break;case\"8002\":c=\" :: Invalid Token \";break;case\"8003\":c=\" :: Out of Credits \";break;case\"8004\":c=\" :: Restricted by rules \";break;case\"8005\":c=\" :: Token suspended \";break}e+=c+\" :: DBG :: \"+b}a=document.createTextNode(e)}this.update_res(a);if(this.config.on_error){this.config.on_error(e)}};this.disp_err_msg=function(b){var a=null;if(\"\"!=b){a=document.createTextNode(b)}this.update_res(a);if(this.config.on_error){this.config.on_error(b)}};this.display_res_line=function(d,c){var b=document.getElementById(\"crafty_postcode_lookup_result_option\"+this.obj_idx);var e=document.createElement(\"option\");e.appendChild(document.createTextNode(d));if(-1==c){e.setAttribute(\"selected\",\"selected\")}if(null!=b){b.appendChild(e)}else{var a=document.createElement(\"select\");a.id=\"crafty_postcode_lookup_result_option\"+this.obj_idx;a.onclick=Function(\"_cp_instances[\"+this.obj_idx+\"].res_clicked(this.selectedIndex);\");a.onkeypress=_cp_kp;if(0!=this.config.res_select_on_change){a.onchange=Function(\"_cp_instances[\"+this.obj_idx+\"].res_selected(this.selectedIndex);\")}if(this.config.max_width&&\"\"!=this.config.max_width){a.style.width=this.config.max_width}var f=this.res_arr_idx;if(1==this.dummy_1st_line){f++}if((navigator.appName==\"Microsoft Internet Explorer\")&&(parseFloat(navigator.appVersion)<=4)){a.size=0}else{if(f>=this.config.max_lines){a.size=this.config.max_lines}else{a.size=f}}a.appendChild(e);this.update_res(a)}};this.update_res=function(a){if(this.lookup_timeout){clearTimeout(this.lookup_timeout)}try{if(document.getElementById){var b=document.getElementById(this.config.result_elem_id);if(b.hasChildNodes()){while(b.firstChild){b.removeChild(b.firstChild)}}if(null!=a){b.appendChild(a)}}}catch(c){}};this.str_trim=function(b){var a=0;var c=b.length-1;while(a<b.length&&b[a]==\" \"){a++}while(c>a&&b[c]==\" \"){c-=1}return b.substring(a,c+1)};this.cp_uc=function(e){if(\"PC\"==e||\"UK\"==e||\"EU\"==e){return(e)}var d=\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";var c=\"\";var f=1;var b=0;for(var a=0;a<e.length;a++){if(-1!=d.indexOf(e.charAt(a))){if(f||b){c=c+e.charAt(a);f=0}else{c=c+e.charAt(a).toLowerCase()}}else{c=c+e.charAt(a);if(a+2>=e.length&&\"'\"==e.charAt(a)){f=0}else{if(\"(\"==e.charAt(a)){close_idx=e.indexOf(\")\",a+1);if(a+3<close_idx){b=0;f=1}else{b=1}}else{if(\")\"==e.charAt(a)){b=0;f=1}else{if(\"-\"==e.charAt(a)){close_idx=e.indexOf(\"-\",a+1);if((-1!=close_idx&&a+3>=close_idx)||a+3>=e.length){b=0;f=0}else{b=0;f=1}}else{if(a+2<e.length&&\"0\"<=e.charAt(a)&&\"9\">=e.charAt(a)){f=0}else{f=1}}}}}}}return(c)};this.leading_caps=function(a,b){if(0!=b||2>a.length){return(a)}var d=\"\";var f=a.split(\" \");for(var c=0;c<f.length;c++){var e=this.str_trim(f[c]);if(\"\"!=e){if(\"\"!=d){d=d+\" \"}d=d+this.cp_uc(e)}}return(d)};this.new_res_line=function(){var a=[];a.org=\"\";a.housename1=\"\";a.housename2=\"\";a.pobox=\"\";a.housenumber=\"\";a.street1=\"\";a.street2=\"\";a.locality_dep=\"\";a.locality=\"\";a.town=\"\";a.county=\"\";a.postcode=\"\";a.udprn=\"\";return(a)};this.res_arr_compare=function(e,c){if(e.match_quality>c.match_quality){return(1)}if(e.match_quality<c.match_quality){return(-1)}if(e.street1>c.street1){return(1)}if(e.street1<c.street1){return(-1)}if(e.street2>c.street2){return(1)}if(e.street2<c.street2){return(-1)}var h;if(\"\"==e.housenumber){h=_cp_eh(Array(e.housename1,e.housename2))}else{h=parseInt(e.housenumber)}var g;if(\"\"==c.housenumber){g=_cp_eh(Array(c.housename1,c.housename2))}else{g=parseInt(c.housenumber)}if(\"\"==h&&\"\"!=g){return(1)}else{if(\"\"!=h&&\"\"==g){return(-1)}else{if(h>g){return(1)}if(h<g){return(-1)}}}var f=_cp_sp(e.housename1);if(!isNaN(parseInt(f))){f=parseInt(f)}var d=_cp_sp(c.housename1);if(!isNaN(parseInt(d))){d=parseInt(d)}if(f>d){return(1)}if(f<d){return(-1)}var f=_cp_sp(e.housename2);if(!isNaN(parseInt(f))){f=parseInt(f)}var d=_cp_sp(c.housename2);if(!isNaN(parseInt(d))){d=parseInt(d)}if(f>d){return(1)}if(f<d){return(-1)}f=e.housename2+e.housename1;d=c.housename2+c.housename1;if(f>d){return(1)}if(f<d){return(-1)}if(e.org>c.org){return(1)}if(e.org<c.org){return(-1)}return(1)};this.disp_res_arr=function(){this.res_arr=this.res_arr.sort(this.res_arr_compare);if(0!=this.config.res_autoselect){this.populate_form_fields(this.res_arr[0])}var a=this.config.delimiter;this.disp_arr=[];for(var c=0;c<this.res_arr_idx;c++){var e=this.res_arr[c];var b=e.org+(e.org!=\"\"?a:\"\")+e.housename2+(e.housename2!=\"\"?a:\"\")+e.housename1+(e.housename1!=\"\"?a:\"\")+e.pobox+(e.pobox!=\"\"?a:\"\")+e.housenumber+(e.housenumber!=\"\"?\" \":\"\")+e.street2+(e.street2!=\"\"?a:\"\")+e.street1+(e.street1!=\"\"?a:\"\")+e.locality_dep+(e.locality_dep!=\"\"?a:\"\")+e.locality+(e.locality!=\"\"?a:\"\")+e.town;if(this.flexi_search){b+=a+e.postcode}var d=[];d.index=c;d.str=b;this.disp_arr[c]=d}this.update_res(null);this.dummy_1st_line=0;if(\"\"!=this.config.first_res_line){this.dummy_1st_line=1;this.display_res_line(this.config.first_res_line,-1)}for(var c=0;c<this.res_arr_idx;c++){this.display_res_line(this.disp_arr[c][\"str\"],c)}if(this.config.pre_populate_common_address_parts){var f=this.new_res_line();f.org=this.res_arr[0][\"org\"];f.housename1=this.res_arr[0][\"housename1\"];f.housename2=this.res_arr[0][\"housename2\"];f.pobox=this.res_arr[0][\"pobox\"];f.housenumber=this.res_arr[0][\"housenumber\"];f.street1=this.res_arr[0][\"street1\"];f.street2=this.res_arr[0][\"street2\"];f.locality_dep=this.res_arr[0][\"locality_dep\"];f.locality=this.res_arr[0][\"locality\"];f.town=this.res_arr[0][\"town\"];f.county=this.res_arr[0][\"county\"];f.postcode=this.res_arr[0][\"postcode\"];f.udprn=this.res_arr[0][\"udprn\"];for(var c=1;c<this.res_arr_idx;c++){if(this.res_arr[c][\"org\"]!=f.org){f.org=\"\"}if(this.res_arr[c][\"housename2\"]!=f.housename2){f.housename2=\"\"}if(this.res_arr[c][\"housename1\"]!=f.housename1){f.housename1=\"\"}if(this.res_arr[c][\"pobox\"]!=f.pobox){f.pobox=\"\"}if(this.res_arr[c][\"housenumber\"]!=f.housenumber){f.housenumber=\"\"}if(this.res_arr[c][\"street1\"]!=f.street1){f.street1=\"\"}if(this.res_arr[c][\"street2\"]!=f.street2){f.street2=\"\"}if(this.res_arr[c][\"locality_dep\"]!=f.locality_dep){f.locality_dep=\"\"}if(this.res_arr[c][\"locality\"]!=f.locality){f.locality=\"\"}if(this.res_arr[c][\"town\"]!=f.town){f.town=\"\"}if(this.res_arr[c][\"county\"]!=f.county){f.county=\"\"}if(this.res_arr[c][\"postcode\"]!=f.postcode){f.postcode=\"\"}if(this.res_arr[c][\"udprn\"]!=f.udprn){f.udprn=\"\"}}this.populate_form_fields(f)}};this.get_elem=function(a){var d=\"\";var c=null;if(\"\"!=this.config.elements){var b=this.config.elements.split(\",\");d=b[a]}else{switch(a){case 0:d=this.config.elem_company;break;case 1:d=this.config.elem_street1;break;case 2:d=this.config.elem_street2;break;case 3:d=this.config.elem_street3;break;case 4:d=this.config.elem_town;break;case 5:d=this.config.elem_county;break;case 6:default:d=this.config.elem_postcode;break;case 7:d=this.config.elem_house_num;break;case 8:d=this.config.elem_search_house;break;case 9:d=this.config.elem_search_street;break;case 10:d=this.config.elem_search_town;break;case 11:d=this.config.elem_udprn;break}}if(\"\"!=d){if(\"\"!=this.config.form){c=document.forms[this.config.form].elements[d]}else{if(document.getElementById){c=document.getElementById(d)}}}return(c)};this.doHouseSearch=function(){var a=this.get_elem(8);if(a&&0<a.value.length){this.house_search=1}this.doLookup()};this.doLookup=function(){this.xmlhttp=null;var a=this.get_elem(6);var b=null;if(a){this.show_busy();this.lookup_timeout=setTimeout(\"_cp_instances[\"+this.obj_idx+\"].lookup_timeout_err()\",this.config.lookup_timeout);b=this.validate_pc(a.value)}if(null!=b){this.direct_xml_fetch(0,b)}else{this.disp_err(\"0002\",\"invalid postcode format\")}};this.flexiSearch=function(){this.xmlhttp=null;var a=\"\";if(this.get_elem(8)&&\"\"!=this.get_elem(8).value){a+=\"&search_house=\"+this.get_elem(8).value}if(this.get_elem(9)&&\"\"!=this.get_elem(9).value){a+=\"&search_street=\"+this.get_elem(9).value}if(this.get_elem(10)&&\"\"!=this.get_elem(10).value){a+=\"&search_town=\"+this.get_elem(10).value}if(\"\"!=a){this.show_busy();this.lookup_timeout=setTimeout(\"_cp_instances[\"+this.obj_idx+\"].lookup_timeout_err()\",this.config.lookup_timeout);this.direct_xml_fetch(1,a)}else{this.disp_err(\"0003\",\"search string too short\")}};this.validate_pc=function(c){var b=\"\";do{b=c;c=c.replace(/[^A-Za-z0-9]/,\"\")}while(b!=c);b=c.toUpperCase();if(7>=b.length&&5<=b.length){var d=b.substring(b.length-3,b.length);var a=b.substring(0,b.length-3);if(true==/[CIKMOV]/.test(d)){return null}if(\"0\"<=d.charAt(0)&&\"9\">=d.charAt(0)&&\"A\"<=d.charAt(1)&&\"Z\">=d.charAt(1)&&\"A\"<=d.charAt(2)&&\"Z\">=d.charAt(2)){switch(a.length){case 2:if(\"A\"<=a.charAt(0)&&\"Z\">=a.charAt(0)&&\"0\"<=a.charAt(1)&&\"9\">=a.charAt(1)){return(b)}break;case 3:if(\"A\"<=a.charAt(0)&&\"Z\">=a.charAt(0)){if(\"0\"<=a.charAt(1)&&\"9\">=a.charAt(1)&&\"0\"<=a.charAt(2)&&\"9\">=a.charAt(2)){return(b)}else{if(\"A\"<=a.charAt(1)&&\"Z\">=a.charAt(1)&&\"0\"<=a.charAt(2)&&\"9\">=a.charAt(2)){return(b)}else{if(\"0\"<=a.charAt(1)&&\"9\">=a.charAt(1)&&\"A\"<=a.charAt(2)&&\"Z\">=a.charAt(2)){return(b)}}}}break;case 4:if(\"A\"<=a.charAt(0)&&\"Z\">=a.charAt(0)&&\"A\"<=a.charAt(1)&&\"Z\">=a.charAt(1)&&\"0\"<=a.charAt(2)&&\"9\">=a.charAt(2)){if(\"0\"<=a.charAt(3)&&\"9\">=a.charAt(3)){return(b)}else{if(\"A\"<=a.charAt(3)&&\"Z\">=a.charAt(3)){return(b)}}}break;default:break}}}return null};this.direct_xml_fetch=function(d,a){try{var e=document.getElementById(this.config.result_elem_id);var b=\"\";if(\"https:\"==document.location.protocol){b=\"https://\"}else{b=\"http://\"}if(0==d){b+=this.config.lookup_url;if(this.config.basic_address){b+=\"basicaddress\"}else{b+=\"rapidaddress\"}b+=\"?postcode=\"+a+\"&callback=_cp_instances[\"+this.obj_idx+\"].handle_js_response&callback_id=0\"}else{if(this.config.basic_address){this.disp_err(\"1207\",\"BasicAddress can't be used for Flexi Search!\");return}else{b+=this.config.lookup_url+\"flexiaddress?callback=_cp_instances[\"+this.obj_idx+\"].handle_js_response&callback_id=1\";b+=\"&max_results=\"+this.config.max_results;b+=a}}if(\"\"!=this.config.access_token){b+=\"&key=\"+this.config.access_token}var c=document.createElement(\"script\");c.src=encodeURI(b);c.type=\"text/javascript\";e.appendChild(c)}catch(f){this.disp_err(\"1206\",f)}};this.handle_js_response=function(c,d,e){if(!d){var f=e.error_code;var a=e.error_msg;this.disp_err(f,a)}else{this.res_arr=[];this.res_arr_idx=0;if(0==c){this.flexi_search=0;if(this.house_search){e=this.filter_data_by_house_name(e);if(null==e){this.disp_err_msg(this.config.err_msg5);return}}this.add_to_res_array(e)}else{this.flexi_search=1;this.res_arr.total_postcode_count=e.total_postcode_count;this.res_arr.total_thoroughfare_count=e.total_thoroughfare_count;this.res_arr.total_delivery_point_count=e.total_delivery_point_count;for(var i=1;i<=e.total_postcode_count;i++){this.add_to_res_array(e[i])}}if(this.res_arr_idx){var b=false;if(1==this.res_arr_idx&&this.config.single_res_autoselect){var g=null;if(\"\"!=this.config.single_res_notice){g=document.createTextNode(this.config.single_res_notice)}this.update_res(g);this.populate_form_fields(this.res_arr[0]);b=true}else{this.disp_res_arr();document.getElementById(\"crafty_postcode_lookup_result_option\"+this.obj_idx).focus()}if(0==c&&\"\"!=e.postcode){var h=this.get_elem(6);h.value=e.postcode}if(this.config.on_result_ready){this.config.on_result_ready()}if(b&&this.config.on_result_selected){this.config.on_result_selected(0)}}else{this.disp_err(\"1205\",\"no result to display\")}}};this.add_to_res_array=function(f){for(var d=1;d<=f.thoroughfare_count;d++){var e=f[d][\"thoroughfare_name\"];if(\"\"!=f[d][\"thoroughfare_descriptor\"]){e+=\" \"+f[d][\"thoroughfare_descriptor\"]}e=this.leading_caps(e,this.config.addr_uppercase);var c=f[d][\"dependent_thoroughfare_name\"];if(\"\"!=f[d][\"dependent_thoroughfare_descriptor\"]){c+=\" \"+f[d][\"dependent_thoroughfare_descriptor\"]}c=this.leading_caps(c,this.config.addr_uppercase);if(\"delivery_point_count\" in f[d]&&0<f[d][\"delivery_point_count\"]){for(var a=1;a<=f[d][\"delivery_point_count\"];a++){var g=this.new_res_line();g.street1=e;g.street2=c;var b=f[d][a];if(\"match_quality\" in b){g.match_quality=b.match_quality}else{g.match_quality=1}g.housenumber=b.building_number;g.housename2=this.leading_caps(b.sub_building_name,this.config.addr_uppercase);g.housename1=this.leading_caps(b.building_name,this.config.addr_uppercase);g.org=b.department_name;if(\"\"!=g.org&&\"\"!=b.organisation_name){g.org+=this.config.delimiter}g.org=this.leading_caps(g.org+b.organisation_name,this.config.org_uppercase);g.pobox=this.leading_caps(b.po_box_number,this.config.addr_uppercase);g.postcode=f.postcode;g.town=this.leading_caps(f.town,this.config.town_uppercase);g.locality=this.leading_caps(f.dependent_locality,this.config.addr_uppercase);g.locality_dep=this.leading_caps(f.double_dependent_locality,this.config.addr_uppercase);if(this.config.traditional_county){g.county=this.leading_caps(f.traditional_county,this.config.county_uppercase)}else{g.county=this.leading_caps(f.postal_county,this.config.county_uppercase)}g.udprn=b.udprn;this.res_arr[this.res_arr_idx]=g;this.res_arr_idx++}}else{var g=this.new_res_line();g.street1=e;g.street2=c;g.postcode=f.postcode;g.town=this.leading_caps(f.town,this.config.town_uppercase);g.locality=this.leading_caps(f.dependent_locality,this.config.addr_uppercase);g.locality_dep=this.leading_caps(f.double_dependent_locality,this.config.addr_uppercase);if(this.config.traditional_county){g.county=this.leading_caps(f.traditional_county,this.config.county_uppercase)}else{g.county=this.leading_caps(f.postal_county,this.config.county_uppercase)}g.match_quality=2;this.res_arr[this.res_arr_idx]=g;this.res_arr_idx++}}};this.filter_data_by_house_name=function(f){var g=this.get_elem(8);if(!g||!g.value.length){return f}var j=g.value.toUpperCase();var k=-1;if(parseInt(j)==j){k=parseInt(j)}var l=\" \"+j;var e=[];var i=1;var b=0;for(var c=1;c<=f.thoroughfare_count;c++){e[i]=[];b=0;for(var d=1;d<=f[c][\"delivery_point_count\"];d++){var h=f[c][d];var a=\" \"+h.sub_building_name+\" \"+h.building_name+\" \";if(-1!=a.indexOf(l)||k==parseInt(h.building_number)){b++;e[i][b]=[];e[i][b][\"building_number\"]=h.building_number;e[i][b][\"sub_building_name\"]=h.sub_building_name;e[i][b][\"building_name\"]=h.building_name;e[i][b][\"department_name\"]=h.department_name;e[i][b][\"organisation_name\"]=h.organisation_name;e[i][b][\"po_box_number\"]=h.po_box_number;e[i][b][\"udprn\"]=h.udprn}}if(b){e[i][\"delivery_point_count\"]=b;e[i][\"thoroughfare_name\"]=f[c][\"thoroughfare_name\"];e[i][\"thoroughfare_descriptor\"]=f[c][\"thoroughfare_descriptor\"];e[i][\"dependent_thoroughfare_name\"]=f[c][\"dependent_thoroughfare_name\"];e[i][\"dependent_thoroughfare_descriptor\"]=f[c][\"dependent_thoroughfare_descriptor\"];i++}}if(1<i){e.thoroughfare_count=i-1;e.town=f.town;e.dependent_locality=f.dependent_locality;e.double_dependent_locality=f.double_dependent_locality;e.traditional_county=f.traditional_county;e.postal_county=f.postal_county;e.postcode=f.postcode;return e}return null};this.lookup_timeout_err=function(){this.disp_err(\"9001\",\"Internal Timeout after \"+this.config.lookup_timeout+\"ms\")}}};","Craftyclicks_Ukpostcodelookup/form_integrations/cc_iwd_checkout.js":"/*\n// This is a collection of JavaScript code to allow easy integration of\n// the Crafty Clicks postcode / address finder functionality into Magento 2\n// custom checkout by IWD. Tested with IWD Checkout Suite version 3.2.0.\n//\n// Provided by www.CraftyClicks.co.uk\n//\n// Requires standard CraftyClicks JS - tested with v4.9.3\n//\n// If you copy/use/modify this code - please keep this\n// comment header in place\n//\n// Copyright (c) 2009-2018 Crafty Clicks (http://www.craftyclicks.com)\n//\n// This code relies on jQuery, you must have a reasonably recent version loaded\n// in your template. Magento should include it as standard.\n//\n// If you need any help, contact support@craftyclicks.co.uk - we will help!\n//\n**********************************************************************************/\n\nfunction CraftyClicksMagento2Class() {\n\tthis.current_setup = 'initial';\n\n\t// initial page setup\n\tthis.initial_setup =function() {\n\t\t// move fields\n\t\tjQuery('#' + this.misc.container_id).find('[name=\"lastname\"]').closest('.field').after(jQuery('#' + this.fields.country_id).closest('.field'));\n\t\tjQuery('#' + this.fields.country_id).closest('.field').before(jQuery('#' + this.fields.company_id).closest('.field'));\n\n\t\t// add cp address class to fields and labels so we can easily grab them for the hide fields feature\n\t\tvar that = this;\n\t\tjQuery.each(this.fields, function(index, value) {\n\t\t\tif (value !== that.fields.postcode_id && value !== that.fields.country_id && value !== that.fields.company_id) {\n\t\t\t\tjQuery('#' + value).closest('.field').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\tif (value == that.fields.address_1_id) {\n\t\t\t\t\tjQuery('#' + value).closest('.field').parent().closest('.field').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tthis.setup_for_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('uk' != this.current_setup) {\n\t\t\t// do the magic for UK\n\n\t\t\t// move postcode to show after country and add placeholder\n\t\t\tjQuery('#' + this.fields.country_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('placeholder', crafty_cfg.txt.search_placeholder);\n\n\t\t\t// check if button already exists\n\t\t\t// Step 6 - add prefix to button and result display so they are unique\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 0) {\n\t\t\t\t// add button after postcode input\n\t\t\t\tvar tmp_html = '<div class=\"field\"><div><button id=\"' + this.misc.prefix + '_cp_button_id\" type=\"button\" class=\"iwd_opc_button active iwd_opc_place_order_button\"><span>' + crafty_cfg.txt.search_buttontext + '</span></button></div></div>';\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.field').after(tmp_html);\n\n\t\t\t\t// add click event listener to button\n\t\t\t\tvar el = document.getElementById(this.misc.prefix + '_cp_button_id');\n\t\t\t\tif (el != null) {\n\t\t\t\t\tel.addEventListener('click', this.button_clicked.bind(this));\n\t\t\t\t}\n\n\t\t\t\t// add results after button\n\t\t\t\tjQuery('#'+this.misc.prefix+'_cp_button_id').closest('.field').after('<div class=\"field\" style=\"display: none;\"><div id=\"' + this.misc.prefix + '_cp_result_display\" class=\"search-list\"></div></div>');\n\t\t\t} else {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').show();\n\t\t\t}\n\n\t\t\t// disable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'new-password')\n\t\t}\n\n\t\tif (crafty_cfg.hide_fields) {\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').hide();\n\t\t}\n\n\t\tthis.current_setup = 'uk';\n\t}\n\n\tthis.setup_for_non_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('non_uk' != this.current_setup) {\n\t\t\t// move postcode field to show after region\n\t\t\tjQuery('#' + this.fields.county_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\n\t\t\t// hide button and result box if they exist\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').hide();\n\t\t\t}\n\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_result_display').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').hide();\n\t\t\t}\n\n\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').children('select').remove();\n\n\t\t\t// show fields\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t\t// enable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'postal-code')\n\n\t\t\tthis.current_setup = 'non_uk';\n\t\t}\n\t}\n\n\tthis.add_lookup = function(setup) {\n\t\t// Step 5 - make sure we only do add_lookup once per instance\n\t\tif (jQuery('#'+setup.fields.postcode_id).attr('cc-applied') == \"1\") {\n\t\t\treturn\n\t\t}\n\t\tcp_obj = CraftyPostcodeCreate(); // instantiate library magic\n\t\tthis.cp_obj = cp_obj;\n\t\t// config\n\t\tthis.fields = setup.fields;\n\t\tthis.misc = setup.misc;\n\n\t\t// the set method is shorthand and is equivalent to cp_obj.config['configItem'] = configValue;\n\t\tcp_obj.set(\"result_elem_id\", this.misc.prefix + \"_cp_result_display\");\n\t\tcp_obj.set(\"form\", \"\");\n\t\tcp_obj.set(\"elem_company\", this.fields.company_id);\n\t\tcp_obj.set(\"elem_street1\", this.fields.address_1_id);\n\t\tcp_obj.set(\"elem_street2\", this.fields.address_2_id);\n\t\tcp_obj.set(\"elem_postcode\", this.fields.postcode_id);\n\t\tcp_obj.set(\"elem_town\", this.fields.town_id);\n\t\tcp_obj.set(\"elem_country\", this.fields.country_id);\n\t\tcp_obj.set(\"elem_county\", this.fields.county_id);\n\n\t\tcp_obj.set(\"container_elem\", this.misc.container_elem);\n\t\tcp_obj.set(\"prefix\", this.misc.prefix);\n\n\t\tcp_obj.set(\"access_token\", crafty_cfg.key);\n\t\tcp_obj.set(\"res_autoselect\", \"0\");\n\t\tcp_obj.set(\"single_res_autoselect\" , 0);\n\t\tcp_obj.set(\"max_lines\" , 1);\n\n\t\tif (crafty_cfg.advanced.county_data == 'traditional') {\n\t\t\tcp_obj.set(\"traditional_county\" , 1);\n\t\t} else if (crafty_cfg.advanced.county_data == 'former_postal') {\n\t\t\tcp_obj.set(\"traditional_county\" , 0);\n\t\t}\n\n\t\tcp_obj.set(\"busy_img_url\" , null);\n\t\tcp_obj.set(\"hide_result\" , false);\n\t\tcp_obj.set(\"on_result_ready\", this.result_ready.bind(this));\n\t\tcp_obj.set(\"on_result_selected\", this.result_selected.bind(this));\n\t\tcp_obj.set(\"on_error\", this.result_error.bind(this));\n\t\tcp_obj.set(\"first_res_line\", '---- please select your address ----');\n\t\tcp_obj.set(\"err_msg1\", crafty_cfg.error_msg['0001']);\n\t\tcp_obj.set(\"err_msg2\", crafty_cfg.error_msg['0002']);\n\t\tcp_obj.set(\"err_msg3\", crafty_cfg.error_msg['0003']);\n\t\tcp_obj.set(\"err_msg4\", crafty_cfg.error_msg['0004']);\n\t\tcp_obj.set(\"max_width\", \"100%\");\n\n\t\t// do initial setup\n\t\tthis.initial_setup();\n\n\t\t// do setup for current country\n\t\tthis.country_changed();\n\n\t\t// listen for country changes\n\t\tvar countryEl = document.getElementById(this.fields.country_id);\n\t\tcountryEl.addEventListener('change', this.country_changed.bind(this));\n\n\t\tjQuery('#'+setup.fields.postcode_id).attr('cc-applied', '1');\n\t}\n\n\tthis.country_changed = function(e) {\n\t\t// show postcode lookup for:\n\t\t// \"GB\" UK\n\t\t// \"JE\" Jersey\n\t\t// \"GG\" Guernsey\n\t\t// \"IM\" Isle of Man\n\t\tvar curr_country = jQuery('#' + this.fields.country_id).val();\n\t\tif ('GB' == curr_country || 'JE' == curr_country || 'GG' == curr_country || 'IM' == curr_country) {\n\t\t\tthis.setup_for_uk();\n\t\t} else {\n\t\t\tthis.setup_for_non_uk();\n\t\t}\n\t}\n\n\tthis.button_clicked = function(e) {\n\t\te.preventDefault();\n\t\tjQuery('#' + this.misc.prefix +'_cp_result_display').siblings('.field-error').children('.search-subtext').hide();\n\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').closest('.field').show();\n\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').show();\n\t\tthis.cp_obj.doLookup();\n\t}\n\n\tthis.result_ready = function() {\n\n\t}\n\n\tthis.result_selected = function() {\n\t\t// update country field if user selects address from GG/JE, etc.\n\t\tswitch(jQuery('#' + this.fields.postcode_id).val().substring(0,2)){\n\t\t\tcase \"GY\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"GG\");\n\t\t\t\tbreak;\n\t\t\tcase \"JE\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"JE\");\n\t\t\t\tbreak;\n\t\t\tcase \"IM\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"IM\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"GB\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (crafty_cfg.advanced.county_data == 'none') {\n\t\t\tjQuery('#'+this.fields.county_id).val('');\n\t\t}\n\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t// trigger change event on address fields to satisfy magento required fields\n\t\tjQuery('#'+this.fields.company_id).trigger('change');\n\t\tjQuery('#'+this.fields.address_1_id).trigger('change');\n\t\tjQuery('#'+this.fields.address_2_id).trigger('change');\n\t\tjQuery('#'+this.fields.postcode_id).trigger('change');\n\t\tjQuery('#'+this.fields.town_id).trigger('change');\n\t\tjQuery('#'+this.fields.county_id).trigger('change');\n\t\tjQuery('#'+this.fields.country_id).trigger('change');\n\t}\n\n\tthis.result_error = function() {\n\t\t// apply magento error styling\n\t\tjQuery('#shipping_cp_result_display').removeClass('search-list');\n\t\tjQuery('#shipping_cp_result_display').addClass('field-error');\n\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\t}\n}\n\n\nactivate_cc = function() {\n\tif (jQuery('#co-shipping-form').find('[name=\"postcode\"]').length == 1) {\n\t\t// Step 3 - now that we know this form exists, create an instance from our constructor\n\t\tvar cc1 = new CraftyClicksMagento2Class();\n\t\t// Step 4 - run the add_lookup method on our instance and pass it field id's\n\t\tcc1.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('#co-shipping-form').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('#co-shipping-form').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('#co-shipping-form').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('#co-shipping-form').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('#co-shipping-form').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('#co-shipping-form').find('[name=\"region\"]').attr('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('#co-shipping-form').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_id\":\t\t\t\"co-shipping-form\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"shipping\"\n\t\t\t}\n\t\t});\n\t}\n\n\tif (jQuery('#co-payment-form').find('[name=\"postcode\"]').length == 1) {\n\t\tvar cc2 = new CraftyClicksMagento2Class();\n\t\tcc2.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('#co-payment-form').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('#co-payment-form').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('#co-payment-form').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"address_3_id\":\t\tjQuery('#co-shipping-form').find('[name=\"street[2]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('#co-payment-form').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('#co-payment-form').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('#co-payment-form').find('[name=\"region\"]').attr('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('#co-payment-form').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_id\":\t\t\t\"co-payment-form\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"payment\"\n\t\t\t}\n\t\t});\n\t}\n}\n\nrequirejs(['jquery'], function($) {\n\tjQuery(document).ready(function() {\n\t\t// Step 1 - check crafty is enabled\n\t\tif (crafty_cfg.enabled) {\n\t\t\t// Step 2 - page takes a while to load, so continuously check for form\n\t\t\tsetInterval(activate_cc, 200);\n\t\t}\n\n\t});\n});","Craftyclicks_Ukpostcodelookup/form_integrations/cc_default_checkout.js":"/*\n// This is a collection of JavaScript code to allow easy integration of\n// the Crafty Clicks postcode / address finder functionality into Magento 2\n//\n// This file works for the standard magento 2 checkout (both community and enterprise)\n//\n// Provided by www.CraftyClicks.co.uk\n//\n// Requires standard CraftyClicks JS - tested with v4.9.3\n//\n// If you copy/use/modify this code - please keep this\n// comment header in place\n//\n// Copyright (c) 2009-2018 Crafty Clicks (http://www.craftyclicks.com)\n//\n// This code relies on jQuery, you must have a reasonably recent version loaded\n// in your template. Magento should include it as standard.\n//\n// If you need any help, contact support@craftyclicks.co.uk - we will help!\n//\n**********************************************************************************/\n\nfunction CraftyClicksMagento2Class() {\n\tthis.current_setup = 'initial';\n\n\t// initial page setup\n\tthis.initial_setup =function() {\n\t\t// move country field to top\n\t\tjQuery('#' + this.misc.container_id).find('[name=\"lastname\"]').closest('.field').after(jQuery('#' + this.fields.country_id).closest('.field'));\n\t\t// if hide fields is true, move telephone field up\n\t\tif (crafty_cfg.hide_fields) {\n\t\t\tjQuery('#' + this.fields.country_id).closest('.field').before(jQuery('#' + this.misc.container_id).find('[name=\"telephone\"]').closest('.field'));\n\t\t}\n\n\t\t// add cp address class to fields and labels so we can easily grab them for the hide fields feature\n\t\tvar that = this;\n\t\tjQuery.each(this.fields, function(index, value) {\n\t\t\tif (value !== that.fields.postcode_id && value !== that.fields.country_id) {\n\t\t\t\tjQuery('#' + value).closest('.control').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\tjQuery('#' + value).closest('.control').prev('label').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\tif (value == that.fields.address_1_id) {\n\t\t\t\t\tjQuery('#' + value).closest('.control').parent().closest('.control').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\t\tjQuery('#' + value).closest('.control').parent().closest('.control').prev('.label').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tthis.setup_for_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('uk' != this.current_setup) {\n\t\t\t// do the magic for UK\n\n\t\t\t// move postcode to show after country and add placeholder\n\t\t\tjQuery('#' + this.fields.country_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('placeholder', crafty_cfg.txt.search_placeholder);\n\n\t\t\t// check if button already exists\n\t\t\t// Step 6 - add prefix to button and result display so they are unique\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 0) {\n\t\t\t\tjQuery('#'+this.fields.postcode_id).wrap('<div class=\"search-bar\"></div>');\n\n\t\t\t\t// add button after postcode input\n\t\t\t\tvar tmp_html = '<button id=\"' + this.misc.prefix + '_cp_button_id\" type=\"button\" class=\"action primary\"><span>' + crafty_cfg.txt.search_buttontext + '</span></button>';\n\t\t\t\tjQuery('#'+this.fields.postcode_id).after(tmp_html);\n\n\t\t\t\t// add click event listener to button\n\t\t\t\tvar el = document.getElementById(this.misc.prefix + '_cp_button_id');\n\t\t\t\tif (el != null) {\n\t\t\t\t\tel.addEventListener('click', this.button_clicked.bind(this));\n\t\t\t\t}\n\n\t\t\t\t// add search-list and mage-error after search-bar\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.search-bar').after('<div id=\"' + this.misc.prefix + '_cp_result_display\" class=\"search-list\"></div>');\n\n\t\t\t\tjQuery('#'+this.misc.prefix + '_cp_result_display').after('<div class=\"search-list\" style=\"display: none;\"><select></select></div>'+\n\t\t\t\t'<div id=\"cc_' + this.misc.prefix + '_error\" class=\"mage-error\" generated><div class=\"search-subtext\"></div></div>');\n\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.field').addClass('search-container type_3')\n\t\t\t} else {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').show();\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').show();\n\t\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').addClass(\"search-container type_3\");\n\t\t\t}\n\n\t\t\t// disable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'new-password')\n\t\t}\n\n\t\tif ('initial' == this.current_setup && crafty_cfg.hide_fields) {\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').hide();\n\t\t} else if ('non_uk' == this.current_setup && crafty_cfg.hide_fields && jQuery('#' + this.fields.postcode_id).val() === \"\") {\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').hide();\n\t\t}\n\n\t\tthis.current_setup = 'uk';\n\t}\n\n\tthis.setup_for_non_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('non_uk' != this.current_setup) {\n\t\t\t// move postcode field to show after region\n\t\t\tjQuery('#' + this.fields.county_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\n\t\t\t// hide button and result box if they exist\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').hide();\n\t\t\t}\n\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_result_display').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').hide();\n\t\t\t}\n\n\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').children('select').remove();\n\n\t\t\t// reset postcode input width\n\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').removeClass(\"search-container type_3\");\n\n\t\t\t// show fields\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t\t// enable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'postal-code')\n\n\t\t\tthis.current_setup = 'non_uk';\n\t\t}\n\t}\n\n\tthis.add_lookup = function(setup) {\n\t\t// Step 5 - make sure we only do add_lookup once per instance\n\t\tif (jQuery('#'+setup.fields.postcode_id).attr('cc-applied') == \"1\") {\n\t\t\treturn\n\t\t}\n\t\tcp_obj = CraftyPostcodeCreate(); // instantiate library magic\n\t\tthis.cp_obj = cp_obj;\n\t\t// config\n\t\tthis.fields = setup.fields;\n\t\tthis.misc = setup.misc;\n\n\t\t// the set method is shorthand and is equivalent to cp_obj.config['configItem'] = configValue;\n\t\tcp_obj.set(\"result_elem_id\", this.misc.prefix + \"_cp_result_display\");\n\t\tcp_obj.set(\"form\", \"\");\n\t\tcp_obj.set(\"elem_company\", this.fields.company_id);\n\t\tcp_obj.set(\"elem_street1\", this.fields.address_1_id);\n\t\tcp_obj.set(\"elem_street2\", this.fields.address_2_id);\n\t\tcp_obj.set(\"elem_postcode\", this.fields.postcode_id);\n\t\tcp_obj.set(\"elem_town\", this.fields.town_id);\n\t\tcp_obj.set(\"elem_country\", this.fields.country_id);\n\t\tcp_obj.set(\"elem_county\", this.fields.county_id);\n\n\t\tcp_obj.set(\"prefix\", this.misc.prefix);\n\n\t\tcp_obj.set(\"access_token\", crafty_cfg.key);\n\t\tcp_obj.set(\"res_autoselect\", \"0\");\n\t\tcp_obj.set(\"single_res_autoselect\" , 0);\n\t\tcp_obj.set(\"max_lines\" , 1);\n\n\t\tif (crafty_cfg.advanced.county_data == 'traditional') {\n\t\t\tcp_obj.set(\"traditional_county\" , 1);\n\t\t} else if (crafty_cfg.advanced.county_data == 'former_postal') {\n\t\t\tcp_obj.set(\"traditional_county\" , 0);\n\t\t}\n\n\t\tcp_obj.set(\"busy_img_url\" , null);\n\t\tcp_obj.set(\"hide_result\" , false);\n\t\tcp_obj.set(\"on_result_ready\", this.result_ready.bind(this));\n\t\tcp_obj.set(\"on_result_selected\", this.result_selected.bind(this));\n\t\tcp_obj.set(\"on_error\", this.result_error.bind(this));\n\t\tcp_obj.set(\"first_res_line\", '---- please select your address ----');\n\t\tcp_obj.set(\"err_msg1\", crafty_cfg.error_msg['0001']);\n\t\tcp_obj.set(\"err_msg2\", crafty_cfg.error_msg['0002']);\n\t\tcp_obj.set(\"err_msg3\", crafty_cfg.error_msg['0003']);\n\t\tcp_obj.set(\"err_msg4\", crafty_cfg.error_msg['0004']);\n\t\tcp_obj.set(\"max_width\", \"100%\");\n\n\t\t// do initial setup\n\t\tthis.initial_setup();\n\n\t\t// do setup for current country\n\t\tthis.country_changed();\n\n\t\t// listen for country changes\n\t\tvar countryEl = document.getElementById(this.fields.country_id);\n\t\tcountryEl.addEventListener('change', this.country_changed.bind(this));\n\n\t\tjQuery('#'+setup.fields.postcode_id).attr('cc-applied', '1');\n\t}\n\n\tthis.country_changed = function(e) {\n\t\t// show postcode lookup for:\n\t\t// \"GB\" UK\n\t\t// \"JE\" Jersey\n\t\t// \"GG\" Guernsey\n\t\t// \"IM\" Isle of Man\n\t\tvar curr_country = jQuery('#' + this.fields.country_id).val();\n\t\tif ('GB' == curr_country || 'JE' == curr_country || 'GG' == curr_country || 'IM' == curr_country) {\n\t\t\tthis.setup_for_uk();\n\t\t} else {\n\t\t\tthis.setup_for_non_uk();\n\t\t}\n\t}\n\n\tthis.button_clicked = function() {\n\t\tthis.cp_obj.doLookup();\n\t}\n\n\tthis.result_ready = function() {\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').hide();\n\t}\n\n\tthis.result_selected = function() {\n\t\t// update country field if user selects address from GG/JE, etc.\n\t\tswitch(jQuery('#' + this.fields.postcode_id).val().substring(0,2)){\n\t\t\tcase \"GY\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"GG\");\n\t\t\tbreak;\n\t\t\tcase \"JE\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"JE\");\n\t\t\tbreak;\n\t\t\tcase \"IM\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"IM\");\n\t\t\tbreak;\n\t\t\tdefault:\n\t\t\tjQuery('#' + this.fields.country_id).val(\"GB\");\n\t\t\tbreak;\n\t\t}\n\n\t\tif (crafty_cfg.advanced.county_data == 'none') {\n\t\t\tjQuery('#'+this.fields.county_id).val('')\n\t\t}\n\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t// trigger change event on address fields to satisfy magento required fields\n\t\tjQuery('#'+this.cp_obj.config[\"elem_company\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_street1\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_street2\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_postcode\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_town\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_county\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_country\"]).trigger('change');\n\t}\n\n\tthis.result_error = function() {\n\t\t// apply magento error styling\n\t\tlet error = jQuery('#' + this.misc.prefix + '_cp_result_display').text();\n\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').text('');\n\t\tjQuery('#' + this.misc.prefix +'_cp_result_display').siblings('.mage-error').children('.search-subtext').text(error);\n\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').show();\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\t}\n}\n\n\nactivate_cc = function() {\n\tif (jQuery('#checkout-step-shipping').find('[name=\"postcode\"]').length == 1) {\n\t\t// Step 3 - now that we know this form exists, create an instance from our constructor\n\t\tvar cc1 = new CraftyClicksMagento2Class();\n\t\t// Step 4 - run the add_lookup method on our instance and pass it field id's\n\t\tcc1.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('#checkout-step-shipping').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('#checkout-step-shipping').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('#checkout-step-shipping').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('#checkout-step-shipping').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('#checkout-step-shipping').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('#checkout-step-shipping').find('[name=\"region\"]').attr('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('#checkout-step-shipping').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_id\":\t\t\t\"checkout-step-shipping\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"shipping\"\n\t\t\t}\n\t\t});\n\t}\n\n\tif (jQuery('#checkout-step-payment').find('[name=\"postcode\"]').length == 1) {\n\t\tvar cc2 = new CraftyClicksMagento2Class();\n\t\tcc2.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('#checkout-step-payment').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('#checkout-step-payment').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('#checkout-step-payment').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"address_3_id\":\t\tjQuery('#checkout-step-shipping').find('[name=\"street[2]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('#checkout-step-payment').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('#checkout-step-payment').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('#checkout-step-payment').find('[name=\"region\"]').attr('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('#checkout-step-payment').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_id\":\t\t\t\"checkout-step-payment\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"payment\"\n\t\t\t}\n\t\t});\n\t}\n}\n\nrequirejs(['jquery'], function($) {\n\tjQuery(document).ready(function() {\n\t\t// Step 1 - check crafty is enabled\n\t\tif (crafty_cfg.enabled) {\n\t\t\t// Step 2 - page takes a while to load, so continuously check for forms\n\t\t\tsetInterval(activate_cc, 200);\n\t\t}\n\n\t});\n});","Craftyclicks_Ukpostcodelookup/form_integrations/cc_customer_address.js":"/*\n// This is a collection of JavaScript code to allow easy integration of\n// the Crafty Clicks postcode / address finder functionality into Magento 2\n//\n// Provided by www.CraftyClicks.co.uk\n//\n// Requires standard CraftyClicks JS - tested with v4.9.3\n//\n// If you copy/use/modify this code - please keep this\n// comment header in place\n//\n// Copyright (c) 2009-2018 Crafty Clicks (http://www.craftyclicks.com)\n//\n// This code relies on jQuery, you must have a reasonably recent version loaded\n// in your template. Magento should include it as standard.\n//\n// If you need any help, contact support@craftyclicks.co.uk - we will help!\n//\n**********************************************************************************/\n\nfunction CraftyClicksMagento2Class() {\n\tthis.current_setup = 'initial';\n\n\t// initial page setup\n\tthis.initial_setup =function() {\n\t\t// move fields\n\t\tjQuery('#' + this.fields.company_id).closest('.field').before(jQuery('#' + this.fields.country_id).closest('.field'));\n\t\tjQuery('#' + this.fields.company_id).closest('.field').before(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\t}\n\n\tthis.setup_for_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('uk' != this.current_setup) {\n\t\t\t// do the magic for UK\n\n\t\t\t// add placeholder\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('placeholder', crafty_cfg.txt.search_placeholder);\n\n\t\t\t// check if button already exists\n\t\t\tif (jQuery('#cp_button_id').length == 0) {\n\t\t\t\tjQuery('#'+this.fields.postcode_id).wrap('<div class=\"search-bar\"></div>');\n\n\t\t\t\t// add button BEFORE postcode input (prevents m2 postcode validation from hijacking cc button)\n\t\t\t\tvar tmp_html = '<button id=\"cp_button_id\" type=\"button\" class=\"action primary\"><span>' + crafty_cfg.txt.search_buttontext + '</span></button>';\n\t\t\t\tjQuery('#'+this.fields.postcode_id).before(tmp_html);\n\n\t\t\t\t// add click event listener to button\n\t\t\t\tvar el = document.getElementById('cp_button_id');\n\t\t\t\tif (el != null) {\n\t\t\t\t\tel.addEventListener('click', this.button_clicked.bind(this));\n\t\t\t\t}\n\n\t\t\t\t// add search-list and mage-error after search-bar\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.search-bar').after('<div id=\"cp_result_display\" class=\"search-list\"></div>');\n\n\t\t\t\tjQuery('#cp_result_display').after('<div class=\"search-list\" style=\"display: none;\"><select></select></div>'+\n\t\t\t\t'<div id=\"cc_' + this.misc.prefix + '_error\" class=\"mage-error\" generated><div class=\"search-subtext\"></div></div>');\n\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.field').addClass('search-container type_3')\n\n\t\t\t\t// move m2 error field after zip (fix to prevent m2 postcode validation hijacking cc button)\n\t\t\t\tvar warningElem = jQuery('#'+this.fields.postcode_id).closest('.form-address-edit').find('div .warning')\n\t\t\t\tjQuery('#'+this.fields.postcode_id).after(warningElem)\n\n\t\t\t} else {\n\t\t\t\tjQuery('#cp_button_id').show();\n\t\t\t\tjQuery('#cp_result_display').show();\n\t\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').addClass(\"search-container type_3\");\n\t\t\t}\n\t\t}\n\n\t\tthis.current_setup = 'uk';\n\t}\n\n\tthis.setup_for_non_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('non_uk' != this.current_setup) {\n\t\t\t// hide button and result box if they exist\n\t\t\tif (jQuery('#cp_button_id').length == 1) {\n\t\t\t\tjQuery('#cp_button_id').hide();\n\t\t\t}\n\n\t\t\tif (jQuery('#cp_result_display').length == 1) {\n\t\t\t\tjQuery('#cp_result_display').hide();\n\t\t\t}\n\n\t\t\tjQuery('#cp_result_display').children('select').remove();\n\n\t\t\t// reset postcode input width\n\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').removeClass(\"search-container type_3\");\n\n\t\t\tthis.current_setup = 'non_uk';\n\t\t}\n\t}\n\n\tthis.add_lookup = function(setup) {\n\t\t// Step 5 - make sure we only do add_lookup once per instance\n\t\tif (jQuery('#'+setup.fields.postcode_id).attr('cc-applied') == \"1\") {\n\t\t\treturn\n\t\t}\n\t\tcp_obj = CraftyPostcodeCreate(); // instantiate library magic\n\t\tthis.cp_obj = cp_obj;\n\t\t// config\n\t\tthis.fields = setup.fields;\n\t\tthis.misc = setup.misc;\n\n\t\t// the set method is shorthand and is equivalent to cp_obj.config['configItem'] = configValue;\n\t\tcp_obj.set(\"result_elem_id\", \"cp_result_display\");\n\t\tcp_obj.set(\"form\", \"\");\n\t\tcp_obj.set(\"elem_company\", this.fields.company_id);\n\t\tcp_obj.set(\"elem_street1\", this.fields.address_1_id);\n\t\tcp_obj.set(\"elem_street2\", this.fields.address_2_id);\n\t\tcp_obj.set(\"elem_postcode\", this.fields.postcode_id);\n\t\tcp_obj.set(\"elem_town\", this.fields.town_id);\n\t\tcp_obj.set(\"elem_country\", this.fields.country_id);\n\n\t\tif (crafty_cfg.advanced.county_data !== 'none') {\n\t\t\tcp_obj.set(\"elem_county\", this.fields.county_id);\n\t\t}\n\n\t\tcp_obj.set(\"container_elem\", this.misc.container_elem);\n\n\t\tcp_obj.set(\"access_token\", crafty_cfg.key);\n\t\tcp_obj.set(\"res_autoselect\", \"0\");\n\t\tcp_obj.set(\"single_res_autoselect\" , 0);\n\t\tcp_obj.set(\"max_lines\" , 1);\n\n\t\tif (crafty_cfg.advanced.county_data == 'traditional') {\n\t\t\tcp_obj.set(\"traditional_county\" , 1);\n\t\t} else if (crafty_cfg.advanced.county_data == 'former_postal') {\n\t\t\tcp_obj.set(\"traditional_county\" , 0);\n\t\t}\n\n\t\tcp_obj.set(\"busy_img_url\" , null);\n\t\tcp_obj.set(\"hide_result\" , false);\n\t\tcp_obj.set(\"on_result_ready\", this.result_ready.bind(this));\n\t\tcp_obj.set(\"on_result_selected\", this.result_selected.bind(this));\n\t\tcp_obj.set(\"on_error\", this.result_error.bind(this));\n\t\tcp_obj.set(\"first_res_line\", '---- please select your address ----');\n\t\tcp_obj.set(\"err_msg1\", crafty_cfg.error_msg['0001']);\n\t\tcp_obj.set(\"err_msg2\", crafty_cfg.error_msg['0002']);\n\t\tcp_obj.set(\"err_msg3\", crafty_cfg.error_msg['0003']);\n\t\tcp_obj.set(\"err_msg4\", crafty_cfg.error_msg['0004']);\n\t\tcp_obj.set(\"max_width\", \"100%\");\n\n\t\t// do initial setup\n\t\tthis.initial_setup();\n\n\t\t// do setup for current country\n\t\tthis.country_changed();\n\n\t\t// listen for country changes\n\t\tvar countryEl = document.getElementById(this.fields.country_id);\n\t\tcountryEl.addEventListener('change', this.country_changed.bind(this));\n\n\t\tjQuery('#'+setup.fields.postcode_id).attr('cc-applied', '1');\n\t}\n\n\tthis.country_changed = function(e) {\n\t\t// show postcode lookup for:\n\t\t// \"GB\" UK\n\t\t// \"JE\" Jersey\n\t\t// \"GG\" Guernsey\n\t\t// \"IM\" Isle of Man\n\t\tvar curr_country = jQuery('#' + this.fields.country_id).val();\n\t\tif ('GB' == curr_country || 'JE' == curr_country || 'GG' == curr_country || 'IM' == curr_country) {\n\t\t\tthis.setup_for_uk();\n\t\t} else {\n\t\t\tthis.setup_for_non_uk();\n\t\t}\n\t}\n\n\tthis.button_clicked = function() {\n\t\tthis.cp_obj.doLookup();\n\t}\n\n\tthis.result_ready = function() {\n\t\tjQuery('#crafty_postcode_lookup_result_option1').addClass('admin__control-select');\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').hide();\n\t}\n\n\tthis.result_selected = function() {\n\t\t// update country field if user selects address from GG/JE, etc.\n\t\tswitch(jQuery('#' + this.fields.postcode_id).val().substring(0,2)){\n\t\t\tcase \"GY\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"GG\");\n\t\t\t\tbreak;\n\t\t\tcase \"JE\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"JE\");\n\t\t\t\tbreak;\n\t\t\tcase \"IM\":\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"IM\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tjQuery('#' + this.fields.country_id).val(\"GB\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (crafty_cfg.advanced.county_data == 'none') {\n\t\t\tjQuery('#'+this.fields.county_id).val('')\n\t\t}\n\n\t\t// trigger change event on address fields to satisfy magento required fields\n\t\tjQuery('#'+this.fields.company_id).trigger('change');\n\t\tjQuery('#'+this.fields.address_1_id).trigger('change');\n\t\tjQuery('#'+this.fields.address_2_id).trigger('change');\n\t\tjQuery('#'+this.fields.postcode_id).trigger('change');\n\t\tjQuery('#'+this.fields.town_id).trigger('change');\n\t\tjQuery('#'+this.fields.county_id).trigger('change');\n\t\tjQuery('#'+this.fields.country_id).trigger('change');\n\t}\n\n\tthis.result_error = function() {\n\t\t// apply magento error styling\n\t\tlet error = jQuery('#cp_result_display').text();\n\t\tjQuery('#cp_result_display').text('');\n\t\tjQuery('#cp_result_display').siblings('.mage-error').children('.search-subtext').text(error);\n\t\tjQuery('#cp_result_display').siblings('.mage-error').css('display', 'block');\n\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').show();\n\t}\n}\n\n\nactivate_cc = function() {\n\tif (jQuery('#form-validate').find('[name=\"postcode\"]').length == 1) {\n\t\t// Step 3 - now that we know this form exists, create an instance from our constructor\n\t\tvar cc1 = new CraftyClicksMagento2Class();\n\t\t// Step 4 - run the add_lookup method on our instance and pass it field id's\n\t\tcc1.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\t\"company\",\n\t\t\t\t\"address_1_id\":\t\t\"street_1\",\n\t\t\t\t\"address_2_id\":\t\t\"street_2\",\n\t\t\t\t\"postcode_id\":\t\t\"zip\",\n\t\t\t\t\"town_id\":\t\t\t\t\"city\",\n\t\t\t\t\"county_id\":\t\t\t\"region\",\n\t\t\t\t\"country_id\":\t\t\t\"country\",\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_id\":\t\"form-validate\"\n\t\t\t}\n\t\t});\n\t}\n}\n\nrequirejs(['jquery'], function($) {\n\tjQuery(document).ready(function() {\n\t\t// Step 1 - check crafty is enabled\n\t\tif (crafty_cfg.enabled) {\n\t\t\t// Step 2 - page takes a while to load, so continuously check for form\n\t\t\tsetInterval(activate_cc, 200);\n\t\t}\n\t});\n});","Craftyclicks_Ukpostcodelookup/form_integrations/cc_aheadworks_checkout.js":"/*\n// This is a collection of JavaScript code to allow easy integration of\n// the Crafty Clicks postcode / address finder functionality into \n// OneStepCheckout by Aheadworks for Magento 2. Tested with OneStepCheckout\n// version 1.2.0.\n//\n// This file works for the standard magento 2 checkout (both community and enterprise)\n//\n// Provided by www.CraftyClicks.co.uk\n//\n// Requires standard CraftyClicks JS - tested with v4.9.3\n//\n// If you copy/use/modify this code - please keep this\n// comment header in place\n//\n// Copyright (c) 2009-2018 Crafty Clicks (http://www.craftyclicks.com)\n//\n// This code relies on jQuery, you must have a reasonably recent version loaded\n// in your template. Magento should include it as standard.\n//\n// If you need any help, contact support@craftyclicks.co.uk - we will help!\n//\n**********************************************************************************/\nfunction CraftyClicksMagento2Class() {\n\tthis.current_setup = 'initial';\n\n\t// initial page setup\n\tthis.initial_setup =function() {\n\t\t// move country field to top\n\t\tjQuery('#' + this.misc.container_class).find('[name=\"lastname\"]').closest('.field').after(jQuery('#' + this.fields.country_id).closest('.field'));\n\t\t// if hide fields is true, move telephone field up\n\t\tif (crafty_cfg.hide_fields) {\n\t\t\tjQuery('#' + this.fields.country_id).closest('.field').before(jQuery('#' + this.misc.container_class).find('[name=\"telephone\"]').closest('.field'));\n\t\t}\n\n\t\t// add cp address class to fields and labels so we can easily grab them for the hide fields feature\n\t\tvar that = this;\n\t\tjQuery.each(this.fields, function(index, value) {\n\t\t\tif (value !== that.fields.postcode_id && value !== that.fields.country_id) {\n\t\t\t\tjQuery('#' + value).closest('.control').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\tjQuery('#' + value).closest('.control').prev('label').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\tif (value == that.fields.address_1_id) {\n\t\t\t\t\tjQuery('#' + value).closest('.control').parent().closest('.control').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\t\tjQuery('#' + value).closest('.control').parent().closest('.control').prev('.label').addClass(that.misc.prefix + '_cp_address_class');\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tthis.setup_for_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('uk' != this.current_setup) {\n\t\t\t// do the magic for UK\n\n\t\t\t// move postcode to show after country and add placeholder\n\t\t\tjQuery('#' + this.fields.country_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('placeholder', crafty_cfg.txt.search_placeholder);\n\n\t\t\t// move state to show on same row as city\n\t\t\tjQuery('#' + this.fields.town_id).closest('.field').after(jQuery('#' + this.fields.county_id).closest('.field'))\n\n\t\t\t// move row containing country and postcode to top\n\t\t\tjQuery('#' + this.fields.address_1_id).closest('.field-row').before(jQuery('#' + this.fields.postcode_id).closest('.field-row'))\n\n\t\t\t// disable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'new-password')\n\n\t\t\t// check if button already exists\n\t\t\t// Step 6 - add prefix to button and result display so they are unique\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 0) {\n\t\t\t\tjQuery('#'+this.fields.postcode_id).wrap('<div class=\"search-bar\"></div>');\n\n\t\t\t\t// add button after postcode input\n\t\t\t\tvar tmp_html = '<button id=\"' + this.misc.prefix + '_cp_button_id\" type=\"button\" class=\"action primary\" style=\"height: 44px\"><span>' + crafty_cfg.txt.search_buttontext + '</span></button>';\n\t\t\t\tjQuery('#'+this.fields.postcode_id).after(tmp_html);\n\n\t\t\t\t// add click event listener to button\n\t\t\t\tvar el = document.getElementById(this.misc.prefix + '_cp_button_id');\n\t\t\t\tif (el != null) {\n\t\t\t\t\tel.addEventListener('click', this.button_clicked.bind(this));\n\t\t\t\t}\n\n\t\t\t\t// add search-list and mage-error after search-bar\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.search-bar').after('<div id=\"' + this.misc.prefix + '_cp_result_display\" class=\"search-list\"></div>');\n\n\t\t\t\tjQuery('#'+this.misc.prefix + '_cp_result_display').after('<div class=\"search-list\" style=\"display: none;\"><select></select></div>'+\n\t\t\t\t'<div id=\"cc_' + this.misc.prefix + '_error\" class=\"mage-error\" generated><div class=\"search-subtext\"></div></div>');\n\n\t\t\t\tjQuery('#'+this.fields.postcode_id).closest('.field').addClass('search-container type_3')\n\t\t\t} else {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').show();\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').show();\n\t\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').addClass(\"search-container type_3\");\n\t\t\t}\n\t\t}\n\n\t\tif ('initial' == this.current_setup && crafty_cfg.hide_fields) {\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').hide();\n\t\t} else if ('non_uk' == this.current_setup && crafty_cfg.hide_fields && jQuery('#' + this.fields.postcode_id).val() === \"\") {\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').hide();\n\t\t}\n\n\t\t// modify search input width for aheadworks\n\t\tjQuery('.search-bar').children('.input-text').attr('style', 'width: 64% !important')\n\t\t\n\t\t// hide error to avoid blank vertical space\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').hide();\n\n\t\tthis.current_setup = 'uk';\n\t}\n\n\tthis.setup_for_non_uk = function() {\n\t\t// check if we need to do anything\n\t\tif ('non_uk' != this.current_setup) {\n\t\t\t// move postcode field to show after region\n\t\t\tjQuery('#' + this.fields.county_id).closest('.field').after(jQuery('#' + this.fields.postcode_id).closest('.field'));\n\n\t\t\t// disable autofill\n\t\t\tjQuery('#' + this.fields.postcode_id).attr('autocomplete', 'postal-code')\n\n\t\t\t// hide button and result box if they exist\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_button_id').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_button_id').hide();\n\t\t\t}\n\n\t\t\tif (jQuery('#' + this.misc.prefix + '_cp_result_display').length == 1) {\n\t\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').hide();\n\t\t\t}\n\n\t\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').children('select').remove();\n\n\t\t\t// reset postcode input width\n\t\t\tjQuery('#' + this.fields.postcode_id).closest('.field').removeClass(\"search-container type_3\");\n\n\t\t\t// show fields\n\t\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t\t// modify search input width for aheadworks\n\t\t\tjQuery('.search-bar').children('.input-text').attr('style', '')\n\n\t\t\t// hide error to avoid blank vertical space\n\t\t\tjQuery('#cc_' + this.misc.prefix + '_error').hide();\n\n\t\t\tthis.current_setup = 'non_uk';\n\t\t}\n\t}\n\n\tthis.add_lookup = function(setup) {\n\t\t// Step 5 - make sure we only do add_lookup once per instance\n\t\tif (jQuery('#'+setup.fields.postcode_id).attr('cc-applied') == \"1\") {\n\t\t\treturn\n\t\t}\n\t\tcp_obj = CraftyPostcodeCreate(); // instantiate library magic\n\t\tthis.cp_obj = cp_obj;\n\t\t// config\n\t\tthis.fields = setup.fields;\n\t\tthis.misc = setup.misc;\n\n\t\t// the set method is shorthand and is equivalent to cp_obj.config['configItem'] = configValue;\n\t\tcp_obj.set(\"result_elem_id\", this.misc.prefix + \"_cp_result_display\");\n\t\tcp_obj.set(\"form\", \"\");\n\t\tcp_obj.set(\"elem_company\", this.fields.company_id);\n\t\tcp_obj.set(\"elem_street1\", this.fields.address_1_id);\n\t\tcp_obj.set(\"elem_street2\", this.fields.address_2_id);\n\t\tcp_obj.set(\"elem_postcode\", this.fields.postcode_id);\n\t\tcp_obj.set(\"elem_town\", this.fields.town_id);\n\t\tcp_obj.set(\"elem_country\", this.fields.country_id);\n\t\tcp_obj.set(\"elem_county\", this.fields.county_id);\n\n\t\tcp_obj.set(\"prefix\", this.misc.prefix);\n\n\t\tcp_obj.set(\"access_token\", crafty_cfg.key);\n\t\tcp_obj.set(\"res_autoselect\", \"0\");\n\t\tcp_obj.set(\"single_res_autoselect\" , 0);\n\t\tcp_obj.set(\"max_lines\" , 1);\n\n\t\tif (crafty_cfg.advanced.county_data == 'traditional') {\n\t\t\tcp_obj.set(\"traditional_county\" , 1);\n\t\t} else if (crafty_cfg.advanced.county_data == 'former_postal') {\n\t\t\tcp_obj.set(\"traditional_county\" , 0);\n\t\t}\n\n\t\tcp_obj.set(\"busy_img_url\" , null);\n\t\tcp_obj.set(\"hide_result\" , false);\n\t\tcp_obj.set(\"on_result_ready\", this.result_ready.bind(this));\n\t\tcp_obj.set(\"on_result_selected\", this.result_selected.bind(this));\n\t\tcp_obj.set(\"on_error\", this.result_error.bind(this));\n\t\tcp_obj.set(\"first_res_line\", '---- please select your address ----');\n\t\tcp_obj.set(\"err_msg1\", crafty_cfg.error_msg['0001']);\n\t\tcp_obj.set(\"err_msg2\", crafty_cfg.error_msg['0002']);\n\t\tcp_obj.set(\"err_msg3\", crafty_cfg.error_msg['0003']);\n\t\tcp_obj.set(\"err_msg4\", crafty_cfg.error_msg['0004']);\n\t\tcp_obj.set(\"max_width\", \"100%\");\n\n\t\t// do initial setup\n\t\tthis.initial_setup();\n\n\t\t// do setup for current country\n\t\tthis.country_changed();\n\n\t\t// listen for country changes\n\t\tvar countryEl = document.getElementById(this.fields.country_id);\n\t\tcountryEl.addEventListener('change', this.country_changed.bind(this));\n\n\t\tjQuery('#'+setup.fields.postcode_id).attr('cc-applied', '1');\n\t}\n\n\tthis.country_changed = function(e) {\n\t\t// show postcode lookup for:\n\t\t// \"GB\" UK\n\t\t// \"JE\" Jersey\n\t\t// \"GG\" Guernsey\n\t\t// \"IM\" Isle of Man\n\t\tvar curr_country = jQuery('#' + this.fields.country_id).val();\n\t\tif ('GB' == curr_country || 'JE' == curr_country || 'GG' == curr_country || 'IM' == curr_country) {\n\t\t\tthis.setup_for_uk();\n\t\t} else {\n\t\t\tthis.setup_for_non_uk();\n\t\t}\n\t}\n\n\tthis.button_clicked = function() {\n\t\tthis.cp_obj.doLookup();\n\t}\n\n\tthis.result_ready = function() {\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').hide();\n\t}\n\n\tthis.result_selected = function() {\n\t\t// update country field if user selects address from GG/JE, etc.\n\t\tswitch(jQuery('#' + this.fields.postcode_id).val().substring(0,2)){\n\t\t\tcase \"GY\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"GG\");\n\t\t\tbreak;\n\t\t\tcase \"JE\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"JE\");\n\t\t\tbreak;\n\t\t\tcase \"IM\":\n\t\t\tjQuery('#' + this.fields.country_id).val(\"IM\");\n\t\t\tbreak;\n\t\t\tdefault:\n\t\t\tjQuery('#' + this.fields.country_id).val(\"GB\");\n\t\t\tbreak;\n\t\t}\n\n\t\tif (crafty_cfg.advanced.county_data == 'none') {\n\t\t\tjQuery('#'+this.fields.county_id).val('')\n\t\t}\n\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\n\t\t// trigger change event on address fields to satisfy magento required fields\n\t\tjQuery('#'+this.cp_obj.config[\"elem_company\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_street1\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_street2\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_postcode\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_town\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_county\"]).trigger('change');\n\t\tjQuery('#'+this.cp_obj.config[\"elem_country\"]).trigger('change');\n\t}\n\n\tthis.result_error = function() {\n\t\t// apply magento error styling\n\t\tlet error = jQuery('#' + this.misc.prefix + '_cp_result_display').text();\n\t\tjQuery('#' + this.misc.prefix + '_cp_result_display').text('');\n\t\tjQuery('#' + this.misc.prefix +'_cp_result_display').siblings('.mage-error').children('.search-subtext').text(error);\n\n\t\tjQuery('#cc_' + this.misc.prefix + '_error').show();\n\t\tjQuery('.' + this.misc.prefix + '_cp_address_class').show();\n\t}\n}\n\n\nactivate_cc = function() {\n\tif (jQuery('.onestep-shipping-address').find('[name=\"postcode\"]').length == 1 &&\n\tjQuery('.onestep-shipping-address').find('[name=\"street[0]\"]').length == 1) {\n\t\t// Step 3 - now that we know this form exists, create an instance from our constructor\n\t\tvar cc1 = new CraftyClicksMagento2Class();\n\t\t// Step 4 - run the add_lookup method on our instance and pass it field id's\n\t\tcc1.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('.onestep-shipping-address').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('.onestep-shipping-address').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('.onestep-shipping-address').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('.onestep-shipping-address').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('.onestep-shipping-address').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('.onestep-shipping-address').find('[name=\"region\"]')[1].getAttribute('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('.onestep-shipping-address').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_class\":\t\t\t\"onestep-shipping-address\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"shipping\"\n\t\t\t}\n\t\t});\n\t}\n\n\tif (jQuery('.onestep-billing-address').find('[name=\"postcode\"]').length == 1 &&\n\tjQuery('.onestep-shipping-address').find('[name=\"street[0]\"]').length == 1) {\n\t\tvar cc2 = new CraftyClicksMagento2Class();\n\t\tcc2.add_lookup({\n\t\t\t\"fields\": {\n\t\t\t\t\"company_id\":\t\t\tjQuery('.onestep-billing-address').find('[name=\"company\"]').attr('id'),\n\t\t\t\t\"address_1_id\":\t\tjQuery('.onestep-billing-address').find('[name=\"street[0]\"]').attr('id'),\n\t\t\t\t\"address_2_id\":\t\tjQuery('.onestep-billing-address').find('[name=\"street[1]\"]').attr('id'),\n\t\t\t\t\"address_3_id\":\t\tjQuery('.onestep-billing-address').find('[name=\"street[2]\"]').attr('id'),\n\t\t\t\t\"postcode_id\":\t\tjQuery('.onestep-billing-address').find('[name=\"postcode\"]').attr('id'),\n\t\t\t\t\"town_id\":\t\t\t\tjQuery('.onestep-billing-address').find('[name=\"city\"]').attr('id'),\n\t\t\t\t\"county_id\":\t\t\tjQuery('.onestep-billing-address').find('[name=\"region\"]')[1].getAttribute('id'),\n\t\t\t\t\"country_id\":\t\t\tjQuery('.onestep-billing-address').find('[name=\"country_id\"]').attr('id'),\n\t\t\t},\n\t\t\t\"misc\": {\n\t\t\t\t\"container_class\":\t\t\t\"onestep-billing-address\",\n\t\t\t\t\"prefix\":\t\t\t\t\t\t\"payment\"\n\t\t\t}\n\t\t});\n\t}\n}\n\nrequirejs(['jquery'], function($) {\n\tjQuery(document).ready(function() {\n\t\t// Step 1 - check crafty is enabled\n\t\tif (crafty_cfg.enabled) {\n\t\t\t// Step 2 - page takes a while to load, so continuously check for forms\n\t\t\tsetInterval(activate_cc, 200);\n\t\t}\n\n\t});\n});","Magento_Msrp/js/msrp.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'jquery',\n    'Magento_Catalog/js/price-utils',\n    'underscore',\n    'jquery-ui-modules/widget',\n    'mage/dropdown',\n    'mage/template'\n], function ($, priceUtils, _) {\n    'use strict';\n\n    $.widget('mage.addToCart', {\n        options: {\n            showAddToCart: true,\n            submitUrl: '',\n            cartButtonId: '',\n            singleOpenDropDown: true,\n            dialog: {}, // Options for mage/dropdown\n            dialogDelay: 500, // Delay in ms after resize dropdown shown again\n            origin: '', //Required, type of popup: 'msrp', 'tier' or 'info' popup\n\n            // Selectors\n            cartForm: '.form.map.checkout',\n            msrpLabelId: '#map-popup-msrp',\n            msrpPriceElement: '#map-popup-msrp .price-wrapper',\n            priceLabelId: '#map-popup-price',\n            priceElement: '#map-popup-price .price',\n            mapInfoLinks: '.map-show-info',\n            displayPriceElement: '.old-price.map-old-price .price-wrapper',\n            fallbackPriceElement: '.normal-price.map-fallback-price .price-wrapper',\n            displayPriceContainer: '.old-price.map-old-price',\n            fallbackPriceContainer: '.normal-price.map-fallback-price',\n            popUpAttr: '[data-role=msrp-popup-template]',\n            popupCartButtonId: '#map-popup-button',\n            paypalCheckoutButons: '[data-action=checkout-form-submit]',\n            popupId: '',\n            realPrice: '',\n            isSaleable: '',\n            msrpPrice: '',\n            helpLinkId: '',\n            addToCartButton: '',\n\n            // Text options\n            productName: '',\n            addToCartUrl: ''\n        },\n\n        openDropDown: null,\n        triggerClass: 'dropdown-active',\n\n        popUpOptions: {\n            appendTo: 'body',\n            dialogContentClass: 'active',\n            closeOnMouseLeave: false,\n            autoPosition: true,\n            closeOnClickOutside: false,\n            'dialogClass': 'popup map-popup-wrapper',\n            position: {\n                my: 'left top',\n                collision: 'fit none',\n                at: 'left bottom',\n                within: 'body'\n            },\n            shadowHinter: 'popup popup-pointer'\n        },\n        popupOpened: false,\n        wasOpened: false,\n\n        /**\n         * Creates widget instance\n         *\n         * @private\n         */\n        _create: function () {\n            if (this.options.origin === 'msrp') {\n                this.initMsrpPopup();\n            } else if (this.options.origin === 'info') {\n                this.initInfoPopup();\n            } else if (this.options.origin === 'tier') {\n                this.initTierPopup();\n            }\n            $(this.options.cartButtonId).on('click', this._addToCartSubmit.bind(this));\n            $(document).on('updateMsrpPriceBlock', this.onUpdateMsrpPrice.bind(this));\n            $(this.options.cartForm).on('submit', this._onSubmitForm.bind(this));\n        },\n\n        /**\n         * Init msrp popup\n         *\n         * @private\n         */\n        initMsrpPopup: function () {\n            var popupDOM = $(this.options.popUpAttr)[0],\n                $msrpPopup = $(popupDOM.innerHTML.trim());\n\n            $msrpPopup.find(this.options.productIdInput).val(this.options.productId);\n            $('body').append($msrpPopup);\n            $msrpPopup.trigger('contentUpdated');\n\n            $msrpPopup.find('button')\n                .on('click',\n                    this.handleMsrpAddToCart.bind(this))\n                .filter(this.options.popupCartButtonId)\n                .text($(this.options.addToCartButton).text());\n\n            $msrpPopup.find(this.options.paypalCheckoutButons).on('click',\n                this.handleMsrpPaypalCheckout.bind(this));\n\n            $(this.options.popupId).on('click',\n                this.openPopup.bind(this));\n\n            this.$popup = $msrpPopup;\n        },\n\n        /**\n         * Init info popup\n         *\n         * @private\n         */\n        initInfoPopup: function () {\n            var infoPopupDOM = $('[data-role=msrp-info-template]')[0],\n                $infoPopup = $(infoPopupDOM.innerHTML.trim());\n\n            $('body').append($infoPopup);\n\n            $(this.options.helpLinkId).on('click', function (e) {\n                this.popUpOptions.position.of = $(e.target);\n                $infoPopup.dropdownDialog(this.popUpOptions).dropdownDialog('open');\n                this._toggle($infoPopup);\n            }.bind(this));\n\n            this.$popup = $infoPopup;\n        },\n\n        /**\n         * Init tier price popup\n         * @private\n         */\n        initTierPopup: function () {\n            var popupDOM = $(this.options.popUpAttr)[0],\n                $tierPopup = $(popupDOM.innerHTML.trim());\n\n            $('body').append($tierPopup);\n            $tierPopup.find(this.options.productIdInput).val(this.options.productId);\n            this.popUpOptions.position.of = $(this.options.helpLinkId);\n\n            $tierPopup.find('button').on('click',\n                this.handleTierAddToCart.bind(this))\n                .filter(this.options.popupCartButtonId)\n                .text($(this.options.addToCartButton).text());\n\n            $tierPopup.find(this.options.paypalCheckoutButons).on('click',\n                this.handleTierPaypalCheckout.bind(this));\n\n            $(this.options.attr).on('click', function (e) {\n                this.$popup = $tierPopup;\n                this.tierOptions = $(e.target).data('tier-price');\n                this.openPopup(e);\n            }.bind(this));\n        },\n\n        /**\n         * handle 'AddToCart' click on Msrp popup\n         * @param {Object} ev\n         *\n         * @private\n         */\n        handleMsrpAddToCart: function (ev) {\n            ev.preventDefault();\n\n            if (this.options.addToCartButton) {\n                $(this.options.addToCartButton).trigger('click');\n                this.closePopup(this.$popup);\n            }\n        },\n\n        /**\n         * handle 'paypal checkout buttons' click on Msrp popup\n         *\n         * @private\n         */\n        handleMsrpPaypalCheckout: function () {\n            this.closePopup(this.$popup);\n        },\n\n        /**\n         * handle 'AddToCart' click on Tier popup\n         *\n         * @param {Object} ev\n         * @private\n         */\n        handleTierAddToCart: function (ev) {\n            ev.preventDefault();\n\n            if (this.options.addToCartButton &&\n                this.options.inputQty && !isNaN(this.tierOptions.qty)\n            ) {\n                $(this.options.inputQty).val(this.tierOptions.qty);\n                $(this.options.addToCartButton).trigger('click');\n                this.closePopup(this.$popup);\n            }\n        },\n\n        /**\n         * handle 'paypal checkout buttons' click on Tier popup\n         *\n         * @private\n         */\n        handleTierPaypalCheckout: function () {\n            if (this.options.inputQty && !isNaN(this.tierOptions.qty)\n            ) {\n                $(this.options.inputQty).val(this.tierOptions.qty);\n                this.closePopup(this.$popup);\n            }\n        },\n\n        /**\n         * Open and set up popup\n         *\n         * @param {Object} event\n         */\n        openPopup: function (event) {\n            var options = this.tierOptions || this.options;\n\n            this.popUpOptions.position.of = $(event.target);\n\n            if (!this.wasOpened) {\n                this.$popup.find(this.options.msrpLabelId).html(options.msrpPrice);\n                this.$popup.find(this.options.priceLabelId).html(options.realPrice);\n                this.wasOpened = true;\n            }\n            this.$popup.dropdownDialog(this.popUpOptions).dropdownDialog('open');\n            this._toggle(this.$popup);\n\n            if (!this.options.isSaleable) {\n                this.$popup.find('form').hide();\n            }\n        },\n\n        /**\n         * Toggle MAP popup visibility\n         *\n         * @param {HTMLElement} $elem\n         * @private\n         */\n        _toggle: function ($elem) {\n            $(document).on('mouseup.msrp touchend.msrp', function (e) {\n                if (!$elem.is(e.target) && $elem.has(e.target).length === 0) {\n                    this.closePopup($elem);\n                }\n            }.bind(this));\n            $(window).on('resize', function () {\n                this.closePopup($elem);\n            }.bind(this));\n        },\n\n        /**\n         * Close MAP information popup\n         *\n         * @param {HTMLElement} $elem\n         */\n        closePopup: function ($elem) {\n            $elem.dropdownDialog('close');\n            $(document).off('mouseup.msrp touchend.msrp');\n        },\n\n        /**\n         * Handler for addToCart action\n         *\n         * @param {Object} e\n         */\n        _addToCartSubmit: function (e) {\n            this.element.trigger('addToCart', this.element);\n\n            if (this.element.data('stop-processing')) {\n                return false;\n            }\n\n            if (this.options.addToCartButton) {\n                $(this.options.addToCartButton).trigger('click');\n\n                return false;\n            }\n\n            if (this.options.addToCartUrl) {\n                $('.mage-dropdown-dialog > .ui-dialog-content').dropdownDialog('close');\n            }\n\n            e.preventDefault();\n            $(this.options.cartForm).trigger('submit');\n        },\n\n        /**\n         * Call on event updatePrice. Proxy to updateMsrpPrice method.\n         *\n         * @param {Event} event\n         * @param {mixed} priceIndex\n         * @param {Object} prices\n         * @param {Object|undefined} $priceBox\n         */\n        onUpdateMsrpPrice: function onUpdateMsrpPrice(event, priceIndex, prices, $priceBox) {\n\n            var defaultMsrp,\n                defaultPrice,\n                msrpPrice,\n                finalPrice;\n\n            defaultMsrp = _.chain(prices).map(function (price) {\n                return price.msrpPrice.amount;\n            }).reject(function (p) {\n                return p === null;\n            }).max().value();\n\n            defaultPrice = _.chain(prices).map(function (p) {\n                return p.finalPrice.amount;\n            }).min().value();\n\n            if (typeof priceIndex !== 'undefined') {\n                msrpPrice = prices[priceIndex].msrpPrice.amount;\n                finalPrice = prices[priceIndex].finalPrice.amount;\n\n                if (msrpPrice === null || msrpPrice <= finalPrice) {\n                    this.updateNonMsrpPrice(priceUtils.formatPriceLocale(finalPrice), $priceBox);\n                } else {\n                    this.updateMsrpPrice(\n                        priceUtils.formatPriceLocale(finalPrice),\n                        priceUtils.formatPriceLocale(msrpPrice),\n                        false,\n                        $priceBox);\n                }\n            } else {\n                this.updateMsrpPrice(\n                    priceUtils.formatPriceLocale(defaultPrice),\n                    priceUtils.formatPriceLocale(defaultMsrp),\n                    true,\n                    $priceBox);\n            }\n        },\n\n        /**\n         * Update prices for configurable product with MSRP enabled\n         *\n         * @param {String} finalPrice\n         * @param {String} msrpPrice\n         * @param {Boolean} useDefaultPrice\n         * @param {Object|undefined} $priceBox\n         */\n        updateMsrpPrice: function (finalPrice, msrpPrice, useDefaultPrice, $priceBox) {\n            var options = this.tierOptions || this.options;\n\n            $(this.options.fallbackPriceContainer, $priceBox).hide();\n            $(this.options.displayPriceContainer, $priceBox).show();\n            $(this.options.mapInfoLinks, $priceBox).show();\n\n            if (useDefaultPrice || !this.wasOpened) {\n                if (this.$popup) {\n                    this.$popup.find(this.options.msrpLabelId).html(options.msrpPrice);\n                    this.$popup.find(this.options.priceLabelId).html(options.realPrice);\n                }\n\n                $(this.options.displayPriceElement, $priceBox).html(msrpPrice);\n                this.wasOpened = true;\n            }\n\n            if (!useDefaultPrice) {\n                this.$popup.find(this.options.msrpPriceElement).html(msrpPrice);\n                this.$popup.find(this.options.priceElement).html(finalPrice);\n                $(this.options.displayPriceElement, $priceBox).html(msrpPrice);\n            }\n        },\n\n        /**\n         * Display non MAP price for irrelevant products\n         *\n         * @param {String} price\n         * @param {Object|undefined} $priceBox\n         */\n        updateNonMsrpPrice: function (price, $priceBox) {\n            $(this.options.fallbackPriceElement, $priceBox).html(price);\n            $(this.options.displayPriceContainer, $priceBox).hide();\n            $(this.options.mapInfoLinks, $priceBox).hide();\n            $(this.options.fallbackPriceContainer, $priceBox).show();\n        },\n\n        /**\n         * Handler for submit form\n         *\n         * @private\n         */\n        _onSubmitForm: function () {\n            if ($(this.options.cartForm).valid()) {\n                $(this.options.cartButtonId).prop('disabled', true);\n            }\n        }\n\n    });\n\n    return $.mage.addToCart;\n});\n","Magento_Msrp/js/product/list/columns/msrp-price.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'jquery',\n    'underscore',\n    'Magento_Catalog/js/product/list/columns/price-box',\n    'Magento_Catalog/js/product/addtocart-button',\n    'mage/dropdown'\n], function ($, _, PriceBox) {\n    'use strict';\n\n    return PriceBox.extend({\n        defaults: {\n            priceBoxSelector: '[data-role=msrp-price-box]',\n            popupTmpl: 'Magento_Msrp/product/item/popup',\n            popupTriggerSelector: '[data-role=msrp-popup-trigger]',\n            popupSelector: '[data-role=msrp-popup]',\n            popupOptions: {\n                appendTo: 'body',\n                dialogContentClass: 'active',\n                closeOnMouseLeave: false,\n                autoPosition: true,\n                dialogClass: 'popup map-popup-wrapper',\n                position: {\n                    my: 'left top',\n                    collision: 'fit none',\n                    at: 'left bottom',\n                    within: 'body'\n                },\n                shadowHinter: 'popup popup-pointer'\n            }\n        },\n\n        /**\n         * Create and open popup with Msrp information.\n         *\n         * @param {Object} data - element data\n         * @param {DOMElement} elem - element\n         * @param {Event} event - event object\n         */\n        openPopup: function (data, elem, event) {\n            var $elem = $(elem),\n                $popup = $elem.find(this.popupSelector),\n                $trigger = $elem.find(this.popupTriggerSelector);\n\n            event.stopPropagation();\n\n            this.popupOptions.position.of = $trigger;\n            this.popupOptions.triggerTarget = $trigger;\n\n            $popup.dropdownDialog(this.popupOptions)\n                  .dropdownDialog('open');\n        },\n\n        /**\n         * Set listeners.\n         *\n         * @param {DOMElement} elem - DOM element\n         * @param {Object} data - element data\n         */\n        initListeners: function (elem, data) {\n            var $trigger = $(elem).find(this.popupTriggerSelector);\n\n            $trigger.on('click', this.openPopup.bind(this, data, elem));\n        },\n\n        /**\n         * Check whether we can apply msrp, or should use standard price.\n         *\n         * @param {Object} row\n         * @returns {Bool}\n         */\n        isMsrpApplicable: function (row) {\n            return this.getPrice(row)['is_applicable'];\n        },\n\n        /**\n         * Retrieve msrp formatted price\n         *\n         * @param {Object} row\n         * @returns {String}\n         */\n        getPrice: function (row) {\n            return row['price_info']['extension_attributes'].msrp;\n        },\n\n        /**\n         * UnsanitizedHtml version of getPrice.\n         *\n         * @param {Object} row\n         * @returns {String}\n         */\n        getPriceUnsanitizedHtml: function (row) {\n            return this.getPrice(row);\n        },\n\n        /**\n         * Get msrp_price property of a price.\n         *\n         * @param {Object} row\n         * @return {HTMLElement} final price html\n         */\n        getMsrpPriceUnsanitizedHtml: function (row) {\n            return this.getPrice(row)['msrp_price'];\n        },\n\n        /**\n         * Returns path to the columns' body template.\n         *\n         * @returns {String}\n         */\n        getBody: function () {\n            return this.bodyTmpl;\n        },\n\n        /**\n         * Check if popup with actual price must be shown.\n         *\n         * @returns {Boolean}\n         */\n        isShowPriceOnGesture: function (row) {\n            return this.getPrice(row)['is_shown_price_on_gesture'];\n        },\n\n        /**\n         * Get msrp price supporting text.\n         *\n         * @returns {String}\n         */\n        getMsrpPriceMessage: function (row) {\n            return this.getPrice(row)['msrp_message'];\n        },\n\n        /**\n         * UnsanitizedHtml version of getMsrpPriceMessage.\n         *\n         * @returns {String}\n         */\n        getMsrpPriceMessageUnsanitizedHtml: function (row) {\n            return this.getMsrpPriceMessage(row);\n        },\n\n        /**\n         * Get msrp price supporting text, when actual price is hidden.\n         *\n         * @returns {String}\n         */\n        getExplanationMessage: function (row) {\n            return this.getPrice(row)['explanation_message'];\n        },\n\n        /**\n         * UnsanitizedHtml version of getExplanationMessage.\n         *\n         * @returns {String}\n         */\n        getExplanationMessageUnsanitizedHtml: function (row) {\n            return this.getExplanationMessage(row);\n        }\n    });\n});\n","Magento_Msrp/js/view/checkout/minicart/subtotal/totals.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @api\n */\n\ndefine([\n    'Magento_Tax/js/view/checkout/minicart/subtotal/totals',\n    'underscore'\n], function (Component, _) {\n    'use strict';\n\n    return Component.extend({\n\n        /**\n         * @override\n         */\n        initialize: function () {\n            this._super();\n            this.displaySubtotal(this.isMsrpApplied(this.cart().items));\n            this.cart.subscribe(function (updatedCart) {\n\n                this.displaySubtotal(this.isMsrpApplied(updatedCart.items));\n            }, this);\n        },\n\n        /**\n         * Determine if subtotal should be hidden.\n         * @param {Array} cartItems\n         * @return {Boolean}\n         */\n        isMsrpApplied: function (cartItems) {\n            return !_.find(cartItems, function (item) {\n                if (_.has(item, 'canApplyMsrp')) {\n                    return item.canApplyMsrp;\n                }\n\n                return false;\n            });\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/order-review.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'uiComponent',\n    'Magento_Customer/js/customer-data'\n], function ($, Component, customerData) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            element: null,\n            placeOrderButtonSelector: '#review-button',\n            shippingMethodFormSelector: '#shipping-method-form',\n            shippingMethodInputSelector: '#shipping-method',\n            updateContainerSelector: '#details-reload',\n            waitLoadingContainer: '#review-please-wait',\n            orderFormSelector: '#order-review-form',\n            editShoppingCartSelector: '.magento-payments-review-items .edit',\n            updateShippingMethodUrl: null,\n            placeOrderUrl: null,\n            canEditShippingMethod: false,\n            isVirtual: false\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            this._super();\n            this.element = element;\n\n            $(this.placeOrderButtonSelector).on('click', this.submitOrder.bind(this));\n            $(this.editShoppingCartSelector).on('click', this.invalidateCustomerData.bind(this));\n\n            if (!this.isVirtual && this.canEditShippingMethod) {\n                $(this.shippingMethodInputSelector).on('change', this.selectShippingMethod.bind(this));\n                this.setPlaceOrderButtonActive(!!$(this.shippingMethodInputSelector).val());\n            }\n        },\n\n        invalidateCustomerData: function () {\n            customerData.invalidate(['cart']);\n        },\n\n        /**\n         * Before request start\n         */\n        beforeRequestStart: function () {\n            $(this.waitLoadingContainer).show();\n        },\n\n        /**\n         * On request complete\n         */\n        onRequestComplete: function () {\n            $(this.waitLoadingContainer).hide();\n        },\n\n        /**\n         * Submit order\n         */\n        submitOrder: function () {\n            if (this.validateForm()) {\n                this.beforeRequestStart();\n                $(this.orderFormSelector).trigger('submit');\n                this.setPlaceOrderButtonActive(false);\n            }\n        },\n\n        /**\n         * Validate form\n         */\n        validateForm: function () {\n            return $(this.element).validation().valid();\n        },\n\n        /**\n         * Enable/disable order button\n         *\n         * @param {Boolean} isActive\n         */\n        setPlaceOrderButtonActive: function (isActive) {\n            $(this.placeOrderButtonSelector).prop('disabled', !isActive).toggleClass('no-checkout', !isActive);\n        },\n\n        /**\n         * Select shipping method\n         */\n        selectShippingMethod: function () {\n            var shippingMethod,\n                formData,\n                responseCallback;\n\n            if ($(this.waitLoadingContainer).is(':visible')) {\n                return false;\n            }\n            shippingMethod = $(this.shippingMethodInputSelector).val();\n            shippingMethod = shippingMethod.trim();\n            this.setPlaceOrderButtonActive(false);\n\n            if (shippingMethod) {\n                formData = $(this.shippingMethodFormSelector).serialize() + '&isAjax=true';\n\n                /**\n                 * @param {Object} response\n                 */\n                responseCallback = function (response) {\n                    if (typeof response.redirectUrl == 'undefined') {\n                        $(this.updateContainerSelector).html(response.html);\n                    } else {\n                        window.location = response.redirectUrl;\n                    }\n                    this.setPlaceOrderButtonActive(true);\n                    this.onRequestComplete();\n                };\n                $.ajax({\n                    url: this.updateShippingMethodUrl,\n                    type: 'post',\n                    context: this,\n                    beforeSend: this.beforeRequestStart,\n                    data: formData,\n                    success: responseCallback\n                });\n            }\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/lib/script-loader.min.js":"/*!\n * paypal-js v3.1.1 (2021-03-14T21:08:07.006Z)\n * Copyright 2020-present, PayPal, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar paypalLoadScript=function(t){\"use strict\";function e(t,e){var r=document.querySelector('script[src=\"'.concat(t,'\"]'));if(null===r)return null;var n=a(t,e);if(Object.keys(r.dataset).length!==Object.keys(n.dataset).length)return null;var o=!0;return Object.keys(r.dataset).forEach((function(t){r.dataset[t]!==n.dataset[t]&&(o=!1)})),o?r:null}function r(t){var e=t.url,r=t.attributes,n=t.onSuccess,o=t.onError,i=a(e,r);i.onerror=o,i.onload=n,document.head.insertBefore(i,document.head.firstElementChild)}function n(t){var e=\"https://www.paypal.com/sdk/js\";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL);var r=function(t,e){var r=\"\",n=\"\";Array.isArray(t)?t.length>1?(r=\"*\",n=t.toString()):r=t.toString():\"string\"==typeof t&&t.length>0?r=t:\"string\"==typeof e&&e.length>0&&(r=\"*\",n=e);return{\"merchant-id\":r,\"data-merchant-id\":n}}(t[\"merchant-id\"],t[\"data-merchant-id\"]),n=Object.assign(t,r),a=Object.keys(n).filter((function(t){return void 0!==n[t]&&null!==n[t]&&\"\"!==n[t]})).reduce((function(t,e){var r=n[e].toString();return\"data-\"===e.substring(0,5)?t.dataAttributes[e]=r:t.queryParams[e]=r,t}),{queryParams:{},dataAttributes:{}}),i=a.queryParams,u=a.dataAttributes;return{url:\"\".concat(e,\"?\").concat(o(i)),dataAttributes:u}}function o(t){var e=\"\";return Object.keys(t).forEach((function(r){0!==e.length&&(e+=\"&\"),e+=r+\"=\"+t[r]})),e}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement(\"script\");return r.src=t,Object.keys(e).forEach((function(t){r.setAttribute(t,e[t]),\"data-csp-nonce\"===t&&r.setAttribute(\"nonce\",e[\"data-csp-nonce\"])})),r}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u();s(t,e);var n=t.url,o=t.attributes;if(\"string\"!=typeof n||0===n.length)throw new Error(\"Invalid url.\");if(void 0!==o&&\"object\"!=typeof o)throw new Error(\"Expected attributes to be an object.\");return new e((function(t,e){if(\"undefined\"==typeof window)return t();r({url:n,attributes:o,onSuccess:function(){return t()},onError:function(){return e(new Error('The script \"'.concat(n,'\" failed to load.')))}})}))}function u(){if(\"undefined\"==typeof Promise)throw new Error(\"Promise is undefined. To resolve the issue, use a Promise polyfill.\");return Promise}function c(t){return window[t]}function s(t,e){if(\"object\"!=typeof t||null===t)throw new Error(\"Expected an options object.\");if(void 0!==e&&\"function\"!=typeof e)throw new Error(\"Expected PromisePonyfill to be a function.\")}return t.loadCustomScript=i,t.loadScript=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u();if(s(t,r),\"undefined\"==typeof window)return r.resolve(null);var o=n(t),a=o.url,d=o.dataAttributes,l=d[\"data-namespace\"]||\"paypal\",f=c(l);return e(a,d)&&f?r.resolve(f):i({url:a,attributes:d},r).then((function(){var t=c(l);if(t)return t;throw new Error(\"The window.\".concat(l,\" global variable is not available.\"))}))},t.version=\"3.1.1\",Object.defineProperty(t,\"__esModule\",{value:!0}),t}({});window.paypalLoadCustomScript=paypalLoadScript.loadCustomScript,window.paypalLoadScript=paypalLoadScript.loadScript;\n","Magento_PaymentServicesPaypal/js/lib/script-loader-wrapper.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine(['underscore', 'Magento_PaymentServicesPaypal/js/lib/script-loader'], function (_, scriptLoader) {\n    'use strict';\n\n    var promises = {},\n        defaultNamespace = 'paypal';\n\n    /**\n     * Parse src query string and move all params to object\n     *\n     * @param {Object} params\n     * @return {Object}\n     */\n    function processParamsSrc(params) {\n        var processedParams = _.clone(params),\n            url = new URL(params.src),\n            queryString = url.search.substring(1),\n            urlParams = JSON.parse('{\"' +\n                decodeURI(queryString).replace(/\"/g, '\\\\\"').replace(/&/g, '\",\"').replace(/=/g, '\":\"') +\n                '\"}');\n\n        _.extend(processedParams, urlParams);\n        delete processedParams.src;\n\n        return processedParams;\n    }\n\n    /**\n     * Convert params to object key => value format\n     *\n     * @param {Object} params\n     * @return {Object}\n     */\n    function convertToParamsObject(params) {\n        var processedParams = {};\n\n        _.each(params, function (param) {\n            processedParams[param.name] = param.value;\n        });\n\n        return processedParams;\n    }\n\n    /**\n     * Load PayPal sdk with params.\n     *\n     * @param {Array} params\n     * @param {String} sdkNamespace\n     * @return {Promise}\n     */\n    return function (params, sdkNamespace) {\n        var src;\n\n        if (!params || !params.length) {\n            return Promise.reject();\n        }\n\n        params = convertToParamsObject(params);\n        params['data-namespace'] = sdkNamespace || defaultNamespace;\n\n        if (!params || !params.src) {\n            return Promise.reject();\n        }\n\n        src = params.src;\n\n        if (!promises[src]) {\n            params = processParamsSrc(params);\n\n            promises[src] = scriptLoader.load(params);\n        }\n\n        return promises[src];\n    };\n});\n","Magento_PaymentServicesPaypal/js/model/step-navigator-mixin.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'mage/utils/wrapper',\n    'Magento_Checkout/js/model/quote',\n    'Magento_PaymentServicesPaypal/js/model/app-switch-data'\n], function (wrapper, quote, appSwitchDataModel) {\n    'use strict';\n\n    let mixin = {\n        handleHash: function (originalFn) {\n            var hashString = window.location.hash.replace('#', '');\n\n            // If the URL hash contains `onApprove` or 'onCancel' or 'token'\n            // then we've come from PayPal App Switch and the hash isn't\n            // going to match with any registered step.\n            if (hashString.includes('onApprove')\n                || hashString.includes('onCancel')\n                || hashString.includes('token')\n            ) {\n                // If this is a virtual quote then set the payment step to visible.\n                if (quote.isVirtual()) {\n                    const paymentStep = this.steps().find(({ code }) => code === 'payment');\n\n                    paymentStep.isVisible(true);\n                    return;\n                }\n\n                // Check if the User has come from the end of the checkout.\n                // If so then take them back there.\n                if (appSwitchDataModel.getData('paymentsOrderId')) {\n                    const paymentStep = this.steps().find(({ code }) => code === 'payment');\n\n                    paymentStep.navigate(paymentStep);\n                    return;\n                }\n\n                const firstStep = this.steps().sort(this.sortItems)?.[0];\n\n                if (firstStep) {\n                    firstStep.navigate(firstStep);\n\n                    return;\n                }\n            }\n\n            return originalFn();\n        }\n    };\n\n    return function (target) {\n        return wrapper.extend(target, mixin);\n    };\n});\n","Magento_PaymentServicesPaypal/js/model/payment-service-mixin.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'mage/utils/wrapper'\n], function (_, wrapper) {\n    'use strict';\n\n    /**\n     * Free method filter\n     * @param {Object} paymentMethod\n     * @return {Boolean}\n     */\n    var paymentServicesMethods = [\n            'payment_services_paypal_smart_buttons',\n            'payment_services_paypal_apple_pay',\n            'payment_services_paypal_google_pay',\n            'payment_services_paypal_hosted_fields',\n            'payment_services_paypal_fastlane'\n        ],\n\n        /**\n         * Check if payment method is from payment services.\n         *\n         * @param {String} needleName\n         * @param {String} paymentMethod\n         * @returns {Boolean}\n         */\n        isPaymentServicesButtonsPaymentMethod = function (needleName, paymentMethod) {\n            return paymentMethod.method === needleName;\n        },\n\n        /**\n         * Check if Apple Pay method is available.\n         */\n        checkApplePayAvailability = function () {\n            window.checkoutConfig.payment['payment_services_paypal_apple_pay'].isVisible = !!(\n                window.checkoutConfig.payment['payment_services_paypal_apple_pay'].isVisible &&\n                window.ApplePaySession\n            );\n            !window.ApplePaySession && console.log('Apple Pay is not supported or not available');\n        },\n\n        extender = {\n            /**\n             * Filter hidden payment methods.\n             *\n             * @param {Function} originFn - Original method.\n             * @param {Array} methods\n             */\n            setPaymentMethods: function (originFn, methods) {\n                var paymentServicesButtonMethodIndex;\n\n                checkApplePayAvailability();\n\n                _.each(paymentServicesMethods, function (paymentMethod) {\n                    if (!window.checkoutConfig.payment[paymentMethod].isVisible) {\n                        paymentServicesButtonMethodIndex = _.findIndex(\n                            methods,\n                            isPaymentServicesButtonsPaymentMethod.bind(null, paymentMethod)\n                        );\n                        paymentServicesButtonMethodIndex >= 0 && methods.splice(paymentServicesButtonMethodIndex, 1);\n                    }\n                });\n\n                return originFn(methods);\n            }\n    };\n\n    return function (target) {\n        return wrapper.extend(target, extender);\n    };\n});\n","Magento_PaymentServicesPaypal/js/model/app-switch-data.js":"/**\n * ADOBE CONFIDENTIAL\n *\n * Copyright 2025 Adobe\n * All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n */\n\ndefine(function () {\n    'use strict';\n\n    const appSwitchKey = 'paypal-app-switch';\n\n    return {\n        clearData: () => {\n            window.localStorage.removeItem(appSwitchKey);\n        },\n\n        getData: (key) => {\n            return JSON.parse(window.localStorage.getItem(appSwitchKey) || '{}')[key];\n        },\n\n        setData: (key, value) => {\n            const data = JSON.parse(window.localStorage.getItem(appSwitchKey) || '{}');\n\n            data[key] = value;\n\n            window.localStorage.setItem(appSwitchKey, JSON.stringify(data));\n        }\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/shipping-information-mixin.js":"define([\n    'Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available',\n    'Magento_PaymentServicesPaypal/js/view/payment/fastlane'\n], function (isFastlaneAvailable, fastlaneModel) {\n    'use strict';\n\n    var mixin = {\n        initialize: function () {\n            this._super();\n\n            // Early return if Fastlane is not available\n            if (!isFastlaneAvailable()) {\n                return;\n            }\n\n            fastlaneModel.setup();\n\n            return this;\n        },\n\n        /**\n         * Override the core back behaviour to call Fastlane if required.\n         */\n        back: function () {\n            if (fastlaneModel.profileData()) {\n                fastlaneModel.displayChangeShipping();\n            } else {\n                this._super();\n            }\n        }\n    };\n\n    return function (shippingInformation) {\n        return shippingInformation.extend(mixin);\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/shipping-mixin.js":"define(function () {\n    'use strict';\n\n    var mixin = {\n        /**\n         * When changing the shipping method store it within checkoutConfig to support PayPal app switch.\n         *\n         * @param {*} shippingMethod\n         */\n        selectShippingMethod: function (shippingMethod) {\n            this._super(shippingMethod);\n\n            window.checkoutConfig.selectedShippingMethod = shippingMethod;\n        },\n    };\n\n    return function (shipping) {\n        return shipping.extend(mixin);\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/form/element/powered-by.js":"define([\n    'knockout',\n    'uiComponent',\n    'Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available',\n    'Magento_PaymentServicesPaypal/js/view/payment/fastlane'\n], function (ko, Component, isFastlaneAvailable, fastlaneModel) {\n    'use strict';\n\n    return Component.extend({\n        profileData: null,\n\n        defaults: {\n            template: 'Magento_PaymentServicesPaypal/form/element/powered-by'\n        },\n\n        /**\n         * Initialise the watermark component.\n         *\n         * @returns {Object} Chainable.\n         */\n        initialize: function (config) {\n            this._super(config);\n\n            this.id = config.id;\n            this.profileData = fastlaneModel.profileData;\n            this.isVisible = ko.observable(false);\n\n            // Add subscription to profile data changes so we try to render again if needed.\n            this.profileData.subscribe(this.renderWatermark.bind(this));\n\n            return this;\n        },\n\n        /**\n         * Gets whether the watermark is enabled for the email address section.\n         *\n         * @returns {Boolean}\n         */\n        isEmailWatermarkEnabled: function () {\n            return this.id === 'paypal-fastlane-email-watermark'\n                && window.checkoutConfig.payment.payment_services_paypal_fastlane.messaging;\n        },\n\n        /**\n         * Gets whether the watermark is enabled for the shipping address section.\n         *\n         * @returns {Boolean}\n         */\n        isShippingWatermarkEnabled: function () {\n            return this.id !== 'paypal-fastlane-email-watermark' && !!this.profileData();\n        },\n\n        shouldRenderWatermark: async function () {\n            // Early return if Fastlane is not available.\n            if (!isFastlaneAvailable()) {\n                return false;\n            }\n\n            await fastlaneModel.setup();\n\n            // Fastlane Watermark should be rendered based on the following:\n            //   - Email watermark is based on the branding configuration\n            //   - All others are based on whether we have profile data\n            const shouldRender = this.isEmailWatermarkEnabled() || this.isShippingWatermarkEnabled();\n\n            this.isVisible(shouldRender);\n        },\n\n        renderWatermark: async function () {\n            await this.shouldRenderWatermark();\n\n            if (this.isVisible()) {\n                fastlaneModel.renderFastlaneWatermarkComponent(`#${this.id}`);\n            }\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/form/element/change-address.js":"define([\n    'uiComponent',\n    'Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available',\n    'Magento_PaymentServicesPaypal/js/view/payment/fastlane'\n], function (Component, isFastlaneAvailable, fastlaneModel) {\n    'use strict';\n\n    return Component.extend({\n        profileData: null,\n\n        defaults: {\n            template: 'Magento_PaymentServicesPaypal/form/element/change-address'\n        },\n\n        /**\n         * Initialise the change address component.\n         *\n         * @returns {Object} Chainable.\n         */\n        initialize: function () {\n            this._super();\n\n            // Early return if Fastlane is not available\n            if (!isFastlaneAvailable()) {\n                return this;\n            }\n\n            this.profileData = fastlaneModel.profileData;\n\n            return this;\n        },\n\n        /**\n         * Display the shipping address modal from Fastlane.\n         *\n         * @returns {void}\n         */\n        displayChangeShipping: async function () {\n            fastlaneModel.displayChangeShipping();\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/form/element/email-mixin.js":"define([\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/step-navigator',\n    'Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available',\n    'Magento_PaymentServicesPaypal/js/view/payment/fastlane'\n], function (quote, stepsNavigator, isFastlaneAvailable, fastlaneModel) {\n    'use strict';\n\n    var mixin = {\n        shippingServiceSubscription: null,\n\n        /**\n         * Add mixin to the checkEmailAvailability so we can trigger Fastlane.\n         */\n        checkEmailAvailability: async function () {\n            this._super();\n\n            // Early return if this is not the shipping address email input or billing address in case of virtual quote.\n            if ((!quote.isVirtual() && this.name !== 'checkout.steps.shipping-step.shippingAddress.customer-email')\n                || (quote.isVirtual() && this.name !== 'checkout.steps.billing-step.payment.customer-email')\n            ) {\n                return;\n            }\n\n            // Early return if Fastlane is not available\n            if (!isFastlaneAvailable()) {\n                return;\n            }\n\n            // Early return if we are already on the payment page.\n            if (stepsNavigator.getActiveItemIndex() !== 0) {\n                return;\n            }\n\n            await fastlaneModel.setup();\n\n            // Check the entered email against Fastlane to see if we have an account.\n            fastlaneModel.lookupCustomerByEmail(this.email());\n        }\n    };\n\n    return function (target) {\n        return target.extend(mixin);\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/payment/apple-pay-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'mageUtils',\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/apple-pay',\n], function ($, _, utils, Component, $t, customerData, ResponseError, ApplePayButton) {\n    'use strict';\n\n    const HTTP_STATUS_OK = 200;\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url,\n            }\n        );\n    }\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalApplePay',\n            scriptParams: {},\n            buttonContainerId: 'apple-pay-${ $.uid }',\n            template: 'Magento_PaymentServicesPaypal/payment/apple-pay',\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            sdkLoaded: null,\n            quoteIdForRest: null,\n            quoteId: null,\n            sdkParamsKey: 'applepay',\n            paymentTypeIconTitle: $t('Pay with Apple Pay'),\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            productFormSelector: '#product_addtocart_form'\n        },\n\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'initApplePayButton', 'onClick', 'afterUpdateQuote', 'beforeCreateOrder',\n                'afterCreateOrder', 'afterOnAuthorize', 'onCancel');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonContainerId;\n            this.getSdkParams()\n                .then(this.initApplePayButton)\n                .catch(console.log);\n\n            return this;\n        },\n\n        initApplePayButton: function () {\n            this.applePayButton = new ApplePayButton({\n                scriptParams: this.sdkParams,\n                createOrderUrl: this.createOrderUrl,\n                updateQuoteUrl: this.authorizeOrderUrl,\n                shippingInformationWhenGuestUrl: this.shippingInformationWhenGuestUrl,\n                shippingInformationWhenLoggedInUrl: this.shippingInformationWhenLoggedInUrl,\n                estimateShippingMethodsWhenGuestUrl: this.estimateShippingMethodsWhenGuestUrl,\n                estimateShippingMethodsWhenLoggedInUrl: this.estimateShippingMethodsWhenLoggedInUrl,\n                updatePayPalOrderUrl: this.updatePayPalOrderUrl,\n                setQuoteAsInactiveUrl: this.setQuoteAsInactiveUrl,\n                countriesUrl: this.countriesUrl,\n                placeOrderUrl: this.placeOrderUrl,\n                onClick: this.onClick,\n                beforeCreateOrder: this.beforeCreateOrder,\n                afterCreateOrder: this.afterCreateOrder,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                afterUpdateQuote: this.afterUpdateQuote,\n                shippingAddressRequired: !this.isVirtual,\n                styles: this.styles,\n                afterOnAuthorize: this.afterOnAuthorize,\n                onCancel: this.onCancel,\n                location: this.pageType,\n            });\n\n            $('#' + this.buttonContainerId).on('click', this.onClick);\n\n            this.applePayButton.sdkLoaded\n                .then(this.applePayButton.initAppleSDK);\n        },\n\n        afterUpdateQuote: function (data) {\n            window.location = data.redirectUrl;\n            this.applePayButton.showLoader(false);\n        },\n\n        onClick: function () {\n\n            var $form = $(this.productFormSelector);\n\n            if ($form.data('mageValidation')) {\n                this.formValid = $form.validation('isValid');\n            }\n\n            if (this.formValid) {\n                this.applePayButton.showLoaderAsync(true)\n                    .then(() => {\n                        return this.applePayButton.createOrder();\n                    })\n                    .then(() => {\n                        refreshCustomerData(this.createOrderUrl);\n                    })\n                    .catch(error => {\n                        this.applePayButton.catchError(error);\n                    });\n            }\n        },\n\n        setQuoteInactive: function () {\n            // Set Quote as inactive to avoid having multiple active quotes for the customer\n            $.ajax({\n                type: 'POST',\n                url: this.setQuoteAsInactiveUrl,\n            });\n        },\n\n        showPopup: function (paymentData) {\n\n            const paymentRequest = {\n                countryCode: this.applePayButton.applePayConfig.countryCode,\n                merchantCapabilities: this.applePayButton.applePayConfig.merchantCapabilities,\n                supportedNetworks: this.applePayButton.applePayConfig.supportedNetworks,\n                currencyCode: String(paymentData['currencyCode']),\n                requiredShippingContactFields: [\"name\", \"phone\", \"email\", \"postalAddress\"],\n                requiredBillingContactFields: [\"postalAddress\"],\n                total: {\n                    label: $t(\"Summary\"),\n                    type: \"final\",\n                    amount: Number(paymentData['totalPrice']).toString(),\n                }\n            };\n\n            // See https://developer.apple.com/documentation/apple_pay_on_the_web/applepaysession\n            this.applePaySession = new ApplePaySession(this.applePayButton.applePayVersionNumber, paymentRequest);\n            this.applePayButton.onApplePayValidateMerchant(this.applePaySession);\n            this.applePayButton.onApplePayCancel(this.applePaySession, this.setQuoteInactive.bind(this));\n            this.applePayButton.onApplePayShippingContactSelected(this.applePaySession, this.quoteIdForRest, paymentRequest.total, null);\n            this.applePayButton.onApplePayShippingMethodSelected(this.applePaySession, this.quoteId, this.quoteIdForRest, this.paypalOrderId);\n            this.applePayButton.onApplePayPaymentAuthorized(this.applePaySession);\n\n            this.applePaySession.begin();\n        },\n\n        /**\n         * Before create order.\n         *\n         * @return {String}\n         */\n        beforeCreateOrder: function () {\n            if (this.formInvalid) {\n                throw new Error('Form is Invalid');\n            }\n\n            let xhr = new XMLHttpRequest();\n            xhr.open('POST', this.addToCartUrl, false);\n            xhr.send(new FormData($(this.productFormSelector)[0]));\n\n            if (xhr.status !== HTTP_STATUS_OK) {\n                throw new Error('Request failed');\n            } else {\n                try {\n                    let result = JSON.parse(xhr.responseText);\n\n                    if (typeof result.success !== 'undefined') {\n                        refreshCustomerData(this.addToCartUrl);\n                        this.quoteIdForRest = result.success.quoteIdMask;\n                        this.quoteId = result.success.quoteId;\n                        return result.success;\n                    }\n                } catch (parseError) {\n                    throw new Error('Failed to parse response JSON: ' + parseError.message);\n                }\n            }\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n\n                this.showPopup({\n                    displayItems: [],\n                    currencyCode: data.response['paypal-order']['currency_code'],\n                    totalPriceStatus: 'FINAL',\n                    totalPrice: Number(data.response['paypal-order']['amount']).toString(),\n                    totalPriceLabel: $t('Total')\n                });\n\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        afterOnAuthorize: function (data) {\n\n            this.applePayButton.showLoaderAsync(true)\n                .then(() => {\n                    fetch(this.placeOrderUrl, {\n                        method: 'POST'\n                    }).then(response => {\n                        if (response.redirected && response.url.includes(\"review\")) {\n                            throw new Error();\n                        }\n                        return response.text();\n                    }).then(result => {\n                        if (result) {\n                            customerData.invalidate(['cart']);\n                            document.open();\n                            document.write(result);\n                            document.close();\n                        }\n                    })\n                    .catch(error => {\n                        this.applePayButton.showLoader(false);\n                        this.applePayButton.catchError(error);\n                    });\n                })\n                .catch(error => {\n                    this.catchError(error);\n                });\n        },\n\n        /**\n         * Redirect to cart on cancel.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         */\n        onCancel: function () {\n            customerData.invalidate(['cart']);\n            window.location = this.cancelUrl;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'uiComponent',\n    'Magento_PaymentServicesPaypal/js/view/payment/actions/get-sdk-params'\n], function (Component, getSdkParams) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            sdkParamsKey: 'paypal',\n            sdkParams: [],\n            cacheTtl: 30000\n        },\n\n        /**\n         * Get sdk params\n         *\n         * @return {Promise<Object>}\n         */\n        getSdkParams: function () {\n            return getSdkParams(this.cacheTtl)\n                .then(function (sdkParams) {\n                    this.sdkParams = sdkParams[this.sdkParamsKey];\n                }.bind(this));\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/smart-buttons-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'jquery',\n    'mageUtils',\n    'scriptLoader',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/smart-buttons',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/helpers/remove-paypal-url-token',\n    'Magento_PaymentServicesPaypal/js/model/app-switch-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'jquery/jquery-storageapi'\n], function (_, $, utils, loadSdkScript, Component, $t, customerData,\n    removePayPalUrlToken, appSwitchDataModel, ResponseError) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url\n            }\n        );\n    };\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalProduct',\n            buttonsContainerId: 'smart-buttons-${ $.uid }',\n            element: null,\n            productFormSelector: '#product_addtocart_form',\n            formInvalid: false,\n            paymentActionError: $t('Something went wrong with your request. Please try again later.'),\n            addToCartUrl: null,\n            isErrorDisplayed: false\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'renderButtons', 'onClick', 'onError', 'beforeCreateOrder',\n                'afterCreateOrder', 'beforeOnAuthorize', 'onCancel');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonsContainerId;\n            this.sdkLoaded = this.getSdkParams().then(() => {\n                return loadSdkScript(this.sdkParams, this.sdkNamespace).then((sdkScript) => {\n                    this.paypal = sdkScript;\n                });\n            });\n            this.renderButtons();\n\n            return this;\n        },\n\n        /**\n         * Render buttons\n         */\n        renderButtons: function () {\n            if (!this.sdkLoaded) {\n                return;\n            }\n\n            this.sdkLoaded.then(function () {\n                let containerSelector = '#' + this.buttonsContainerId;\n\n                if ($(containerSelector).length > 0) {\n                    this.setup(containerSelector);\n                    this.render();\n                } else {\n                    console.warn('PayPal button container not found:', containerSelector);\n                }\n            }.bind(this)).catch(function () {\n                console.log('Error: Failed to load PayPal SDK script!');\n            });\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            let event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n\n        /**\n         * Add error handing to catch errors with authorizing the order.\n         *\n         * @param {*} error\n         */\n        catchOnAuthorize: function (error) {\n            this.onError(error);\n        },\n\n        /**\n         * Add error handling to catch errors on creating the order.\n         *\n         * @param {*} error\n         */\n        catchCreateOrder: function (error) {\n            this.onError(error);\n        },\n\n        /**\n         * Catch errors.\n         *\n         * @param {*} error\n         */\n        onError: function (error) {\n            removePayPalUrlToken();\n\n            this.render(this.element);\n\n            let message = error instanceof ResponseError ? error.message : this.paymentActionError;\n\n            this.showLoader(false);\n\n            if (this.isErrorDisplayed) {\n                return;\n            }\n            this.addMessage(message);\n            this.isErrorDisplayed = true;\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n            customerData.set('messages', {\n                messages: [{\n                    type: type,\n                    text: message\n                }],\n                'data_id': Math.floor(Date.now() / 1000)\n            });\n        },\n\n        /**\n         * Calls when user click PayPal button\n         *\n         * @param {Object} data\n         * @param {Promise} actions\n         * @return {Promise}\n         */\n        onClick: function (data, actions) {\n            let productForm = $(this.productFormSelector);\n\n            if (productForm.data('mageValidation')) {\n                this.formInvalid = !productForm.validation('isValid');\n            }\n\n            if (this.formInvalid) {\n                return actions.reject();\n            }\n\n            appSwitchDataModel.setData('pageType', this.pageType);\n\n            return actions.resolve();\n        },\n\n        /**\n         * Set quote created from PDP as Inactive\n         */\n        setQuoteInactive: function () {\n            // Set Quote as inactive to avoid having multiple active quotes for the customer\n            return $.ajax({\n                type: 'POST',\n                url: this.setQuoteAsInactiveUrl\n            });\n        },\n\n        /**\n         * Before create order.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            this.isErrorDisplayed = false;\n            this.showLoader(true);\n\n            return new Promise(function (resolve, reject) {\n                if (this.formInvalid) {\n                    return reject();\n                }\n\n                fetch(this.addToCartUrl, {\n                    method: 'POST',\n                    headers: {},\n                    body: new FormData($(this.productFormSelector)[0]),\n                    credentials: 'same-origin'\n                }).then(function (response) {\n                    return response.json();\n                }).then(function (data) {\n                    if (typeof data.success !== 'undefined') {\n                        refreshCustomerData(this.addToCartUrl);\n\n                        return resolve();\n                    }\n\n                    return reject(new ResponseError(data.error));\n                }.bind(this)).catch(function () {\n                    return reject();\n                });\n            }.bind(this));\n        },\n\n        /**\n         * After order id created.\n         *\n         * @param {Object} res\n         * @return {*}\n         */\n        afterCreateOrder: function (res) {\n            if (res.response['is_successful']) {\n                refreshCustomerData(this.createOrderUrl);\n\n                return res.response['paypal-order'].id;\n            }\n\n            throw new ResponseError(res.response.error);\n        },\n\n        /**\n         * Before onAuthorize execute\n         *\n         * @param {Object} data\n         * @return {Promise}\n         */\n        beforeOnAuthorize: function (data) {\n            this.showLoader(true);\n\n            return Promise.resolve(data);\n        },\n\n        /**\n         * Set the quote inactive on cancel\n         */\n        onCancel: function () {\n            removePayPalUrlToken();\n\n            this.render(this.element);\n\n            this.setQuoteInactive()\n                .always(() => {\n                    this.showLoader(false);\n                });\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/message-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'Magento_PaymentServicesPaypal/js/view/payment/message',\n    'Magento_PaymentServicesPaypal/js/view/product/product-data-provider',\n    'Magento_PaymentServicesPaypal/js/view/product/grouped-product-data-provider',\n    'Magento_PaymentServicesPaypal/js/view/product/bundle-product-data-provider',\n    'Magento_PaymentServicesPaypal/js/view/product/gift-card-product-data-provider'\n], function (\n    Component,\n    Message,\n    ProductDataProvider,\n    GroupedProductDataProvider,\n    BundledProductDataProvider,\n    GiftCardProductDataProvider\n) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalProduct',\n            element: null,\n            message: null\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            var providerOptions = {\n                updateAmount: this.updateAmount.bind(this)\n            };\n\n            this.element = element;\n            this._super();\n\n            if (GroupedProductDataProvider.prototype.isProductGrouped()) {\n                this.provider = new GroupedProductDataProvider(providerOptions);\n            } else if (BundledProductDataProvider.prototype.isBundleProduct()) {\n                this.provider = new BundledProductDataProvider(providerOptions);\n            }  else if (GiftCardProductDataProvider.prototype.isProductGiftCard()) {\n                this.provider = new GiftCardProductDataProvider(providerOptions);\n            } else {\n                this.provider = new ProductDataProvider(providerOptions);\n            }\n            this.getSdkParams()\n                .then(this.initMessage.bind(this))\n                .then(this.render.bind(this));\n        },\n\n        /**\n         * Create instance of messages.\n         */\n        initMessage: function () {\n            this.message = new Message({\n                sdkNamespace: this.sdkNamespace,\n                scriptParams: this.sdkParams,\n                element: this.element,\n                renderContainer: this.renderContainer,\n                styles: this.styles,\n                placement: this.placement,\n                amount: this.provider.getAmount()\n            });\n        },\n\n        /**\n         * Update message amount.\n         */\n        updateAmount: function () {\n            this.message && this.message.updateAmount(this.provider.getAmount());\n        },\n\n        /**\n         * Render the message\n         */\n        render: function () {\n            this.message.render();\n            this.provider.updatePrice();\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/google-pay-cart.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'jquery',\n    'mageUtils',\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/google-pay'\n], function (_, $, utils, Component, $t, customerData, ResponseError, GooglePayButton) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url,\n            }\n        );\n    }\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalGooglePay',\n            sdkParamsKey: 'googlepay',\n            buttonContainerId: 'google-pay-${ $.uid }',\n            paymentActionError: $t('Something went wrong with your request. Please try again later.'),\n            isErrorDisplayed: false\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'initGooglePayButton', 'onClick',\n                'afterOnAuthorize', 'catchError', 'onCancel');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonContainerId;\n            this.getSdkParams()\n                .then(this.initGooglePayButton)\n                .catch(console.log);\n\n            return this;\n        },\n\n        initGooglePayButton: function () {\n            this.googlePayButton = new GooglePayButton({\n                scriptParams: this.sdkParams,\n                createOrderUrl: this.createOrderUrl,\n                updateQuoteUrl: this.authorizeOrderUrl,\n                onClick: this.onClick,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                afterOnAuthorize: this.afterOnAuthorize,\n                shippingAddressRequired: !this.isVirtual,\n                styles: this.styles,\n                onCancel: this.onCancel,\n                mode: this.googlePayMode,\n                getOrderDetailsUrl: this.getOrderDetailsUrl,\n                threeDSMode: this.threeDSMode,\n                location: this.pageType,\n            });\n\n            this.googlePayButton.sdkLoaded\n                .then(this.googlePayButton.initGoogleSDK);\n        },\n\n        afterOnAuthorize: function (data) {\n            window.location = data.redirectUrl;\n            this.googlePayButton.showLoader(false);\n        },\n\n        onClick: function () {\n            this.isErrorDisplayed = false;\n\n            this.googlePayButton.showLoaderAsync(true)\n                .then(() => {\n                    return this.googlePayButton.createOrder();\n                })\n                .then(() => {\n                    refreshCustomerData(this.createOrderUrl);\n                })\n                .catch(error => {\n                    this.catchError(error);\n                });\n        },\n\n        /**\n         * Catch errors.\n         *\n         * @param {*} error\n         */\n        catchError: function (error) {\n            var message = error instanceof ResponseError ? error.message : this.paymentActionError;\n\n            console.log(error);\n\n            this.googlePayButton.showLoader(false);\n\n            if (this.isErrorDisplayed) {\n                return;\n            }\n\n            if (error.hidden === undefined || !error.hidden) {\n                this.addMessage(message);\n            }\n\n            this.isErrorDisplayed = true;\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n            customerData.set('messages', {\n                messages: [{\n                    type: type,\n                    text: message\n                }],\n                'data_id': Math.floor(Date.now() / 1000)\n            });\n        },\n\n        /**\n         * Redirect to cart on cancel.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         */\n        onCancel: function () {\n            customerData.invalidate(['cart']);\n            window.location = this.cancelUrl;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/fastlane.js":"/**\n * ADOBE CONFIDENTIAL\n *\n * Copyright 2025 Adobe\n * All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n */\n\ndefine([\n    'jquery',\n    'knockout',\n    'uiRegistry',\n    'mage/translate',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/action/select-payment-method',\n    'Magento_Checkout/js/action/set-shipping-information',\n    'Magento_Checkout/js/checkout-data',\n    'Magento_Checkout/js/model/shipping-service',\n    'Magento_Checkout/js/model/step-navigator',\n    'Magento_Customer/js/model/address-list',\n    'Magento_Ui/js/model/messageList',\n    'Magento_PaymentServicesPaypal/js/helpers/get-allowed-locations',\n    'Magento_PaymentServicesPaypal/js/helpers/map-address-to-fastlane',\n    'Magento_PaymentServicesPaypal/js/helpers/map-address-to-magento',\n    'scriptLoader'\n], function ($, ko, uiRegistry, $t, quote, selectPaymentMethodAction, setShippingInformationAction, checkoutData,\n             shippingService, stepNavigator, addressList, messageList,\n             getAllowedLocations, mapAddressToFastlane, mapAddressToMagento, loadSdkScript) {\n    'use strict';\n\n    return {\n        code: 'payment_services_paypal_fastlane',\n        clientInstance: null,\n        fastlaneInstance: null,\n        fastlanePaymentComponent: null,\n        fastlaneWatermarkComponent: null,\n        deviceData: null,\n        runningSetup: null,\n        customerContextId: null,\n        profileData: ko.observable(null),\n        email: null,\n        sdkNamespace: 'paypalFastlane',\n        liabilityShift: ko.observable(null),\n        authenticationState: ko.observable(null),\n\n        /**\n         * Creates the Fastlane instance.\n         *\n         * The Fastlane instance is assigned to this.fastlaneInstance.\n         *\n         * @returns {void}\n         */\n        createFastlaneInstance: function () {\n            return new Promise((resolve) => {\n                const braintreeVersion = '3.116.2';\n                const fastlaneRequire = require.config({\n                    context: 'fastlane',\n                    paths: {\n                        braintree: `https://js.braintreegateway.com/web/${braintreeVersion}/js`,\n                        fastlane: 'https://www.paypalobjects.com/connect-boba',\n                    },\n                    shim: {\n                        'fastlane/axo': {\n                            deps: ['braintree/client', 'braintree/hosted-fields'],\n                        },\n                        'fastlane/axo.min': {\n                            deps: ['braintree/client.min', 'braintree/hosted-fields.min'],\n                        },\n                    },\n                });\n\n                fastlaneRequire(['fastlane/axo.min'], () => {\n                    (async () => {\n                        window.braintree = window.braintree || {};\n                        window.braintree.client = await new Promise(resolve => fastlaneRequire(['braintree/client.min'], resolve));\n                        window.braintree.hostedFields = await new Promise(resolve => fastlaneRequire(['braintree/hosted-fields.min'], resolve));\n                        window.braintree.version = braintreeVersion;\n\n                        await loadSdkScript(window.checkoutConfig.payment[this.getCode()].sdkParams, this.sdkNamespace)\n\n                        const fastlaneInstance = await window[this.sdkNamespace].Connect({\n                            shippingAddressOptions: {\n                                allowedLocations: getAllowedLocations(),\n                            },\n                            styles: this.getStyles()\n                        });\n\n                        resolve(fastlaneInstance);\n                    })();\n                });\n            });\n        },\n\n        /**\n         * Return the payment method code.\n         *\n         * @returns {string}\n         */\n        getCode: function () {\n            return this.code;\n        },\n\n        getStyles: function () {\n            return {\n                theme: window.checkoutConfig.payment[this.getCode()].styling.theme,\n                root: {\n                    backgroundColor: window.checkoutConfig.payment[this.getCode()].styling.rootBackgroundColor,\n                    errorColor: window.checkoutConfig.payment[this.getCode()].styling.rootErrorColor,\n                    fontFamily: window.checkoutConfig.payment[this.getCode()].styling.rootFontFamily,\n                    fontSizeBase: window.checkoutConfig.payment[this.getCode()].styling.rootFontSize,\n                    padding: window.checkoutConfig.payment[this.getCode()].styling.rootPadding,\n                    primaryColor: window.checkoutConfig.payment[this.getCode()].styling.rootPrimaryColor,\n                    textColorBase: window.checkoutConfig.payment[this.getCode()].styling.rootTextColor,\n                },\n                input: {\n                    backgroundColor: window.checkoutConfig.payment[this.getCode()].styling.inputBackgroundColor,\n                    borderColor: window.checkoutConfig.payment[this.getCode()].styling.inputBorderColor,\n                    borderRadius: window.checkoutConfig.payment[this.getCode()].styling.inputBorderRadius,\n                    borderWidth: window.checkoutConfig.payment[this.getCode()].styling.inputBorderWidth,\n                    focusBorderColor: window.checkoutConfig.payment[this.getCode()].styling.inputFocusBorderColor,\n                    textColorBase: window.checkoutConfig.payment[this.getCode()].styling.inputTextColor,\n                }\n            };\n        },\n\n        /**\n         * Setups all the required instances needed for Fastlane.\n         *\n         * @returns {Promise} A promise that completes once the client, data collector and Fastlane instances\n         * have been created.\n         */\n        setup: async function () {\n            // If the Fastlane instance has already been creates then immediately return a completed promise.\n            if (this.fastlaneInstance !== null) {\n                return Promise.resolve();\n            }\n\n            // There are multiple different components that can call the setup function at the same time so this\n            // is in place to prevent creating multiple instances.\n            if (this.runningSetup) {\n                return this.runningSetup;\n            }\n\n            this.runningSetup = new Promise(async (resolve) => {\n                this.attachStepsListener();\n\n                if (this.fastlaneInstance === null) {\n                    this.fastlaneInstance = await this.createFastlaneInstance();\n                }\n\n                resolve();\n            });\n\n            return this.runningSetup;\n        },\n\n        /**\n         * Attach a listener on the steps so that going to payment page opens Fastlane by default.\n         */\n        attachStepsListener: function () {\n            stepNavigator.steps.subscribe((steps) => {\n                const payment = steps.find(({ code }) => code === 'payment');\n\n                // Check against a few things:\n                // 1. The payment step is visible\n                // 2. The User has authenticated with Fastlane\n                // 3. No other payment method has been selected\n                if (payment.isVisible() && this.profileData() && !quote.paymentMethod()) {\n                    checkoutData.setSelectedPaymentMethod(this.code);\n                    selectPaymentMethodAction({ method: this.code });\n                }\n            });\n        },\n\n        /**\n         * Run the lookup for an email address within Fastlane.\n         *\n         * This will reset data within this.profileData and this.customerContextId and then trigger\n         * another authentication if a new account is found.\n         *\n         * @param {string} email\n         * @returns {void}\n         */\n        lookupCustomerByEmail: async function (email) {\n            // Early return if we haven't run setup and got a valid Fastlane instance.\n            if (!this.fastlaneInstance) {\n                return;\n            }\n\n            try {\n                this.showLoader(true);\n\n                // When we perform another lookup destroy all existing data.\n                this.profileData(null);\n                this.customerContextId = null;\n\n                // Lookup the new User.\n                const { customerContextId } = await this.fastlaneInstance?.identity?.lookupCustomerByEmail(email) || {};\n\n                this.showLoader(false);\n\n                this.customerContextId = customerContextId;\n\n                // If we have do have an account then trigger the authentication.\n                if (this.customerContextId) {\n                    return this.triggerAuthenticationFlow();\n                }\n            } catch (error) {\n                console.warn(error);\n                this.showLoader(false);\n            }\n        },\n\n        /**\n         * Checks whether the quote already contains a customer email address and shipping address.\n         *\n         * @param {Object} profileData - The complete profile data as gathered from Fastlane.\n         * @param {Object} [profileData.card] - Optional card data object.\n         * @param {Object} [profileData.name] - Optional name data object.\n         * @param {Object} [profileData.shippingAddress] - Optional shipping address object.\n         * @returns {Boolean}\n         */\n        quoteHasAddressSaved: function (profileData) {\n            return !this.email\n                && profileData?.shippingAddress?.address?.addressLine1\n                && !quote.shippingAddress().postcode;\n        },\n\n        /**\n         * Checks whether the User has changed their email address against the quote.\n         *\n         * @returns {Boolean}\n         */\n        userHasChangedEmailAddress: function () {\n            return this.email && this.email !== quote.guestEmail;\n        },\n\n        /**\n         * Trigger the authentication flow within Fastlane.\n         *\n         * Once the User has finished the action the information will be available within this.profileData.\n         *\n         * @returns {void}\n         */\n        triggerAuthenticationFlow: async function () {\n            // Early return if we haven't run setup and got a valid Fastlane instance.\n            if (!this.fastlaneInstance) {\n                return;\n            }\n\n            this.showLoader(true);\n            const { profileData }\n                = await this.fastlaneInstance.identity.triggerAuthenticationFlow(this.customerContextId);\n\n            this.showLoader(false);\n\n            // With the account data push it into the required models.\n            if (profileData) {\n                // Before processing the data we need to check for a few things:\n                //   - If there is no email address already but we do have a postcode then don't override as this will\n                //     be a custom address set by the User.\n                //   - If we have an email address stored but it doesn't match with the quote then the User must have\n                //     updated their email address and authenticated so process their new profile data.\n                if (this.quoteHasAddressSaved(profileData) || this.userHasChangedEmailAddress()) {\n                    this.processUserData(profileData);\n                }\n\n                // Store the current email address and profile data.\n                this.email = quote.guestEmail;\n                this.profileData(profileData);\n            }\n        },\n\n        /**\n         * Renders the Fastlane card component inside the given css selector.\n         *\n         * @param {string} selector The css selector where to render the card component.\n         * @returns {void}\n         */\n        renderFastlanePaymentComponent: async function (selector) {\n            // Early return if we haven't run setup and got a valid Fastlane instance.\n            if (!this.fastlaneInstance) {\n                return;\n            }\n\n            // If there is no customer context ID they must have reloaded on the payment page so trigger the\n            // authentication here again.\n            if (this.customerContextId === null) {\n                await this.lookupCustomerByEmail(quote.guestEmail);\n            }\n\n            const shippingAddress = mapAddressToFastlane(quote.shippingAddress()),\n                fields = {\n                    phoneNumber: {\n                        prefill: this.profileData()?.shippingAddress?.phoneNumber\n                            || quote.shippingAddress().telephone || ''\n                    },\n                    cardholderName: {\n                        // Enabled flag currently not available within Fastlane SDK but leaving functionality\n                        // in as it will be in a later release.\n                        // enabled: window.checkoutConfig.fastlane.show_cardholder_name,\n                        prefill: shippingAddress.firstName && shippingAddress.lastName\n                            ? `${shippingAddress.firstName} ${shippingAddress.lastName}` : ''\n                    }\n                },\n                styles = this.getStyles();\n\n            this.fastlanePaymentComponent = await this.fastlaneInstance\n                .FastlanePaymentComponent({ fields, shippingAddress, styles });\n            this.fastlanePaymentComponent.render(selector);\n        },\n\n        /**\n         * Shows the address Fastlane address selector.\n         *\n         * When the User selects a new address this will automatically call `processUserData` with the updated\n         * information.\n         *\n         * @returns {void}\n         */\n        displayChangeShipping: async function () {\n            // Early return if we haven't run setup and got a valid Fastlane instance.\n            if (!this.fastlaneInstance?.profile) {\n                return;\n            }\n\n            this.showLoader(true);\n\n            const {\n                selectionChanged,\n                selectedAddress\n            } = await this.fastlaneInstance.profile.showShippingAddressSelector();\n\n            if (selectionChanged) {\n                this.processUserData({ shippingAddress: selectedAddress });\n            }\n\n            this.showLoader(false);\n        },\n\n        /**\n         * Renders the Fastlane watermark into the given selector.\n         * @param {string} selector The css selector where to render the watermark component.\n         * @returns {void}\n         */\n        renderFastlaneWatermarkComponent: async function (selector) {\n            // Early return if we haven't run setup and got a valid Fastlane instance.\n            if (!this.fastlaneInstance) {\n                return;\n            }\n\n            // Make sure the element still exists.\n            if (!document.querySelector(selector)) {\n                return;\n            }\n\n            this.fastlaneWatermarkComponent = await this.fastlaneInstance.FastlaneWatermarkComponent({\n                includeAdditionalInfo: true\n            });\n            this.fastlaneWatermarkComponent.render(selector);\n        },\n\n        /**\n         * Handles all the data from Fastlane and populating that into Adobe Commerce checkout models.\n         *\n         * @param {Object} profileData - The complete profile data as gathered from Fastlane.\n         * @param {Object} [profileData.card] - Optional card data object.\n         * @param {Object} [profileData.name] - Optional name data object.\n         * @param {Object} [profileData.shippingAddress] - Optional shipping address object.\n         * @returns {void}\n         */\n        processUserData: async function (profileData) {\n            // Clean up any existing subscriptions so we don't add more than one at a time.\n            if (this.shippingServiceSubscription) {\n                this.shippingServiceSubscription.dispose();\n            }\n\n            try {\n                // If the quote is virtual then open paypal and stop.\n                if (quote.isVirtual()) {\n                    selectPaymentMethodAction({ method: this.code });\n                    return;\n                }\n\n                const shippingAddress = uiRegistry.get('checkout.steps.shipping-step.shippingAddress'),\n                    mappedAddress = mapAddressToMagento(profileData.shippingAddress);\n\n                // Subscribe to get the updated shipping rates.\n                this.shippingServiceSubscription = shippingService.getShippingRates().subscribe(function (rates) {\n                    this.shippingServiceSubscription.dispose();\n\n                    // Filter out the \"instore\" option as we cannot select the pickup location\n                    rates = rates.filter(function (rate) {\n                        return rate.carrier_code !== 'instore';\n                    });\n\n                    if (!rates || !rates.length) {\n                        this.redirectToShipping();\n                        return;\n                    }\n\n                    // If the shipping address is valid and we have some shipping rates then set the data to quote.\n                    if (!shippingAddress.source.get('params.invalid') && rates && rates[0]) {\n                        shippingAddress.selectShippingMethod(rates[0]);\n\n                        setShippingInformationAction().done(\n                            function () {\n                                // If we are on the first step of the checkout then we can skip to the next step.\n                                if (stepNavigator.getActiveItemIndex() === 0) {\n                                    stepNavigator.next();\n                                }\n                            }\n                        );\n                    }\n                }.bind(this));\n\n                // Push mapped address into the correct models which will trigger getting the updated shipping methods.\n                addressList.push(mappedAddress);\n                this.addAddressToCheckoutProvider(mappedAddress);\n\n                shippingAddress.source.set('params.invalid', false);\n                shippingAddress.triggerShippingDataValidateEvent();\n\n                if (shippingAddress.source.get('params.invalid')) {\n                    this.redirectToShipping();\n                }\n            } catch {\n                messageList.addErrorMessage({\n                    message: $t('The selected shipping address is not available to be used. Please enter a new one.')\n                });\n                this.showLoader(false);\n            }\n        },\n\n        /**\n         * Redirects the User back to the shipping step.\n         * @returns {void}\n         */\n        redirectToShipping: function () {\n            stepNavigator.setHash('shipping');\n            this.showLoader(false);\n        },\n\n        /**\n         * Push the new address into the checkout provider.\n         *\n         * @param {Object} address - A complete address object in the correct Adobe Commerce format.\n         * @returns {void}\n         */\n        addAddressToCheckoutProvider: function (address) {\n            const checkoutProvider = uiRegistry.get('checkoutProvider');\n            const billingAddress = uiRegistry.get('checkout.steps.billing-step.payment.payments-list.paypal_billing_agreement-form');\n\n            checkoutProvider.set(\n                'shippingAddress',\n                address\n            );\n\n            // If the billing address is set to be the same as the shipping then update the billing address with\n            // the same changed address.\n            if (billingAddress && billingAddress.isAddressSameAsShipping()) {\n                quote.shippingAddress({ ...address, street: Object.values(address.street) });\n                quote.billingAddress({ ...address, street: Object.values(address.street) });\n            }\n        },\n\n        /**\n         * Get the payment token.\n         *\n         * @returns {Promise}\n         */\n        getPaymentToken: function () {\n            if (!this.fastlanePaymentComponent) {\n                const error = new Error();\n\n                error.name = 'paypal_paypal:undefined_component';\n                throw error;\n            }\n\n            return this.fastlanePaymentComponent.getPaymentToken();\n        },\n\n        /**\n         * Validate the token with 3DS.\n         *\n         * @param {string} nonce\n         */\n        validate3DS: async function (nonce) {\n            const totals = quote.totals();\n\n            const payload = {\n                amount: totals['base_grand_total'].toFixed(2),\n                currency: window.checkoutConfig.quoteData.base_currency_code,\n                nonce,\n                threeDSRequested: true,\n                transactionContext: {\n                    experience_context: {\n                        brand_name: \"\",\n                        locale: window.LOCALE\n                    }\n                }\n            }\n\n            const isThreeDomainSecureEligible = await window[this.sdkNamespace].ThreeDomainSecureClient.isEligible(payload);\n\n            if (isThreeDomainSecureEligible) {\n                const { liabilityShift, authenticationState, nonce } = await window[this.sdkNamespace].ThreeDomainSecureClient.show();\n\n                this.liabilityShift(liabilityShift);\n                this.authenticationState(authenticationState);\n                if (authenticationState === \"succeeded\") {\n                    return nonce;\n                } else {\n                    throw new Error('Authentication has been failed or cancelled');\n                }\n            }\n\n            return nonce;\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            var event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/payment/google-pay-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'jquery',\n    'mageUtils',\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/google-pay'\n], function (_, $, utils, Component, $t, customerData, ResponseError, GooglePayButton) {\n    'use strict';\n\n    const HTTP_STATUS_OK = 200;\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url,\n            }\n        );\n    }\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalGooglePay',\n            scriptParams: {},\n            buttonContainerId: 'google-pay-${ $.uid }',\n            template: 'Magento_PaymentServicesPaypal/payment/google-pay',\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            sdkLoaded: null,\n            sdkParamsKey: 'googlepay',\n            paymentTypeIconTitle: $t('Pay with Google Pay'),\n            requestProcessingError: $t('Something went wrong with your request. Please try again later.'),\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            productFormSelector: '#product_addtocart_form'\n        },\n\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'initGooglePayButton', 'onClick', 'afterUpdateQuote',\n                'catchError', 'beforeCreateOrder', 'afterOnAuthorize', 'onCancel');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonContainerId;\n            this.getSdkParams()\n                .then(this.initGooglePayButton)\n                .catch(console.log);\n\n            return this;\n        },\n\n        initGooglePayButton: function () {\n            this.googlePayButton = new GooglePayButton({\n                scriptParams: this.sdkParams,\n                createOrderUrl: this.createOrderUrl,\n                updateQuoteUrl: this.authorizeOrderUrl,\n                onClick: this.onClick,\n                setQuoteAsInactiveUrl: this.setQuoteAsInactiveUrl,\n                beforeCreateOrder: this.beforeCreateOrder,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                afterUpdateQuote: this.afterUpdateQuote,\n                shippingAddressRequired: !this.isVirtual,\n                styles: this.styles,\n                afterOnAuthorize: this.afterOnAuthorize,\n                onCancel: this.onCancel,\n                mode: this.googlePayMode,\n                getOrderDetailsUrl: this.getOrderDetailsUrl,\n                threeDSMode: this.threeDSMode,\n                location: this.pageType,\n            });\n\n            this.googlePayButton.sdkLoaded\n                .then(this.googlePayButton.initGoogleSDK);\n        },\n\n        afterUpdateQuote: function (data) {\n            window.location = data.redirectUrl;\n            this.googlePayButton.showLoader(false);\n        },\n\n        onClick: function () {\n            var $form = $(this.productFormSelector);\n\n            if ($form.data('mageValidation')) {\n                this.formValid = $form.validation('isValid');\n            }\n\n            if (this.formValid) {\n                this.isErrorDisplayed = false;\n\n                this.googlePayButton.showLoaderAsync(true)\n                    .then(() => {\n                        return this.googlePayButton.createOrder();\n                    })\n                    .then(() => {\n                        refreshCustomerData(this.createOrderUrl);\n                    })\n                    .catch(error => {\n                        this.catchError(error);\n                    });\n            }\n        },\n\n        /**\n         * Set quote created from PDP as Inactive\n         */\n        setQuoteInactive: function () {\n            // Set Quote as inactive to avoid having multiple active quotes for the customer\n            return $.ajax({\n                type: 'POST',\n                url: this.setQuoteAsInactiveUrl\n            });\n        },\n\n        /**\n         * Catch errors.\n         *\n         * @param {*} error\n         */\n        catchError: function (error) {\n            console.log(error);\n            this.googlePayButton.showLoader(false);\n\n            if (error.name !== \"PayPalGooglePayError\") {\n                try {\n                    this.setQuoteInactive()\n                } catch (e) {\n                    console.warn('Failed to set quote inactive:', e);\n                }\n            }\n\n            if (this.isErrorDisplayed) {\n                return;\n            }\n\n            if (error.hidden === undefined || !error.hidden) {\n                this.addMessage(this.requestProcessingError);\n            }\n\n            this.isErrorDisplayed = true;\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n            customerData.set('messages', {\n                messages: [{\n                    type: type,\n                    text: message\n                }],\n                'data_id': Math.floor(Date.now() / 1000)\n            });\n        },\n\n        /**\n         * Before create order.\n         *\n         * @return {String}\n         */\n        beforeCreateOrder: function () {\n            this.isErrorDisplayed = false;\n\n            if (this.formInvalid) {\n                throw new Error('Form is Invalid');\n            }\n\n            let xhr = new XMLHttpRequest();\n            xhr.open('POST', this.addToCartUrl, false);\n            xhr.send(new FormData($(this.productFormSelector)[0]));\n\n            if (xhr.status !== HTTP_STATUS_OK) {\n                throw new Error('Request failed');\n            } else {\n                try {\n                    let result = JSON.parse(xhr.responseText);\n\n                    if (typeof result.success !== 'undefined') {\n                        refreshCustomerData(this.addToCartUrl);\n                        return result.success;\n                    }\n                } catch (parseError) {\n                    throw new Error('Failed to parse response JSON: ' + parseError.message);\n                }\n            }\n        },\n\n        afterOnAuthorize: function (data) {\n            window.location = data.redirectUrl;\n            this.googlePayButton.showLoader(false);\n        },\n\n        /**\n         * Set quote inactive on cancel\n         */\n        onCancel: function () {\n            this.setQuoteInactive()\n                .always(() => {\n                    this.googlePayButton.showLoader(false);\n                });\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/message.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'uiComponent',\n    'scriptLoader'\n], function ($, Component, loadSdkScript) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypal',\n            renderContainer: null,\n            amountAttribute: 'data-pp-amount',\n            amount: null\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function () {\n            this._super();\n            this.sdkLoaded = loadSdkScript(this.scriptParams, this.sdkNamespace);\n\n            return this;\n        },\n\n        /**\n         * Update amount\n         *\n         * @param {*} amount\n         */\n        updateAmount: function (amount) {\n            this.amount = amount;\n            $(this.renderContainer).attr(this.amountAttribute, this.amount);\n        },\n\n        /**\n         * Render message\n         *\n         * @return {Promise}\n         */\n        render: function () {\n            return this.sdkLoaded.then(function (sdkScript) {\n                const styles = this.getStyles();\n\n                if (!styles) {\n                    return;\n                }\n\n                sdkScript.Messages({\n                    amount: parseFloat(this.amount).toFixed(2),\n                    placement: this.placement,\n                    style: styles\n                })\n                .render(this.renderContainer);\n            }.bind(this)).catch(function (exception) {\n                console.log('Error: Failed to load PayPal SDK script!');\n                console.log(exception.message);\n            });\n        },\n\n        /**\n         * Gets the Pay Later Message styling for the given placement.\n         *\n         * Returns null if the placement is disabled.\n         *\n         * @returns {Object|bool}\n         */\n        getStyles: function () {\n            if (!this.styles) {\n                return {};\n            }\n\n            let parsedStyles = JSON.parse(this.styles),\n                placement = this.placement === 'payment' ? 'checkout' : this.placement,\n                styles = parsedStyles[placement];\n\n            if (!styles) {\n                return false;\n            }\n\n            return styles;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/message-cart.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'Magento_PaymentServicesPaypal/js/view/payment/message',\n    'Magento_Customer/js/customer-data'\n], function (Component, Message, customerData) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalCart',\n            element: null,\n            message: null\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            var cartData = customerData.get('cart');\n\n            this.element = element;\n            this._super();\n            this.getSdkParams()\n                .then(this.initMessage.bind(this))\n                .then(function () {\n                    cartData.subscribe(function (updatedCart) {\n                        this.message.updateAmount(updatedCart.subtotalAmount);\n                    }, this);\n                }.bind(this))\n                .then(this.render.bind(this));\n\n        },\n\n        /**\n         * Create instance of messages.\n         */\n        initMessage: function () {\n            var cartData = customerData.get('cart');\n\n            this.message = new Message({\n                sdkNamespace: this.sdkNamespace,\n                scriptParams: this.sdkParams,\n                element: this.element,\n                renderContainer: this.renderContainer,\n                styles: this.styles,\n                placement: this.placement,\n                amount: cartData().subtotalAmount\n            });\n        },\n\n        /**\n         * Render message\n         */\n        render: function () {\n            this.message.render();\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'uiComponent',\n    'Magento_Checkout/js/model/payment/renderer-list',\n    'Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available'\n], function (Component, rendererList, isFastlaneAvailable) {\n    'use strict';\n\n    const cardField = isFastlaneAvailable() ? {\n        type: 'payment_services_paypal_fastlane',\n        component: 'Magento_PaymentServicesPaypal/js/view/payment/method-renderer/fastlane'\n    } : {\n        type: 'payment_services_paypal_hosted_fields',\n        component: 'Magento_PaymentServicesPaypal/js/view/payment/method-renderer/hosted-fields'\n    };\n\n    rendererList.push({\n        type: 'payment_services_paypal_smart_buttons',\n        component: 'Magento_PaymentServicesPaypal/js/view/payment/method-renderer/smart-buttons'\n    }, {\n        type: 'payment_services_paypal_apple_pay',\n        component: 'Magento_PaymentServicesPaypal/js/view/payment/method-renderer/apple-pay'\n    }, {\n        type: 'payment_services_paypal_google_pay',\n        component: 'Magento_PaymentServicesPaypal/js/view/payment/method-renderer/google-pay'\n    }, cardField);\n\n    return Component.extend({});\n});\n","Magento_PaymentServicesPaypal/js/view/payment/apple-pay-cart.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'jquery',\n    'mageUtils',\n    'Magento_PaymentServicesPaypal/js/view/payment/paypal-abstract',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/apple-pay',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/cart/totals-processor/default',\n    'Magento_Customer/js/model/customer',\n], function (_, $, utils, Component, $t, customerData, ResponseError, ApplePayButton, quote, totalsProcessor, customer) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalApplePay',\n            sdkParamsKey: 'applepay',\n            buttonContainerId: 'apple-pay-${ $.uid }',\n            paymentActionError: $t('Something went wrong with your request. Please try again later.'),\n            isErrorDisplayed: false\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'initApplePayButton', 'onClick', 'afterOnAuthorize',  'afterCreateOrder', 'showPopup', 'cancelApplePay');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonContainerId;\n\n            this.getSdkParams()\n                .then(this.initApplePayButton)\n                .catch(console.log);\n\n            return this;\n        },\n\n        initApplePayButton: function () {\n            this.applePayButton = new ApplePayButton({\n                scriptParams: this.sdkParams,\n                createOrderUrl: this.createOrderUrl,\n                estimateShippingMethodsWhenLoggedInUrl: this.estimateShippingMethodsWhenLoggedInUrl,\n                estimateShippingMethodsWhenGuestUrl: this.estimateShippingMethodsWhenGuestUrl,\n                shippingInformationWhenLoggedInUrl: this.shippingInformationWhenLoggedInUrl,\n                shippingInformationWhenGuestUrl: this.shippingInformationWhenGuestUrl,\n                updatePaypalOrderUrl: this.updatePaypalOrderUrl,\n                countriesUrl: this.countriesUrl,\n                placeOrderUrl: this.placeOrderUrl,\n                showPopup: this.showPopup,\n                updateQuoteUrl: this.authorizeOrderUrl,\n                onClick: this.onClick,\n                afterCreateOrder: this.afterCreateOrder,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                afterOnAuthorize: this.afterOnAuthorize,\n                shippingAddressRequired: !this.isVirtual,\n                styles: this.styles,\n                location: this.pageType,\n            });\n\n            $('#' + this.buttonContainerId).on('click', this.onClick);\n\n            this.applePayButton.sdkLoaded\n                .then(this.applePayButton.initAppleSDK);\n        },\n\n        afterOnAuthorize: function (data) {\n\n            this.applePayButton.showLoaderAsync(true)\n            .then(() => {\n                fetch(this.placeOrderUrl, {\n                    method: 'POST'\n                }).then(response => {\n                    if (response.redirected && response.url.includes(\"review\")) {\n                        throw new Error();\n                    }\n                    return response.text();\n                }).then(result => {\n                    if (result) {\n                        customerData.invalidate(['cart']);\n                        document.open();\n                        document.write(result);\n                        document.close();\n                    }\n                })\n                    .catch(error => {\n                        this.applePayButton.showLoader(false);\n                        this.applePayButton.catchError(error);\n                    });\n            })\n            .catch(error => {\n                this.catchError(error);\n            });\n        },\n\n        onClick: function () {\n            // Reload customer data to use correct loggedin/guest urls in the applepay button\n            // See smart_buttons_minicart.phtml:21-22\n            if (this.location === 'minicart') {\n                this.fixCustomerData();\n            }\n\n            // Show popup with initial order amount from window.checkoutConfig\n            // See smart_buttons_minicart.phtml:20\n            this.applePayButton.showLoaderAsync(true).then(() => {\n                const data = {\n                    response: {\n                        'paypal-order': {\n                            currency_code: window.checkoutConfig.quoteData.base_currency_code,\n                            amount: window.checkoutConfig.quoteData.grand_total.toString(),\n                        }\n                    }\n                }\n                this.applePayButton.showPopup(data);\n            })\n\n            this.isErrorDisplayed = false;\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        cancelApplePay: function (){\n            customerData.invalidate(['cart']);\n            window.location.reload();\n        },\n\n        showPopup: function (paymentData) {\n            const paymentRequest = {\n                countryCode: this.applePayButton.applePayConfig.countryCode,\n                merchantCapabilities: this.applePayButton.applePayConfig.merchantCapabilities,\n                supportedNetworks: this.applePayButton.applePayConfig.supportedNetworks,\n                currencyCode: paymentData.response['paypal-order']['currency_code'],\n                requiredShippingContactFields: [\"name\", \"phone\", \"email\", \"postalAddress\"],\n                requiredBillingContactFields: [\"postalAddress\"],\n                total: {\n                    label: $t(\"Summary\"),\n                    type: \"final\",\n                    amount: Number(paymentData.response['paypal-order']['amount']).toString(),\n                }\n            };\n\n            // See https://developer.apple.com/documentation/apple_pay_on_the_web/applepaysession\n            this.applePaySession = new ApplePaySession(this.applePayButton.applePayVersionNumber, paymentRequest);\n\n            this.applePayButton.onApplePayValidateMerchant(this.applePaySession);\n            this.applePayButton.onApplePayCancel(this.applePaySession, this.cancelApplePay);\n            this.applePayButton.onApplePayShippingContactSelected(this.applePaySession, quote.getQuoteId() , paymentRequest.total, quote.isVirtual());\n            this.applePayButton.onApplePayShippingMethodSelectedInCartPage(this.applePaySession, quote.getQuoteId());\n            this.applePayButton.onApplePayPaymentAuthorized(this.applePaySession);\n\n            this.applePaySession.begin();\n        },\n\n        /**\n         * Fix customer data\n         *\n         * Why do we need this?\n         * See: src/app/code/Magento/Customer/view/frontend/web/js/model/customer.js:17\n         *\n         * When we initialise customer data on the page where the minicart was not rendered yet,\n         * the customer data in the \"window\" object is 'undefined' at first because . This makes this line\n         *      var isLoggedIn = ko.observable(window.isCustomerLoggedIn),\n         * to create an observable of undefined variable, that does not work in knockout.\n         * knockout expects an existing variable to create an observable.\n         *\n         * Later, when we render minicart and update \"window\" object with customer data,\n         * it's not being picked up by customer.js logic and when try to read the data, it's still undefined,\n         * even though it exists in the \"window\" object.\n         *\n         * This function forces the customer data to be updated from the \"window\" object.\n         */\n        fixCustomerData: function () {\n            if (customer.isLoggedIn() === undefined && window.isCustomerLoggedIn !== undefined) {\n                customer.setIsLoggedIn(window.isCustomerLoggedIn);\n            }\n\n            if (customer.isLoggedIn() && _.isEmpty(customer.customerData)) {\n                customer.customerData = window.customerData;\n            }\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/smart-buttons-cart.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'jquery',\n    'mageUtils',\n    'scriptLoader',\n    'Magento_PaymentServicesPaypal/js/helpers/remove-paypal-url-token',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/smart-buttons',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error'\n], function (_, $, utils, loadSdkScript, removePayPalUrlToken, Component, $t, customerData, ResponseError) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url\n            }\n        );\n    };\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalCart',\n            buttonsContainerId: 'smart-buttons-${ $.uid }',\n            element: null,\n            paymentActionError: $t('Something went wrong with your request. Please try again later.'),\n            isErrorDisplayed: false\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config, element) {\n            _.bindAll(this, 'renderButtons', 'onError', 'beforeCreateOrder', 'afterCreateOrder',\n                'beforeOnAuthorize', 'onCancel');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.element = element;\n            this.element.id = this.buttonsContainerId;\n            this.sdkLoaded = this.getSdkParams().then(() => {\n                return loadSdkScript(this.sdkParams, this.sdkNamespace).then((sdkScript) => {\n                    this.paypal = sdkScript;\n                });\n            });\n            this.renderButtons();\n\n            return this;\n        },\n\n        /**\n         * Render buttons\n         */\n        renderButtons: function () {\n            if (!this.sdkLoaded) {\n                return;\n            }\n\n            this.sdkLoaded.then(function () {\n                let containerSelector = '#' + this.buttonsContainerId;\n\n                if ($(containerSelector).length > 0) {\n                    this.setup(containerSelector);\n                    this.render();\n                } else {\n                    console.warn('PayPal button container not found:', containerSelector);\n                }\n            }.bind(this)).catch(function () {\n                console.log('Error: Failed to load PayPal SDK script!');\n            });\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            let event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n\n        /**\n         * Add error handling to catch errors on creating the order.\n         *\n         * @param {*} error\n         */\n        catchCreateOrder: function (error) {\n            this.onError(error);\n        },\n\n        /**\n         * Catch errors.\n         *\n         * @param {*} error\n         */\n        onError: function (error) {\n            let message = error instanceof ResponseError ? error.message : this.paymentActionError;\n\n            this.showLoader(false);\n\n            if (this.isErrorDisplayed) {\n                return;\n            }\n            this.addMessage(message);\n            this.isErrorDisplayed = true;\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n            customerData.set('messages', {\n                messages: [{\n                    type: type,\n                    text: message\n                }],\n                'data_id': Math.floor(Date.now() / 1000)\n            });\n        },\n\n        /**\n         * Before create order.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            this.isErrorDisplayed = false;\n            this.showLoader(true);\n\n            return Promise.resolve();\n        },\n\n        /**\n         * After order id created.\n         *\n         * @param {Object} res\n         * @return {*}\n         */\n        afterCreateOrder: function (res) {\n            if (res.response['is_successful']) {\n                refreshCustomerData(this.createOrderUrl);\n\n                return res.response['paypal-order'].id;\n            }\n\n            throw new ResponseError(res.response.error);\n        },\n\n        /**\n         * Before onAuthorize execute\n         *\n         * @param {Object} data\n         * @return {Promise}\n         */\n        beforeOnAuthorize: function (data) {\n            this.showLoader(true);\n\n            return Promise.resolve(data);\n        },\n\n        /**\n         * Redirect to cart on cancel.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         */\n        onCancel: function (data, actions) {\n            removePayPalUrlToken();\n\n            customerData.invalidate(['cart']);\n            window.location.replace(this.cancelUrl);\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/vault.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n/*browser:true*/\n\n/* @api */\ndefine([\n    'underscore',\n    'uiComponent',\n    'mage/translate',\n    'Magento_Checkout/js/model/payment/renderer-list',\n    'uiLayout',\n    'uiRegistry'\n], function (_, Component, $t, rendererList, layout, registry) {\n    'use strict';\n\n    var vaultGroupName = 'vaultGroup';\n\n    layout([{\n        name: vaultGroupName,\n        component: 'Magento_Checkout/js/model/payment/method-group',\n        alias: 'vault',\n        sortOrder: 10,\n        title: $t('Stored Cards')\n    }]);\n\n    registry.get(vaultGroupName, function (vaultGroup) {\n        _.each(window.checkoutConfig.payment.vault, function (config, index) {\n            rendererList.push(\n                {\n                    type: index,\n                    config: config.config,\n                    component: config.component,\n                    group: vaultGroup,\n\n                    /**\n                     * Custom payment method types comparator\n                     * @param {String} typeA\n                     * @param {String} typeB\n                     * @return {Boolean}\n                     */\n                    typeComparatorCallback: function (typeA, typeB) {\n                        // vault token items have the same name as vault payment without index\n                        return typeA.substring(0, typeA.lastIndexOf('_')) === typeB;\n                    }\n                }\n            );\n        });\n    });\n\n    /**\n     * Add view logic here if needed\n     */\n    return Component.extend({});\n});\n","Magento_PaymentServicesPaypal/js/view/payment/actions/get-sdk-params.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'Magento_Customer/js/customer-data',\n    'jquery/jquery-storageapi'\n], function ($, _, customerData) {\n    'use strict';\n\n    var promise = null,\n        timeoutKey = 'payments-sdk-params-timeout',\n        paymentsKey = 'payments',\n        sdkParamsKey = 'sdkParams';\n\n    return function (cacheTtl) {\n        if (!promise) {\n            promise = new Promise(function (resolve, reject) {\n                var dateNow = Date.now(),\n                    dateTo = dateNow + cacheTtl,\n                    timeout = $.localStorage.get(timeoutKey);\n                if (timeout < dateNow || !timeout) {\n                    return customerData.reload([paymentsKey]).done(function () {\n                        $.localStorage.set(timeoutKey, dateTo);\n                        resolve(customerData.get(paymentsKey)()[sdkParamsKey]);\n                    }).fail(reject.bind(this, []));\n                }\n\n                if (!_.isEmpty(customerData.get(paymentsKey)())) {\n                    return resolve(customerData.get(paymentsKey)()[sdkParamsKey]);\n                }\n\n                customerData.get(paymentsKey).subscribe(function (payments) {\n                    resolve(payments[sdkParamsKey]);\n                });\n\n            });\n        }\n\n        return promise;\n    };\n});\n","Magento_PaymentServicesPaypal/js/view/payment/methods/smart-buttons.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'uiComponent',\n    'scriptLoader',\n    'Magento_Customer/js/customer-data',\n    'Magento_PaymentServicesPaypal/js/helpers/remove-paypal-url-token',\n    'Magento_PaymentServicesPaypal/js/model/app-switch-data',\n    'Magento_PaymentServicesPaypal/js/view/payment/actions/get-sdk-params'\n], function ($, _, Component, loadSdkScript, customerData, removePayPalUrlToken, appSwitchDataModel, getSdkParams) {\n    'use strict';\n\n    /**\n     * Create order request.\n     *\n     * @param {String} url\n     * @param {Object} payPalOrderData\n     * @param {FormData} orderData\n     * @return {Promise<Object>}\n     */\n    const performCreateOrder = function (url, payPalOrderData, orderData) {\n        orderData = orderData || new FormData();\n        orderData.append('form_key', $.mage.cookies.get('form_key'));\n        orderData.append('payment_source', payPalOrderData['paymentSource']);\n\n        return fetch(url, {\n            method: 'POST',\n            headers: {},\n            body: orderData || new FormData(),\n            credentials: 'same-origin'\n        }).then(function (response) {\n            return response.json();\n        });\n    },\n\n    /**\n     * Payment authorization request.\n     *\n     * @return {Promise<Object>}\n     */\n    performAuthorization = function (url, data) {\n        return fetch(url, {\n            method: 'POST',\n            headers: {\n                'X-Requested-With': 'XMLHttpRequest',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                orderId: data.orderID\n            })\n        }).then((response) => {\n            if (!response.ok) {\n                throw new Error($t('We\u2019re unable to take that order right now.'));\n            }\n            return response.json();\n        }).then((response)  => {\n            const parsed = JSON.parse(response);\n\n            if (!parsed.success) {\n                throw new Error($t('We\u2019re unable to take that order right now.'));\n            }\n\n            customerData.invalidate(['cart']);\n            window.location.replace(parsed.redirectUrl);\n        });\n    };\n\n    return Component.extend({\n        defaults: {\n            sdkParamsKey: 'paypal',\n            sdkParams: [],\n            cacheTtl: 30000,\n            sdkNamespace: 'paypal',\n            paypal: null,\n            paymentSource: '',\n            creatOrderUrl: '',\n            placeOrderUrl: '',\n            authorizeOrderUrl: '',\n            setQuoteAsInactiveUrl: '',\n            completeOrderUrl: '',\n            style: {},\n            paymentRequest: {\n                applepay: {\n                    requiredShippingContactFields: []\n                }\n            },\n            element: null,\n            instance: null,\n            hasReturned: false\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            _.bindAll(this, 'createOrder', 'onApprove', 'onError', 'onCancel', 'onClick');\n            this._super();\n\n            if (this.scriptParams?.length) {\n                this.sdkLoaded = loadSdkScript(this.scriptParams, this.sdkNamespace).then(function (sdkScript) {\n                    this.paypal = sdkScript;\n                }.bind(this));\n            }\n\n            return this;\n        },\n\n        /**\n         * Get sdk params\n         *\n         * @return {Promise<Object>}\n         */\n        getSdkParams: function () {\n            return getSdkParams(this.cacheTtl)\n                .then(function (sdkParams) {\n                    this.sdkParams = sdkParams[this.sdkParamsKey];\n                }.bind(this));\n        },\n\n        /**\n         * In the case where the button color is not supported by Apple (black or white)\n         * Map the button color to black (same behavior as PayPal SDK script)\n         *\n         * @param buttonStyles\n         * @returns {(*&{color: string})|*}\n         */\n        mapButtonColorForApplePay: function (buttonStyles) {\n            let buttonColor = buttonStyles.color;\n\n            if (buttonColor === 'black' || buttonColor === 'white') {\n                return buttonStyles;\n            }\n            return {\n                ...buttonStyles,\n                color: 'black'\n            };\n        },\n\n        /**\n         * Set up the smart buttons.\n         *\n         * @param {HTMLElement} element\n         * @returns {*}\n         */\n        setup: function (element) {\n            let buttonsConfig;\n\n            if (typeof this.paypal === 'undefined' || !this.paypal.Buttons) {\n                return null;\n            }\n\n            if (element) {\n                this.element = element;\n            }\n\n            buttonsConfig = {\n                appSwitchWhenAvailable: this.appSwitchWhenAvailable,\n                element: this.element,\n                paymentRequest: this.paymentRequest,\n                style: this.styles,\n                onClick: this.onClick,\n                createOrder: this.createOrder,\n                onApprove: this.onApprove,\n                onError: this.onError,\n                onCancel: this.onCancel,\n                onInit: this.onInit\n            };\n\n            if (this.onShippingChange) {\n                buttonsConfig.onShippingChange = this.onShippingChange.bind(this);\n            }\n            if (this.fundingSource) {\n                buttonsConfig.fundingSource = this.fundingSource;\n                if (this.fundingSource === 'applepay') {\n                    buttonsConfig.style = this.mapButtonColorForApplePay(this.styles);\n                }\n            }\n\n            this.instance = this.paypal.Buttons(buttonsConfig);\n        },\n\n        /**\n         * Render Smart Buttons.\n         *\n         * @return {*}\n         */\n        render: function () {\n            if (this.instance.isEligible()) {\n                if (this.instance.hasReturned() && appSwitchDataModel.getData('pageType') === this.pageType) {\n                    this.hasReturned = true;\n                    this.instance.resume();\n                } else {\n                    $(this.element).html('');\n                    this.setup(this.element);\n                    this.instance.render(this.element);\n                }\n            }\n\n            return this.instance;\n        },\n\n        /**\n         * Calls when smart buttons initializing\n         */\n        onInit: function () {\n        },\n\n        /**\n         * Calls when user click PayPal button.\n         */\n        onClick: function () {\n            appSwitchDataModel.setData('pageType', this.pageType);\n        },\n\n        /**\n         * Calls before create order.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            return Promise.resolve();\n        },\n\n        /**\n         * Create order.\n         *\n         * @return {Promise}\n         */\n        createOrder: function (data) {\n            this.paymentSource = data['paymentSource'];\n\n            // add location to the order create request\n            let orderData = new FormData();\n            orderData.append('location', this.location || this.pageType);\n\n            return this.beforeCreateOrder()\n                .then(performCreateOrder.bind(this, this.createOrderUrl, data, orderData))\n                .then(function (orderData) {\n                    return this.afterCreateOrder(orderData);\n                }.bind(this)).catch(function (error) {\n                    return this.catchCreateOrder(error);\n                }.bind(this)).finally(function (error) {\n                    return this.finallyCreateOrder(error);\n                }.bind(this));\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {*}\n         */\n        afterCreateOrder: function (data) {\n            return data.orderId;\n        },\n\n        /**\n         * Catch error on order creation.\n         */\n        catchCreateOrder: function () {\n        },\n\n        /**\n         * Finally for order creation.\n         *\n         */\n        finallyCreateOrder: function () {\n        },\n\n        /**\n         * Before authorization call.\n         *\n         * @return {Promise}\n         */\n        beforeOnAuthorize: function (data, actions) {\n            return Promise.resolve(data);\n        },\n\n        /**\n         * On payment approve.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         * @return {Promise}\n         */\n        onApprove: function (data, actions) {\n            return this.beforeOnAuthorize(data, actions)\n                .then(performAuthorization.bind(this, this.completeOrderUrl))\n                .catch(function (error) {\n                    return this.catchOnAuthorize(error);\n                }.bind(this)).finally(function (error) {\n                    return this.finallyOnAuthorize(error);\n                }.bind(this));\n        },\n\n        /**\n         * Catch payment authorization errors.\n         */\n        catchOnAuthorize: function () {\n        },\n\n        /**\n         * Finally for payment authorization.\n         */\n        finallyOnAuthorize: function () {\n        },\n\n        /**\n         * Calls when shipping address changes..\n         *\n         * @param {Object} data\n         */\n        onShippingChange: undefined,\n\n        handleError: function () {\n            removePayPalUrlToken();\n\n            this.render(this.element);\n        },\n\n        /**\n         * Calls when error happened on PayPal side.\n         *\n         * @param {Error} error\n         */\n        onError: function (error) {\n            console.log('Error: ', error?.message || this.paymentActionError);\n\n            this.handleError();\n        },\n\n        /**\n         * Calls when user canceled payment.\n         */\n        onCancel: function (error) {\n            this.onError(error);\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/methods/hosted-fields.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'underscore',\n    'uiComponent',\n    'mage/translate',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'scriptLoader'\n], function (_, Class, $t, ResponseError, loadSdkScript) {\n    'use strict';\n\n    return Class.extend({\n        defaults: {\n            sdkNamespace: 'paypal',\n            paypal: null,\n            formId: 'hosted-fields-form',\n            instance: undefined,\n            createOrderUrl: null,\n            orderCreateErrorMessage: {\n                default: $t('Failed to place order. Try again or refresh the page if that does not resolve the issue.'), // eslint-disable-line max-len,\n                //TODO: Update messages\n                'POSTAL_CODE_REQUIRED': $t('Postal code is required.'),\n                'CITY_REQUIRED': $t('City is required.')\n            },\n            styles: {\n                input: {\n                    color: '#ccc',\n                    'font-family': '\"Open Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif',\n                    'font-size': '16px',\n                    'font-weight': '400'\n                },\n                ':focus': {\n                    color: '#333'\n                },\n                '.valid': {\n                    color: '#333'\n                }\n            },\n            fields: {\n                number: {\n                    class: 'number',\n                    selector: '#${ $.formId } .${ $.fields.number.class }',\n                    placeholder: ''\n                },\n                expirationDate: {\n                    class: 'expiration-date',\n                    selector: '#${ $.formId } .${ $.fields.expirationDate.class }',\n                    placeholder: 'MM/YY'\n                },\n                cvv: {\n                    class: 'cvv',\n                    selector: '#${ $.formId } .${ $.fields.cvv.class }',\n                    placeholder: ''\n                }\n            },\n            scriptParams: [],\n            sdkLoaded: null,\n            shouldCardBeVaulted: false\n        },\n\n        /** @inheritdoc */\n        initialize: function (config) {\n            _.bindAll(this, 'createOrder');\n\n            if (config.fields) {\n                this.constructor.defaults.fields = config.fields;\n            }\n            this._super();\n            this.sdkLoaded = loadSdkScript(this.scriptParams, this.sdkNamespace).then(function (sdkScript) {\n                this.paypal = sdkScript;\n            }.bind(this));\n            return this;\n        },\n\n        /** @inheritdoc */\n        initObservable: function () {\n            this._super()\n                .observe('shouldCardBeVaulted');\n\n            return this;\n        },\n\n        /**\n         * Check if eligible\n         *\n         * @return {Boolean}\n         */\n        isEligible: function () {\n            return typeof this.paypal !== 'undefined' &&\n                this.paypal.HostedFields &&\n                this.paypal.HostedFields.isEligible();\n        },\n\n        /**\n         * Render fields.\n         *\n         * @return {*}\n         */\n        render: function () {\n            return this.paypal.HostedFields.render({\n                createOrder: this.createOrder,\n                styles: this.styles,\n                fields: this.fields\n            }).then(function (instance) {\n                this.instance = instance;\n\n                return instance;\n            }.bind(this));\n        },\n\n        /**\n         * Calls before create order.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            return Promise.resolve();\n        },\n\n        /**\n         * Create order in payment service / PayPal\n         *\n         * @returns {Promise<any>}\n         */\n        createOrder: function () {\n            return this.beforeCreateOrder()\n                .then(function () {\n                    const shouldCardBeVaulted = this.shouldCardBeVaulted(),\n                        orderData = new FormData();\n\n                    orderData.append('payment_source', this.paymentSource);\n\n                    return fetch(`${this.createOrderUrl}?vault=${shouldCardBeVaulted}`, {\n                        method: 'POST',\n                        headers: {},\n                        body: orderData\n                    });\n                }.bind(this)).then(function (res) {\n                    return res.json();\n                }).then(function (data) {\n                    if (data.response['is_successful']) {\n                        this.onOrderSuccess(data.response['paypal-order']);\n                    } else {\n                        throw new ResponseError(\n                            this.orderCreateErrorMessage[data.response.message] || this.orderCreateErrorMessage.default\n                        );\n                    }\n\n                    return data.response['paypal-order'].id;\n                }.bind(this)).catch(function (error) {\n                    if (error instanceof ResponseError) {\n                        throw error;\n                    }\n                    throw new ResponseError(this.orderCreateErrorMessage.default);\n                }.bind(this));\n        },\n\n        /**\n         * Customizable handler for order creation.\n         */\n        onOrderSuccess: function () {}\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/methods/apple-pay.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'uiComponent',\n    'scriptLoader',\n    'Magento_PaymentServicesPaypal/js/lib/script-loader',\n    'Magento_Customer/js/customer-data',\n    'Magento_Customer/js/model/customer',\n    'mage/translate',\n], function ($, _, Component, loadSdkScript, scriptLoader, customerData, customer, $t) {\n    'use strict';\n\n    const HTTP_STATUS_CREATED = 201;\n\n    const APPLE_PAY_VERSION_NUMBER = 4; // See https://developer.apple.com/documentation/apple_pay_on_the_web/apple_pay_js_api/creating_an_apple_pay_session\n    const appleSDKSrc = 'https://applepay.cdn-apple.com/jsapi/v1/apple-pay-sdk.js';\n\n    /**\n     * Create order request.\n     *\n     * @param {String} url\n     * @param {Object} payPalOrderData\n     * @param {FormData} orderData\n     * @return {Object}\n     */\n    var performCreateOrder = function (url, payPalOrderData, orderData) {\n\n            orderData = orderData || new FormData();\n            orderData.append('form_key', $.mage.cookies.get('form_key'));\n            orderData.append('payment_source', payPalOrderData['paymentSource']);\n\n            let xhr = new XMLHttpRequest();\n            xhr.open('POST', url, false);\n            xhr.send(orderData);\n\n            if (xhr.status !== HTTP_STATUS_CREATED) {\n                throw new Error('Request failed');\n            } else {\n                return JSON.parse(xhr.responseText);\n            }\n        },\n\n        /**\n         * Payment authorization request.\n         *\n         * @return {Promise<Object>}\n         */\n        performOnAuthorize = function (url, data) {\n            var orderData = new FormData();\n\n            orderData.append('form_key', $.mage.cookies.get('form_key'));\n            orderData.append('paypal_order_id', data.orderID);\n\n            return fetch(url, {\n                method: 'POST',\n                headers: {},\n                body: orderData,\n                credentials: 'same-origin'\n            }).then(function (response) {\n                return response.json();\n            });\n        };\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypal',\n            paypal: null,\n            paymentSource: 'applepay',\n            createOrderUrl: '',\n            placeOrderUrl: '',\n            updateQuoteUrl: '',\n            estimateShippingMethodsWhenLoggedInUrl: '',\n            estimateShippingMethodsWhenGuestUrl: '',\n            shippingInformationWhenLoggedInUrl: '',\n            shippingInformationWhenGuestUrl: '',\n            updatePaypalOrderUrl: '',\n            setQuoteAsInactiveUrl: '',\n            countriesUrl: '',\n            instance: null,\n            scriptParams: {},\n            allowedPaymentMethods: null,\n            merchantInfo: null,\n            buttonContainerId: null,\n            paypalOrderId: null,\n            eligible: false,\n            applePayInstance: null,\n            applePayConfig: null,\n            appleSession: null,\n            applePayVersionNumber: APPLE_PAY_VERSION_NUMBER,\n            countryCode: null,\n            regionCode: null,\n            regionId: null,\n            postalCode: null,\n            requestProcessingError: $t('Something went wrong with your request. Please try again later.'),\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            _.bindAll(this, 'createOrder', 'onApprove', 'onError', 'initAppleSDK', 'performAuthorization',\n                'onClick', 'beforeOnAuthorize', 'afterOnAuthorize', 'onCancel');\n            this._super();\n            this.sdkLoaded = Promise.all([this.loadPayPalSDK(), this.loadAppleSDK()]);\n\n            return this;\n        },\n\n        loadPayPalSDK: function () {\n            return loadSdkScript(this.scriptParams, this.sdkNamespace)\n                .then(function (sdkScript) {\n                    this.paypal = sdkScript;\n                }.bind(this))\n                .catch(function (e) {\n                    this.onError(e);\n                });\n        },\n\n        loadAppleSDK: function () {\n            return scriptLoader.loadCustom({url: appleSDKSrc})\n                .catch(function (e) {\n                    this.onError(e);\n                });\n        },\n\n        isCustomerLoggedIn: function () {\n            return customer.isLoggedIn();\n        },\n\n        initAppleSDK: function () {\n            if (!window.ApplePaySession) {\n                console.warn('This device does not support Apple Pay');\n                return;\n            }\n\n            if (!ApplePaySession.canMakePayments()) {\n                console.warn('This device is not capable of making Apple Pay payments');\n            }\n\n            this.applePayInstance = this.paypal.Applepay();\n            return this.applePayInstance.config()\n                .then(applePayConfig => {\n                    this.applePayConfig = applePayConfig;\n                    this.renderApplePayButton();\n                })\n                .catch(applepayConfigError => {\n                    console.error('Error while fetching Apple Pay configuration.');\n                });\n        },\n\n        onApplePayValidateMerchant: function (applePaySession) {\n            applePaySession.onvalidatemerchant = (event) => {\n                this.applePayInstance\n                    .validateMerchant({\n                        validationUrl: event.validationURL,\n                    })\n                    .then((payload) => {\n                        applePaySession.completeMerchantValidation(payload.merchantSession);\n                    })\n                    .catch((error) => {\n                        applePaySession.abort();\n                        this.isErrorDisplayed = false;\n                        this.catchError(error)\n                    });\n            };\n        },\n\n        onApplePayPaymentAuthorized: function (applePaySession, paypalOrderId = null) {\n            applePaySession.onpaymentauthorized = async (event) => {\n                try {\n                    let shippingContact = event.payment.shippingContact;\n\n                    // Remove non-numeric characters from phone number as Paypal doesn't allow it\n                    if (shippingContact && shippingContact.phoneNumber) {\n                        shippingContact = {\n                            ...shippingContact,\n                            phoneNumber: shippingContact.phoneNumber.replace(/\\D/g, '')\n                        };\n                    }\n\n                    await this.applePayInstance.confirmOrder({\n                        orderId: paypalOrderId !== null ? paypalOrderId : this.paypalOrderId,\n                        token: event.payment.token,\n                        billingContact: event.payment.billingContact,\n                        shippingContact: shippingContact\n                    });\n\n                    applePaySession.completePayment({\n                        status: window.ApplePaySession.STATUS_SUCCESS,\n                    });\n\n                    await this.onApprove();\n                } catch (error) {\n                    applePaySession.completePayment({\n                        status: window.ApplePaySession.STATUS_FAILURE,\n                    });\n                    this.isErrorDisplayed = false;\n                    this.catchError(error)\n                }\n            };\n        },\n\n        onApplePayShippingContactSelected: function (applePaySession, quoteId, total, isVirtual) {\n            applePaySession.onshippingcontactselected = (event) => {\n\n                const shippingMethods = [];\n\n                let estimateShippingMethodURL = (this.isCustomerLoggedIn())\n                    ? this.estimateShippingMethodsWhenLoggedInUrl\n                    : this.estimateShippingMethodsWhenGuestUrl.replace(':cartId', quoteId);\n\n                if (this.location === 'product') {\n                    // Product Page: we need to use guest cart quote because it is created outside the checkout process\n                    estimateShippingMethodURL = this.estimateShippingMethodsWhenGuestUrl.replace(':cartId', quoteId);\n                }\n\n                this.countryCode = event.shippingContact.countryCode;\n                this.regionCode = event.shippingContact.administrativeArea;\n                this.postalCode = event.shippingContact.postalCode;\n\n                this.getRegionIdByCode(this.regionCode, this.countryCode)\n                    .then((regionId) => {\n                        this.regionId = regionId;\n                    })\n                    .catch((error)=>  {\n                        // If the Apple region Code doesn't match to the one in Commerce\n                        // we set the regionId to null to still apply the taxes of the country\n                        // to continue with the checkout\n                        console.log(error);\n                        this.regionId = null;\n                    });\n\n                $.ajax({\n                    type: 'POST',\n                    url: estimateShippingMethodURL,\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    data: JSON.stringify({\n                        address: {\n                            country_id: event.shippingContact.countryCode,\n                            postcode: event.shippingContact.postalCode,\n                            city: event.shippingContact.locality\n                        }\n                    })\n                }).then(estimateShippingMethods => {\n\n                    estimateShippingMethods.forEach(method => {\n                        shippingMethods.push({\n                            label: method.method_title,\n                            detail: method.carrier_title,\n                            amount: method.amount.toString(),\n                            identifier: method.carrier_code + '_' + method.method_code,\n                        });\n                    });\n\n                    applePaySession.completeShippingContactSelection({\n                        newShippingMethods: shippingMethods,\n                        newTotal: total,\n                    })\n\n                }, error => {\n                    this.isErrorDisplayed = false;\n                    applePaySession.abort();\n                    this.catchError(error);\n                });\n\n                if (isVirtual) {\n                    // If Quote is virtual, no need to select shipping\n                    // We can already create the order\n                    this.createOrder();\n                }\n            }\n        },\n\n        onApplePayShippingMethodSelectedInCartPage: function (applePaySession, quoteId) {\n            this.onApplePayShippingMethodSelected(applePaySession, quoteId, null,null);\n        },\n\n        onApplePayShippingMethodSelected: function (applePaySession, quoteId, quoteMaskedId, paypalOrderId) {\n           applePaySession.onshippingmethodselected = (event) => {\n\n                let shippingInformationURL = (this.isCustomerLoggedIn())\n                    ? this.shippingInformationWhenLoggedInUrl\n                    : this.shippingInformationWhenGuestUrl.replace(':quoteId', quoteId);\n\n                if (this.location === 'product') {\n                    // Product Page: we need to use quoteMaskedId as the quote is created outside the checkout process\n                    shippingInformationURL = this.shippingInformationWhenGuestUrl.replace(':quoteId', quoteMaskedId);\n                }\n\n                $.ajax({\n                    type: 'POST',\n                    url: shippingInformationURL,\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    data: JSON.stringify({\n                        addressInformation: {\n                            shipping_address: {\"country_id\": this.countryCode, \"region_id\": this.regionId, \"postcode\": this.postalCode},\n                            shipping_method_code: event.shippingMethod.identifier.split('_')[1],\n                            shipping_carrier_code: event.shippingMethod.identifier.split('_')[0],\n                            extension_attributes: {}\n                        }\n                    })\n                }).then(result => {\n\n                    let items = [];\n\n                    result['totals']['items'].forEach(item => {\n                        items.push({\n                            label: item.name + ' ( x ' + item.qty + ' )',\n                            type: \"final\",\n                            amount: item.row_total\n                        });\n                    });\n\n                    items.push({\n                        label: \"Shipping\",\n                        type: \"final\",\n                        amount: result['totals']['shipping_amount'],\n                    });\n\n                    if (result['totals']['tax_amount'] !== 0) {\n                        items.push({\n                            label: \"Tax\",\n                            type: \"final\",\n                            amount: result['totals']['tax_amount'],\n                        });\n                    }\n\n                    applePaySession.completeShippingMethodSelection({\n                        newLineItems: items,\n                        newTotal: {\n                            label: \"Summary\",\n                            type: \"final\",\n                            amount: result['totals']['grand_total'],\n                        },\n                    });\n\n                    if (this.location === 'product') {\n                        // In the product page, the paypal order has been created on the onClick handler\n                        // so we just need to update the amount with the shipping selected\n                        this.updatePaypalOrder();\n                    } else {\n                        // In Cart and Minicart, we need to create the Paypal Order\n                        this.createOrder();\n                    }\n\n                }).catch(error => {\n                    applePaySession.abort();\n                    this.isErrorDisplayed = false;\n                    this.catchError(error);\n                });\n            };\n        },\n\n        updatePaypalOrder: function() {\n\n            // Update PayPal Order Amount as the shipping method has been selected and the price changed\n            // Without the update, the payment is failing as the order amount could be different\n            $.ajax({\n                type: 'POST',\n                url: this.updatePayPalOrderUrl,\n            }).catch(error => {\n                this.catchError(error);\n            });\n        },\n\n        onApplePayCancel: function (applePaySession, callback) {\n            applePaySession.oncancel = () => {\n                if (typeof callback === 'function') {\n                    callback();\n                }\n\n                this.showLoader(false);\n            }\n        },\n\n        getApplePaymentRequestLineItems: function (quote){\n            let items = [];\n\n            quote.getItems().forEach(item => {\n                items.push({\n                    label: item.name + ' ( x ' + item.qty + ' )',\n                    type: \"final\",\n                    amount: item.price * item.qty,\n                });\n            });\n\n            items.push({\n                label: $t(\"Shipping\"),\n                type: \"final\",\n                amount: quote.getTotals()()['shipping_amount'],\n            });\n\n            if (quote.getTotals()['tax_amount'] !== 0) {\n                items.push({\n                    label: $t(\"Tax\"),\n                    type: \"final\",\n                    amount: quote.getTotals()()['tax_amount'],\n                });\n            }\n\n            return items;\n        },\n\n        showPopup: function (paymentData, quote) {\n            const paymentRequest = {\n                countryCode: this.applePayConfig.countryCode,\n                merchantCapabilities: this.applePayConfig.merchantCapabilities,\n                supportedNetworks: this.applePayConfig.supportedNetworks,\n                currencyCode: paymentData.response['paypal-order']['currency_code'],\n                lineItems: this.getApplePaymentRequestLineItems(quote),\n                requiredBillingContactFields: [\"postalAddress\"],\n                shippingContact: {\n                    countryCode: quote.shippingAddress().countryId,\n                    postalCode: quote.shippingAddress().postcode,\n                    locality: quote.shippingAddress().city,\n                    administrativeArea: quote.shippingAddress().regionCode,\n                    familyName: quote.shippingAddress().lastname,\n                    givenName: quote.shippingAddress().firstname,\n                    addressLines: quote.shippingAddress().street,\n                },\n                total: {\n                    label: $t(\"Summary\"),\n                    type: \"final\",\n                    amount: Number(paymentData.response['paypal-order']['amount']).toString(),\n                }\n            };\n\n            // See https://developer.apple.com/documentation/apple_pay_on_the_web/applepaysession\n            this.applePaySession = new ApplePaySession(APPLE_PAY_VERSION_NUMBER, paymentRequest);\n            this.onApplePayValidateMerchant(this.applePaySession);\n            this.onApplePayPaymentAuthorized(this.applePaySession, paymentData.response['paypal-order']['id']);\n            this.onApplePayCancel(this.applePaySession);\n\n            this.applePaySession.begin();\n        },\n\n        onCancel: function () {\n            window.location = data.redirectUrl;\n            this.showLoader(false);\n        },\n\n        renderApplePayButton: function () {\n            if (this.applePayConfig.isEligible) {\n                const buttonStyle = this.mapButtonStyle();\n                const buttonType = this.mapButtonType();\n                const height = this.styles.height > 0\n                    ? this.styles.height + \"px\"\n                    : \"40px\";\n\n                const btnId = this.generateUniqueElementId();\n                document.getElementById(this.buttonContainerId).innerHTML = `\n                <apple-pay-button\n                    id=\"${btnId}\"\n                    buttonstyle=\"${buttonStyle}\"\n                    type=\"${buttonType}\"\n                    locale=\"${window.LOCALE}\"\n                    style=\" --apple-pay-button-width: 100%; --apple-pay-button-height: ${height}\"\n                >`;\n                document.getElementById(btnId).addEventListener(\"click\", this.onClick);\n            }\n        },\n\n        generateUniqueElementId: function() {\n            return `btn-appl-${Date.now()}-${Math.floor(Math.random() * 1000)}`;\n        },\n\n        mapButtonStyle: function () {\n            return this.styles.color === 'white' ? 'white' : 'black';\n        },\n\n        mapButtonType: function () {\n            switch (this.styles.label) {\n                case 'paypal':\n                case 'installment':\n                    return 'plain';\n                case 'checkout':\n                    return 'check-out';\n                case 'buynow':\n                    return 'buy';\n                default:\n                    return 'pay';\n            }\n        },\n\n        enableButton: function () {\n            $('#' + this.buttonContainerId).find('button').prop('disabled', false);\n        },\n\n        disableButton: function () {\n            $('#' + this.buttonContainerId).find('button').prop('disabled', true);\n        },\n\n        performAuthorization: function (paymentData) {},\n\n        onClick: function () {},\n\n        /**\n         * Calls before create order.\n         */\n        beforeCreateOrder: function () {},\n\n        /**\n         * Create order.\n         *\n         * @return {String}\n         */\n        createOrder: function () {\n            let data = {'paymentSource': this.paymentSource};\n\n            // add location to the order create request\n            let createOrderData = new FormData();\n            createOrderData.append('location', this.location);\n\n            try {\n                this.beforeCreateOrder();\n                let orderData = performCreateOrder(this.createOrderUrl, data, createOrderData);\n                this.paypalOrderId = this.afterCreateOrder(orderData);\n                return this.paypalOrderId;\n            } catch (error) {\n                this.isErrorDisplayed = false;\n                this.catchError(error);\n\n                // Propagate the error to be caught in the promise chain\n                return Promise.reject(error);\n            }\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {},\n\n        /**\n         * Catch error on order creation.\n         */\n        catchCreateOrder: function () {},\n\n        /**\n         * On payment approve.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         * @return {Promise}\n         */\n        onApprove: function () {\n            const data = {orderID: this.paypalOrderId};\n\n            return this.beforeOnAuthorize()\n                .then(performOnAuthorize.bind(this, this.updateQuoteUrl, data))\n                .then(this.afterOnAuthorize)\n                .catch(this.onError);\n        },\n\n        beforeOnAuthorize: function () {\n            return Promise.resolve();\n        },\n\n        afterOnAuthorize: function () {\n            return Promise.resolve();\n        },\n\n        /**\n         * Calls when error happened on paypal side.\n         *\n         * @param {Error} error\n         */\n        onError: function (error) {\n            console.log('Error: ', error.message);\n        },\n\n        isEligible: function () {\n            return this.eligible;\n        },\n\n        /**\n         * Async Show/hide loader\n         *\n         * @param {Boolean} show\n         */\n        showLoaderAsync: function (show) {\n            return new Promise(function (resolve, reject) {\n                var event = show ? 'processStart' : 'processStop';\n                $('body').trigger(event);\n\n                // Set minimum time for loader to show\n                setTimeout(() => {\n                    resolve();\n                }, 50);\n            });\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            var event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n\n        /**\n         *  Get region ID by region code and country code\n         *\n         * @param regionCode\n         * @param countryCode\n         * @returns {null}\n         */\n        getRegionIdByCode: function (regionCode, countryCode) {\n            return new Promise(function (resolve, reject) {\n                $.ajax({\n                    url: this.countriesUrl.replace(':countryCode', countryCode),\n                    method: 'GET',\n                    success: function (response) {\n                        if (response.available_regions && response.available_regions.length) {\n                            var matchedRegion = response.available_regions.find(function (region) {\n                                return region.code === regionCode;\n                            });\n\n                            if (matchedRegion) {\n                                resolve(matchedRegion.id);\n                            } else {\n                                reject('Region not found');\n                            }\n                        } else {\n                            reject('No regions available for country: ' + countryCode);\n                        }\n                    },\n                    error: function () {\n                        reject('Error fetching regions for country: ' + countryCode);\n                    }\n                });\n            }.bind(this));\n        },\n\n        /**\n         * Catch errors.\n         *\n         * @param {*} error\n         */\n        catchError: function (error) {\n            this.showLoader(false);\n\n            if (this.isErrorDisplayed) {\n                return;\n            }\n\n            if (error.hidden === undefined || !error.hidden) {\n                this.addMessage(this.requestProcessingError);\n            }\n\n            this.isErrorDisplayed = true;\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n\n            // Need to set a slight delay to avoid refresh from core\n            setTimeout(function () {\n                customerData.set('messages', {\n                    messages: [{\n                        text: message,\n                        type: type\n                    }]\n                });\n            }, 1000);\n        },\n\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/methods/google-pay.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'uiComponent',\n    'scriptLoader',\n    'Magento_PaymentServicesPaypal/js/lib/script-loader',\n    'mage/translate',\n    'mage/cookies'\n], function ($, _, Component, loadSdkScript, scriptLoader, $t) {\n    'use strict';\n\n    const HTTP_STATUS_CREATED = 201;\n\n    const googleSDKSrc = 'https://pay.google.com/gp/p/js/pay.js',\n        baseRequest = {\n            apiVersion: 2,\n            apiVersionMinor: 0,\n            callbackIntents: ['PAYMENT_AUTHORIZATION'],\n            emailRequired: true,\n            shippingAddressParameters: {phoneNumberRequired: true}\n        };\n\n    /**\n     * Create order request.\n     *\n     * @param {String} url\n     * @param {Object} payPalOrderData\n     * @param {FormData} orderData\n     * @param {String | false} threeDSMode\n     * @return {Object}\n     */\n    var performCreateOrder = function (url, payPalOrderData, orderData, threeDSMode) {\n\n            orderData = orderData || new FormData();\n            orderData.append('form_key', $.mage.cookies.get('form_key'));\n            orderData.append('payment_source', payPalOrderData['paymentSource']);\n\n            if (threeDSMode) {\n                orderData.append('three_ds_mode', threeDSMode);\n            }\n\n            let xhr = new XMLHttpRequest();\n            xhr.open('POST', url, false);\n            xhr.send(orderData);\n\n            if (xhr.status !== HTTP_STATUS_CREATED) {\n                throw new Error('Request failed');\n            } else {\n                return JSON.parse(xhr.responseText);\n            }\n        },\n\n        /**\n         * Payment authorization request.\n         *\n         * @return {Promise<Object>}\n         */\n        performOnAuthorize = function (url, data) {\n            var orderData = new FormData();\n\n            orderData.append('form_key', $.mage.cookies.get('form_key'));\n            orderData.append('paypal_order_id', data.orderID);\n\n            return fetch(url, {\n                method: 'POST',\n                headers: {},\n                body: orderData,\n                credentials: 'same-origin'\n            }).then(function (response) {\n                return response.json();\n            });\n        };\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypal',\n            paypal: null,\n            paymentSource: 'googlepay',\n            createOrderUrl: '',\n            updateQuoteUrl: '',\n            setQuoteAsInactiveUrl: '',\n            instance: null,\n            scriptParams: {},\n            allowedPaymentMethods: null,\n            merchantInfo: null,\n            buttonContainerId: null,\n            paypalOrderId: null,\n            eligible: false,\n            mode: 'TEST',\n            shippingAddressRequired: true,\n            getOrderDetailsUrl: '',\n            threeDSMode: '',\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            _.bindAll(this, 'createOrder', 'onApprove', 'onError', 'initGoogleSDK', 'performAuthorization',\n                'onClick', 'beforeOnAuthorize', 'afterOnAuthorize', 'onCancel');\n            this._super();\n            this.sdkLoaded = Promise.all([this.loadPayPalSDK(), this.loadGoogleSDK()]);\n\n            return this;\n        },\n\n        loadPayPalSDK: function () {\n            return loadSdkScript(this.scriptParams, this.sdkNamespace)\n                .then(function (sdkScript) {\n                    this.paypal = sdkScript;\n                }.bind(this))\n                .catch(function (e) {\n                    this.onError(e);\n                });\n        },\n\n        loadGoogleSDK: function () {\n            return scriptLoader.loadCustom({url: googleSDKSrc})\n                .catch(function (e) {\n                    this.onError(e);\n                });\n        },\n\n        initGoogleSDK: function () {\n            return this.getGooglePayConfig()\n                .then(config =>\n                    this.getGooglePaymentsClient()\n                        .isReadyToPay(this.getGoogleIsReadyToPayRequest(config.allowedPaymentMethods))\n                        .then(function (response) {\n                            if (response.result) {\n                                this.renderGooglePayButton();\n                            }\n                        }.bind(this))\n                ).catch(function (e) {\n                    this.onError({\n                        hidden: true,\n                        error: e\n                    });\n                }.bind(this));\n        },\n\n        getGooglePaymentsClient: function () {\n            if (this.instance === null) {\n                this.instance = new google.payments.api.PaymentsClient({\n                    environment: this.mode,\n                    paymentDataCallbacks: {\n                        onPaymentAuthorized: this.performAuthorization\n                    }\n                });\n            }\n            return this.instance;\n        },\n\n        showPopup: function (paymentData) {\n            this.getGooglePaymentDataRequest(paymentData)\n                .then((data) => {\n                    this.getGooglePaymentsClient()\n                        .loadPaymentData(data)\n                        .catch(this.onCancel);\n                }).catch((error) => this.onError(error));\n        },\n\n        onCancel: function () {\n            this.showLoader(false);\n        },\n\n        getGooglePaymentDataRequest: async function (transactionInfo) {\n            const paymentDataRequest = Object.assign({}, baseRequest),\n                {allowedPaymentMethods, merchantInfo} = await this.getGooglePayConfig();\n\n            paymentDataRequest.allowedPaymentMethods = allowedPaymentMethods;\n            paymentDataRequest.transactionInfo = transactionInfo;\n            paymentDataRequest.merchantInfo = merchantInfo;\n            paymentDataRequest.shippingAddressRequired = this.shippingAddressRequired;\n\n            return paymentDataRequest;\n        },\n\n        getGooglePayConfig: async function () {\n            if (this.allowedPaymentMethods === null || this.merchantInfo === null) {\n                const googlePayConfig = await this.paypal.Googlepay().config();\n\n                this.allowedPaymentMethods = googlePayConfig.allowedPaymentMethods;\n                this.merchantInfo = googlePayConfig.merchantInfo;\n            }\n\n            return {\n                allowedPaymentMethods: this.allowedPaymentMethods,\n                merchantInfo: this.merchantInfo\n            };\n        },\n\n        getGoogleIsReadyToPayRequest: function (allowedPaymentMethods) {\n            return Object.assign({}, baseRequest, {\n                allowedPaymentMethods: allowedPaymentMethods\n            });\n        },\n\n        renderGooglePayButton: function () {\n            const buttonContainer = $('#' + this.buttonContainerId);\n\n            let buttonProps = {\n                onClick: this.onClick,\n                buttonColor: this.styles.button_color,\n                buttonType: this.styles.button_type\n            };\n\n            buttonProps.buttonSizeMode = 'fill';\n\n            if (this.styles.button_custom_height) {\n                buttonContainer.height(this.styles.button_custom_height);\n            }\n\n            buttonContainer.append(\n                this.getGooglePaymentsClient().createButton(buttonProps)\n            );\n            this.eligible = true;\n        },\n\n        enableButton: function () {\n            $('#' + this.buttonContainerId).find('button').prop('disabled', false);\n        },\n\n        disableButton: function () {\n            $('#' + this.buttonContainerId).find('button').prop('disabled', true);\n        },\n\n        performAuthorization: function (paymentData) {\n            return new Promise(function (resolve) {\n                this.processPayment(paymentData)\n                    .then(resolve)\n                    .catch(function () {\n                        this.onError(new Error('couldn\\'t process payment'));\n                        resolve({transactionState: 'ERROR'});\n                    }.bind(this));\n            }.bind(this));\n        },\n\n        processPayment: async function (paymentData) {\n            try {\n                const {status} = await this.paypal.Googlepay().confirmOrder({\n                    orderId: this.paypalOrderId,\n                    paymentMethodData: paymentData.paymentMethodData,\n                    shippingAddress: paymentData.shippingAddress,\n                    email: paymentData.email\n                });\n\n                if (status === 'APPROVED') {\n                    this.onApprove(paymentData);\n                    return {transactionState: 'SUCCESS'};\n                }\n\n                if (status === 'PAYER_ACTION_REQUIRED') {\n                    this.paypal.Googlepay().initiatePayerAction({orderId: this.paypalOrderId}).then(\n                        async () => {\n                            return fetch(`${this.getOrderDetailsUrl}`, {\n                                method: 'GET'\n                            }).then((res) => {\n                                return res.json();\n                            }).then((data) => {\n                                if (data.response['is_successful'] && data.response['paypal-order']) {\n                                    const order = data.response['paypal-order'];\n                                    let authenticationResult = order.payment_source_details.card.authentication_result;\n                                    if (authenticationResult\n                                        && (\n                                            authenticationResult.liability_shift === 'POSSIBLE'\n                                            || authenticationResult.liability_shift === \"YES\"\n                                            || authenticationResult.liability_shift === undefined\n                                        )\n                                    ) {\n                                        this.onApprove(paymentData);\n                                    } else {\n                                        this.onError(new Error('couldn\\'t approve order using 3DS'));\n                                    }\n                                }\n                            }).catch((error) => {\n                                console.log(\"ERROR: \", error)\n                                this.onError(new Error('couldn\\'t approve order using 3DS'));\n                            })\n                        }\n                    ).catch((error) => {\n                        console.log(\"ERROR: \", error)\n                        this.onError(new Error('couldn\\'t approve order using 3DS'));\n                    });\n\n                    return {transactionState: 'SUCCESS'};\n                }\n\n                this.onError(new Error('couldn\\'t process payment'));\n\n                return {transactionState: 'ERROR'};\n            } catch (err) {\n                this.onError(err);\n                return {\n                    transactionState: 'ERROR',\n                    error: {\n                        message: err.message\n                    }\n                };\n            }\n        },\n\n        onClick: function () {\n        },\n\n        /**\n         * Calls before create order.\n         */\n        beforeCreateOrder: function () {\n        },\n\n        /**\n         * Create order.\n         *\n         * @return {String}\n         */\n        createOrder: function () {\n            let data = {'paymentSource': this.paymentSource};\n\n            try {\n                this.beforeCreateOrder();\n\n                // add location to the order create request\n                let formData = new FormData();\n                formData.append('location', this.location);\n\n                let orderData = performCreateOrder(this.createOrderUrl, data, formData, this.threeDSMode);\n                this.paypalOrderId = this.afterCreateOrder(orderData);\n                return this.paypalOrderId;\n            } catch (error) {\n                return this.catchCreateOrder(error);\n            }\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n\n                this.showPopup({\n                    displayItems: [],\n                    currencyCode: data.response['paypal-order']['currency_code'],\n                    totalPriceStatus: 'FINAL',\n                    totalPrice: Number(data.response['paypal-order']['amount']).toString(),\n                    totalPriceLabel: $t('Total')\n                });\n\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        /**\n         * Catch error on order creation.\n         */\n        catchCreateOrder: function () {\n        },\n\n        /**\n         * On payment approve.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         * @return {Promise}\n         */\n        onApprove: function () {\n            const data = {orderID: this.paypalOrderId};\n\n            return this.beforeOnAuthorize()\n                .then(performOnAuthorize.bind(this, this.updateQuoteUrl, data))\n                .then(this.afterOnAuthorize)\n                .catch(this.onError);\n        },\n\n        beforeOnAuthorize: function () {\n            return Promise.resolve();\n        },\n\n        afterOnAuthorize: function () {\n            return Promise.resolve();\n        },\n\n        /**\n         * Calls when error happened on PayPal side.\n         *\n         * @param {Error} error\n         */\n        onError: function (error) {\n            console.log('Error: ', error.message);\n        },\n\n        isEligible: function () {\n            return this.eligible;\n        },\n\n        /**\n         * Async Show/hide loader\n         *\n         * @param {Boolean} show\n         */\n        showLoaderAsync: function (show) {\n            return new Promise(function (resolve, reject) {\n                var event = show ? 'processStart' : 'processStop';\n                $('body').trigger(event);\n\n                // Set minimum time for loader to show\n                setTimeout(() => {\n                    resolve();\n                }, 10);\n            });\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            var event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/apple-pay.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'Magento_Checkout/js/view/payment/default',\n    'jquery',\n    'underscore',\n    'mageUtils',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'mage/translate',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/apple-pay',\n    'Magento_Checkout/js/model/payment/additional-validators',\n    'Magento_Checkout/js/action/set-billing-address',\n    'Magento_Ui/js/model/messageList',\n    'Magento_Customer/js/customer-data'\n], function (\n    Component,\n    $,\n    _,\n    utils,\n    quote,\n    fullScreenLoader,\n    $t,\n    ApplePayButton,\n    additionalValidators,\n    setBillingAddressAction,\n    globalMessageList,\n    customerData\n) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url,\n            }\n        );\n    }\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalApplePay',\n            fundingSource: 'applepay',\n            buttonContainerId: 'apple-pay-${ $.uid }',\n            template: 'Magento_PaymentServicesPaypal/payment/apple-pay',\n            isAvailable: false,\n            isButtonRendered: false,\n            grandTotalAmount: null,\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            paymentTypeIconTitle: $t('Pay with Apple Pay'),\n            requestProcessingError: $t('Error happened when processing the request. Please try again later.'),\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            paymentTypeIconUrl: window.checkoutConfig.payment['payment_services_paypal_apple_pay'].paymentTypeIconUrl\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config) {\n            _.bindAll(this, 'catchError', 'beforeCreateOrder', 'afterCreateOrder', 'placeOrder', 'onClick');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.initApplePayButton();\n\n            return this;\n        },\n\n        /**\n         * Initialize observables\n         *\n         * @returns {Component} Chainable.\n         */\n        initObservable: function () {\n            this._super().observe('grandTotalAmount isAvailable isButtonRendered');\n            this.grandTotalAmount(quote.totals()['base_grand_total']);\n\n            return this;\n        },\n\n        /**\n         * Create instance of smart buttons.\n         */\n        initApplePayButton: function () {\n            this.applePayButton = new ApplePayButton({\n                scriptParams: window.checkoutConfig.payment[this.getCode()].sdkParams,\n                createOrderUrl: window.checkoutConfig.payment[this.getCode()].createOrderUrl,\n                estimateShippingMethodsWhenLoggedInUrl: window.checkoutConfig.payment[this.getCode()].estimateShippingMethodsWhenLoggedInUrl,\n                estimateShippingMethodsWhenGuestUrl: window.checkoutConfig.payment[this.getCode()].estimateShippingMethodsWhenGuestUrl,\n                shippingInformationWhenLoggedInUrl: window.checkoutConfig.payment[this.getCode()].shippingInformationWhenLoggedInUrl,\n                shippingInformationWhenGuestUrl: window.checkoutConfig.payment[this.getCode()].shippingInformationWhenGuestUrl,\n                updatePayPalOrderUrl: window.checkoutConfig.payment[this.getCode()].updatePayPalOrderUrl,\n                countriesUrl: window.checkoutConfig.payment[this.getCode()].countriesUrl,\n                onClick: this.onClick,\n                beforeCreateOrder: this.beforeCreateOrder,\n                afterCreateOrder: this.afterCreateOrder,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                onApprove: this.placeOrder,\n                styles: window.checkoutConfig.payment[this.getCode()].buttonStyles,\n                location: window.checkoutConfig.payment[this.getCode()].location,\n            });\n        },\n\n        /**\n         * Get method code\n         *\n         * @return {String}\n         */\n        getCode: function () {\n            return 'payment_services_paypal_apple_pay';\n        },\n\n        /**\n         * Get method data\n         *\n         * @return {Object}\n         */\n        getData: function () {\n            return {\n                'method': this.item.method,\n                'additional_data': {\n                    'payments_order_id': this.paymentsOrderId,\n                    'paypal_order_id': this.paypalOrderId,\n                    'payment_source': this.fundingSource\n                }\n            };\n        },\n\n        /**\n         * Render buttons\n         */\n        afterRender: function () {\n            this.applePayButton.sdkLoaded\n                .then(this.applePayButton.initAppleSDK)\n                .then(function () {\n                        this.isAvailable(true);\n                        this.isButtonRendered(true);\n                    }.bind(this)\n                ).catch(function () {\n                this.isAvailable(false);\n            }.bind(this)).finally(function () {\n                this.isButtonRendered(true);\n            }.bind(this));\n        },\n\n        /**\n         * Enable/disable buttons.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         */\n        onInit: function (data, actions) {\n            if (!this.isPlaceOrderActionAllowed()) {\n                actions.disable();\n            }\n\n            this.isPlaceOrderActionAllowed.subscribe(function (isAllowed) {\n                if (isAllowed) {\n                    actions.enable();\n                } else {\n                    actions.disable();\n                }\n            });\n        },\n\n        /**\n         * Validate form onClick\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         * @return {*}\n         */\n        onClick: function (data, actions) {\n            this.applePayButton.showLoaderAsync(true)\n                .then(() => {\n                    this.applePayButton.createOrder();\n                })\n                .then(() => {\n                    refreshCustomerData(window.checkoutConfig.payment[this.getCode()].createOrderUrl);\n                })\n                .catch(error => {\n                    this.catchError(error);\n                });\n        },\n\n        /**\n         * Before order created.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            if (this.validate() && this.isPlaceOrderActionAllowed() && additionalValidators.validate()) {\n                return new Promise(function (resolve, reject) {\n                    setBillingAddressAction(globalMessageList).done(resolve.bind(null, null)).fail(reject);\n                });\n            } else {\n                throw {message: 'before create order validation failed', hidden: true};\n            }\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n\n                this.applePayButton.showPopup(data, quote);\n\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        /**\n         * Catch error.\n         *\n         * @param {Error} error\n         */\n        catchError: function (error) {\n            this.messageContainer.addErrorMessage({\n                message: this.requestProcessingError\n            });\n            console.log('Error: ', error.message);\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/google-pay.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'Magento_Checkout/js/view/payment/default',\n    'jquery',\n    'underscore',\n    'mageUtils',\n    'Magento_Checkout/js/model/quote',\n    'mage/translate',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/google-pay',\n    'Magento_Checkout/js/model/payment/additional-validators',\n    'Magento_Checkout/js/action/set-billing-address',\n    'Magento_Ui/js/model/messageList',\n    'uiRegistry',\n    'Magento_Customer/js/customer-data'\n], function (\n    Component,\n    $,\n    _,\n    utils,\n    quote,\n    $t,\n    GooglePayButton,\n    additionalValidators,\n    setBillingAddressAction,\n    globalMessageList,\n    registry,\n    customerData\n) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url,\n            }\n        );\n    }\n\n    return Component.extend({\n        defaults: {\n            buttonContainerId: 'google-pay-${ $.uid }',\n            template: 'Magento_PaymentServicesPaypal/payment/google-pay',\n            isAvailable: false,\n            isButtonRendered: false,\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            paymentTypeIconTitle: $t('Pay with Google Pay'),\n            requestProcessingError: $t('Error happened when processing the request. Please try again later.'),\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            paymentTypeIconUrl:  window.checkoutConfig.payment['payment_services_paypal_google_pay'].paymentTypeIconUrl,\n            fundingSource: window.checkoutConfig.payment['payment_services_paypal_google_pay'].paymentSource\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config) {\n            _.bindAll(this, 'catchError', 'beforeCreateOrder', 'afterCreateOrder', 'placeOrder', 'onClick');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.initGooglePayButton();\n\n            return this;\n        },\n\n        /**\n         * Initialize observables\n         *\n         * @returns {Component} Chainable.\n         */\n        initObservable: function () {\n            this._super().observe('isAvailable isButtonRendered');\n\n            return this;\n        },\n\n        initGooglePayButton: function () {\n            this.googlePayButton = new GooglePayButton({\n                scriptParams: window.checkoutConfig.payment[this.getCode()].sdkParams,\n                createOrderUrl: window.checkoutConfig.payment[this.getCode()].createOrderUrl,\n                onClick: this.onClick,\n                beforeCreateOrder: this.beforeCreateOrder,\n                afterCreateOrder: this.afterCreateOrder,\n                catchCreateOrder: this.catchError,\n                onError: this.catchError,\n                buttonContainerId: this.buttonContainerId,\n                onApprove: this.placeOrder,\n                styles: window.checkoutConfig.payment[this.getCode()].styles,\n                mode: window.checkoutConfig.payment[this.getCode()].mode,\n                shippingAddressRequired: false,\n                getOrderDetailsUrl: window.checkoutConfig.payment[this.getCode()].getOrderDetailsUrl,\n                threeDSMode: window.checkoutConfig.payment[this.getCode()].threeDSMode,\n                location: window.checkoutConfig.payment[this.getCode()].location,\n            });\n\n            if (!this.isPlaceOrderActionAllowed()) {\n                this.googlePayButton.disableButton();\n            }\n\n            this.isPlaceOrderActionAllowed.subscribe(function (isAllowed) {\n                if (isAllowed) {\n                    this.googlePayButton.enableButton();\n                } else {\n                    this.googlePayButton.disableButton();\n                }\n            }.bind(this));\n        },\n\n        /**\n         * Get method code\n         *\n         * @return {String}\n         */\n        getCode: function () {\n            return 'payment_services_paypal_google_pay';\n        },\n\n        /**\n         * Get method data\n         *\n         * @return {Object}\n         */\n        getData: function () {\n            return {\n                'method': this.item.method,\n                'additional_data': {\n                    'payments_order_id': this.paymentsOrderId,\n                    'paypal_order_id': this.paypalOrderId,\n                    'payment_source': this.fundingSource\n                }\n            };\n        },\n\n        onClick: function () {\n            this.googlePayButton.showLoaderAsync(true)\n                .then(() => {\n                    return this.googlePayButton.createOrder();\n                })\n                .then(() => {\n                    refreshCustomerData(window.checkoutConfig.payment[this.getCode()].createOrderUrl);\n                })\n                .catch(error => {\n                    this.catchError(error);\n                });\n        },\n\n        /**\n         * Render buttons\n         */\n        afterRender: function () {\n            this.googlePayButton.sdkLoaded\n                .then(function () {\n                    this.googlePayButton.initGoogleSDK()\n                        .then(function () {\n                            this.isAvailable(this.googlePayButton.isEligible());\n                        }.bind(this)).catch(function () {\n                            this.isAvailable(false);\n                        }.bind(this)).finally(function () {\n                            this.isButtonRendered(true);\n                        }.bind(this)\n                    );\n                }.bind(this));\n        },\n\n        /**\n         * Before order created.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            if (this.validate() && this.isPlaceOrderActionAllowed() && additionalValidators.validate()) {\n                setBillingAddressAction(globalMessageList)\n                    .fail(function () {\n                        throw {message: 'Failed to set billing address'};\n                    });\n            } else {\n                throw {message: 'before create order validation failed', hidden: true};\n            }\n        },\n\n        /**\n         * @inheritdoc\n         */\n        validate: function () {\n            var isShippingValid = true,\n                source, shippingAddress;\n\n            if (!this._super()) {\n                return false;\n            }\n            source = registry.get('checkoutProvider');\n            shippingAddress = registry.get('index = shippingAddress');\n\n            if (source && shippingAddress) {\n                source.set('params.invalid', false);\n                if (quote.billingAddress() === null) {\n                    this.triggerBillingValidation(source);\n                }\n\n                // skip shipping validation if quote is virtual or in-store pickup\n                if (!quote.isVirtual() && !quote.shippingMethod()['method_code'] === 'pickup') {\n                    isShippingValid = shippingAddress.validateShippingInformation();\n                }\n\n                return isShippingValid && !source.get('params.invalid');\n            }\n\n            return true;\n        },\n\n        /**\n         * Trigger billing address validation\n         *\n         * @param {Object} source\n         */\n        triggerBillingValidation: function (source) {\n            var dataScope = `billingAddress${ window.checkoutConfig.displayBillingOnPaymentMethod ?\n                this.getCode() : 'shared'}`;\n\n            source.trigger(`${ dataScope }.data.validate`);\n\n            if (source.get(`${dataScope}.custom_attributes`)) {\n                source.trigger(`${dataScope}.custom_attributes.data.validate`);\n            }\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n\n                let displayItems = [],\n                    subTotal = this.getTotalsSegment('subtotal'),\n                    shippingTotal = this.getTotalsSegment('shipping'),\n                    taxTotal = this.getTotalsSegment('tax'),\n                    discountTotal = this.getTotalsSegment('discount');\n\n                if (subTotal != null) {\n                    displayItems.push(\n                        {\n                            label: $t('Subtotal'),\n                            type: 'SUBTOTAL',\n                            price: subTotal.value.toString()\n                        }\n                    );\n                }\n                if (taxTotal != null) {\n                    displayItems.push(\n                        {\n                            label: $t('Tax'),\n                            type: 'TAX',\n                            price: taxTotal.value.toString()\n                        }\n                    );\n                }\n\n                if (shippingTotal != null) {\n                    displayItems.push(\n                        {\n                            label: $t('Shipping'),\n                            type: 'LINE_ITEM',\n                            price: shippingTotal.value.toString()\n                        }\n                    );\n                }\n\n                if (discountTotal != null) {\n                    displayItems.push(\n                        {\n                            label: $t('Discount'),\n                            type: 'LINE_ITEM',\n                            price: discountTotal.value.toString()\n                        }\n                    );\n                }\n\n                this.googlePayButton.showPopup({\n                    displayItems: displayItems,\n                    currencyCode: quote.totals()['base_currency_code'].toString(),\n                    totalPriceStatus: 'FINAL',\n                    totalPrice: quote.totals()['base_grand_total'].toString(),\n                    totalPriceLabel: $t('Total')\n                });\n\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        /**\n         * Catch error.\n         *\n         * @param {Error} error\n         */\n        catchError: function (error) {\n            if (error.hidden === undefined || !error.hidden) {\n                this.messageContainer.addErrorMessage({\n                    message: this.requestProcessingError\n                });\n            }\n\n            this.googlePayButton.showLoader(false);\n\n            console.log('Error: ', error);\n        },\n\n        getTotalsSegment: function (code) {\n            var segment = null;\n\n            if (!('total_segments' in quote.totals())) {\n                return null;\n            }\n\n            quote.totals()['total_segments'].forEach(function (s) {\n                if (s.code === code) {\n                    segment = s;\n                }\n            });\n\n            return segment;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/vault.js":"/**\n * Copyright \u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'mage/translate',\n    'Magento_Vault/js/view/payment/method-renderer/vault',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'escaper'\n], function (\n    $t,\n    VaultComponent,\n    loader,\n    ResponseError,\n    escaper\n) {\n   'use strict';\n\n   return VaultComponent.extend({\n       defaults: {\n           template: 'Magento_PaymentServicesPaypal/payment/vault',\n           paymentSource: 'vault',\n           paypalOrderId: null,\n           paymentsOrderId: null,\n           generalErrorMessage: $t('An error occurred. Refresh the page and try again.'),\n           paymentMethodValidationError: $t('Your payment was not successful. Try again.'),\n           allowedTags: ['br'],\n       },\n\n       /**\n        * Get card brand\n        * @returns {String}\n        */\n       getCardBrand: function () {\n           return this.mapCardBrand(this.details.brand);\n       },\n\n       /**\n        * Map the credit card brand received from PayPal to the Commerce standard\n        * @param payPalCardBrand\n        * @returns {*}\n        */\n       mapCardBrand: function (payPalCardBrand) {\n           const cardBrandMapping = {\n               AMEX: 'AE',\n               DISCOVER: 'DI',\n               DINERS: 'DN',\n               ELO: 'ELO',\n               HIPER: 'HC',\n               JCB: 'JCB',\n               MAESTRO: 'MI',\n               MASTER_CARD: 'MC',\n               MASTERCARD: 'MC',\n               VISA: 'VI'\n           };\n\n           return cardBrandMapping[payPalCardBrand];\n       },\n\n       /**\n        * Get last 4 digits of card\n        * @returns {String}\n        */\n       getMaskedCard: function () {\n           return this.details.maskedCC;\n       },\n\n       /**\n        * Get card Description\n        * @returns {String}\n        */\n       getCardDescription: function () {\n           return this.details.description;\n       },\n\n       /**\n        * Get formatted card billing address\n        * @returns {String}\n        */\n       getFormattedCardBillingAddress: function () {\n           let billingAddress = this.details.billingAddress;\n\n           if (!billingAddress) {\n               return '';\n           }\n\n           let street1 = billingAddress.address_line_1 || '';\n           let street2 = billingAddress.address_line_2 || '';\n           let region = billingAddress.region || '';\n           let city = billingAddress.city || '';\n           let postalCode = billingAddress.postal_code || '';\n           let countryCode = billingAddress.country_code || '';\n\n           let formattedAddress = street1 + '<br/>';\n\n           if (street2 !== '') {\n               formattedAddress += street2 + '<br/>';\n           }\n\n           formattedAddress += region + ' ' + city + ' ' + postalCode + '<br/>' +\n               countryCode;\n\n           return this.getSafeHtml(formattedAddress);\n       },\n\n       /**\n        * Get card holder name\n        * @returns {String}\n        */\n       getCardHolderName: function () {\n           return this.details.cardholderName;\n       },\n\n       /**\n        * Sanitize text\n        *\n        * @param {String} html\n        * @returns {String}\n        */\n       getSafeHtml: function (html) {\n           return escaper.escapeHtml(html, this.allowedTags);\n       },\n\n       /**\n        * Get PayPal order ID\n        */\n       getData: function () {\n          let data = this._super();\n\n          data['additional_data']['paypal_order_id'] = this.paypalOrderId;\n          data['additional_data']['payments_order_id'] = this.paymentsOrderId;\n          data['additional_data']['public_hash'] = this.publicHash;\n          data['additional_data']['payment_source'] = this.paymentSource;\n          return data;\n       },\n\n       /**\n        * Place order\n        */\n       onPlaceOrder: function () {\n           loader.startLoader();\n           this.createOrder()\n               .then(function (order) {\n                   this.onOrderSuccess(order);\n               }.bind(this))\n               .then(function () {\n                   this.placeOrder();\n               }.bind(this))\n               .catch(this.onError.bind(this))\n               .finally(loader.stopLoader);\n       },\n\n       /**\n        * Create PayPal order\n        * @returns {Promise<any>}\n        */\n       createOrder: function () {\n           var orderData = new FormData();\n\n           orderData.append('payment_source', this.paymentSource);\n           orderData.append('location', this.location);\n\n           return fetch(this.createOrderUrl, {\n               method: 'POST',\n               headers: {},\n               body: orderData,\n               credentials: 'same-origin'\n           }).then(function (res) {\n               return res.json();\n           }).then(function (data) {\n               if (data.response['is_successful']) {\n                   return data.response['paypal-order'];\n               }\n           });\n       },\n\n       /**\n        * populate PayPal order ID and trigger Commerce order flow\n        * @param order\n        */\n       onOrderSuccess: function (order) {\n           this.paypalOrderId = order['id'];\n           this.paymentsOrderId = order['mp_order_id'];\n       },\n\n       /**\n        * handle payment error\n        * @param error\n        */\n       onError: function (error) {\n           var message = this.generalErrorMessage;\n\n           if (error instanceof ResponseError) {\n               message = error.message;\n           } else if (error['debug_id']) {\n               message = this.paymentMethodValidationError;\n           }\n\n           this.messageContainer.addErrorMessage({\n               message: message\n           });\n           console.log(error['debug_id'] ? 'Error' + JSON.stringify(error) : error.toString());\n       },\n   });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/smart-buttons.js":"/**\n * ADOBE CONFIDENTIAL\n *\n * Copyright 2021 Adobe\n * All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'Magento_Checkout/js/view/payment/default',\n    'jquery',\n    'underscore',\n    'mageUtils',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'mage/translate',\n    'Magento_PaymentServicesPaypal/js/helpers/remove-paypal-url-token',\n    'Magento_PaymentServicesPaypal/js/model/app-switch-data',\n    'Magento_PaymentServicesPaypal/js/view/payment/methods/smart-buttons',\n    'Magento_PaymentServicesPaypal/js/view/payment/message',\n    'Magento_Checkout/js/model/payment/additional-validators',\n    'Magento_Checkout/js/action/set-billing-address',\n    'Magento_Ui/js/model/messageList',\n    'uiRegistry',\n    'Magento_Customer/js/customer-data'\n], function (\n    Component,\n    $,\n    _,\n    utils,\n    quote,\n    fullScreenLoader,\n    $t,\n    removePayPalUrlToken,\n    appSwitchDataModel,\n    SmartButtons,\n    Message,\n    additionalValidators,\n    setBillingAddressAction,\n    globalMessageList,\n    registry,\n    customerData\n) {\n    'use strict';\n\n    var refreshCustomerData = function (url) {\n        // Trigger ajaxComplete event to update customer data\n        customerData.onAjaxComplete(\n            {},\n            {\n                type: 'POST',\n                url: url\n            }\n        );\n    };\n\n    return Component.extend({\n        defaults: {\n            sdkNamespace: 'paypalCheckoutButtons',\n            buttonsContainerId: 'smart-buttons-${ $.uid }',\n            payLaterMessageContainerId: 'pay-later-message-${ $.uid }',\n            template: 'Magento_PaymentServicesPaypal/payment/smart-buttons',\n            isAvailable: false,\n            isButtonsRendered: false,\n            grandTotalAmount: null,\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            requestProcessingError: $t('Error happened when processing the request. Please try again later.'),\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            paymentTypeIconUrl: window.checkoutConfig.payment['payment_services_paypal_smart_buttons'].paymentTypeIconUrl, // eslint-disable-line max-len\n            paymentTypeIconTitle: $t('Pay with PayPal')\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function (config) {\n            _.bindAll(this, 'onClick', 'onInit', 'catchError', 'beforeCreateOrder', 'afterCreateOrder');\n            config.uid = utils.uniqueid();\n            this._super();\n            this.initSmartButtons();\n            this.initMessage();\n            quote.totals.subscribe(function (totals) {\n                this.grandTotalAmount(totals['base_grand_total']);\n                this.message.updateAmount(totals['base_grand_total']);\n            }.bind(this));\n\n            return this;\n        },\n\n        /**\n         * Initialize observables\n         *\n         * @returns {Component} Chainable.\n         */\n        initObservable: function () {\n            this._super().observe('grandTotalAmount isAvailable isButtonsRendered');\n            this.grandTotalAmount(quote.totals()['base_grand_total']);\n\n            return this;\n        },\n\n        /**\n         * Create instance of smart buttons.\n         */\n        initSmartButtons: function () {\n            this.buttons = new SmartButtons({\n                sdkNamespace: this.sdkNamespace,\n                scriptParams: window.checkoutConfig.payment[this.getCode()].sdkParams,\n                createOrderUrl: window.checkoutConfig.payment[this.getCode()].createOrderUrl,\n                styles: window.checkoutConfig.payment[this.getCode()].buttonStyles,\n                onInit: this.onInit,\n                onClick: this.onClick,\n                beforeCreateOrder: this.beforeCreateOrder,\n                afterCreateOrder: this.afterCreateOrder,\n                catchCreateOrder: this.catchError,\n                onApprove: function () {\n                    if (this.hasReturned) {\n                        this.setAppSwitchResumeData();\n                    }\n\n                    this.placeOrder();\n                }.bind(this),\n                onError: this.catchError,\n                location: window.checkoutConfig.payment[this.getCode()].location,\n                appSwitchWhenAvailable: window.checkoutConfig.payment[this.getCode()].appSwitchWhenAvailable\n            });\n        },\n\n        /**\n         * Initialize message component\n         */\n        initMessage: function () {\n            this.message = new Message({\n                scriptParams: window.checkoutConfig.payment[this.getCode()].sdkParams,\n                element: this.element,\n                renderContainer: '#' + this.payLaterMessageContainerId,\n                styles: window.checkoutConfig.payment[this.getCode()].messageStyles,\n                placement: 'payment',\n                amount: this.grandTotalAmount()\n            });\n        },\n\n        /**\n         * Get method code\n         *\n         * @return {String}\n         */\n        getCode: function () {\n            return 'payment_services_paypal_smart_buttons';\n        },\n\n        /**\n         * Get method data\n         *\n         * @return {Object}\n         */\n        getData: function () {\n            return {\n                'method': this.item.method,\n                'additional_data': {\n                    'payments_order_id': this.paymentsOrderId,\n                    'paypal_order_id': this.paypalOrderId,\n                    'payment_source': this.buttons.paymentSource\n                }\n            };\n        },\n\n        /**\n         * Render buttons\n         */\n        afterRender: function () {\n            this.buttons.sdkLoaded.then(function () {\n                this.buttons.setup('#' + this.buttonsContainerId);\n\n                if (this.buttons.instance.hasReturned()) {\n                    this.hasReturned = true;\n                    this.buttons.instance.resume();\n                } else {\n                    this.buttons.render();\n                }\n\n                this.renderMessage();\n                this.isAvailable(!!this.buttons.instance && this.buttons.instance.isEligible());\n            }.bind(this)).catch(function () {\n                this.isAvailable(false);\n\n                return this.buttons;\n            }.bind(this)).finally(function () {\n                this.isButtonsRendered(true);\n            }.bind(this));\n        },\n\n        /**\n         * Render message\n         */\n        renderMessage: function () {\n            if (window.checkoutConfig.payment[this.getCode()].canDisplayMessage) {\n                this.message.render();\n            }\n        },\n\n        /**\n         * Enable/disable buttons.\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         */\n        onInit: function (data, actions) {\n            if (!this.isPlaceOrderActionAllowed()) {\n                actions.disable();\n            }\n\n            this.isPlaceOrderActionAllowed.subscribe(function (isAllowed) {\n                if (isAllowed) {\n                    actions.enable();\n                } else {\n                    actions.disable();\n                }\n            });\n        },\n\n        /**\n         * @inheritdoc\n         */\n        validate: function () {\n            var isShippingValid = true,\n                source, shippingAddress;\n\n            if (!this._super()) {\n                return false;\n            }\n            source = registry.get('checkoutProvider');\n            shippingAddress = registry.get('index = shippingAddress');\n\n            if (source && shippingAddress) {\n                source.set('params.invalid', false);\n                if (quote.billingAddress() === null) {\n                    this.triggerBillingValidation(source);\n                }\n\n                // skip shipping validation if quote is virtual or in-store pickup\n                if (!quote.isVirtual() && !quote.shippingMethod()['method_code'] === 'pickup') {\n                    isShippingValid = shippingAddress.validateShippingInformation();\n                }\n\n                return isShippingValid && !source.get('params.invalid');\n            }\n\n            return true;\n        },\n\n        /**\n         * Trigger billing address validation\n         *\n         * @param {Object} source\n         */\n        triggerBillingValidation: function (source) {\n            var dataScope = `billingAddress${ window.checkoutConfig.displayBillingOnPaymentMethod ?\n                this.getCode() : 'shared'}`;\n\n            source.trigger(`${ dataScope }.data.validate`);\n\n            if (source.get(`${dataScope}.custom_attributes`)) {\n                source.trigger(`${dataScope}.custom_attributes.data.validate`);\n            }\n        },\n\n        /**\n         * Validate form onClick\n         *\n         * @param {Object} data\n         * @param {Object} actions\n         * @return {*}\n         */\n        onClick: function (data, actions) {\n            if (this.validate() && additionalValidators.validate()) {\n                // Add terms data to app switch.\n                if (window.checkoutConfig?.checkoutAgreements?.isEnabled) {\n                    const agreementsInputPath = '.payment-method._active div.checkout-agreements input';\n\n                    $(agreementsInputPath).each(function (index, element) {\n                        const termsData = appSwitchDataModel.getData('terms') || {};\n                        termsData[element.id] = element.value;\n\n                        appSwitchDataModel.setData('terms', termsData);\n                    });\n                }\n\n                const reCaptcha = $('.g-recaptcha:visible');\n                const reCaptchaId = reCaptcha && reCaptcha.last().attr('id');\n\n                // Add recaptcha if it exists.\n                if (reCaptchaId) {\n                    const reCaptchaToken = $(`#${reCaptchaId} [name=\"g-recaptcha-response\"]`).val();\n\n                    appSwitchDataModel.setData('recaptcha', reCaptchaToken);\n                }\n\n                return actions.resolve();\n\n            }\n\n            appSwitchDataModel.setData('pageType', this.pageType);\n\n            return actions.reject();\n        },\n\n        /**\n         * Before order created.\n         *\n         * @return {Promise}\n         */\n        beforeCreateOrder: function () {\n            return new Promise(function (resolve, reject) {\n                setBillingAddressAction(globalMessageList).done(resolve.bind(null, null)).fail(reject);\n            });\n        },\n\n        /**\n         * After order created.\n         *\n         * @param {Object} data\n         * @return {String}\n         */\n        afterCreateOrder: function (data) {\n            if (data.response['paypal-order'] && data.response['paypal-order']['mp_order_id']) {\n                refreshCustomerData(window.checkoutConfig.payment[this.getCode()].createOrderUrl);\n\n                this.paymentsOrderId = data.response['paypal-order']['mp_order_id'];\n                this.paypalOrderId = data.response['paypal-order'].id;\n\n                appSwitchDataModel.setData('paymentsOrderId', this.paymentsOrderId);\n                appSwitchDataModel.setData('paypalOrderId', this.paypalOrderId);\n                appSwitchDataModel.setData('paymentSource', this.buttons.paymentSource);\n\n                return this.paypalOrderId;\n            }\n\n            throw new Error();\n        },\n\n        /**\n         * Catch error.\n         *\n         * @param {Error} error\n         */\n        catchError: function (error) {\n            removePayPalUrlToken();\n            this.messageContainer.addErrorMessage({\n                message: this.requestProcessingError\n            });\n            console.log('Error: ', error.message);\n\n            this.afterRender();\n        },\n\n        /**\n         * Re-initialise checkout data.\n         *\n         * This is in case the App Switch returns in a new tab.\n         */\n        setAppSwitchResumeData: function () {\n            this.paymentsOrderId = appSwitchDataModel.getData('paymentsOrderId');\n            this.paypalOrderId = appSwitchDataModel.getData('paypalOrderId');\n            this.buttons.paymentSource = appSwitchDataModel.getData('paymentSource');\n\n            // Add terms data to app switch.\n            if (window.checkoutConfig?.checkoutAgreements?.isEnabled) {\n                const terms = appSwitchDataModel.getData('terms');\n\n                if (terms) {\n                    Object.keys(terms).forEach((term) => {\n                        $(`#${term}`).prop('checked', terms[term] === '1');\n                    });\n                }\n            }\n\n            const reCaptcha = $('.g-recaptcha:visible'),\n                reCaptchaId = reCaptcha && reCaptcha.last().attr('id');\n\n            if (reCaptchaId) {\n                const reCaptchaToken = appSwitchDataModel.getData('recaptcha');\n\n                $(`#${reCaptchaId} [name=\"g-recaptcha-response\"]`).val(reCaptchaToken);\n            }\n\n            appSwitchDataModel.clearData();\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/hosted-fields.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'underscore',\n    'mage/translate',\n    'Magento_Checkout/js/view/payment/default',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'Magento_PaymentServicesPaypal/js/view/errors/response-error',\n    'Magento_Checkout/js/action/set-billing-address',\n    'Magento_Ui/js/model/messageList',\n    'Magento_Vault/js/view/payment/vault-enabler',\n    'Magento_Checkout/js/model/payment/additional-validators',\n    'Magento_PaymentServicesPaypal/js/lib/script-loader',\n    'ko'\n], function (\n    $,\n    _,\n    $t,\n    Component,\n    quote,\n    loader,\n    ResponseError,\n    setBillingAddressAction,\n    globalMessageList,\n    VaultEnabler,\n    additionalValidators,\n    scriptLoader,\n    ko\n) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            isFormValid: false,\n            invalidFields: [],\n            isAvailable: false,\n            isFormRendered: false,\n            fields: {\n                number: {\n                    class: 'card-number-field',\n                    label: $t('Credit Card Number'),\n                    errorMessage: $t('Please enter a valid credit card number.'),\n                    selector: '#${ $.formId } .${ $.fields.number.class }',\n                    placeholder: '',\n                    showLockIcon: true\n                },\n                expirationDate: {\n                    class: 'expiration-date-field',\n                    selector: '#${ $.formId } .expiration-date-field',\n                    label: $t('Expiration Date'),\n                    errorMessage: $t('Incorrect credit card expiration date.'),\n                    placeholder: 'MM/YY'\n                },\n                cvv: {\n                    class: 'cvv-field',\n                    selector: '#${ $.formId } .cvv-field',\n                    label: $t('Card Security Code'),\n                    errorMessage: $t('Please enter a valid credit card security code.'),\n                    tooltip: {\n                        title: $t('What is this?'),\n                        src:  $.cvvImgUrl,\n                        contentUnsanitizedHtml: '<img src=\"${ $.cvvImgUrl }\" ' +\n                            'alt=\"${ $.cvvTitle }\" title=\"${ $.cvvTitle }\" />'\n                    },\n                    placeholder: ''\n                }\n            },\n            cardsByCode: {\n                \"amex\": \"AE\",\n                \"discover\": \"DI\",\n                \"elo\": \"ELO\",\n                \"hiper\": \"HC\",\n                \"jcb\": \"JCB\",\n                \"mastercard\": \"MC\",\n                \"visa\": \"VI\",\n            },\n            cards: {\n                AE: {\n                    eligibilityCode: 'amex',\n                    typeCode: 'american-express'\n                },\n                DI: {\n                    eligibilityCode: 'discover',\n                    typeCode: 'discover'\n                },\n                ELO: {\n                    eligibilityCode: 'elo',\n                    typeCode: 'elo'\n                },\n                HC: {\n                    eligibilityCode: 'hiper',\n                    typeCode: 'hiper'\n                },\n                JCB: {\n                    eligibilityCode: 'jcb',\n                    typeCode: 'jcb'\n                },\n                MC: {\n                    eligibilityCode: 'mastercard',\n                    typeCode: 'master-card'\n                },\n                VI: {\n                    eligibilityCode: 'visa',\n                    typeCode: 'visa'\n                }\n            },\n            orderCreateErrorMessage: {\n                default: $t('Failed to place order. Try again or refresh the page if that does not resolve the issue.'), // eslint-disable-line max-len,\n                'POSTAL_CODE_REQUIRED': $t('Postal code is required.'),\n                'CITY_REQUIRED': $t('City is required.')\n            },\n            availableCards: [],\n            getOrderDetailsUrl: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].getOrderDetailsUrl, // eslint-disable-line max-len\n            requiresCardDetails: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].requiresCardDetails, // eslint-disable-line max-len\n            ccIcons: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].ccIcons,\n            paymentSource: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].paymentSource,\n            cvvImgUrl:  window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].cvvImageUrl,\n            isCommerceVaultEnabled: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].isCommerceVaultEnabled, // eslint-disable-line max-len\n            emptyErrorMessage: $t('This is a required field.'),\n            paymentTypeIconUrl:  window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].paymentTypeIconUrl, // eslint-disable-line max-len\n            paymentTypeIconTitle: $t('Pay with credit card'),\n            lockTitle: $t('Secure transaction'),\n            cvvTitle: $t('The card security code is a three or four digit number printed on a credit card. Visa, Mastercard, and Discover cards have a three digit code on the card back. American Express cards have a four digit code on the card front.'), // eslint-disable-line max-len\n            paymentMethodValidationError: $t('Your payment was not successful. Ensure you have entered your details correctly and try again, or try a different payment method. If you have continued problems, contact the issuing bank for your payment method.'), // eslint-disable-line max-len\n            notEligibleErrorMessage: $t('This payment option is currently unavailable.'),\n            generalErrorMessage: '${ $.paymentMethodValidationError }',\n            placeOrderTitle: $t('Place Order'),\n            formId: 'hosted-fields-form',\n            template: 'Magento_PaymentServicesPaypal/payment/credit-card',\n            ccType: '',\n            billingAddress: quote.billingAddress,\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            cardBin: null,\n            holderName: null,\n            cardLast4: null,\n            cardExpiryMonth: null,\n            cardExpiryYear: null,\n            hostedFields: null,\n            shouldCardBeVaulted: false,\n\n            paymentsSdk: null,\n            paymentsSdkInitPromise: null,\n            isInProgress: ko.observable(false),\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            _.bindAll(\n                this,\n                'onError',\n                'getOrderCardDetails'\n            );\n            this._super();\n            this.initPaymentsSDK();\n            this.initVaulting();\n\n            return this;\n        },\n\n        /**\n         * Initialize Payments SDK\n         * Load js script and initialize SDK\n         */\n        initPaymentsSDK: function () {\n            this.paymentsSdkInitPromise = new Promise(\n                function (resolve, reject) {\n                    scriptLoader.loadCustom({url: this.getPaymentsSDKUrl()})\n                        .then(function () {\n                            const sdkConfig = {\n                                storeViewCode: this.getGraphQLStoreCode()\n                            }\n\n                            if (this.getGraphQLToken()) {\n                                sdkConfig.getCustomerToken = () => this.getGraphQLToken();\n                            }\n\n                            if (this.getGraphQLUrl()) {\n                                sdkConfig.apiUrl = this.getGraphQLUrl();\n                            }\n\n                            this.paymentsSdk = new window.PaymentServicesSDK(sdkConfig);\n\n                            this.paymentsSdk.Payment.init({location: \"CHECKOUT\"})\n                                .then(() => {resolve()})\n                                .catch((e) => {reject(e)});\n                        }.bind(this)).catch((e) => {reject(e)});\n                }.bind(this)\n            );\n        },\n\n        /**\n         * Initialize vaulting\n         */\n        initVaulting: function () {\n            this.vaultEnabler = new VaultEnabler();\n            this.vaultEnabler.isActivePaymentTokenEnabler(false);\n            this.vaultEnabler.setPaymentCode(window.checkoutConfig.payment[this.getCode()].ccVaultCode);\n        },\n\n        /** @inheritdoc */\n        initObservable: function () {\n            this._super()\n                .observe('billingAddress paymentsOrderId paypalOrderId cardBin ' +\n                    'holderName cardLast4 cardExpiryMonth cardExpiryYear ' +\n                    'ccType isFormValid invalidFields availableCards isAvailable isFormRendered shouldCardBeVaulted');\n\n            return this;\n        },\n\n        /** @inheritdoc */\n        getCode: function () {\n            return 'payment_services_paypal_hosted_fields';\n        },\n\n        /** @inheritdoc */\n        getData: function () {\n            var data = this._super();\n\n            data['additional_data'] = {\n                payments_order_id: this.paymentsOrderId(),\n                paypal_order_id: this.paypalOrderId(),\n                payment_source: this.paymentSource\n            };\n\n            if (this.cardBin()) {\n                data['additional_data']['cardBin'] = this.cardBin();\n            }\n\n            if (this.holderName()) {\n                data['additional_data']['holderName'] = this.holderName();\n            }\n\n            if (this.cardLast4()) {\n                data['additional_data']['cardLast4'] = this.cardLast4();\n            }\n\n            if (this.cardExpiryMonth()) {\n                data['additional_data']['cardExpiryMonth'] = this.cardExpiryMonth();\n            }\n\n            if (this.cardExpiryYear()) {\n                data['additional_data']['cardExpiryYear'] = this.cardExpiryYear();\n            }\n\n            this.vaultEnabler.visitAdditionalData(data);\n            return data;\n        },\n\n        /** @inheritdoc */\n        afterRender: function () {\n            this.$form = $('#' + this.formId);\n\n            this.paymentsSdkInitPromise.then(function () {\n                this.isAvailable(this.paymentsSdk.Payment.CreditCard.isAvailable())\n\n                if (!this.isAvailable()) {\n                    this.isFormRendered(true);\n                    return;\n                }\n\n                this.paymentsSdk.Payment.CreditCard.render({\n                    fields: {\n                        number: {\n                            selector: this.fields.number.selector,\n                            label: this.fields.number.label,\n                            class: this.fields.number.class,\n                        },\n                        expirationDate: {\n                            selector: this.fields.expirationDate.selector,\n                            label: this.fields.expirationDate.label,\n                            class: this.fields.expirationDate.class,\n                        },\n                        cvv: {\n                            selector: this.fields.cvv.selector,\n                            label: this.fields.cvv.label,\n                            class: this.fields.cvv.class,\n                        },\n                    },\n                    styles: {\n                        input: {\n                            color: '#ccc',\n                            'font-family': '\"Open Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif',\n                            'font-size': '16px',\n                            'font-weight': '400'\n                        },\n                        ':focus': {\n                            color: '#333'\n                        },\n                        '.valid': {\n                            color: '#333'\n                        }\n                    },\n                    onRender: this.onRender.bind(this),\n                    getCartId: this.getMaskedCardId,\n                    onStart: this.onStart.bind(this),\n                    onSuccess: this.onSuccess.bind(this),\n                    getBillingAddress: this.getBillingAddress.bind(this),\n                    getShouldVaultCard: () => this.isCommerceVaultEnabled && this.checkShouldCardBeVaulted(),\n                    onValidityChange: this.onValidityChange.bind(this),\n                    onCardTypeChange: this.onCardTypeChange.bind(this),\n                    onError: this.onError.bind(this),\n                });\n            }.bind(this))\n                .catch((e) => {\n                    console.log('Error initializing Payments SDK', e);\n                    this.isFormRendered(true);\n                    this.isAvailable(false);\n                });\n        },\n\n        /**\n         * Get masked cart id\n         */\n        getMaskedCardId: function () {\n            return window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].quoteMaskedId;\n        },\n\n        /**\n         * Get Payments SDK URL to load JS script\n         */\n        getPaymentsSDKUrl: function () {\n            return window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].paymentsSDKUrl;\n        },\n\n        /**\n         * Get GraphQL store code to use in GraphQL requests\n         */\n        getGraphQLStoreCode: function () {\n            return window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].storeViewCode;\n        },\n\n        /**\n         * Get GraphQL edpoint\n         */\n        getGraphQLUrl: function () {\n            return window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].graphQLEndpointUrl;\n        },\n\n        /**\n         * Get GraphQL token for authentication\n         */\n        getGraphQLToken: function () {\n            return window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].oauthToken;\n        },\n\n        /**\n         * Provide billing address for the order\n         */\n        getBillingAddress: function () {\n            return {\n                firstName: this.billingAddress().firstname,\n                lastName: this.billingAddress().lastname,\n                streetAddress: this.billingAddress().street[0],\n                extendedAddress: this.billingAddress().street[1],\n                region: this.billingAddress().region,\n                locality: this.billingAddress().city,\n                postalCode: this.billingAddress().postcode,\n                countryCodeAlpha2: this.billingAddress().countryId,\n            };\n        },\n\n        /**\n         * Start callback for Hosted Fields\n         * Called when the form is submitted\n         *\n         * @param preventCheckout\n         * @returns {Promise<void>}\n         */\n        onStart: async function (preventCheckout) {\n            if (!this.canProceedWithOrder()) {\n                preventCheckout(\"invalid form\");\n            }\n\n            loader.startLoader();\n\n            await setBillingAddressAction(globalMessageList);\n        },\n\n        /**\n         * Success callback for Hosted Fields\n         * Called when PP order is created and card details are collected\n         *\n         * @param data\n         */\n        onSuccess: function (data) {\n            this.paymentsOrderId(data.mpOrderId);\n            this.paypalOrderId(data.payPalOrderId);\n\n            this.getOrderCardDetails()\n                .then(this.placeOrder.bind(this))\n                .catch(this.onError.bind(this));\n        },\n\n        /**\n         * Called after Hosted Fields are rendered\n         *\n         * @param hostedFields\n         */\n        onRender: function (hostedFields)  {\n            this.isFormValid(false);\n            this.ccType('');\n            this.invalidFields([]);\n\n            var cards = hostedFields.getEligibleCards()\n                .filter(card => this.cardsByCode[card.code] !== undefined)\n                .map(card => this.cardsByCode[card.code]);\n\n            this.availableCards(cards);\n\n            this.$form.off('submit');\n            this.$form.on('submit', function (e) {\n                e.preventDefault();\n                this.isInProgress(true);\n                hostedFields.submit()\n                    .catch(this.onError.bind(this))\n                    .finally(function () {\n                        loader.stopLoader();\n                        this.isInProgress(false);\n                    }.bind(this));\n            }.bind(this));\n\n            this.isFormRendered(true);\n        },\n\n        /**\n         * Validity change handler.\n         *\n         * @param {Object} hostedFields\n         * @param {Object} event\n         */\n        onValidityChange: function (fields, emittedBy) {\n            var valid = _.every(fields, function (field) {return field.isValid});\n            var invalidFields = this.invalidFields().filter(field => field.name !== emittedBy);\n\n            if (!valid) {\n                if (fields[emittedBy] && !fields[emittedBy].isValid) {\n                    invalidFields.push({\n                        name: emittedBy,\n                        message: fields[emittedBy].isEmpty ? this.emptyErrorMessage : this.fields[emittedBy].errorMessage\n                    });\n                }\n                this.invalidFields(invalidFields)\n            }\n\n            this.isFormValid(valid);\n            this.isFormValid() && this.invalidFields([]);\n        },\n\n        /**\n         * Check if field is valid.\n         *\n         * @param {String} fieldName\n         * @return {Boolean}\n         */\n        isFieldValid: function (fieldName) {\n            return !this.invalidFields.findWhere({\n                name: fieldName\n            });\n        },\n\n        /**\n         * Get error message for field.\n         *\n         * @param {String} fieldName\n         * @return {String}\n         */\n        getFieldErrorMessage: function (fieldName) {\n            return !this.isFieldValid(fieldName) ? this.invalidFields.findWhere({\n                name: fieldName\n            }).message : '';\n        },\n\n        /**\n         * Card type changes handler.\n         *\n         * @param {Array} a list of cards\n         */\n        onCardTypeChange: function (cards) {\n            var code = '';\n\n            if (cards.length === 1 && this.cardsByCode[cards[0].code]) {\n                code = this.cardsByCode[cards[0].code]\n            }\n\n            this.ccType(code);\n        },\n\n        /**\n         * Get order card details\n         * Used when Signifyd is enabled and requires card details\n         *\n         * @param response\n         * @returns {Promise<any>|Promise<Awaited<unknown>>}\n         */\n        getOrderCardDetails: function (response) {\n            if (!this.requiresCardDetails) {\n                return Promise.resolve(response);\n            }\n\n            return fetch(`${this.getOrderDetailsUrl}`, {\n                method: 'GET'\n            }).then(function (res) {\n                return res.json();\n            }).then(function (data) {\n                if (data.response['is_successful'] && data.response['paypal-order']) {\n                    const order = data.response['paypal-order'];\n\n                    this.cardBin(order?.payment_source_details?.card?.bin_details?.bin);\n                    this.holderName(order?.payment_source_details?.card?.name);\n                    this.cardLast4(order?.payment_source_details?.card?.last_digits);\n                    this.cardExpiryMonth(order?.payment_source_details?.card?.card_expiry_month);\n                    this.cardExpiryYear(order?.payment_source_details?.card?.card_expiry_year);\n                }\n\n                return response;\n            }.bind(this)).catch(function (err) {\n                console.log(\n                    'Could not get order details. Proceeding with order placement without card details',\n                    err\n                );\n                return response;\n            });\n        },\n\n        /**\n         * Error callback for transaction.\n         */\n        onError: function (error) {\n            loader.stopLoader();\n            var message = this.generalErrorMessage;\n\n            if (error instanceof ResponseError) {\n                message = error.message;\n            } else if (error['debug_id']) {\n                message = this.paymentMethodValidationError;\n            }\n\n            if (this.isOrderCreateError(error)) {\n                message = this.parseOrderCreateError(error);\n            }\n\n            this.messageContainer.addErrorMessage({\n                message: message\n            });\n\n            if (error instanceof Error) {\n                console.log(error.toString());\n            } else {\n                console.log('Error' + JSON.stringify(error));\n            }\n        },\n\n        /**\n         * Place order\n         * Click event handler for place order button\n         */\n        placeOrderClick: function () {\n            if (this.isPlaceOrderActionAllowed() === true) {\n                $('#' + this.formId).trigger('submit');\n            }\n        },\n\n        /**\n         * Check if customer checks the \"Save for later\" box upon checkout\n         *\n         * @returns {*}\n         */\n        checkShouldCardBeVaulted: function () {\n            const checked = this.vaultEnabler.isActivePaymentTokenEnabler();\n\n            this.shouldCardBeVaulted(checked);\n            return checked;\n        },\n\n        /**\n         * Check if the form is valid and the order can be placed\n         *\n         * @returns {*}\n         */\n        canProceedWithOrder: function () {\n            return this.validate()\n                && additionalValidators.validate()\n                && this.isFormValid()\n                && this.isPlaceOrderActionAllowed();\n        },\n\n        isOrderCreateError: function (error) {\n            return error?.cause?.graphQLErrors\n                ?.find(e => e?.path?.join(\"\").indexOf(\"createPaymentOrder\") > -1) !== undefined;\n        },\n\n        parseOrderCreateError: function (error) {\n            if (this.isErrorCode(error, 'POSTAL_CODE_REQUIRED')) {\n                return this.orderCreateErrorMessage.POSTAL_CODE_REQUIRED;\n            }\n\n            if (this.isErrorCode(error, 'CITY_REQUIRED')) {\n                return this.orderCreateErrorMessage.CITY_REQUIRED;\n            }\n\n            return this.orderCreateErrorMessage.default;\n        },\n\n        isErrorCode: function (error, code) {\n            return error?.cause?.graphQLErrors\n                ?.find(e => e?.path?.join(\"\").indexOf(\"createPaymentOrder\") > -1)\n                ?.extensions?.debugMessage?.indexOf(code) > -1;\n        }\n\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/payment/method-renderer/fastlane.js":"/**\n * ADOBE CONFIDENTIAL\n *\n * Copyright 2025 Adobe\n * All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'mage/translate',\n    'uiRegistry',\n    'Magento_Checkout/js/action/set-billing-address',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'Magento_Checkout/js/model/payment/additional-validators',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/view/payment/default',\n    'Magento_PaymentServicesPaypal/js/helpers/map-address-to-magento',\n    'Magento_PaymentServicesPaypal/js/view/payment/fastlane',\n    'Magento_Ui/js/model/messageList',\n], function (\n    $,\n    $t,\n    uiRegistry,\n    setBillingAddressAction,\n    loader,\n    additionalValidators,\n    quote,\n    Component,\n    mapAddressToMagento,\n    fastlaneModel,\n    messageList\n) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            code: 'payment_services_paypal_fastlane',\n            template: 'Magento_PaymentServicesPaypal/payment/fastlane',\n            createOrderUrl: window.checkoutConfig.payment['payment_services_paypal_fastlane'].createOrderUrl,\n            paymentTypeIconUrl:  window.checkoutConfig.payment['payment_services_paypal_fastlane'].paymentTypeIconUrl, // eslint-disable-line max-len\n            paymentTypeIconTitle: $t('Pay with credit card'),\n            location: window.checkoutConfig.payment['payment_services_paypal_fastlane'].location,\n            paymentSource: window.checkoutConfig.payment['payment_services_paypal_fastlane'].paymentSource,\n            requiresCardDetails: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].requiresCardDetails,\n            threeDSMode: window.checkoutConfig.payment['payment_services_paypal_fastlane'].threeDS,\n            getOrderDetailsUrl: window.checkoutConfig.payment['payment_services_paypal_hosted_fields'].getOrderDetailsUrl,\n            paymentsOrderId: null,\n            paypalOrderId: null,\n            fastlaneToken: null,\n        },\n\n        /**\n         * @returns {exports.initialize}\n         */\n        initialize: async function (config) {\n            this._super(config);\n\n            return this;\n        },\n\n        afterRender: async function () {\n            await fastlaneModel.setup();\n            fastlaneModel.renderFastlanePaymentComponent('#payment-services-paypal-fastlane');\n        },\n\n        onClick: async function () {\n            if (!additionalValidators.validate()) {\n                return;\n            }\n\n            // Create the order with PayPal\n            // Get the token from Fastlane\n            // Submit payment\n            try {\n                loader.startLoader();\n\n                let { id, paymentSource: { card: { billingAddress, name } } } = await fastlaneModel.getPaymentToken(),\n                    [firstname, ...lastname] = name.split(' '),\n                    mappedAddress = mapAddressToMagento({ address: billingAddress }),\n                    shippingAddress = quote.shippingAddress();\n\n                // Fastlane doesn't provide a phone number in the billing address so get it from shipping if available.\n                if (shippingAddress.telephone) {\n                    mappedAddress.telephone = shippingAddress.telephone;\n                }\n\n                // Add the firstname and lastname as these aren't within the billing address from Fastlane either.\n                mappedAddress.firstname = firstname;\n                mappedAddress.lastname = lastname.join(' ');\n\n                quote.billingAddress({...mappedAddress, street: Object.values(mappedAddress.street)});\n\n                if (this.isBillingAddressValid()) {\n                    if (this.threeDSMode) {\n                        id = await fastlaneModel.validate3DS(id);\n                    }\n\n                    this.fastlaneToken = id;\n                    this.placeOrder();\n                } else {\n                    this.isProcessing = false;\n                    messageList.addErrorMessage({\n                        message: $t('Your billing address is not valid.')\n                    });\n                }\n            } catch(error) {\n                loader.stopLoader();\n                messageList.addErrorMessage({\n                    message: $t('Cannot validate payment.')\n                });\n            } finally {\n                loader.stopLoader();\n            }\n        },\n\n        /**\n         * Validates the billing address in the checkout provider.\n         *\n         * @returns {Boolean}\n         */\n        isBillingAddressValid() {\n            // Load the Braintree payment form.\n            const billingAddress = uiRegistry.get('checkoutProvider');\n\n            // Reset the validation.\n            billingAddress.set('params.invalid', false);\n\n            // Call validation and also the custom attributes validation if they exist.\n            billingAddress.trigger(billingAddress.dataScopePrefix + '.data.validate');\n\n            if (billingAddress.get(billingAddress.dataScopePrefix + '.custom_attributes')) {\n                billingAddress.trigger(billingAddress.dataScopePrefix + '.custom_attributes.data.validate');\n            }\n\n            return !billingAddress.get('params.invalid');\n        },\n\n        getOrderPaymentDetails: function (data) {\n            if (!this.requiresCardDetails) {\n                return Promise.resolve(data);\n            }\n\n            return fetch(`${this.getOrderDetailsUrl}`, {\n                method: 'GET'\n            }).then((res) => {\n                return res.json();\n            }).catch(function (err) {\n                console.log(\n                    'Could not get order details. Proceeding with order placement without card details.',\n                    err\n                );\n                return data;\n            });\n        },\n\n        /** @inheritdoc */\n        getData: function () {\n            var data = this._super();\n\n            data['additional_data'] = {\n                paypal_fastlane_profile: fastlaneModel.profileData() ? 'Yes' : 'No',\n                payment_source: this.paymentSource,\n                paypal_fastlane_token: this.fastlaneToken,\n                liability_shift: fastlaneModel.liabilityShift() ?? 'false',\n                authentication_state: fastlaneModel.authenticationState() ?? 'Cancelled',\n            };\n\n            return data;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/errors/response-error.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([], function () {\n    'use strict';\n\n    /**\n     * Error type to handle response errors.\n     *\n     * @param {String} message\n     * @constructor\n     */\n    function ResponseError(message) {\n        this.name = 'ResponseError';\n        this.message = message;\n        this.stack = new Error().stack;\n    }\n\n    ResponseError.prototype = new Error;\n\n    /**\n     * Return a string representation\n     *\n     * @returns {String}\n     */\n    ResponseError.prototype.toString = function () {\n        return this.message;\n    };\n\n    return ResponseError;\n});\n","Magento_PaymentServicesPaypal/js/view/customer_account/vault/add-card-button.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'jquery-ui-modules/widget',\n    'mage/translate'\n], function ($) {\n    'use strict';\n\n    $.widget('mage.cards', {\n        /**\n         * Bind event handlers for adding cards.\n         * @private\n         */\n        _create: function () {\n            let options = this.options;\n            let addCard = options.addCard;\n\n            if (addCard) {\n                $(document).on('click', addCard, this._addCard.bind(this));\n            }\n        },\n\n        /**\n         * Add a new card.\n         * @private\n         */\n        _addCard: function () {\n            window.location = this.options.addCardLocation;\n        }\n    });\n\n    return $.mage.cards;\n});\n","Magento_PaymentServicesPaypal/js/view/customer_account/vault/add-card-form.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/* eslint-disable no-undef */\ndefine([\n    \"jquery\",\n    \"underscore\",\n    \"uiComponent\",\n    \"scriptLoader\",\n    'Magento_PaymentServicesPaypal/js/lib/script-loader',\n    'mage/translate',\n    'Magento_Customer/js/customer-data',\n], function ($, _, Component, loadSdkScript, scriptLoader, $t, customerData) {\n    \"use strict\";\n\n    const cardFormSubmitButton = document.getElementById(\"paymentservices-add-card-button\");\n    const paymentServicesAddVaultCardContainer = document.getElementById(\"paymentservices_add_vault_card\");\n    const cardFormAddress = $(\".form-address-edit\")\n\n    return Component.extend({\n        defaults: {\n            template: \"Magento_PaymentServicesPaypal/customer_account/vault/add-card-form\",\n            componentParams: null,\n            paymentsSdk: null,\n            paymentsSdkInitPromise: null,\n            invalidFields: [],\n            emptyErrorMessage: $t('This is a required field.'),\n            fields: {\n                number: {\n                    errorMessage: $t('Please enter a valid credit card number.'),\n                },\n                expirationDate: {\n                    errorMessage: $t('Incorrect credit card expiration date.'),\n                },\n                cvv: {\n                    errorMessage: $t('Please enter a valid credit card security code.'),\n                }\n            }\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function () {\n            this._super()\n                .observe('invalidFields');\n\n            this.initPaymentsSDK(this.componentParams);\n\n            return this;\n        },\n\n        initPaymentsSDK: function ({ paymentsSDKUrl, storeViewCode, oauthToken, graphQLEndpointUrl }) {\n            this.showLoader(true);\n            this.paymentsSdkInitPromise = scriptLoader\n                .loadCustom({url: paymentsSDKUrl})\n                .then(async () => {\n                    const sdkConfig = {\n                        storeViewCode: storeViewCode\n                    }\n\n                    if (oauthToken) {\n                        sdkConfig.getCustomerToken = () => oauthToken;\n                    }\n\n                    if (graphQLEndpointUrl) {\n                        sdkConfig.apiUrl = graphQLEndpointUrl;\n                    }\n\n                    this.paymentsSdk = new PaymentServicesSDK(sdkConfig)\n                    await this.paymentsSdk.Vault.init()\n                });\n        },\n\n        /**\n         * @inheritdoc\n         */\n        afterRender: function () {\n            this.paymentsSdkInitPromise.then(async () => {\n\n                this.showLoader(false);\n\n                if (!this.paymentsSdk.Vault.CreditCard.isAvailable()) {\n                    paymentServicesAddVaultCardContainer.innerHTML = this.displayMessage($t(\"CreditCard Vault is not available.\"), 'error');\n                    return;\n                }\n\n                await this.paymentsSdk.Vault.CreditCard.render({\n                    styles: {\n                        input: {\n                            'font-family': '\"Open Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif',\n                            'font-size': '14px',\n                            'font-weight': '400',\n                            'border': '1px solid #c2c2c2',\n                            'border-radius': '1px',\n                            'padding': '0 9px',\n                            'height': '32px',\n                            'width': '100%',\n                            'box-sizing': 'border-box',\n                        },\n                        ':focus': {\n                            color: '#333'\n                        },\n                        '.valid': {\n                            color: '#333'\n                        },\n                        '.invalid': {\n                            'color': '#ed8380',\n                            'box-shadow': 'none'\n                        },\n                        body: {\n                            'margin': '0',\n                            'padding': '0',\n                        },\n                        // Remove card icon\n                        \"input.card-field-number.display-icon + .card-icon\": {\n                            display: \"none !important\",\n                            height: \"0\",\n                        },\n                        // Unindent card number\n                        \"input.card-field-number.display-icon\": {\n                            padding: \"0 9px !important\",\n                        },\n                    },\n                    fields: {\n                        description: {selector: \"#card-vault-container #vault-card-description\"},\n                        number: {selector: \"#card-vault-container #vault-card-number\"},\n                        expirationDate: {selector: \"#card-vault-container #vault-expiration-date\"},\n                        cvv: {selector: \"#card-vault-container #vault-cvv\"},\n                    },\n                    onError: (error) => {\n                        this.addMessage($t(\"Error while vaulting the card, please try again.\"), \"error\");\n                        console.error(error.message)\n                        this.showLoader(false);\n                    },\n                    onCancel: () => {\n                        console.debug(\"user cancelled the card vaulting process\");\n                        this.showLoader(false);\n                    },\n                    getBillingAddress: this.getBillingAddress.bind(this),\n                    onSuccess: () => {\n                        this.showLoader(false);\n                        paymentServicesAddVaultCardContainer.innerHTML = this.displayMessage($t('Card vaulted successfully. Please wait to be redirected to the Stored Payment Methods page.'), 'success');\n\n                        // Redirect to saved card list page\n                        setTimeout(() => {\n                            window.location.replace(this.componentParams.savedCardListUrl);\n                        }, 3000);\n                    },\n                    onValidityChange: this.onValidityChange.bind(this),\n                }).then((creditCardVault) => {\n                    cardFormSubmitButton.addEventListener(\"click\", () => {\n\n                        // Display errors for card fields\n                        if (!creditCardVault.isFormValid()) {\n                            var fields = creditCardVault.getFormState();\n                            Object.keys(fields).forEach((field) => {\n                                this.onValidityChange(fields, field);\n                            })\n                            creditCardVault.submit();\n                        }\n\n                        // Validate the address form\n                        if (!cardFormAddress.validation() || !cardFormAddress.validation('isValid')) {\n                            this.showLoader(false);\n                            return;\n                        }\n\n                        if (creditCardVault.isFormValid()) {\n                            this.showLoader(true);\n                            creditCardVault.submit();\n                        }\n                    });\n                }).catch((e) => {\n                    this.showLoader(false);\n                    this.addMessage($t(\"Error rendering Payment SDK, please reload the page and try again.\"), \"error\");\n                    console.error('Error rendering Payments SDK', e);\n                });\n            }).catch((error) => {\n                this.showLoader(false);\n                paymentServicesAddVaultCardContainer.innerHTML = this.displayMessage($t(\"Error initializing Payment SDK, please reload the page and try again.\"), 'error');\n                console.error(\"Error initializing Payment SDK:\", error);\n            });\n        },\n\n        /**\n         * Provide the billing address from the form\n         */\n        getBillingAddress: function () {\n            const regionInput = cardFormAddress.find(\"[name='region']\").val();\n            const regionIdDropdown = cardFormAddress.find(\"[name='region_id']\");\n            const regionIdValue = regionIdDropdown.val();\n            const regionIdLabel = regionIdDropdown.val() ? regionIdDropdown.find(`option[value='${regionIdValue}']`).text() : \"\";\n\n            return {\n                firstName: cardFormAddress.find(\"[name='firstname']\").val(),\n                lastName: cardFormAddress.find(\"[name='lastname']\").val(),\n                streetAddress: cardFormAddress.find(\"[name='street[0]']\").val(),\n                extendedAddress: cardFormAddress.find(\"[name='street[1]']\").val(),\n                region: regionIdDropdown.prop('disabled') ? regionInput : regionIdLabel,\n                locality: cardFormAddress.find(\"[name='city']\").val(),\n                postalCode: cardFormAddress.find(\"[name='postcode']\").val(),\n                countryCodeAlpha2: cardFormAddress.find(\"[name='country_id']\").val(),\n            };\n        },\n\n        /**\n         * Show/hide loader.\n         *\n         * @param {Boolean} show\n         */\n        showLoader: function (show) {\n            var event = show ? 'processStart' : 'processStop';\n\n            $('body').trigger(event);\n        },\n\n        /**\n         * Add message to customer data.\n         *\n         * @param {String} message\n         * @param {String} [type]\n         */\n        addMessage: function (message, type) {\n            type = type || 'error';\n            customerData.set('messages', {\n                messages: [{\n                    type: type,\n                    text: message\n                }],\n                'data_id': Math.floor(Date.now() / 1000)\n            });\n        },\n\n        onValidityChange: function (fields, emittedBy) {\n            var valid = _.every(fields, function (field) {\n                return field.isValid\n            });\n\n            var invalidFields = this.invalidFields().filter(field => field.name !== emittedBy);\n\n            if (!valid) {\n                if (fields[emittedBy] && !fields[emittedBy].isValid) {\n                    invalidFields.push({\n                        name: emittedBy,\n                        message: fields[emittedBy].isEmpty ? this.emptyErrorMessage : this.fields[emittedBy].errorMessage\n                    });\n                }\n                this.invalidFields(invalidFields)\n            } else {\n                this.invalidFields([]);\n            }\n        },\n\n        isFieldValid: function (fieldName) {\n            return !this.invalidFields.findWhere({\n                name: fieldName\n            });\n        },\n\n        getFieldErrorMessage: function (fieldName) {\n            return !this.isFieldValid(fieldName) ? this.invalidFields.findWhere({\n                name: fieldName\n            }).message : '';\n        },\n\n        displayMessage: function (text, type) {\n            return `<div class=\"${type} message\"><div>${$t(text)}</div></div>`;\n        },\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/product/gift-card-product-data-provider.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'underscore',\n    'Magento_PaymentServicesPaypal/js/view/product/product-data-provider'\n], function ($, _, Component) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            priceBoxContextSelector: '.giftcard-amount',\n            priceBoxSelector: '#giftcard-amount, #giftcard-amount-input'\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            this._super();\n            this.price = $(this.priceBoxSelector, this.priceBoxContextSelector).val();\n\n            return this;\n        },\n\n        /**\n         * Subscribe for price change.\n         */\n        priceSubscribe: function () {\n            $(this.priceBoxSelector, this.priceBoxContextSelector).on('change', function (event) {\n                this.price = event.target.value;\n                this.updateAmount(this.getAmount());\n            }.bind(this));\n        },\n\n        /**\n         * Checks if product is grouped type.\n         *\n         * @return {Boolean}\n         */\n        isProductGiftCard: function () {\n            return !!$(this.constructor.defaults.priceBoxContextSelector).length;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/product/grouped-product-data-provider.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine(['jquery', 'underscore', 'uiClass'], function ($, _, Component) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            tableWrapperSelector: '.table-wrapper.grouped',\n            qtyFieldSelector: '.input-text.qty',\n            priceBoxSelector: '[data-role=\"priceBox\"]',\n            priceInfo: {}\n        },\n\n        /**\n         * @inheritdoc\n         */\n        initialize: function () {\n            this._super();\n            $('tbody tr', this.tableWrapperSelector).each(function (index, element) {\n                var priceBox = $(this.priceBoxSelector, element),\n                    qtyElement = $(this.qtyFieldSelector, element),\n                    productId = priceBox.data('productId'),\n                    priceElement = $('#product-price-' + productId);\n\n                this.priceInfo[productId] = {\n                    qty: this.getQuantity(qtyElement),\n                    price: priceElement.data('priceAmount')\n                };\n            }.bind(this));\n            this.quantitySubscribe();\n\n            return this;\n        },\n\n        /**\n         * Subscribe for quantity changes.\n         */\n        quantitySubscribe: function () {\n            $(this.qtyFieldSelector).on('change', function (event) {\n                var qtyElement = $(event.target),\n                    parent = qtyElement.parents('tr'),\n                    priceBox = $(this.priceBoxSelector, parent),\n                    productId = priceBox.data('productId');\n\n                if (this.priceInfo[productId]) {\n                    this.priceInfo[productId].qty = this.getQuantity(qtyElement);\n                }\n\n                this.updateAmount(this.getAmount());\n            }.bind(this));\n        },\n\n        /**\n         * Get product amount.\n         *\n         * @return {Number}\n         */\n        getAmount: function () {\n            var amount = 0;\n\n            _.each(this.priceInfo, function (info) {\n                amount += info.price * info.qty;\n            });\n\n            return amount;\n        },\n\n        /**\n         * Get product quantity.\n         *\n         * @param {HTMLElement} element\n         * @return {Number}\n         */\n        getQuantity: function (element) {\n            var qty = parseFloat(element.val());\n\n            return !isNaN(qty) && qty ? qty : 0;\n        },\n\n        /**\n         * Checks if product is grouped type.\n         *\n         * @return {Boolean}\n         */\n        isProductGrouped: function () {\n            return !!$(this.constructor.defaults.tableWrapperSelector).length;\n        },\n\n        /**\n         * Subscribe for price change.\n         */\n        priceSubscribe: function () {\n        },\n\n        /**\n         * Trigger price update.\n         */\n        updatePrice: function () {\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/product/bundle-product-data-provider.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'underscore',\n    'Magento_PaymentServicesPaypal/js/view/product/product-data-provider'\n], function ($, _, Component) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            priceBoxContextSelector: '#bundleSummary',\n            slideSelector: '#bundle-slide'\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            this._super();\n\n            // Need to track bundle product slide to trigger amount update to make message visible.\n            $(this.slideSelector).on('click', function () {\n                setTimeout(function () {\n                    this.updateAmount(this.getAmount());\n                }.bind(this), 300);\n            }.bind(this));\n            this.updateAmount(this.getAmount());\n\n            return this;\n        },\n\n        /**\n         * Checks if product is grouped type.\n         *\n         * @return {Boolean}\n         */\n        isBundleProduct: function () {\n            return !!$(this.constructor.defaults.priceBoxContextSelector).length;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/view/product/product-data-provider.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine(['jquery', 'uiClass', 'priceBox'], function ($, Component) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            qtyFieldSelector: '#qty',\n            priceBoxSelector: '.price-box',\n            priceBoxContextSelector: '.product-info-main',\n            finalPriceSelector: '[data-price-type=\"finalPrice\"]',\n            price: 0,\n            qty: 0\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            this._super();\n            this.price = $(this.finalPriceSelector, this.priceBoxContextSelector).attr('data-price-amount');\n            this.qty = $(this.qtyFieldSelector).val();\n            this.quantitySubscribe();\n            this.priceSubscribe();\n\n            return this;\n        },\n\n        /**\n         * Subscribe for quantity changes.\n         */\n        quantitySubscribe: function () {\n            $(this.qtyFieldSelector).on('change', function () {\n                this.qty = $(this.qtyFieldSelector).val();\n                this.updateAmount(this.getAmount());\n            }.bind(this));\n        },\n\n        /**\n         * Subscribe for price change.\n         */\n        priceSubscribe: function () {\n            $(this.priceBoxSelector, this.priceBoxContextSelector).on('updatePrice', function (event) {\n                var prices = $(event.target).data('magePriceBox').cache.displayPrices;\n\n                this.price = prices.finalPrice.amount;\n                this.updateAmount(this.getAmount());\n            }.bind(this));\n        },\n\n        /**\n         * Trigger price update.\n         */\n        updatePrice: function () {\n            $(this.priceBoxSelector).trigger('updatePrice');\n        },\n\n        /**\n         * Get product amount.\n         *\n         * @return {Number}\n         */\n        getAmount: function () {\n            return this.qty * this.price;\n        }\n    });\n});\n","Magento_PaymentServicesPaypal/js/helpers/map-address-to-magento.js":"define([\n    'Magento_Checkout/js/model/new-customer-address',\n    'Magento_PaymentServicesPaypal/js/helpers/get-allowed-locations',\n    'Magento_PaymentServicesPaypal/js/helpers/get-street-line-count',\n    'Magento_PaymentServicesPaypal/js/helpers/get-region-id'\n], function (Address, getAllowedLocations, getStreetLineCount, getRegionId) {\n    'use strict';\n\n    /**\n     * Creates an array of empty strings with the length being the set street lines for a customer address.\n     *\n     * @returns {Array}\n     */\n    const createEmptyStreetArray = () => {\n        const streetLines = getStreetLineCount();\n        return Array.apply(null, Array(streetLines))\n            .reduce((prev, curr, index) => { prev[index] = ''; return prev; }, {});\n    };\n\n    /**\n     * Fastlane provides an address object that isn't in the correct Adobe Commerce format so map it to the\n     * correct format.\n     *\n     * @param {Object} address - An address object as gathered from Fastlane.\n     * @returns {Object} - A correctly mapped address using 'Magento_Checkout/js/model/new-customer-address' model.\n     */\n    return function (address) {\n        const street = createEmptyStreetArray();\n\n        street[0] = address.address.addressLine1 || address.address.streetAddress;\n\n        if (address.address.addressLine2 || address.address.extendedAddress) {\n            street[1] = address.address.addressLine2 || address.address.extendedAddress;\n        }\n\n        const mappedAddress = Address({\n                region: {\n                    region_id: getRegionId(\n                        address.address.countryCode || address.address.countryCodeAlpha2,\n                        address.address.adminArea1 || address.address.region\n                    ),\n                    region_code: address.address.adminArea1 || address.address.region,\n                    region: address.address.adminArea1 || address.address.region\n                },\n                company: address.address.company || '',\n                country_id: address.address.countryCode || address.address.countryCodeAlpha2,\n                street,\n                firstname: address.name?.firstName || '',\n                lastname: address.name?.lastName || '',\n                city: address.address.adminArea2 || address.address.locality,\n                telephone: address.phoneNumber?.nationalNumber || '00000000000',\n                postcode: address.address.postalCode\n            }),\n            allowedLocations = getAllowedLocations();\n\n        mappedAddress.country_id = mappedAddress.countryId;\n        mappedAddress.region_code = mappedAddress.regionCode;\n        mappedAddress.region_id = mappedAddress.regionId;\n        mappedAddress.street = street;\n\n        // If the country / region isn't available on this website then throw an error.\n        if (!allowedLocations.includes(mappedAddress.countryId)) {\n            const error = new Error();\n\n            error.name = 'paypal_fastlane:address_unavailable';\n            throw error;\n        }\n\n        return mappedAddress;\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/remove-paypal-url-token.js":"define(function () {\n    'use strict';\n\n    return function () {\n            // Remove the URL hash token to prevent refreshes trying to resume the same payment.\n            const params = new URLSearchParams(window.location.search);\n            params.delete('token');\n            window.history.replaceState('', document.title, window.location.pathname + '?' + params.toString());\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/get-street-line-count.js":"define(['uiRegistry'], function (uiRegistry) {\n    'use strict';\n\n    /**\n     * Returns the integer count of the number of street lines available on a customer address.\n     *\n     * @returns {number}\n     */\n    return function () {\n        const shippingAddress = uiRegistry.get('checkout.steps.shipping-step.shippingAddress');\n        return Object.values(shippingAddress.source.shippingAddress.street).length;\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/get-allowed-locations.js":"define(['uiRegistry'], function (uiRegistry) {\n    'use strict';\n\n    /**\n     * Get the available list of countries as defined in configuration.\n     *\n     * @returns {Array}\n     */\n    return function () {\n        const countries = uiRegistry.get('checkoutProvider').get('dictionaries.country_id'),\n            allowedLocations = countries.map(({ value }) => value).filter((value) => value && value !== 'delimiter');\n\n        return allowedLocations;\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/map-address-to-fastlane.js":"define(function () {\n    'use strict';\n\n    /**\n     * Formats an address object back to the format expected by Fastlane.\n     *\n     * @param {Object} address - Address that ideally is a 'Magento_Checkout/js/model/new-customer-address' object.\n     * @returns {Object} - A correctly mapped address that is expected by Fastlane.\n     */\n    return function (address) {\n        const formattedAddress = {\n            firstName: address.firstname,\n            lastName: address.lastname,\n            company: address.company,\n            locality: address.city,\n            region: address.regionCode,\n            postalCode: address.postcode,\n            countryCodeAlpha2: address.countryId,\n            phoneNumber: address.telephone\n        };\n\n        // Street needs a little bit of extra work because it can be more than two lines.\n        formattedAddress.streetAddress =  address.street?.[0];\n\n        // If there is a second line available then join all of the remaining array properties together.\n        if (address.street?.[1]) {\n            formattedAddress.extendedAddress = address.street.slice(1).join(', ');\n        }\n\n        return formattedAddress;\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/get-region-id.js":"define(['Magento_Customer/js/customer-data'], function (customerData) {\n    'use strict';\n\n    /**\n     * Converts a region string into the associated region ID.\n     *\n     * @returns {number}\n     */\n    return function (countryCode, administrativeArea) {\n        const countryData = customerData.get('directory-data')(),\n            country = countryData[countryCode];\n\n            if (country?.regions) {\n                const regionIds = Object.keys(country.regions);\n\n                return regionIds.find((regionId) => {\n                    return country.regions[regionId].code === administrativeArea;\n                }) || 0;\n            }\n\n            return 0;\n    };\n});\n","Magento_PaymentServicesPaypal/js/helpers/is-fastlane-available.js":"define(['Magento_Customer/js/model/customer'], function (customer) {\n    'use strict';\n\n    /**\n     * Small helper to check if Fastlane is enabled and the User is NOT logged in.\n     *\n     * @retuns {boolean}\n     */\n    return function () {\n        return window.checkoutConfig.payment.payment_services_paypal_fastlane?.isVisible && !customer.isLoggedIn();\n    };\n});\n","Magento_Bundle/js/validation.js":"define([\n    'jquery',\n    'jquery-ui-modules/widget'\n], function ($) {\n    'use strict';\n    var enhancedMageValidation = {\n        /**\n         * @param {*} error\n         * @param {*} element\n         */\n        options: {\n            errorPlacement: function (error, element) {\n                var errorPlacement = element,\n                    fieldWrapper,messageBox;\n\n                // logic for date-picker error placement\n                if (element.hasClass('_has-datepicker')) {\n                    errorPlacement = element.siblings('button');\n                }\n                // logic for field wrapper\n                fieldWrapper = element.closest('.addon');\n\n                if (fieldWrapper.length) {\n                    errorPlacement = fieldWrapper.after(error);\n                }\n                //logic for checkboxes/radio\n                if (element.is(':checkbox') || element.is(':radio')) {\n                    errorPlacement = element.parents('.control').children().last();\n\n                    //fallback if group does not have .control parent\n                    if (!errorPlacement.length) {\n                        errorPlacement = element.siblings('label').last();\n                    }\n                }\n                if (element.attr('data-errors-msg-box')) {\n                    messageBox = $(element.attr('data-errors-msg-box'));\n                    messageBox.html(error);\n                    return;\n                }\n                //logic for control with tooltip\n                if (element.siblings('.tooltip').length) {\n                    errorPlacement = element.siblings('.tooltip');\n                }\n                //logic for select with tooltip in after element\n                if (element.next().find('.tooltip').length) {\n                    errorPlacement = element.next();\n                }\n                errorPlacement.after(error);\n            }\n\n        }\n    };\n\n    return function (mageValidation) {\n        $.widget('mage.validation', mageValidation, enhancedMageValidation);\n        return $.mage.validation;\n    };\n});\n","Magento_Bundle/js/price-bundle.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @api\n */\ndefine([\n    'jquery',\n    'underscore',\n    'mage/template',\n    'priceUtils',\n    'jquery/jquery.parsequery',\n    'priceBox'\n], function ($, _, mageTemplate, utils) {\n    'use strict';\n\n    var globalOptions = {\n        optionConfig: null,\n        productBundleSelector: 'input.bundle.option, select.bundle.option, textarea.bundle.option',\n        qtyFieldSelector: 'input.qty',\n        priceBoxSelector: '.price-box',\n        optionHandlers: {},\n        optionTemplate: '<%- data.label %>' +\n            '<% if (data.finalPrice.value) { %>' +\n            ' +<%- data.finalPrice.formatted %>' +\n            '<% } %>',\n        controlContainer: 'dd', // should be eliminated\n        priceFormat: {},\n        isFixedPrice: false,\n        optionTierPricesBlocksSelector: '#option-tier-prices-{1} [data-role=\"selection-tier-prices\"]',\n        isOptionsInitialized: false\n    };\n\n    $.widget('mage.priceBundle', {\n        options: globalOptions,\n\n        /**\n         * @private\n         */\n        _init: function initPriceBundle() {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                qty = $(this.options.qtyFieldSelector, form);\n\n            // Override defaults with URL query parameters and/or inputs values\n            this._overrideDefaults();\n\n            options.trigger('change');\n            qty.trigger('change');\n        },\n\n        /**\n         * @private\n         */\n        _create: function createPriceBundle() {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                priceBox = $(this.options.priceBoxSelector, form),\n                qty = $(this.options.qtyFieldSelector, form);\n\n            this._updatePriceBox();\n            priceBox.on('price-box-initialized', this._updatePriceBox.bind(this));\n            options.on('change', this._onBundleOptionChanged.bind(this));\n            qty.on('change', this._onQtyFieldChanged.bind(this));\n        },\n\n        /**\n         * Override default options values settings with either URL query parameters or\n         * initialized inputs values.\n         * @private\n         */\n        _overrideDefaults: function () {\n            var hashIndex = window.location.href.indexOf('#');\n\n            if (hashIndex !== -1) {\n                this._parseQueryParams(window.location.href.substr(hashIndex + 1));\n            }\n        },\n\n        /**\n         * Parse query parameters from a query string and set options values based on the\n         * key value pairs of the parameters.\n         * @param {*} queryString - URL query string containing query parameters.\n         * @private\n         */\n        _parseQueryParams: function (queryString) {\n            var queryParams = $.parseQuery({\n                    query: queryString\n                }),\n                selectedValues = [],\n                form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                qtys = $(this.options.qtyFieldSelector, form);\n\n            $.each(queryParams, $.proxy(function (key, value) {\n                qtys.each(function (index, qty) {\n                    if (qty.name === key) {\n                        $(qty).val(value);\n                    }\n                });\n                options.each(function (index, option) {\n                    let optionType = $(option).prop('type');\n\n                    if (option.name === key ||\n                        optionType === 'select-multiple'\n                        && key.indexOf(option.name.substr(0, option.name.length - 2)) !== false\n                    ) {\n\n                        switch (optionType) {\n                            case 'radio':\n                                $(option).val() === value ? $(option).prop('checked', true) : '';\n                                break;\n                            case 'checkbox':\n                                $(option).prop('checked', true);\n                                break;\n                            case 'hidden':\n                            case 'select-one':\n                                $(option).val(value);\n                                break;\n                            case 'select-multiple':\n                                selectedValues.push(value);\n                                break;\n                        }\n                        if (optionType === 'select-multiple' && selectedValues.length) {\n                            $(option).val(selectedValues);\n                        }\n                    }\n                });\n            }, this));\n        },\n\n        /**\n         * Update price box config with bundle option prices\n         * @private\n         */\n        _updatePriceBox: function () {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                priceBox = $(this.options.priceBoxSelector, form);\n\n            if (!this.options.isOptionsInitialized) {\n                if (priceBox.data('magePriceBox') &&\n                    priceBox.priceBox('option') &&\n                    priceBox.priceBox('option').priceConfig\n                ) {\n                    if (priceBox.priceBox('option').priceConfig.optionTemplate) { //eslint-disable-line max-depth\n                        this._setOption('optionTemplate', priceBox.priceBox('option').priceConfig.optionTemplate);\n                    }\n                    this._setOption('priceFormat', priceBox.priceBox('option').priceConfig.priceFormat);\n                    priceBox.priceBox('setDefault', this.options.optionConfig.prices);\n                    this.options.isOptionsInitialized = true;\n                }\n                this._applyOptionNodeFix(options);\n            }\n\n            return this;\n        },\n\n        /**\n         * Handle change on bundle option inputs\n         * @param {jQuery.Event} event\n         * @private\n         */\n        _onBundleOptionChanged: function onBundleOptionChanged(event) {\n            var changes,\n                bundleOption = $(event.target),\n                priceBox = $(this.options.priceBoxSelector, this.element),\n                handler = this.options.optionHandlers[bundleOption.data('role')];\n\n            bundleOption.data('optionContainer', bundleOption.closest(this.options.controlContainer));\n            bundleOption.data('qtyField', bundleOption.data('optionContainer').find(this.options.qtyFieldSelector));\n\n            if (handler && handler instanceof Function) {\n                changes = handler(bundleOption, this.options.optionConfig, this);\n            } else {\n                changes = defaultGetOptionValue(bundleOption, this.options.optionConfig);//eslint-disable-line\n            }\n\n            // eslint-disable-next-line no-use-before-define\n            if (isValidQty(bundleOption)) {\n                if (changes) {\n                    priceBox.trigger('updatePrice', changes);\n                }\n\n                this._displayTierPriceBlock(bundleOption);\n                this.updateProductSummary();\n            }\n        },\n\n        /**\n         * Handle change on qty inputs near bundle option\n         * @param {jQuery.Event} event\n         * @private\n         */\n        _onQtyFieldChanged: function onQtyFieldChanged(event) {\n            var field = $(event.target),\n                optionInstance,\n                optionConfig;\n\n            if (field.data('optionId') && field.data('optionValueId')) {\n                optionInstance = field.data('option');\n                optionConfig = this.options.optionConfig\n                    .options[field.data('optionId')]\n                    .selections[field.data('optionValueId')];\n                optionConfig.qty = field.val();\n\n                // eslint-disable-next-line no-use-before-define\n                if (isValidQty(optionInstance)) {\n                    optionInstance.trigger('change');\n                }\n            }\n        },\n\n        /**\n         * Helper to fix backend behavior:\n         *  - if default qty large than 1 then backend multiply price in config\n         *\n         * @deprecated\n         * @private\n         */\n        _applyQtyFix: function applyQtyFix() {\n            var config = this.options.optionConfig;\n\n            if (config.isFixedPrice) {\n                _.each(config.options, function (option) {\n                    _.each(option.selections, function (item) {\n                        if (item.qty && item.qty !== 1) {\n                            _.each(item.prices, function (price) {\n                                price.amount /= item.qty;\n                            });\n                        }\n                    });\n                });\n            }\n        },\n\n        /**\n         * Helper to fix issue with option nodes:\n         *  - you can't place any html in option ->\n         *    so you can't style it via CSS\n         * @param {jQuery} options\n         * @private\n         */\n        _applyOptionNodeFix: function applyOptionNodeFix(options) {\n            var config = this.options,\n                format = config.priceFormat,\n                template = config.optionTemplate;\n\n            template = mageTemplate(template);\n            options.filter('select').each(function (index, element) {\n                var $element = $(element),\n                    optionId = utils.findOptionId($element),\n                    optionConfig = config.optionConfig && config.optionConfig.options[optionId].selections,\n                    value;\n\n                $element.find('option').each(function (idx, option) {\n                    var $option,\n                        optionValue,\n                        toTemplate,\n                        prices;\n\n                    $option = $(option);\n                    optionValue = $option.val();\n\n                    if (!optionValue && optionValue !== 0) {\n                        return;\n                    }\n\n                    toTemplate = {\n                        data: {\n                            label: optionConfig[optionValue] && optionConfig[optionValue].name\n                        }\n                    };\n                    prices = optionConfig[optionValue].prices;\n\n                    _.each(prices, function (price, type) {\n                        value = +price.amount;\n                        value += _.reduce(price.adjustments, function (sum, x) {//eslint-disable-line\n                            return sum + x;\n                        }, 0);\n                        toTemplate.data[type] = {\n                            value: value,\n                            formatted: utils.formatPriceLocale(value, format)\n                        };\n                    });\n\n                    $option.html(template(toTemplate));\n                });\n            });\n        },\n\n        /**\n         * Custom behavior on getting options:\n         * now widget able to deep merge accepted configuration with instance options.\n         * @param  {Object}  options\n         * @return {$.Widget}\n         */\n        _setOptions: function setOptions(options) {\n            $.extend(true, this.options, options);\n\n            this._super(options);\n\n            return this;\n        },\n\n        /**\n         * Show or hide option tier prices block\n         *\n         * @param {Object} optionElement\n         * @private\n         */\n        _displayTierPriceBlock: function (optionElement) {\n            var optionType = optionElement.prop('type'),\n                optionId,\n                optionValue,\n                optionTierPricesElements;\n\n            if (optionType === 'select-one') {\n                optionId = utils.findOptionId(optionElement[0]);\n                optionValue = optionElement.val() || null;\n                optionTierPricesElements = $(this.options.optionTierPricesBlocksSelector.replace('{1}', optionId));\n\n                _.each(optionTierPricesElements, function (tierPriceElement) {\n                    var selectionId = $(tierPriceElement).data('selection-id') + '';\n\n                    if (selectionId === optionValue) {\n                        $(tierPriceElement).show();\n                    } else {\n                        $(tierPriceElement).hide();\n                    }\n                });\n            }\n        },\n\n        /**\n         * Handler to update productSummary box\n         */\n        updateProductSummary: function updateProductSummary() {\n            this.element.trigger('updateProductSummary', {\n                config: this.options.optionConfig\n            });\n        }\n    });\n\n    return $.mage.priceBundle;\n\n    /**\n     * Converts option value to priceBox object\n     *\n     * @param   {jQuery} element\n     * @param   {Object} config\n     * @returns {Object|null} - priceBox object with additional prices\n     */\n    function defaultGetOptionValue(element, config) {\n        var changes = {},\n            optionHash,\n            tempChanges,\n            qtyField,\n            optionId = utils.findOptionId(element[0]),\n            optionValue = element.val() || null,\n            optionName = element.prop('name'),\n            optionType = element.prop('type'),\n            optionConfig = config.options[optionId].selections,\n            optionQty = 0,\n            canQtyCustomize = false,\n            selectedIds = config.selected;\n\n        switch (optionType) {\n            case 'radio':\n            case 'select-one':\n\n                if (optionType === 'radio' && !element.is(':checked')) {\n                    return null;\n                }\n\n                qtyField = element.data('qtyField');\n                qtyField.data('option', element);\n\n                if (optionValue) {\n                    optionQty = optionConfig[optionValue].qty || 0;\n                    canQtyCustomize = optionConfig[optionValue].customQty === '1';\n                    toggleQtyField(qtyField, optionQty, optionId, optionValue, canQtyCustomize);//eslint-disable-line\n                    tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                    tempChanges = applyTierPrice(//eslint-disable-line\n                        tempChanges,\n                        optionQty,\n                        optionConfig[optionValue]\n                    );\n                    tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                } else {\n                    tempChanges = {};\n                    toggleQtyField(qtyField, '0', optionId, optionValue, false);//eslint-disable-line\n                }\n                optionHash = 'bundle-option-' + optionName;\n                changes[optionHash] = tempChanges;\n                selectedIds[optionId] = [optionValue];\n                break;\n\n            case 'select-multiple':\n                optionValue = _.compact(optionValue);\n\n                _.each(optionConfig, function (row, optionValueCode) {\n                    optionHash = 'bundle-option-' + optionName + '##' + optionValueCode;\n                    optionQty = row.qty || 0;\n                    tempChanges = utils.deepClone(row.prices);\n                    tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                    tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                    changes[optionHash] = _.contains(optionValue, optionValueCode) ? tempChanges : {};\n                });\n\n                selectedIds[optionId] = optionValue || [];\n                break;\n\n            case 'checkbox':\n                optionHash = 'bundle-option-' + optionName + '##' + optionValue;\n                optionQty = optionConfig[optionValue].qty || 0;\n                tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                changes[optionHash] = element.is(':checked') ? tempChanges : {};\n\n                selectedIds[optionId] = selectedIds[optionId] || [];\n\n                if (!_.contains(selectedIds[optionId], optionValue) && element.is(':checked')) {\n                    selectedIds[optionId].push(optionValue);\n                } else if (!element.is(':checked')) {\n                    selectedIds[optionId] = _.without(selectedIds[optionId], optionValue);\n                }\n                break;\n\n            case 'hidden':\n                optionHash = 'bundle-option-' + optionName + '##' + optionValue;\n                optionQty = optionConfig[optionValue].qty || 0;\n                canQtyCustomize = optionConfig[optionValue].customQty === '1';\n                qtyField = element.data('qtyField');\n                qtyField.data('option', element);\n                toggleQtyField(qtyField, optionQty, optionId, optionValue, canQtyCustomize);//eslint-disable-line\n                tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n\n                optionHash = 'bundle-option-' + optionName;\n                changes[optionHash] = tempChanges;\n                selectedIds[optionId] = [optionValue];\n                break;\n        }\n\n        return changes;\n    }\n\n    /**\n     * Check the quantity field if negative value occurs.\n     *\n     * @param {Object} bundleOption\n     */\n    function isValidQty(bundleOption) {\n        var isValid = true,\n            qtyElem = bundleOption.data('qtyField'),\n            bundleOptionType = bundleOption.prop('type');\n\n        if (['radio', 'select-one'].includes(bundleOptionType) && qtyElem.val() < 0) {\n            isValid = false;\n        }\n\n        return isValid;\n    }\n\n    /**\n     * Helper to toggle qty field\n     * @param {jQuery} element\n     * @param {String|Number} value\n     * @param {String|Number} optionId\n     * @param {String|Number} optionValueId\n     * @param {Boolean} canEdit\n     */\n    function toggleQtyField(element, value, optionId, optionValueId, canEdit) {\n        element\n            .val(value)\n            .data('optionId', optionId)\n            .data('optionValueId', optionValueId)\n            .attr('disabled', !canEdit);\n\n        if (canEdit) {\n            element.removeClass('qty-disabled');\n        } else {\n            element.addClass('qty-disabled');\n        }\n    }\n\n    /**\n     * Helper to multiply on qty\n     *\n     * @param   {Object} prices\n     * @param   {Number} qty\n     * @returns {Object}\n     */\n    function applyQty(prices, qty) {\n        _.each(prices, function (everyPrice) {\n            everyPrice.amount *= qty;\n            _.each(everyPrice.adjustments, function (el, index) {\n                everyPrice.adjustments[index] *= qty;\n            });\n        });\n\n        return prices;\n    }\n\n    /**\n     * Helper to limit price with tier price\n     *\n     * @param {Object} oneItemPrice\n     * @param {Number} qty\n     * @param {Object} optionConfig\n     * @returns {Object}\n     */\n    function applyTierPrice(oneItemPrice, qty, optionConfig) {\n        var tiers = optionConfig.tierPrice,\n            magicKey = _.keys(oneItemPrice)[0],\n            tiersFirstKey = _.keys(optionConfig)[0],\n            lowest = false;\n\n        if (!tiers) {//tiers is undefined when options has only one option\n            tiers = optionConfig[tiersFirstKey].tierPrice;\n        }\n\n        tiers.sort(function (a, b) {//sorting based on \"price_qty\"\n            return a['price_qty'] - b['price_qty'];\n        });\n\n        _.each(tiers, function (tier, index) {\n            if (tier['price_qty'] > qty) {\n                return;\n            }\n\n            if (tier.prices[magicKey].amount < oneItemPrice[magicKey].amount) {\n                lowest = index;\n            }\n        });\n\n        if (lowest !== false) {\n            oneItemPrice = utils.deepClone(tiers[lowest].prices);\n        }\n\n        return oneItemPrice;\n    }\n});\n","Magento_Bundle/js/product-summary.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @api\n */\ndefine([\n    'jquery',\n    'mage/template',\n    'jquery-ui-modules/widget',\n    'Magento_Bundle/js/price-bundle'\n], function ($, mageTemplate) {\n    'use strict';\n\n    /**\n     * Widget product Summary:\n     * Handles rendering of Bundle options and displays them in the Summary box\n     */\n    $.widget('mage.productSummary', {\n        options: {\n            mainContainer:          '#product_addtocart_form',\n            templates: {\n                summaryBlock:       '[data-template=\"bundle-summary\"]',\n                optionBlock:        '[data-template=\"bundle-option\"]'\n            },\n            optionSelector:         '[data-container=\"options\"]',\n            summaryContainer:       '[data-container=\"product-summary\"]',\n            bundleSummaryContainer: '.bundle-summary'\n        },\n        cache: {},\n\n        /**\n         * Method attaches event observer to the product form\n         * @private\n         */\n        _create: function () {\n            this.element\n                .closest(this.options.mainContainer)\n                .on('updateProductSummary', $.proxy(this._renderSummaryBox, this))\n                .priceBundle({})\n            ;\n        },\n\n        /**\n         * Method extracts data from the event and renders Summary box\n         * using jQuery template mechanism\n         * @param {Event} event\n         * @param {Object} data\n         * @private\n         */\n        _renderSummaryBox: function (event, data) {\n            this.cache.currentElement = data.config;\n            this.cache.currentElementCount = 0;\n\n            // Clear Summary box\n            this.element.html('');\n            this.cache.currentElement.positions.forEach(function (optionId) {\n                this._renderOption(optionId, this.cache.currentElement.selected[optionId]);\n            }, this);\n            this.element\n                .parents(this.options.bundleSummaryContainer)\n                .toggleClass('empty', !this.cache.currentElementCount); // Zero elements equal '.empty' container\n        },\n\n        /**\n         * @param {String} key\n         * @param {String} row\n         * @private\n         */\n        _renderOption: function (key, row) {\n            var template;\n\n            if (row && row.length > 0 && row[0] !== null) {\n                template = this.element\n                    .closest(this.options.summaryContainer)\n                    .find(this.options.templates.summaryBlock)\n                    .html();\n                template = mageTemplate(template.trim(), {\n                    data: {\n                        _label_: this.cache.currentElement.options[key].title\n                    }\n                });\n\n                this.cache.currentKey = key;\n                this.cache.summaryContainer = $(template);\n                this.element.append(this.cache.summaryContainer);\n\n                $.each(row, this._renderOptionRow.bind(this));\n                this.cache.currentElementCount += row.length;\n\n                //Reset Cache\n                this.cache.currentKey = null;\n            }\n        },\n\n        /**\n         * @param {String} key\n         * @param {String} optionIndex\n         * @private\n         */\n        _renderOptionRow: function (key, optionIndex) {\n            var template;\n\n            template = this.element\n                .closest(this.options.summaryContainer)\n                .find(this.options.templates.optionBlock)\n                .html();\n            template = mageTemplate(template.trim(), {\n                data: {\n                    _quantity_: this.cache.currentElement.options[this.cache.currentKey].selections[optionIndex].qty,\n                    _label_: this.cache.currentElement.options[this.cache.currentKey].selections[optionIndex].name\n                }\n            });\n            this.cache.summaryContainer\n                .find(this.options.optionSelector)\n                .append(template);\n        }\n    });\n\n    return $.mage.productSummary;\n});\n","Magento_Bundle/js/slide.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @api\n */\ndefine([\n    'jquery',\n    'jquery-ui-modules/widget'\n], function ($) {\n    'use strict';\n\n    $.widget('mage.slide', {\n        options: {\n            slideSpeed: 1500,\n            slideSelector: '#bundle-slide',\n            slideBackSelector: '.bundle-slide-back',\n            bundleProductSelector: '#bundleProduct',\n            bundleOptionsContainer: '#options-container',\n            productViewContainer: '#productView',\n            slidedown: true\n\n        },\n\n        /** @inheritdoc */\n        _create: function () {\n            if (this.options.slidedown === true) {\n                $(this.options.slideSelector).on('click', $.proxy(this._show, this));\n                $(this.options.slideBackSelector).on('click', $.proxy(this._hide, this));\n                this.options.autostart && this._show();\n            } else {\n                $(this.options.slideSelector).on('click', $.proxy(this._slide, this));\n                $(this.options.slideBackSelector).on('click', $.proxy(this._slideBack, this));\n                this.options.autostart && this._slide();\n            }\n        },\n\n        /**\n         * slide bundleOptionsContainer over to the main view area\n         * @private\n         */\n        _slide: function () {\n            $(this.options.bundleProductSelector).css('top', '0px');\n            $(this.options.bundleOptionsContainer).show();\n            this.element.css('height', $(this.options.productViewContainer).height() + 'px');\n            $(this.options.bundleProductSelector).css('left', '0px').animate(\n                {\n                    'left': '-' + this.element.width() + 'px'\n                },\n                this.options.slideSpeed,\n                $.proxy(function () {\n                    this.element.css('height', 'auto');\n                    $(this.options.productViewContainer).hide();\n                }, this)\n            );\n        },\n\n        /**\n         * slideback productViewContainer to main view area\n         * @private\n         */\n        _slideBack: function () {\n            $(this.options.bundleProductSelector).css('top', '0px');\n            $(this.options.productViewContainer).show();\n            this.element.css('height', $(this.options.bundleOptionsContainer).height() + 'px');\n            $(this.options.bundleProductSelector).animate(\n                {\n                    'left': '0px'\n                },\n                this.options.slideSpeed,\n                $.proxy(function () {\n                    $(this.options.bundleOptionsContainer).hide();\n                    this.element.css('height', 'auto');\n                }, this)\n            );\n        },\n\n        /**\n         * @private\n         */\n        _show: function () {\n            $(this.options.bundleOptionsContainer).slideDown(800);\n            $('html, body').animate({\n                scrollTop: $(this.options.bundleOptionsContainer).offset().top\n            }, 600);\n            $('#product-options-wrapper > fieldset').trigger('focus');\n        },\n\n        /**\n         * @private\n         */\n        _hide: function () {\n            $('html, body').animate({\n                scrollTop: 0\n            }, 600);\n            $(this.options.bundleOptionsContainer).slideUp(800);\n        }\n    });\n\n    return $.mage.slide;\n});\n","Magento_CatalogSearch/js/search-terms-log.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mageUtils'\n], function ($, utils) {\n    'use strict';\n\n    return function (data) {\n        $.ajax({\n            method: 'GET',\n            url: data.url,\n            data: {\n                'q': utils.getUrlParameters(window.location.href).q\n            }\n        });\n    };\n});\n","Magento_LoginAsCustomerFrontendUi/js/login.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'Magento_Customer/js/customer-data',\n    'Magento_Customer/js/section-config'\n], function ($, customerData, sectionConfig) {\n\n    'use strict';\n\n    return function (config) {\n        customerData.reload(sectionConfig.getSectionNames()).done(function () {\n            window.location.href = config.redirectUrl;\n        });\n    };\n});\n","Magento_LoginAsCustomerFrontendUi/js/view/loginAsCustomer.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'underscore',\n    'uiComponent',\n    'Magento_Customer/js/customer-data',\n    'mage/translate'\n], function ($, _, Component, customer) {\n    'use strict';\n\n    return Component.extend({\n\n        defaults: {\n            isVisible: false\n        },\n\n        /** @inheritdoc */\n        initialize: function () {\n            var customerData, loggedAsCustomerData;\n\n            this._super();\n\n            customerData = customer.get('customer');\n            loggedAsCustomerData = customer.get('loggedAsCustomer');\n\n            customerData.subscribe(function (data) {\n                this.fullname = data.fullname;\n                this.updateBanner();\n            }.bind(this));\n            loggedAsCustomerData.subscribe(function (data) {\n                this.adminUserId = data.adminUserId;\n                this.websiteName = data.websiteName;\n                this.updateBanner();\n            }.bind(this));\n\n            this.fullname = customerData().fullname;\n            this.adminUserId = loggedAsCustomerData().adminUserId;\n            this.websiteName = loggedAsCustomerData().websiteName;\n\n            this.updateBanner();\n        },\n\n        /** @inheritdoc */\n        initObservable: function () {\n            this._super()\n                .observe(['isVisible', 'notificationText']);\n\n            return this;\n        },\n\n        /**\n         * Update banner area\n         *\n         * @returns void\n         */\n        updateBanner: function () {\n            if (this.adminUserId !== undefined) {\n                this.isVisible(this.adminUserId);\n            }\n\n            if (this.fullname !== undefined && this.websiteName !== undefined) {\n                this.notificationText($.mage.__('You are connected as <strong>%1</strong> on %2')\n                    .replace('%1', _.escape(this.fullname))\n                    .replace('%2', _.escape(this.websiteName)));\n            }\n        }\n    });\n});\n","Magento_Multishipping/js/multi-shipping-balance.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mage/dataPost',\n    'jquery-ui-modules/widget'\n], function ($, dataPost) {\n    'use strict';\n\n    $.widget('mage.multiShippingBalance', {\n        options: {\n            changeUrl: ''\n        },\n\n        /**\n         * Initialize balance checkbox events.\n         *\n         * @private\n         */\n        _create: function () {\n            this.element.on('change', $.proxy(function (event) {\n                dataPost().postData({\n                    action: this.options.changeUrl,\n                    data: {\n                        useBalance: +$(event.target).is(':checked')\n                    }\n                });\n            }, this));\n        }\n    });\n\n    return $.mage.multiShippingBalance;\n});\n","Magento_Multishipping/js/multi-shipping.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'Magento_Customer/js/customer-data',\n    'jquery-ui-modules/widget'\n], function ($, customerData) {\n    'use strict';\n\n    $.widget('mage.multiShipping', {\n        options: {\n            itemsQty: 0,\n            addNewAddressBtn: 'button[data-role=\"add-new-address\"]', // Add a new multishipping address.\n            addNewAddressFlag: '#add_new_address_flag', // Hidden input field with value 0 or 1.\n            canContinueBtn: 'button[data-role=\"can-continue\"]', // Continue (update quantity or go to shipping).\n            canContinueFlag: '#can_continue_flag' // Hidden input field with value 0 or 1.\n        },\n\n        /**\n         * Bind event handlers to click events for corresponding buttons.\n         * @private\n         */\n        _create: function () {\n            this._prepareCartData();\n            $(this.options.addNewAddressBtn).on('click', $.proxy(this._addNewAddress, this));\n            $(this.options.canContinueBtn).on('click', $.proxy(this._canContinue, this));\n        },\n\n        /**\n         * Takes cart items qty from current cart data and compare it with current items qty\n         * Reloads cart data if cart items qty is wrong\n         * @private\n         */\n        _prepareCartData: function () {\n            var cartData = customerData.get('cart');\n\n            if (cartData()['summary_count'] !== this.options.itemsQty) {\n                customerData.reload(['cart'], false);\n            }\n        },\n\n        /**\n         * Add a new address. Set the hidden input field and submit the form. Then enter a new shipping address.\n         * @private\n         */\n        _addNewAddress: function () {\n            $(this.options.addNewAddressFlag).val(1);\n            this.element.submit();\n        },\n\n        /**\n         * Can the user continue to the next step? The data-flag attribute holds either 0 (no) or 1 (yes).\n         * @private\n         * @param {Event} event - Click event on the corresponding button.\n         */\n        _canContinue: function (event) {\n            $(this.options.canContinueFlag).val(parseInt($(event.currentTarget).data('flag'), 10));\n        }\n    });\n\n    return $.mage.multiShipping;\n});\n","Magento_Multishipping/js/overview.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'jquery-ui-modules/widget',\n    'mage/translate'\n], function ($) {\n    'use strict';\n\n    $.widget('mage.orderOverview', {\n        options: {\n            opacity: 0.5, // CSS opacity for the 'Place Order' button when it's clicked and then disabled.\n            pleaseWaitLoader: 'span.please-wait', // 'Submitting order information...' Ajax loader.\n            placeOrderSubmit: 'button[type=\"submit\"]', // The 'Place Order' button.\n            agreements: '.checkout-agreements' // Container for all of the checkout agreements and terms/conditions\n        },\n\n        /**\n         * Bind a submit handler to the form.\n         * @private\n         */\n        _create: function () {\n            this.element.on('submit', $.proxy(this._showLoader, this));\n        },\n\n        /**\n         * Verify that all agreements and terms/conditions are checked. Show the Ajax loader. Disable\n         * the submit button (i.e. Place Order).\n         * @return {Boolean}\n         * @private\n         */\n        _showLoader: function () {\n            if ($(this.options.agreements).find('input[type=\"checkbox\"]:not(:checked)').length > 0) {\n                return false;\n            }\n            this.element.find(this.options.pleaseWaitLoader).show().end()\n                .find(this.options.placeOrderSubmit).prop('disabled', true).css('opacity', this.options.opacity);\n\n            return true;\n        }\n    });\n\n    return $.mage.orderOverview;\n});\n","Magento_Multishipping/js/payment.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mage/template',\n    'Magento_Ui/js/modal/alert',\n    'jquery-ui-modules/widget',\n    'mage/translate'\n], function ($, mageTemplate, alert) {\n    'use strict';\n\n    $.widget('mage.payment', {\n        options: {\n            continueSelector: '#payment-continue',\n            methodsContainer: '#payment-methods',\n            minBalance: 0,\n            tmpl: '<input id=\"hidden-free\" type=\"hidden\" name=\"payment[method]\" value=\"free\">'\n        },\n\n        /** @inheritdoc */\n        _create: function () {\n            this.element.find('dd [name^=\"payment[\"]').prop('disabled', true).end()\n                .on('click', this.options.continueSelector, $.proxy(this._submitHandler, this))\n                .on('updateCheckoutPrice', $.proxy(function (event, data) {\n                    //updating the checkoutPrice\n                    if (data.price) {\n                        this.options.checkoutPrice += data.price;\n                    }\n\n                    //updating total price\n                    if (data.totalPrice) {\n                        data.totalPrice = this.options.checkoutPrice;\n                    }\n\n                    if (this.options.checkoutPrice <= this.options.minBalance) {\n                        // Add free input field, hide and disable unchecked\n                        // checkbox payment method and all radio button payment methods\n                        this._disablePaymentMethods();\n                    } else {\n                        // Remove free input field, show all payment method\n                        this._enablePaymentMethods();\n                    }\n                }, this))\n                .on('click', 'dt input:radio', $.proxy(this._paymentMethodHandler, this));\n\n            if (this.options.checkoutPrice < this.options.minBalance) {\n                this._disablePaymentMethods();\n            } else {\n                this._enablePaymentMethods();\n            }\n        },\n\n        /**\n         * Display payment details when payment method radio button is checked\n         * @private\n         * @param {EventObject} e\n         */\n        _paymentMethodHandler: function (e) {\n            var element = $(e.target),\n                parentsDl = element.closest('dl');\n\n            parentsDl.find('dt input:radio').prop('checked', false);\n            parentsDl.find('dd').addClass('no-display').end()\n                .find('.items').hide()\n                .find('[name^=\"payment[\"]').prop('disabled', true);\n            element.prop('checked', true).parent()\n                .next('dd').removeClass('no-display')\n                .find('.items').show().find('[name^=\"payment[\"]').prop('disabled', false);\n        },\n\n        /**\n         * make sure one payment method is selected\n         * @private\n         * @return {Boolean}\n         */\n        _validatePaymentMethod: function () {\n            var methods = this.element.find('[name^=\"payment[\"]'),\n                isValid = false;\n\n            if (methods.length === 0) {\n                alert({\n                    content: $.mage.__('We can\\'t complete your order because you don\\'t have a payment method set up.')\n                });\n            } else if (this.options.checkoutPrice <= this.options.minBalance) {\n                isValid = true;\n            } else if (methods.filter('input:radio:checked').length) {\n                isValid = true;\n            } else {\n                alert({\n                    content: $.mage.__('Please choose a payment method.')\n                });\n            }\n\n            return isValid;\n        },\n\n        /**\n         * Disable and enable payment methods\n         * @private\n         */\n        _disablePaymentMethods: function () {\n            var tmpl = mageTemplate(this.options.tmpl, {\n                data: {}\n            });\n\n            this.element.find('input[name=\"payment[method]\"]').prop('disabled', true).end()\n                .find('input[id^=\"use\"][name^=\"payment[use\"]:not(:checked)').prop('disabled', true).parent().hide();\n            this.element.find('[name=\"payment[method]\"][value=\"free\"]').parent('dt').remove();\n            this.element.find(this.options.methodsContainer).hide().find('[name^=\"payment[\"]').prop('disabled', true);\n\n            $(tmpl).appendTo(this.element);\n        },\n\n        /**\n         * Enable and enable payment methods\n         * @private\n         */\n        _enablePaymentMethods: function () {\n            this.element.find('input[name=\"payment[method]\"]').prop('disabled', false).end()\n                .find('dt input:radio:checked').trigger('click').end()\n                .find('input[id^=\"use\"][name^=\"payment[use\"]:not(:checked)').prop('disabled', false).parent().show();\n            this.element.find(this.options.methodsContainer).show();\n        },\n\n        /**\n         * Returns checked payment method.\n         *\n         * @private\n         */\n        _getSelectedPaymentMethod: function () {\n            return this.element.find('input[name=\\'payment[method]\\']:checked');\n        },\n\n        /**\n         * Validate  before form submit\n         * @private\n         * @param {EventObject} e\n         */\n        _submitHandler: function (e) {\n            var currentMethod,\n                submitButton;\n\n            e.preventDefault();\n\n            if (this._validatePaymentMethod()) {\n                currentMethod = this._getSelectedPaymentMethod();\n                submitButton = currentMethod.parent().next('dd').find('button[type=submit]');\n\n                if (submitButton.length) {\n                    submitButton.first().trigger('click');\n                } else {\n                    this.element.trigger('submit');\n                }\n            }\n        }\n    });\n\n    return $.mage.payment;\n});\n","Magento_ReCaptchaWebapiUi/js/webapiReCaptchaRegistry.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([], function () {\n    'use strict';\n\n    return {\n        /**\n         * recaptchaId: token map.\n         *\n         * Tokens for already verified recaptcha.\n         */\n        tokens: {},\n\n        /**\n         * recaptchaId: triggerFn map.\n         *\n         * Call a trigger to initiate a recaptcha verification.\n         */\n        triggers: {},\n\n        /**\n         * recaptchaId: callback map\n         */\n        _listeners: {},\n\n        /**\n         * recaptchaId: bool map\n         */\n        _isInvisibleType: {},\n\n        /**\n         * Add a listener to when the ReCaptcha finishes verification\n         * @param {String} id - ReCaptchaId\n         * @param {Function} func - Will be called back with the token\n         */\n        addListener: function (id, func) {\n            if (this.tokens.hasOwnProperty(id)) {\n                func(this.tokens[id]);\n            } else {\n                this._listeners[id] = func;\n            }\n        },\n\n        /**\n         * Remove a listener\n         *\n         * @param id\n         */\n        removeListener: function (id) {\n            this._listeners[id] = undefined;\n        }\n    };\n});\n","Magento_ReCaptchaWebapiUi/js/webapiReCaptcha.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n// jscs:disable jsDoc\n\n/* global grecaptcha */\ndefine(\n    [\n        'Magento_ReCaptchaFrontendUi/js/reCaptcha',\n        'Magento_ReCaptchaWebapiUi/js/webapiReCaptchaRegistry'\n    ],\n    function (Component, registry) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                autoTrigger: false\n            },\n\n            /**\n             * Provide the token to the registry.\n             *\n             * @param {String} token\n             */\n            reCaptchaCallback: function (token) {\n                //Make the token retrievable in other UI components.\n                registry.tokens[this.getReCaptchaId()] = token;\n\n                if (typeof registry._listeners[this.getReCaptchaId()] !== 'undefined') {\n                    registry._listeners[this.getReCaptchaId()](token);\n                }\n            },\n\n            /**\n             * Register this ReCaptcha.\n             *\n             * @param {Object} parentForm\n             * @param {String} widgetId\n             */\n            initParentForm: function (parentForm, widgetId) {\n                var self = this,\n                    trigger;\n\n                trigger = function () {\n                    self.reCaptchaCallback(grecaptcha.getResponse(widgetId));\n                };\n                registry._isInvisibleType[this.getReCaptchaId()] = false;\n\n                if (this.getIsInvisibleRecaptcha()) {\n                    trigger = function () {\n                        grecaptcha.execute(widgetId);\n                    };\n                    registry._isInvisibleType[this.getReCaptchaId()] = true;\n                }\n\n                if (this.autoTrigger) {\n                    //Validate ReCaptcha when initiated\n                    trigger();\n                    registry.triggers[this.getReCaptchaId()] = new Function();\n                } else {\n                    registry.triggers[this.getReCaptchaId()] = trigger;\n                }\n                this.tokenField = null;\n            }\n        });\n    }\n);\n","Magento_ReCaptchaWebapiUi/js/jquery-mixin.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n// jscs:disable requireDotNotation\n\ndefine([\n    'mage/utils/wrapper'\n], function (wrapper) {\n    'use strict';\n\n    return function (jQuery) {\n        jQuery.ajax = wrapper.wrapSuper(jQuery.ajax, function () {\n            //Moving ReCaptcha value from payload to the header for requests to web API\n            var settings,\n                payload;\n\n            if (arguments.length !== 0) {\n                settings = arguments.length === 1 ? arguments[0] : arguments[1];\n            }\n\n            if (settings && settings.hasOwnProperty('data')) {\n                //The request has a body, trying to parse JSON data\n                try {\n                    payload = JSON.parse(settings.data);\n                } catch (e) {\n                    //Not JSON\n                }\n            }\n\n            if (payload && payload.hasOwnProperty('xReCaptchaValue')) {\n                if (!settings.hasOwnProperty('headers')) {\n                    settings.headers = {};\n                }\n                settings.headers['X-ReCaptcha'] = payload.xReCaptchaValue;\n                delete payload['xReCaptchaValue'];\n                settings.data = JSON.stringify(payload);\n            }\n\n            return this._super.apply(this, arguments);\n        });\n\n        return jQuery;\n    };\n});\n","Magento_Review/js/submit-review.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery'\n], function ($) {\n    'use strict';\n\n    return function (config, element) {\n        $(element).on('submit', function () {\n            if ($(this).valid()) {\n                $(this).find('.submit').attr('disabled', true);\n            }\n        });\n    };\n});\n","Magento_Review/js/error-placement.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mage/mage'\n], function ($) {\n    'use strict';\n\n    return function (config, element) {\n        $(element).mage('validation', {\n            /** @inheritdoc */\n            errorPlacement: function (error, el) {\n\n                if (el.parents('#product-review-table').length) {\n                    $('#product-review-table').siblings(this.errorElement + '.' + this.errorClass).remove();\n                    $('#product-review-table').after(error);\n                } else {\n                    el.after(error);\n                }\n            }\n        });\n    };\n});\n","Magento_Review/js/process-reviews.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'tabs',\n    'collapsible'\n], function ($) {\n    'use strict';\n\n    /**\n     * @param {String} url\n     * @param {*} fromPages\n     */\n    function processReviews(url, fromPages) {\n        $.ajax({\n            url: url,\n            cache: true,\n            dataType: 'html',\n            showLoader: false,\n            loaderContext: $('.product.data.items')\n        }).done(function (data) {\n            $('#product-review-container').html(data).trigger('contentUpdated');\n            $('[data-role=\"product-review\"] .pages a').each(function (index, element) {\n                $(element).on('click', function (event) { //eslint-disable-line max-nested-callbacks\n                    processReviews($(element).attr('href'), true);\n                    event.preventDefault();\n                });\n            });\n        }).always(function () {\n            if (fromPages == true) { //eslint-disable-line eqeqeq\n                $('html, body').animate({\n                    scrollTop: $('#reviews').offset().top - 50\n                }, 300);\n            }\n        });\n    }\n\n    return function (config) {\n        var reviewTab = $(config.reviewsTabSelector),\n            requiredReviewTabRole = 'tab';\n\n        if (reviewTab.attr('role') === requiredReviewTabRole && reviewTab.hasClass('active')) {\n            processReviews(config.productReviewUrl, location.hash === '#reviews');\n        } else {\n            reviewTab.one('beforeOpen', function () {\n                processReviews(config.productReviewUrl);\n            });\n        }\n\n        $(function () {\n            $('.product-info-main .reviews-actions a').on('click', function (event) {\n                var anchor, addReviewBlock;\n\n                event.preventDefault();\n                anchor = $(this).attr('href').replace(/^.*?(#|$)/, '');\n                addReviewBlock = $('#' + anchor);\n\n                if (addReviewBlock.length) {\n                    $('.product.data.items [data-role=\"content\"]').each(function (index) { //eslint-disable-line\n                        if (this.id == 'reviews') { //eslint-disable-line eqeqeq\n                            $('.product.data.items').tabs('activate', index);\n                        }\n                    });\n                    $('html, body').animate({\n                        scrollTop: addReviewBlock.offset().top - 50\n                    }, 300);\n                }\n\n            });\n        });\n    };\n});\n","Magento_Review/js/validate-review.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'jquery/validate',\n    'mage/translate'\n], function ($) {\n    'use strict';\n\n    $.validator.addMethod(\n        'rating-required', function (value) {\n            return value !== undefined;\n        }, $.mage.__('Please select one of each of the ratings above.'));\n});\n","Magento_Review/js/view/review.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'uiComponent',\n    'Magento_Customer/js/customer-data',\n    'Magento_Customer/js/view/customer'\n], function (Component, customerData) {\n    'use strict';\n\n    return Component.extend({\n        /** @inheritdoc */\n        initialize: function () {\n            this._super();\n\n            this.review = customerData.get('review').extend({\n                disposableCustomerData: 'review'\n            });\n        },\n\n        /**\n         * @return {*}\n         */\n        nickname: function () {\n            return this.review().nickname || customerData.get('customer')().firstname;\n        }\n    });\n});\n","Craftyclicks_Clicktoaddress/cc_c2a.min.js":"/*!\n * ClickToAddress by Crafty Clicks\n *\n * @author      Crafty Clicks Limited\n * @link        https://craftyclicks.co.uk\n * @copyright   Copyright (c) 2016, Crafty Clicks Limited\n * @license     Licensed under the terms of the MIT license.\n * @version     1.1.17\n */\nclickToAddress.prototype.search=function(searchText,id,sequence){\"use strict\";var that=this;if(searchText===\"\"){return}this.setProgressBar(0);var parameters={key:this.key,query:searchText,id:id,country:this.activeCountry,fingerprint:this.fingerprint,integration:this.tag,js_version:this.jsVersion,sequence:sequence,type:0};if(sequence==-1){parameters.type=2}if(typeof this.accessTokenOverride[this.activeCountry]!=\"undefined\"){parameters.key=this.accessTokenOverride[this.activeCountry]}if(this.coords!={}){parameters.coords={};parameters.coords.lat=this.coords.latitude;parameters.coords.lng=this.coords.longitude}try{var data=this.cacheRetrieve(parameters);that.setProgressBar(1);that.clear();that.hideErrors();that.searchResults=data;that.showResults();if(!that.focused){that.activeInput.focus()}that.searchStatus.lastResponseId=sequence||0;that.cacheStore(parameters,data,sequence);return}catch(err){if([\"cc/cr/01\",\"cc/cr/02\"].indexOf(err)==-1){throw err}}var url=this.baseURL+\"find\";this.apiRequest(\"find\",parameters,function(data){if(that.searchStatus.lastResponseId<=sequence){that.setProgressBar(1);that.clear();that.hideErrors();that.searchResults=data;that.showResults();if(!that.focused){that.activeInput.focus()}that.searchStatus.lastResponseId=sequence||0;that.cacheStore(parameters,data,sequence)}})};clickToAddress.prototype.getAddressDetails=function(id){\"use strict\";var that=this;var parameters={id:id,country:this.activeCountry,key:this.key,fingerprint:this.fingerprint,js_version:this.jsVersion,integration:this.tag,type:1};if(typeof this.accessTokenOverride[this.activeCountry]!=\"undefined\"){parameters.key=this.accessTokenOverride[this.activeCountry]}if(this.coords!={}){parameters.coords=this.coords}try{var data=this.cacheRetrieve(parameters);that.fillData(data.result);that.hideErrors();that.cleanHistory();that.cacheStore(parameters,data);return}catch(err){if([\"cc/cr/01\",\"cc/cr/02\"].indexOf(err)==-1){throw err}}var url=this.baseURL+\"retrieve\";this.apiRequest(\"retrieve\",parameters,function(data){try{that.fillData(data.result);that.hideErrors();that.cleanHistory();that.cacheStore(parameters,data)}catch(e){that.error(\"JS503\",e)}})};clickToAddress.prototype.getAvailableCountries=function(success_function){\"use strict\";var that=this;var parameters={key:this.key,fingerprint:this.fingerprint,js_version:this.jsVersion,integration:this.tag,language:this.countryLanguage};this.apiRequest(\"countries\",parameters,function(data){try{that.serviceReady=1;that.validCountries=data.countries;that.ipLocation=data.ip_location;that.hideErrors();try{success_function()}catch(e){that.error(\"JS515\",e)}}catch(e){that.error(\"JS505\",e)}})};clickToAddress.prototype.handleApiError=function(ajax){\"use strict\";if([401,402].indexOf(ajax.status)!=-1){this.serviceReady=-1;this.error(\"API401\");return}var data={};try{data=JSON.parse(ajax.responseText)}catch(e){data={}}if(typeof data.error!=\"undefined\"&&typeof data.error.status==\"string\"){this.error(\"API500\",\"API error: [\"+data.error.status+\"]\"+data.error.message)}else{this.error(\"API500\")}};clickToAddress.prototype.apiRequest=function(action,parameters,callback){var url=this.baseURL+action;var keys=Object.keys(this.customParameters);for(var i=0;i<keys.length;i++){parameters[keys[i]]=this.customParameters[keys[i]]}var request=new XMLHttpRequest;request.open(\"POST\",url,true);request.setRequestHeader(\"Content-Type\",\"application/json\");request.setRequestHeader(\"Accept\",\"application/json\");var that=this;request.onreadystatechange=function(){if(this.readyState===4){if(this.status==401){return}if(this.status>=200&&this.status<400){try{var data=JSON.parse(this.responseText);callback(data)}catch(e){that.error(\"JS506\",e)}}else{that.handleApiError(this)}}};request.send(JSON.stringify(parameters));var xmlHttpTimeout=setTimeout(function(){if(request!==null&&request.readyState!==4){request.abort();that.error(\"JS501\")}},1e4);request=null};clickToAddress.prototype.cacheRetrieve=function(search){\"use strict\";if(search.type==0||search.type==2){if(typeof this.cache.finds[search.country]==\"undefined\"){throw\"cc/cr/01\"}for(var i=0;i<this.cache.finds[search.country].length;i++){if(this.cache.finds[search.country][i].query==search.query&&this.cache.finds[search.country][i].id==search.id){return this.cache.finds[search.country][i].response}}throw\"cc/cr/02\"}if(search.type==1){if(typeof this.cache.retrieves[search.country]==\"undefined\"){throw\"cc/cr/01\"}for(var i=0;i<this.cache.retrieves[search.country].length;i++){if(this.cache.retrieves[search.country][i].id==search.id){return this.cache.retrieves[search.country][i].response}}throw\"cc/cr/02\"}throw\"cc/cr/03\"};clickToAddress.prototype.cacheStore=function(search,obj,sequence){\"use strict\";var sequence=sequence||0;if(search.type===0){if(typeof this.cache.finds[search.country]==\"undefined\"){this.cache.finds[search.country]=[]}var splice_pos=Math.abs(this.tools.binaryIndexOf(this.cache.finds[search.country],sequence));this.cache.finds[search.country].splice(splice_pos,0,{query:search.query,id:search.id,response:obj,sequence:sequence});if(this.cache.finds[search.country].length>100){this.cache.finds[search.country].shift()}this.setHistoryStep();return}if(search.type==1){if(typeof this.cache.retrieves[search.country]==\"undefined\"){this.cache.retrieves[search.country]=[]}for(var i=0;i<this.cache.retrieves[search.country].length;i++){if(this.cache.retrieves[search.country][i].id==search.id){return}}this.cache.retrieves[search.country].push({id:search.id,response:obj});return}if(search.type==2){return}};clickToAddress.prototype.history=function(dir){\"use strict\";if(!this.historyTools)return;if(this.cachePos<=-1){this.cachePos=0}var searchParams={};var cacheLength=Object.keys(this.cache.finds[this.activeCountry]).length-1;if(dir===0){this.cachePos++;searchParams=this.cache.finds[this.activeCountry][cacheLength-this.cachePos]}else{this.cachePos--;searchParams=this.cache.finds[this.activeCountry][cacheLength-this.cachePos]}this.setHistoryStep();this.activeInput.value=searchParams.query;this.search(searchParams.query,searchParams.id,-1)};clickToAddress.prototype.setHistoryActions=function(){\"use strict\";if(!this.historyTools)return;var that=this;var backBtn=this.searchObj.getElementsByClassName(\"cc-back\")[0];var forwardBtn=this.searchObj.getElementsByClassName(\"cc-forward\")[0];this.tools.ccEvent(backBtn,\"click\",function(){if(backBtn.className==\"cc-back\"){that.history(0)}});this.tools.ccEvent(forwardBtn,\"click\",function(){if(forwardBtn.className==\"cc-forward\"){that.history(1)}})};clickToAddress.prototype.setHistoryStep=function(){\"use strict\";if(!this.historyTools)return;var backBtn=this.searchObj.getElementsByClassName(\"cc-back\")[0];var forwardBtn=this.searchObj.getElementsByClassName(\"cc-forward\")[0];backBtn.className=\"cc-back\";forwardBtn.className=\"cc-forward\";var logo_visible=0;if(typeof this.cache.finds[this.activeCountry]==\"undefined\"||this.cachePos>=Object.keys(this.cache.finds[this.activeCountry]).length-1||Object.keys(this.cache.finds[this.activeCountry]).length<=1){backBtn.className=\"cc-back cc-disabled\";logo_visible++}if(typeof this.cache.finds[this.activeCountry]==\"undefined\"||this.cachePos<=0||Object.keys(this.cache.finds[this.activeCountry]).length<=1){forwardBtn.className=\"cc-forward cc-disabled\";logo_visible++}var logo=this.searchObj.getElementsByClassName(\"c2a_logo\");if(logo.length){if(logo_visible==2){this.tools.removeClass(logo[0],\"hidden\");this.tools.removeClass(logo[0],\"tools_in_use\")}else{this.tools.addClass(logo[0],\"hidden\");this.tools.addClass(logo[0],\"tools_in_use\")}}};clickToAddress.prototype.hideHistory=function(){\"use strict\";if(!this.historyTools)return;var backBtn=this.searchObj.getElementsByClassName(\"cc-back\")[0];var forwardBtn=this.searchObj.getElementsByClassName(\"cc-forward\")[0];backBtn.className=\"cc-back cc-disabled\";forwardBtn.className=\"cc-forward cc-disabled\"};clickToAddress.prototype.cleanHistory=function(){\"use strict\";if(this.cachePos<=0||typeof this.cache.finds[this.activeCountry]==\"undefined\"){return}var removeAt=Object.keys(this.cache.finds[this.activeCountry]).length-this.cachePos;this.cache.finds[this.activeCountry].splice(removeAt,this.cachePos);this.cachePos=-1;var keys_length=Object.keys(this.cache.finds[this.activeCountry]).length;if(keys_length>0){this.activeId=this.cache.finds[this.activeCountry][keys_length-1].id}else{this.activeId=\"\"}this.setHistoryStep()};clickToAddress.prototype.error=function(code,message){\"use strict\";var errors={JS500:{default_message:\"Unknown Server Error\",level:0},JS501:{default_message:\"API server seems unreachable\",level:0},JS502:{default_message:\"API search request resulted in a JS error.\",level:0},JS503:{default_message:\"API address retrieve request resulted in a JS error.\",level:0},JS504:{default_message:\"onResultSelected callback function resulted in a JS error.\",level:0},JS505:{default_message:\"API countrylist retrieve request resulted in a JS error.\",level:0},JS515:{default_message:\"Country list retrieve callback function resulted in an error.\",level:0},JS506:{default_message:\"JSON parsing error\",level:0},JS401:{default_message:'Invalid value for countryMatchWith. Fallback to \"text\"',level:0},API401:{default_message:\"Please review your account; access token restricted from accessing the service.\",level:1},API500:{default_message:\"API error occured\",level:1}};console.warn(\"CraftyClicks Debug Error Message\");var c=\"[\"+code+\"]\";if(typeof message==\"undefined\"||!this.debug){if(typeof errors[code]!==\"undefined\"){console.warn(c+errors[code].default_message)}else{console.warn(c)}}else{if(typeof message.stack!=\"undefined\"){console.warn(c+message.stack)}else{console.warn(c+message)}}if(errors[code].level==1){this.info(\"error\")}if(typeof this.onError==\"function\"){this.onError(code,message)}};clickToAddress.prototype.hideErrors=function(){\"use strict\";if(this.serviceReady!=-1){this.errorObj.innerHTML=\"\";this.errorObj.className=\"c2a_error c2a_error_hidden\"}};clickToAddress.prototype.start_debug=function(){\"use strict\";var that=this;var css=document.createElement(\"style\");css.type=\"text/css\";var styles=\"#cc_c2a_debug { \"+[\"position: fixed;\",\"right: 0px;\",\"background-color: white;\",\"top: 50px;\",\"border: 1px solid black;\",\"border-top-left-radius: 5px;\",\"border-bottom-left-radius: 5px;\",\"padding: 5px;\",\"text-align: center;\",\"border-right: none;\"].join(\" \")+\" }\";styles+=\" #cc_c2a_debug > div{\"+[\"border-radius: 5px;\",\"padding: 5px;\",\"border: 1px solid black;\",\"margin-bottom: 5px;\"].join(\" \")+\"}\";styles+=\" #cc_c2a_debug .c2a_toggle.c2a_toggle_on{ background-color: #87D37C; color: white; }\";styles+=\" #cc_c2a_debug .c2a_toggle{ cursor: pointer; }\";this.tools.__$styleInject(styles);var cc_debug=document.createElement(\"DIV\");cc_debug.id=\"cc_c2a_debug\";var html=['<div><img style=\"width: 40px;\" src=\"https://craftyclicks.co.uk/wp-content/themes/craftyclicks_wp_theme/assets/images/product/prod_gl.png\"/></div>','<div id=\"toggl_transl\" class=\"c2a_toggle\">Toggle Transl</div>'].join(\"\");cc_debug.innerHTML=html;document.body.appendChild(cc_debug);var btn1=document.getElementById(\"toggl_transl\");this.tools.ccEvent(btn1,\"click\",function(){that.transliterate=!that.transliterate;if(that.transliterate){btn1.className=\"c2a_toggle c2a_toggle_on\";that.addTransl()}else{btn1.className=\"c2a_toggle\"}})};clickToAddress.prototype.info=function(state,count){\"use strict\";var infoBar=this.searchObj.getElementsByClassName(\"infoBar\")[0];switch(state){case\"pre-trial\":infoBar.className+=\" infoActive infoTrial\";infoBar.innerHTML='<h5>Access token is needed!</h5><p>To get a trial token, sign up for a <a href=\"https://account.craftyclicks.co.uk/login/signup\">free trial</a>.</p><p>Then find the placeholder accessToken xxxxx-xxxxx-xxxxx-xxxxx in your HTML and replace it with a your own token.</p>';break;case\"no-results\":infoBar.className+=\" infoActive infoWarning\";infoBar.innerHTML=this.texts.no_results;break;case\"error\":infoBar.className+=\" infoActive infoWarning\";infoBar.innerHTML=this.texts.generic_error;break;default:infoBar.className=\"infoBar\";infoBar.innerHTML=\"\";break}};clickToAddress.prototype.setFingerPrint=function(){\"use strict\";var low=1e15;var high=1e16;var value=Math.floor(Math.random()*(high-low+1)+low);this.fingerprint=value.toString(16)};clickToAddress.prototype.getFingerPrint=function(){\"use strict\";return this.fingerprint};function clickToAddress(config){\"use strict\";var that=this;if(document.getElementById(\"cc_c2a\")!==null){throw\"Already initiated\"}if(typeof that==\"undefined\"||typeof that.preset==\"undefined\"){throw'Incorrect way to initialize this code. use \"new ClickToAddress(config);\"'}that.preset(config);that.gfxModeTools=c2a_gfx_modes[\"mode\"+that.gfxMode];that.gfxModeTools.addHtml(that);that.searchObj=document.getElementById(\"cc_c2a\");that.resultList=that.searchObj.getElementsByClassName(\"c2a_results\")[0];that.errorObj=that.searchObj.getElementsByClassName(\"c2a_error\")[0];that.getAvailableCountries(function(){that.serviceReady=1;that.setCountryChange();var isValidCountry=function(country,validCountries){for(var i=0;i<validCountries.length;i++){if(validCountries[i].code==country){return true}}return false};var country=null;if(that.validCountries.length){country=that.validCountries[0].code;if(isValidCountry(that.defaultCountry,that.validCountries)){country=that.defaultCountry}if(that.getIpLocation&&that.ipLocation!==\"\"&&isValidCountry(that.ipLocation,that.validCountries)){country=that.ipLocation}}else{throw\"Incorrect country configuration.\"}that.selectCountry(country)});if(that.searchObj.getElementsByClassName(\"cc-history\").length){that.setHistoryActions()}this.tools.ccEvent(that.searchObj,\"mouseover\",function(){that.hover=true});this.tools.ccEvent(that.searchObj,\"mouseout\",function(){that.hover=false});this.tools.ccEvent(document,\"click\",function(){that.hide()});this.tools.ccEvent(window,\"scroll\",function(){if(that.visible&&that.focused){setTimeout(function(){that.gfxModeTools.reposition(that,that.activeInput)},100)}});this.tools.ccEvent(window,\"resize\",function(){if(that.visible){setTimeout(function(){that.gfxModeTools.reposition(that,that.activeInput)},100)}});this.tools.ccEvent(that.resultList,\"scroll\",function(){var scrollTop=parseInt(this.scrollTop);var innerHeight=parseInt(window.getComputedStyle(this,null).getPropertyValue(\"height\"));if(that.searchStatus.inCountryMode!=1&&parseInt(this.scrollHeight)!==0&&scrollTop+innerHeight>=parseInt(this.scrollHeight)*.8){that.showResultsExtra()}});that.getStyleSheet();that.tools.__$styleInject(\"#cc_c2a ul.c2a_results li.cc-hidden{ display: none; }\");if(that.transliterate){that.addTransl()}if(that.debug){that.start_debug()}if(that.key==\"xxxxx-xxxxx-xxxxx-xxxxx\"){that.info(\"pre-trial\")}if(typeof config.dom!=\"undefined\"){that.attach(config.dom)}}clickToAddress.prototype.fillData=function(addressDataResult){\"use strict\";var addressData=null;if(this.transliterate&&typeof this.transl===\"function\"){var resultKeys=Object.keys(addressDataResult);addressData={};for(var k=0;k<resultKeys.length;k++){addressData[resultKeys[k]]=this.transl(addressDataResult[resultKeys[k]])}}else{addressData=addressDataResult}if(typeof this.activeDom.country!=\"undefined\"){var options=this.activeDom.country.getElementsByTagName(\"option\");if(options.length){var target_val=\"\";for(var i=0;i<options.length&&target_val===\"\";i++){if(options[i].innerHTML==this.validCountries[this.activeCountryId].country_name){target_val=options[i].value;break}if(options[i].value==this.activeCountry){target_val=options[i].value;break}}this.activeDom.country.value=target_val}else{this.activeDom.country.value=this.validCountries[this.activeCountryId].country_name}}if(typeof this.activeDom.line_1!=\"undefined\"){var line_3=[];if(addressData.line_1===\"\"&&addressData.company_name!==\"\"){addressData.line_1=addressData.company_name}this.activeDom.line_1.value=addressData.line_1;if(typeof this.activeDom.line_2!=\"undefined\"){this.activeDom.line_2.value=addressData.line_2}else{if(addressData.line_2!==\"\"){line_3.push(addressData.line_2)}}if(addressData.company_name!==\"\"){if(typeof this.activeDom.company!=\"undefined\"){this.activeDom.company.value=addressData.company_name;this.lastSearchCompanyValue=addressData.company_name}else{this.activeDom.line_1.value=addressData.company_name+\", \"+this.activeDom.line_1.value}}else{if(typeof this.activeDom.company!=\"undefined\"){if(this.lastSearchCompanyValue!==\"\"&&this.activeDom.company.value==this.lastSearchCompanyValue){this.activeDom.company.value=\"\"}this.lastSearchCompanyValue=\"\"}}if(typeof this.activeDom.postcode!=\"undefined\"){this.activeDom.postcode.value=addressData.postal_code}else{line_3.push(addressData.postal_code)}if(typeof this.activeDom.town!=\"undefined\"){if(addressData.locality!==\"\"){this.activeDom.town.value=addressData.locality}else{this.activeDom.town.value=addressData.dependent_locality}}else{if(addressData.locality!==\"\"){line_3.push(addressData.locality)}else{line_3.push(addressData.dependent_locality)}}if(addressData.province_code!==\"\"||addressData.province_name!==\"\"){var province_set={preferred:addressData.province,code:addressData.province_code,name:addressData.province_name};if(typeof this.getCfg(\"onSetCounty\")==\"function\"){this.getCfg(\"onSetCounty\")(this,this.activeDom,province_set)}else if(typeof this.activeDom.county!=\"undefined\"){this.setCounty(this.activeDom.county,province_set)}}if(line_3.length){if(typeof this.activeDom.line_2!=\"undefined\"){this.activeDom.line_2.value+=\", \"+line_3.join(\", \")}else{this.activeDom.line_1.value+=\", \"+line_3.join(\", \")}}}if(typeof this.getCfg(\"onResultSelected\")==\"function\"){try{addressData.country=this.validCountries[this.activeCountryId];this.getCfg(\"onResultSelected\")(this,this.activeDom,addressData)}catch(e){this.error(\"JS504\")}}this.hide(true)};clickToAddress.prototype.setCounty=function(element,province){\"use strict\";if(element.tagName==\"SELECT\"){var target_val=province.code;if(target_val===\"\"){target_val=province.name}var options=element.getElementsByTagName(\"option\");if(options.length){var found=0;var province_name=this.tools.removeDiacritics(province.name);var province_code=this.tools.removeDiacritics(province.code);for(var i=0;i<options.length;i++){var option_content=this.tools.removeDiacritics(options[i].innerHTML);var option_value=this.tools.removeDiacritics(options[i].value);if(option_content!==\"\"&&(option_content==province_name||option_content==province_code)||option_value!==\"\"&&(option_value==province_name||option_value==province_code)){target_val=options[i].value;found++;break}}if(!found){var province_text=province.name;if(province_text===\"\"){province_text=province.code}var provinceMatchText=this.tools.removeDiacritics(province_text);var matches={rank:0,ids:[]};for(var i=0;i<options.length;i++){var option_text=this.tools.removeDiacritics(options[i].innerHTML);var highestRank=0;var rankTable=[];for(var j=0;j<provinceMatchText.length;j++){rankTable[j]=[];for(var k=0;k<option_text.length;k++){if(provinceMatchText[j]==option_text[k]){if(j>0&&k>0){rankTable[j][k]=rankTable[j-1][k-1]+1}else{rankTable[j][k]=1}if(rankTable[j][k]>highestRank){highestRank=rankTable[j][k]}}else{rankTable[j][k]=0}}}if(matches.rank<highestRank){matches.rank=highestRank;matches.ids=[]}if(matches.rank==highestRank){matches.ids.push(i)}}if(matches.ids.length>1){var characterDifferences=function(a,b){var aTable={};var bTable={};for(var i=0;i<a.length;i++){if(typeof aTable[a[i]]==\"undefined\")aTable[a[i]]=1;else{aTable[a[i]]++}}for(var i=0;i<b.length;i++){if(typeof bTable[b[i]]==\"undefined\")bTable[b[i]]=1;else{bTable[b[i]]++}}var totalScore=0;var aKeys=Object.keys(aTable);for(var i=0;i<aKeys.length;i++){if(typeof bTable[aKeys[i]]==\"undefined\"){totalScore+=aTable[aKeys[i]]}else{totalScore+=Math.abs(aTable[aKeys[i]]-bTable[aKeys[i]]);delete bTable[aKeys]}}var bKeys=Object.keys(bTable);for(var i=0;i<bKeys.length;i++){totalScore+=bTable[bKeys[i]]}return totalScore};var charMatch={id:0,rank:1e3};for(var i=0;i<matches.ids.length;i++){var r=characterDifferences(this.tools.removeDiacritics(options[matches.ids[i]].innerHTML),provinceMatchText);if(r<charMatch.rank){charMatch.rank=r;charMatch.id=i}}target_val=options[matches.ids[charMatch.id]].value}else{target_val=options[matches.ids[0]].value}}element.value=target_val}}else{var province_for_input=province.preferred;if(province_for_input===\"\"){province_for_input=province.name}if(province_for_input===\"\"){province_for_input=province.code}element.value=province_for_input}};clickToAddress.prototype.showResults=function(){\"use strict\";var _cs=this;_cs.scrollPosition=0;_cs.resetSelector();_cs.info(\"clear\");_cs.resultList.innerHTML=\"\";for(var i=0;i<_cs.searchResults.results.length;i++){var row=_cs.searchResults.results[i];if(typeof row.count==\"undefined\"||typeof row.id==\"undefined\"){throw\"server error\"}var labels=[];var hover_label=row.labels.join(\", \");for(var j=0;j<row.labels.length;j++){if(_cs.transliterate&&typeof _cs.transl===\"function\"){labels.push(_cs.transl(row.labels[j]))}else{labels.push(row.labels[j])}}var content=\"<div>\";if(typeof labels[0]==\"string\"&&labels[0]!==\"\")content+=\"<span>\"+labels[0]+\"</span>\";if(typeof labels[1]==\"string\"&&labels[1]!==\"\")content+='<span class=\"light\">'+labels[1]+\"</span>\";if(typeof row.count==\"number\"&&row.count>1)content+='<span class=\"light\">'+_cs.texts.more.replace(\"{{value}}\",row.count)+\"</span>\";content+=\"</div>\";var new_elem=document.createElement(\"LI\");new_elem.innerHTML=content;_cs.tools.ccData(new_elem,\"id\",row.id.toString());_cs.tools.ccData(new_elem,\"count\",row.count.toString());new_elem.setAttribute(\"title\",hover_label);if(row.count!=1){_cs.tools.addClass(new_elem,\"cc-filter\")}if(i>=_cs.scrollLimit){_cs.tools.addClass(new_elem,\"cc-hidden\")}_cs.resultList.appendChild(new_elem)}_cs.resultList.scrollTop=0;var listElements=_cs.resultList.getElementsByTagName(\"li\");for(var i=0;i<listElements.length;i++){_cs.tools.ccEvent(listElements[i],\"click\",function(){_cs.select(this)})}if(_cs.searchResults.results.length===0){_cs.info(\"no-results\");_cs.hasContent=false}else{_cs.hasContent=true}};clickToAddress.prototype.showResultsExtra=function(){\"use strict\";var _cs=this;var listElements=_cs.resultList.querySelectorAll(\".cc-hidden\");for(var i=0;i<_cs.scrollLimit&&i<listElements.length;i++){_cs.tools.removeClass(listElements[i],\"cc-hidden\")}};clickToAddress.prototype.select=function(li){\"use strict\";this.resetSelector();this.cleanHistory();li.id=this.tools.ccData(li,\"id\");li.count=this.tools.ccData(li,\"count\");if(li.count===\"1\"){this.getAddressDetails(li.id);this.loseFocus();return}if(li.count!==\"1\"){this.sequence++;this.searchStatus.lastSearchId=this.sequence;var current_sequence=this.sequence;this.search(this.activeInput.value,li.id,current_sequence);this.getFocus();this.activeId=li.id;return}if(li.className!=\"deadend\"){this.sequence++;this.searchStatus.lastSearchId=this.sequence;this.search(this.activeInput.value);this.getFocus();return}};clickToAddress.prototype.getGeo=function(){\"use strict\";var that=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){that.coords=position.coords;that.showGeo()})}};clickToAddress.prototype.changeCountry=function(filter){\"use strict\";this.hideHistory();this.resetSelector();var newHtml=\"\";var limit=this.validCountries.length;for(var i=0;i<limit;i++){newHtml+=\"<li></li>\"}this.resultList.innerHTML=newHtml;var listElements=this.resultList.getElementsByTagName(\"li\");this.resultList.scrollTop=0;var that=this;var skip=0;for(var i=0;i<listElements.length;i++){var row=this.validCountries[i+skip];var content=\"\";if(typeof filter!==\"undefined\"&&filter!==\"\"){var matchFound=false;for(var j=0;!matchFound&&j<Object.keys(row).length;j++){var rowElem=row[Object.keys(row)[j]];if(typeof rowElem==\"object\"&&Array.isArray(rowElem)){for(var k=0;!matchFound&&k<rowElem.length;k++){var text=rowElem[k].toString().toLowerCase();if(text.indexOf(filter.toLowerCase())===0){matchFound=true}}}else{var text=rowElem.toString().toLowerCase();if(text.indexOf(filter.toLowerCase())===0){matchFound=true}}}if(matchFound){content='<span class=\"cc-flag cc-flag-'+row.short_code+'\"></span>'+\"<span>\"+row.country_name+\"</span>\"}else{listElements[i].parentNode.removeChild(listElements[i]);i--;skip++}}else{var content='<span class=\"cc-flag cc-flag-'+row.short_code+'\"></span>'+\"<span>\"+row.country_name+\"</span>\"}if(content!=\"\"){listElements[i].innerHTML=content;listElements[i].setAttribute(\"countryCode\",row.code);that.hasContent=true;this.tools.ccEvent(listElements[i],\"click\",function(){that.selectCountry(this.getAttribute(\"countryCode\"))})}}this.searchStatus.inCountryMode=1;this.getFocus()};clickToAddress.prototype.selectCountry=function(countryCode,skipSearch){\"use strict\";var skipSearch=skipSearch||false;var that=this;this.clear();var selectedCountry={};this.activeCountryId=0;for(var i=0;i<this.validCountries.length;i++){if(this.validCountries[i].code==countryCode){this.activeCountryId=i;break}}selectedCountry=this.validCountries[this.activeCountryId];if(this.countrySelectorOption!==\"hidden\"){var countryObj=this.searchObj.getElementsByClassName(\"country_img\")[0];countryObj.setAttribute(\"class\",\"country_img cc-flag cc-flag-\"+selectedCountry.short_code);if(this.countrySelectorOption==\"disabled\"){this.searchObj.getElementsByClassName(\"country_btn\")[0].getElementsByTagName(\"span\")[0].innerHTML=selectedCountry.country_name}}this.activeCountry=countryCode;that.searchStatus.inCountryMode=0;this.getFocus();if(!skipSearch&&typeof this.activeInput.value!=\"undefined\"&&typeof this.lastSearch!=\"\"){this.activeInput.value=this.lastSearch;this.activeId=\"\";this.sequence++;this.searchStatus.lastSearchId=this.sequence;var current_sequence=this.sequence;setTimeout(function(){if(that.searchStatus.lastSearchId<=current_sequence){if(that.activeInput.value!==\"\"){that.search(that.activeInput.value,that.activeId,current_sequence);that.cleanHistory()}else{that.clear()}}},200);this.gfxModeTools.reposition(this,this.activeInput)}this.setHistoryStep();this.setPlaceholder(0)};clickToAddress.prototype.setCountryChange=function(){\"use strict\";var finalValidCountries=[];if(this.enabledCountries.length!==0){for(var iEC=0;iEC<this.enabledCountries.length;iEC++){var enabledCountryTestString=this.enabledCountries[iEC];var exactMatch=null;var partialMatch=[];for(var iVC=0;iVC<this.validCountries.length;iVC++){if(finalValidCountries.indexOf(iVC)!==-1){continue}var row=this.validCountries[iVC];switch(this.countryMatchWith){case\"iso_3\":if(enabledCountryTestString==row.iso_3166_1_alpha_3){exactMatch=iVC}break;case\"iso_2\":if(enabledCountryTestString==row.iso_3166_1_alpha_2){exactMatch=iVC}break;case\"code\":var testArray=[row.code.toUpperCase(),row.short_code.toUpperCase()];if(testArray.indexOf(enabledCountryTestString)!==-1){exactMatch=iVC}break;default:this.error(\"JS401\");case\"text\":for(var j=0;!exactMatch&&j<Object.keys(row).length;j++){var rowElem=row[Object.keys(row)[j]];if(typeof rowElem==\"string\"||typeof rowElem==\"number\"){var text=rowElem.toString().toUpperCase();if(text.indexOf(enabledCountryTestString)===0){if(text==enabledCountryTestString){exactMatch=iVC}else if(partialMatch.indexOf(iVC)==-1){partialMatch.push(iVC)}}}else{for(var l=0;l<rowElem.length;l++){var text=rowElem[l].toString().toUpperCase();if(text.indexOf(enabledCountryTestString)===0){if(text==enabledCountryTestString){exactMatch=iVC}else if(partialMatch.indexOf(iVC)==-1){partialMatch.push(iVC)}}}}}break}}if(exactMatch!==null){finalValidCountries.push(exactMatch)}else if(partialMatch.length>0){for(var iPM=0;iPM<partialMatch.length;iPM++){finalValidCountries.push(partialMatch[iPM])}}exactMatch=null;partialMatch=[]}var offset=0;for(var iVC=0;iVC<this.validCountries.length;iVC++){if(finalValidCountries.indexOf(iVC+offset)==-1){this.validCountries.splice(iVC,1);offset++;iVC--}}}if(this.validCountries.length===0){throw\"No valid countries left in the country list!\"}if(this.countrySelectorOption==\"enabled\"){var countryObj=this.searchObj.getElementsByClassName(\"country_btn\")[0];var that=this;this.tools.ccEvent(countryObj,\"click\",function(){if(that.searchStatus.inCountryMode===0){that.setPlaceholder(1);that.changeCountry();that.activeInput.value=\"\";that.hasContent=true;that.info()}else{that.setPlaceholder(0);that.searchStatus.inCountryMode=0;that.hide(true);that.getFocus();that.hover=true}})}};if(typeof c2a_gfx_modes==\"undefined\"){var c2a_gfx_modes={}}c2a_gfx_modes[\"mode1\"]={addHtml:function(that){var cc_dropdown=document.createElement(\"DIV\");cc_dropdown.className=\"c2a_mode\"+that.gfxMode+\" c2a_\"+that.style.ambient+\" c2a_accent_\"+that.style.accent;cc_dropdown.id=\"cc_c2a\";var historyBar='<div class=\"cc-history\"><div class=\"cc-back cc-disabled\"></div>';historyBar+='<div class=\"cc-forward cc-disabled\"></div></div>';var mainbar=\"\";if(that.countrySelectorOption!=\"hidden\"||that.historyTools){mainbar+='<div class=\"mainbar\">';if(that.countrySelectorOption!=\"hidden\"){var btnClass=\"country_btn\";if(that.countrySelectorOption==\"enabled\"){btnClass+=\" country_btn_active\"}mainbar+='<div class=\"'+btnClass+'\"><div class=\"country_img\"></div><span>'+that.texts.country_button+\"</span></div>\"}if(that.historyTools){mainbar+=historyBar}if(that.showLogo){mainbar+='<div class=\"c2a_logo\" title=\"Provided by Crafty Clicks\"></div>'}mainbar+=\"</div>\"}var progressBar='<div class=\"progressBar\"></div>';var infoBar='<div class=\"infoBar\"></div>';var footerHtml=progressBar+mainbar+infoBar;var footerClass=\"c2a_footer\",title=\"\";var html='<div class=\"c2a_error\"></div><ul class=\"c2a_results\"></ul>'+'<div class=\"'+footerClass+'\">'+footerHtml+\"</div>\";cc_dropdown.innerHTML=html;document.body.appendChild(cc_dropdown)},reposition:function(that,target){var elemRect=target.getBoundingClientRect();var doc=document.documentElement;var docTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0);var docLeft=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0);var topOffset=elemRect.top+docTop+(target.offsetHeight-1);var leftOffset=elemRect.left+docLeft+3;var htmlBox=window.getComputedStyle(document.getElementsByTagName(\"html\")[0]);topOffset+=parseInt(htmlBox.getPropertyValue(\"margin-top\"))+parseInt(htmlBox.getPropertyValue(\"padding-top\"));leftOffset+=parseInt(htmlBox.getPropertyValue(\"margin-left\"))+parseInt(htmlBox.getPropertyValue(\"padding-left\"));that.searchObj.style.left=leftOffset+\"px\";that.searchObj.style.top=topOffset+\"px\";that.searchObj.style.width=target.offsetWidth-6+\"px\";var logo=that.searchObj.getElementsByClassName(\"c2a_logo\");if(logo.length){if(elemRect.width<300){that.tools.addClass(logo[0],\"hidden\")}else{if(!that.tools.hasClass(logo[0],\"tools_in_use\")){that.tools.removeClass(logo[0],\"hidden\")}}}var activeClass=\"c2a_active\";target.cc_current_target=1;var activeElements=document.getElementsByClassName(activeClass);for(var i=0;i<activeElements.length;i++){if(typeof activeElements[i].cc_current_target==\"undefined\"){activeElements[i].className=activeElements[i].className.replace(\" \"+activeClass,\"\")}}delete target.cc_current_target;if(target.className.indexOf(activeClass)==-1){target.className+=\" \"+activeClass}}};if(typeof c2a_gfx_modes==\"undefined\"){var c2a_gfx_modes={}}c2a_gfx_modes[\"mode2\"]={addHtml:function(that){var cc_dropdown=document.createElement(\"DIV\");cc_dropdown.className=\"c2a_mode\"+that.gfxMode+\" c2a_\"+that.style.ambient+\" c2a_accent_\"+that.style.accent;cc_dropdown.id=\"cc_c2a\";var mainbar=\"\";if(that.countrySelectorOption!=\"hidden\"||that.historyTools){mainbar+='<div class=\"mainbar\">';if(that.countrySelectorOption!=\"hidden\"){var btnClass=\"country_btn\";if(that.countrySelectorOption==\"enabled\"){btnClass+=\" country_btn_active\"}mainbar+='<div class=\"'+btnClass+'\"><div class=\"country_img\"></div><span>'+that.texts.country_button+\"</span></div>\"}if(that.historyTools){mainbar+='<div class=\"cc-history\"><div class=\"cc-back disabled\"></div>';mainbar+='<div class=\"cc-forward disabled\"></div></div>'}if(that.showLogo){mainbar+='<div class=\"c2a_logo\" title=\"Provided by Crafty Clicks\"></div>'}mainbar+=\"</div>\"}var progressBar='<div class=\"progressBar\"></div>';var infoBar='<div class=\"infoBar\"></div>';\nvar footerClass=\"c2a_footer\";var footerHtml=progressBar+infoBar;var html=mainbar+'<div class=\"c2a_error\"></div><ul class=\"c2a_results\"></ul>'+'<div class=\"'+footerClass+'\">'+footerHtml+\"</div>\";cc_dropdown.innerHTML=html;document.body.appendChild(cc_dropdown)},reposition:function(that,target){var elemRect=target.getBoundingClientRect();var doc=document.documentElement;var docTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0);var docLeft=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0);var mainBarHeight=0;if(that.searchObj.getElementsByClassName(\"mainbar\").length){mainBarHeight=that.searchObj.getElementsByClassName(\"mainbar\")[0].clientHeight}var topOffset=elemRect.top+docTop-(mainBarHeight+6);var leftOffset=elemRect.left+docLeft;var htmlBox=window.getComputedStyle(document.getElementsByTagName(\"html\")[0]);topOffset+=parseInt(htmlBox.getPropertyValue(\"margin-top\"))+parseInt(htmlBox.getPropertyValue(\"padding-top\"));leftOffset+=parseInt(htmlBox.getPropertyValue(\"margin-left\"))+parseInt(htmlBox.getPropertyValue(\"padding-left\"));that.searchObj.style.left=leftOffset-5+\"px\";that.searchObj.style.top=topOffset+\"px\";that.searchObj.style.width=target.offsetWidth+10+\"px\";if(that.searchObj.getElementsByClassName(\"c2a_results\").length){that.searchObj.getElementsByClassName(\"c2a_results\")[0].style.marginTop=target.offsetHeight+6+\"px\"}var logo=that.searchObj.getElementsByClassName(\"c2a_logo\");if(logo.length){if(elemRect.width<300){that.tools.addClass(logo[0],\"hidden\")}else{if(!that.tools.hasClass(logo[0],\"tools_in_use\")){that.tools.removeClass(logo[0],\"hidden\")}}}var activeClass=\"c2a_active\";target.cc_current_target=1;var activeElements=document.getElementsByClassName(activeClass);for(var i=0;i<activeElements.length;i++){if(typeof activeElements[i].cc_current_target==\"undefined\"){activeElements[i].className=activeElements[i].className.replace(\" \"+activeClass,\"\")}}delete target.cc_current_target;if(target.className.indexOf(activeClass)==-1){target.className+=\" \"+activeClass}}};if(typeof c2a_gfx_modes==\"undefined\"){var c2a_gfx_modes={}}c2a_gfx_modes[\"mode3\"]={addHtml:function(that){var cc_dropdown=document.createElement(\"DIV\");cc_dropdown.className=\"c2a_mode\"+that.gfxMode+\" c2a_\"+that.style.ambient+\" c2a_accent_\"+that.style.accent;cc_dropdown.id=\"cc_c2a\";var historyBar='<div class=\"cc-history\"><div class=\"cc-back cc-disabled\"></div>';historyBar+='<div class=\"cc-forward cc-disabled\"></div></div>';var mainbar=\"\";if(that.countrySelectorOption!=\"hidden\"||that.historyTools){mainbar+='<div class=\"mainbar\">';if(that.countrySelectorOption!=\"hidden\"){var btnClass=\"country_btn\";if(that.countrySelectorOption==\"enabled\"){btnClass+=\" country_btn_active\"}mainbar+='<div class=\"'+btnClass+'\"><div class=\"country_img\"></div><span>'+that.texts.country_button+\"</span></div>\"}if(that.historyTools){mainbar+=historyBar}if(that.showLogo){mainbar+='<div class=\"c2a_logo\" title=\"Provided by Crafty Clicks\"></div>'}mainbar+=\"</div>\"}var progressBar='<div class=\"progressBar\"></div>';var infoBar='<div class=\"infoBar\"></div>';var footerHtml=progressBar+mainbar+infoBar;var footerClass=\"c2a_footer\";var html='<div class=\"c2a_error\"></div><ul class=\"c2a_results\"></ul>'+'<div class=\"'+footerClass+'\">'+footerHtml+\"</div>\";cc_dropdown.innerHTML=html;document.body.appendChild(cc_dropdown)},reposition:function(that,target){var elemRect=target.getBoundingClientRect();var doc=document.documentElement;var docTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0);var docLeft=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0);var topOffset=elemRect.top+docTop+(target.offsetHeight+3);var leftOffset=elemRect.left+docLeft;var htmlBox=window.getComputedStyle(document.getElementsByTagName(\"html\")[0]);topOffset+=parseInt(htmlBox.getPropertyValue(\"margin-top\"))+parseInt(htmlBox.getPropertyValue(\"padding-top\"));leftOffset+=parseInt(htmlBox.getPropertyValue(\"margin-left\"))+parseInt(htmlBox.getPropertyValue(\"padding-left\"));that.searchObj.style.left=leftOffset+\"px\";that.searchObj.style.top=topOffset+\"px\";that.searchObj.style.width=target.offsetWidth+\"px\";var logo=that.searchObj.getElementsByClassName(\"c2a_logo\");if(logo.length){if(elemRect.width<300){that.tools.addClass(logo[0],\"hidden\")}else{if(!that.tools.hasClass(logo[0],\"tools_in_use\")){that.tools.removeClass(logo[0],\"hidden\")}}}var activeClass=\"c2a_active\";target.cc_current_target=1;var activeElements=document.getElementsByClassName(activeClass);for(var i=0;i<activeElements.length;i++){if(typeof activeElements[i].cc_current_target==\"undefined\"){activeElements[i].className=activeElements[i].className.replace(\" \"+activeClass,\"\")}}delete target.cc_current_target;if(target.className.indexOf(activeClass)==-1){target.className+=\" \"+activeClass}}};clickToAddress.prototype.setupText=function(textCfg){\"use strict\";this.texts={default_placeholder:\"Start with post/zip code or street\",country_placeholder:\"Type here to search for a country\",country_button:\"Change Country\",generic_error:\"Service unavailable.</br>Please enter your address manually.\",no_results:\"No results found\",more:\"({{value}} more)\"};if(typeof textCfg!=\"undefined\"){var keys=Object.keys(this.texts);for(var i=0;i<keys.length;i++){if(typeof textCfg[keys[i]]!=\"undefined\"&&textCfg[keys[i]]!==\"\"){this.texts[keys[i]]=textCfg[keys[i]]}}}};clickToAddress.prototype.setCfg=function(config,name,defaultValue,cfgValue){\"use strict\";defaultValue=defaultValue||false;cfgValue=cfgValue||false;if(!cfgValue){cfgValue=name}if(typeof config[cfgValue]!=\"undefined\"&&config[cfgValue]!==\"\"){this[name]=config[cfgValue]}else{this[name]=defaultValue}};clickToAddress.prototype.getCfg=function(name){if(typeof this.activeDom.config!==\"undefined\"&&typeof this.activeDom.config[name]!==\"undefined\"){return this.activeDom.config[name]}else{return this[name]}};clickToAddress.prototype.preset=function(config){\"use strict\";this.jsVersion=\"1.1.17\";this.serviceReady=0;this.debug=false;this.activeCountry=\"\";this.hover=false;this.visible=false;this.focused=false;this.hasContent=false;this.keyboardHideInProgress=false;this.coords=0;this.activeDom={};this.domLib=[];this.searchResults={};this.searchObj={};this.selectorPos=-1;this.activeInput=\"init\";this.searchStatus={lastSearchId:0,lastResponseId:0,inCountryMode:0};this.sequence=0;this.cache={finds:{},retrieves:{}};this.cachePos=-1;this.scrollPosition=0;this.scrollLimit=20;this.activeId=\"\";this.lastSearch=\"\";this.funcStore={};this.transl=null;this.lastSearchCompanyValue=\"\";this.setCfg(config,\"gfxMode\",1);this.setCfg(config,\"baseURL\",\"https://api.craftyclicks.co.uk/address/1.1\",\"relay\");if(this.baseURL[this.baseURL.length]!=\"/\"){this.baseURL+=\"/\"}this.setCfg(config,\"key\",\"\",\"accessToken\");this.setCfg(config,\"defaultCountry\",\"gbr\");this.setCfg(config,\"enabledCountries\",[]);if(this.enabledCountries.length){for(var eci=0;eci<this.enabledCountries.length;eci++){this.enabledCountries[eci]=this.enabledCountries[eci].toUpperCase()}}this.setCfg(config,\"style\",{ambient:\"light\",accent:\"default\"});if([\"light\",\"dark\",\"custom\"].indexOf(this.style.ambient)==-1){this.style.ambient=\"light\"}if([\"default\",\"red\",\"pink\",\"purple\",\"deepPurple\",\"indigo\",\"blue\",\"lightBlue\",\"cyan\",\"teal\",\"green\",\"lightGreen\",\"lime\",\"yellow\",\"amber\",\"orange\",\"deepOrange\",\"brown\",\"grey\",\"blueGrey\",\"custom\"].indexOf(this.style.accent)==-1){this.style.accent=\"default\"}this.setCfg(config,\"domMode\",\"name\");this.setCfg(config,\"placeholders\",true);this.setCfg(config,\"onResultSelected\");this.setCfg(config,\"onCountryChange\");this.setCfg(config,\"onSearchFocus\");this.setCfg(config,\"onSetCounty\");this.setCfg(config,\"onError\");this.setCfg(config,\"historyTools\",true);if(this.enabledCountries.length===1){this.setCfg(config,\"countrySelector\",false);this.setCfg(config,\"countrySelectorOption\",\"disabled\")}else{this.setCfg(config,\"countrySelector\",true);this.setCfg(config,\"countrySelectorOption\",\"enabled\")}if(typeof config.countrySelectorOption==\"undefined\"&&typeof config.countrySelector!=\"undefined\"){if(this.countrySelector){this.countrySelectorOption=\"enabled\"}else{this.countrySelectorOption=\"disabled\"}}this.setCfg(config,\"showLogo\",true);this.setCfg(config,\"getIpLocation\",true);this.setCfg(config,\"accessTokenOverride\",{});this.setupText(config.texts);this.setCfg(config,\"countryLanguage\",\"en\");this.setCfg(config,\"countryMatchWith\",\"iso_3\");this.setCfg(config,\"tag\",\"\");this.setCfg(config,\"cssPath\",\"https://cc-cdn.com/generic/styles/v1/cc_c2a.min.css\");this.setCfg(config,\"preserveAutocompleteAttribute\",false);this.setCfg(config,\"disableAutoSearch\",false);this.setCfg(config,\"transliterate\",false);this.setCfg(config,\"debug\",false);this.setCfg(config,\"customParameters\",{});this.setFingerPrint()};clickToAddress.prototype.tools={};clickToAddress.prototype.tools.ccEvent=function(target,event_to_react,function_to_call){target.addEventListener(event_to_react,function_to_call)};clickToAddress.prototype.tools.ccData=function(target,attr,value){if(typeof target===\"undefined\"||typeof attr===\"undefined\"){return}if(typeof value!==\"undefined\"){target.setAttribute(\"data-\"+attr,JSON.stringify({data:value}));return true}else{return JSON.parse(target.getAttribute(\"data-\"+attr)).data}};clickToAddress.prototype.tools.defaultDiacriticsRemovalMap=[{base:\"A\",letters:/[\\u0041\\u24B6\\uFF21\\u00C0\\u00C1\\u00C2\\u1EA6\\u1EA4\\u1EAA\\u1EA8\\u00C3\\u0100\\u0102\\u1EB0\\u1EAE\\u1EB4\\u1EB2\\u0226\\u01E0\\u00C4\\u01DE\\u1EA2\\u00C5\\u01FA\\u01CD\\u0200\\u0202\\u1EA0\\u1EAC\\u1EB6\\u1E00\\u0104\\u023A\\u2C6F]/g},{base:\"AA\",letters:/[\\uA732]/g},{base:\"AE\",letters:/[\\u00C6\\u01FC\\u01E2]/g},{base:\"AO\",letters:/[\\uA734]/g},{base:\"AU\",letters:/[\\uA736]/g},{base:\"AV\",letters:/[\\uA738\\uA73A]/g},{base:\"AY\",letters:/[\\uA73C]/g},{base:\"B\",letters:/[\\u0042\\u24B7\\uFF22\\u1E02\\u1E04\\u1E06\\u0243\\u0182\\u0181]/g},{base:\"C\",letters:/[\\u0043\\u24B8\\uFF23\\u0106\\u0108\\u010A\\u010C\\u00C7\\u1E08\\u0187\\u023B\\uA73E]/g},{base:\"D\",letters:/[\\u0044\\u24B9\\uFF24\\u1E0A\\u010E\\u1E0C\\u1E10\\u1E12\\u1E0E\\u0110\\u018B\\u018A\\u0189\\uA779]/g},{base:\"DZ\",letters:/[\\u01F1\\u01C4]/g},{base:\"Dz\",letters:/[\\u01F2\\u01C5]/g},{base:\"E\",letters:/[\\u0045\\u24BA\\uFF25\\u00C8\\u00C9\\u00CA\\u1EC0\\u1EBE\\u1EC4\\u1EC2\\u1EBC\\u0112\\u1E14\\u1E16\\u0114\\u0116\\u00CB\\u1EBA\\u011A\\u0204\\u0206\\u1EB8\\u1EC6\\u0228\\u1E1C\\u0118\\u1E18\\u1E1A\\u0190\\u018E]/g},{base:\"F\",letters:/[\\u0046\\u24BB\\uFF26\\u1E1E\\u0191\\uA77B]/g},{base:\"G\",letters:/[\\u0047\\u24BC\\uFF27\\u01F4\\u011C\\u1E20\\u011E\\u0120\\u01E6\\u0122\\u01E4\\u0193\\uA7A0\\uA77D\\uA77E]/g},{base:\"H\",letters:/[\\u0048\\u24BD\\uFF28\\u0124\\u1E22\\u1E26\\u021E\\u1E24\\u1E28\\u1E2A\\u0126\\u2C67\\u2C75\\uA78D]/g},{base:\"I\",letters:/[\\u0049\\u24BE\\uFF29\\u00CC\\u00CD\\u00CE\\u0128\\u012A\\u012C\\u0130\\u00CF\\u1E2E\\u1EC8\\u01CF\\u0208\\u020A\\u1ECA\\u012E\\u1E2C\\u0197]/g},{base:\"J\",letters:/[\\u004A\\u24BF\\uFF2A\\u0134\\u0248]/g},{base:\"K\",letters:/[\\u004B\\u24C0\\uFF2B\\u1E30\\u01E8\\u1E32\\u0136\\u1E34\\u0198\\u2C69\\uA740\\uA742\\uA744\\uA7A2]/g},{base:\"L\",letters:/[\\u004C\\u24C1\\uFF2C\\u013F\\u0139\\u013D\\u1E36\\u1E38\\u013B\\u1E3C\\u1E3A\\u0141\\u023D\\u2C62\\u2C60\\uA748\\uA746\\uA780]/g},{base:\"LJ\",letters:/[\\u01C7]/g},{base:\"Lj\",letters:/[\\u01C8]/g},{base:\"M\",letters:/[\\u004D\\u24C2\\uFF2D\\u1E3E\\u1E40\\u1E42\\u2C6E\\u019C]/g},{base:\"N\",letters:/[\\u004E\\u24C3\\uFF2E\\u01F8\\u0143\\u00D1\\u1E44\\u0147\\u1E46\\u0145\\u1E4A\\u1E48\\u0220\\u019D\\uA790\\uA7A4]/g},{base:\"NJ\",letters:/[\\u01CA]/g},{base:\"Nj\",letters:/[\\u01CB]/g},{base:\"O\",letters:/[\\u004F\\u24C4\\uFF2F\\u00D2\\u00D3\\u00D4\\u1ED2\\u1ED0\\u1ED6\\u1ED4\\u00D5\\u1E4C\\u022C\\u1E4E\\u014C\\u1E50\\u1E52\\u014E\\u022E\\u0230\\u00D6\\u022A\\u1ECE\\u0150\\u01D1\\u020C\\u020E\\u01A0\\u1EDC\\u1EDA\\u1EE0\\u1EDE\\u1EE2\\u1ECC\\u1ED8\\u01EA\\u01EC\\u00D8\\u01FE\\u0186\\u019F\\uA74A\\uA74C]/g},{base:\"OI\",letters:/[\\u01A2]/g},{base:\"OO\",letters:/[\\uA74E]/g},{base:\"OU\",letters:/[\\u0222]/g},{base:\"P\",letters:/[\\u0050\\u24C5\\uFF30\\u1E54\\u1E56\\u01A4\\u2C63\\uA750\\uA752\\uA754]/g},{base:\"Q\",letters:/[\\u0051\\u24C6\\uFF31\\uA756\\uA758\\u024A]/g},{base:\"R\",letters:/[\\u0052\\u24C7\\uFF32\\u0154\\u1E58\\u0158\\u0210\\u0212\\u1E5A\\u1E5C\\u0156\\u1E5E\\u024C\\u2C64\\uA75A\\uA7A6\\uA782]/g},{base:\"S\",letters:/[\\u0053\\u24C8\\uFF33\\u1E9E\\u015A\\u1E64\\u015C\\u1E60\\u0160\\u1E66\\u1E62\\u1E68\\u0218\\u015E\\u2C7E\\uA7A8\\uA784]/g},{base:\"T\",letters:/[\\u0054\\u24C9\\uFF34\\u1E6A\\u0164\\u1E6C\\u021A\\u0162\\u1E70\\u1E6E\\u0166\\u01AC\\u01AE\\u023E\\uA786]/g},{base:\"TZ\",letters:/[\\uA728]/g},{base:\"U\",letters:/[\\u0055\\u24CA\\uFF35\\u00D9\\u00DA\\u00DB\\u0168\\u1E78\\u016A\\u1E7A\\u016C\\u00DC\\u01DB\\u01D7\\u01D5\\u01D9\\u1EE6\\u016E\\u0170\\u01D3\\u0214\\u0216\\u01AF\\u1EEA\\u1EE8\\u1EEE\\u1EEC\\u1EF0\\u1EE4\\u1E72\\u0172\\u1E76\\u1E74\\u0244]/g},{base:\"V\",letters:/[\\u0056\\u24CB\\uFF36\\u1E7C\\u1E7E\\u01B2\\uA75E\\u0245]/g},{base:\"VY\",letters:/[\\uA760]/g},{base:\"W\",letters:/[\\u0057\\u24CC\\uFF37\\u1E80\\u1E82\\u0174\\u1E86\\u1E84\\u1E88\\u2C72]/g},{base:\"X\",letters:/[\\u0058\\u24CD\\uFF38\\u1E8A\\u1E8C]/g},{base:\"Y\",letters:/[\\u0059\\u24CE\\uFF39\\u1EF2\\u00DD\\u0176\\u1EF8\\u0232\\u1E8E\\u0178\\u1EF6\\u1EF4\\u01B3\\u024E\\u1EFE]/g},{base:\"Z\",letters:/[\\u005A\\u24CF\\uFF3A\\u0179\\u1E90\\u017B\\u017D\\u1E92\\u1E94\\u01B5\\u0224\\u2C7F\\u2C6B\\uA762]/g},{base:\"a\",letters:/[\\u0061\\u24D0\\uFF41\\u1E9A\\u00E0\\u00E1\\u00E2\\u1EA7\\u1EA5\\u1EAB\\u1EA9\\u00E3\\u0101\\u0103\\u1EB1\\u1EAF\\u1EB5\\u1EB3\\u0227\\u01E1\\u00E4\\u01DF\\u1EA3\\u00E5\\u01FB\\u01CE\\u0201\\u0203\\u1EA1\\u1EAD\\u1EB7\\u1E01\\u0105\\u2C65\\u0250]/g},{base:\"aa\",letters:/[\\uA733]/g},{base:\"ae\",letters:/[\\u00E6\\u01FD\\u01E3]/g},{base:\"ao\",letters:/[\\uA735]/g},{base:\"au\",letters:/[\\uA737]/g},{base:\"av\",letters:/[\\uA739\\uA73B]/g},{base:\"ay\",letters:/[\\uA73D]/g},{base:\"b\",letters:/[\\u0062\\u24D1\\uFF42\\u1E03\\u1E05\\u1E07\\u0180\\u0183\\u0253]/g},{base:\"c\",letters:/[\\u0063\\u24D2\\uFF43\\u0107\\u0109\\u010B\\u010D\\u00E7\\u1E09\\u0188\\u023C\\uA73F\\u2184]/g},{base:\"d\",letters:/[\\u0064\\u24D3\\uFF44\\u1E0B\\u010F\\u1E0D\\u1E11\\u1E13\\u1E0F\\u0111\\u018C\\u0256\\u0257\\uA77A]/g},{base:\"dz\",letters:/[\\u01F3\\u01C6]/g},{base:\"e\",letters:/[\\u0065\\u24D4\\uFF45\\u00E8\\u00E9\\u00EA\\u1EC1\\u1EBF\\u1EC5\\u1EC3\\u1EBD\\u0113\\u1E15\\u1E17\\u0115\\u0117\\u00EB\\u1EBB\\u011B\\u0205\\u0207\\u1EB9\\u1EC7\\u0229\\u1E1D\\u0119\\u1E19\\u1E1B\\u0247\\u025B\\u01DD]/g},{base:\"f\",letters:/[\\u0066\\u24D5\\uFF46\\u1E1F\\u0192\\uA77C]/g},{base:\"g\",letters:/[\\u0067\\u24D6\\uFF47\\u01F5\\u011D\\u1E21\\u011F\\u0121\\u01E7\\u0123\\u01E5\\u0260\\uA7A1\\u1D79\\uA77F]/g},{base:\"h\",letters:/[\\u0068\\u24D7\\uFF48\\u0125\\u1E23\\u1E27\\u021F\\u1E25\\u1E29\\u1E2B\\u1E96\\u0127\\u2C68\\u2C76\\u0265]/g},{base:\"hv\",letters:/[\\u0195]/g},{base:\"i\",letters:/[\\u0069\\u24D8\\uFF49\\u00EC\\u00ED\\u00EE\\u0129\\u012B\\u012D\\u00EF\\u1E2F\\u1EC9\\u01D0\\u0209\\u020B\\u1ECB\\u012F\\u1E2D\\u0268\\u0131]/g},{base:\"j\",letters:/[\\u006A\\u24D9\\uFF4A\\u0135\\u01F0\\u0249]/g},{base:\"k\",letters:/[\\u006B\\u24DA\\uFF4B\\u1E31\\u01E9\\u1E33\\u0137\\u1E35\\u0199\\u2C6A\\uA741\\uA743\\uA745\\uA7A3]/g},{base:\"l\",letters:/[\\u006C\\u24DB\\uFF4C\\u0140\\u013A\\u013E\\u1E37\\u1E39\\u013C\\u1E3D\\u1E3B\\u017F\\u0142\\u019A\\u026B\\u2C61\\uA749\\uA781\\uA747]/g},{base:\"lj\",letters:/[\\u01C9]/g},{base:\"m\",letters:/[\\u006D\\u24DC\\uFF4D\\u1E3F\\u1E41\\u1E43\\u0271\\u026F]/g},{base:\"n\",letters:/[\\u006E\\u24DD\\uFF4E\\u01F9\\u0144\\u00F1\\u1E45\\u0148\\u1E47\\u0146\\u1E4B\\u1E49\\u019E\\u0272\\u0149\\uA791\\uA7A5]/g},{base:\"nj\",letters:/[\\u01CC]/g},{base:\"o\",letters:/[\\u006F\\u24DE\\uFF4F\\u00F2\\u00F3\\u00F4\\u1ED3\\u1ED1\\u1ED7\\u1ED5\\u00F5\\u1E4D\\u022D\\u1E4F\\u014D\\u1E51\\u1E53\\u014F\\u022F\\u0231\\u00F6\\u022B\\u1ECF\\u0151\\u01D2\\u020D\\u020F\\u01A1\\u1EDD\\u1EDB\\u1EE1\\u1EDF\\u1EE3\\u1ECD\\u1ED9\\u01EB\\u01ED\\u00F8\\u01FF\\u0254\\uA74B\\uA74D\\u0275]/g},{base:\"oi\",letters:/[\\u01A3]/g},{base:\"ou\",letters:/[\\u0223]/g},{base:\"oo\",letters:/[\\uA74F]/g},{base:\"p\",letters:/[\\u0070\\u24DF\\uFF50\\u1E55\\u1E57\\u01A5\\u1D7D\\uA751\\uA753\\uA755]/g},{base:\"q\",letters:/[\\u0071\\u24E0\\uFF51\\u024B\\uA757\\uA759]/g},{base:\"r\",letters:/[\\u0072\\u24E1\\uFF52\\u0155\\u1E59\\u0159\\u0211\\u0213\\u1E5B\\u1E5D\\u0157\\u1E5F\\u024D\\u027D\\uA75B\\uA7A7\\uA783]/g},{base:\"s\",letters:/[\\u0073\\u24E2\\uFF53\\u00DF\\u015B\\u1E65\\u015D\\u1E61\\u0161\\u1E67\\u1E63\\u1E69\\u0219\\u015F\\u023F\\uA7A9\\uA785\\u1E9B]/g},{base:\"t\",letters:/[\\u0074\\u24E3\\uFF54\\u1E6B\\u1E97\\u0165\\u1E6D\\u021B\\u0163\\u1E71\\u1E6F\\u0167\\u01AD\\u0288\\u2C66\\uA787]/g},{base:\"tz\",letters:/[\\uA729]/g},{base:\"u\",letters:/[\\u0075\\u24E4\\uFF55\\u00F9\\u00FA\\u00FB\\u0169\\u1E79\\u016B\\u1E7B\\u016D\\u00FC\\u01DC\\u01D8\\u01D6\\u01DA\\u1EE7\\u016F\\u0171\\u01D4\\u0215\\u0217\\u01B0\\u1EEB\\u1EE9\\u1EEF\\u1EED\\u1EF1\\u1EE5\\u1E73\\u0173\\u1E77\\u1E75\\u0289]/g},{base:\"v\",letters:/[\\u0076\\u24E5\\uFF56\\u1E7D\\u1E7F\\u028B\\uA75F\\u028C]/g},{base:\"vy\",letters:/[\\uA761]/g},{base:\"w\",letters:/[\\u0077\\u24E6\\uFF57\\u1E81\\u1E83\\u0175\\u1E87\\u1E85\\u1E98\\u1E89\\u2C73]/g},{base:\"x\",letters:/[\\u0078\\u24E7\\uFF58\\u1E8B\\u1E8D]/g},{base:\"y\",letters:/[\\u0079\\u24E8\\uFF59\\u1EF3\\u00FD\\u0177\\u1EF9\\u0233\\u1E8F\\u00FF\\u1EF7\\u1E99\\u1EF5\\u01B4\\u024F\\u1EFF]/g},{base:\"z\",letters:/[\\u007A\\u24E9\\uFF5A\\u017A\\u1E91\\u017C\\u017E\\u1E93\\u1E95\\u01B6\\u0225\\u0240\\u2C6C\\uA763]/g}];clickToAddress.prototype.tools.removeDiacritics=function(str){var changes=this.defaultDiacriticsRemovalMap;for(var i=0;i<changes.length;i++){str=str.replace(changes[i].letters,changes[i].base)}return str.toLowerCase()};clickToAddress.prototype.tools.binaryIndexOf=function(array,sequence){\"use strict\";var minIndex=0;var maxIndex=array.length-1;var currentIndex;var currentElement;var resultIndex;while(minIndex<=maxIndex){resultIndex=currentIndex=(minIndex+maxIndex)/2|0;currentElement=array[currentIndex];if(currentElement.sequence<sequence){minIndex=currentIndex+1}else if(currentElement.sequence>sequence){maxIndex=currentIndex-1}else{return currentIndex}}return~maxIndex};clickToAddress.prototype.tools.getCountryCode=function(c2a,text,matchBy){switch(matchBy){case\"iso_3\":for(var i=0;i<c2a.validCountries.length;i++){var row=c2a.validCountries[i];if(row.iso_3166_1_alpha_3==text){return row.code}}break;case\"iso_2\":for(var i=0;i<c2a.validCountries.length;i++){var row=c2a.validCountries[i];if(row.iso_3166_1_alpha_2==text){return row.code}}break}return false};if(typeof getCountryCode==\"undefined\"){var getCountryCode=function(c2a,text,matchBy){switch(matchBy){case\"iso_3\":for(var i=0;i<c2a.validCountries.length;i++){var row=c2a.validCountries[i];if(row.iso_3166_1_alpha_3==text){return row.code}}break;case\"iso_2\":for(var i=0;i<c2a.validCountries.length;i++){var row=c2a.validCountries[i];if(row.iso_3166_1_alpha_2==text){return row.code}}break}return false}}clickToAddress.prototype.tools.addClass=function(elem,value){var classes=elem.className.split(\" \");if(classes.indexOf(value)==-1){classes.push(value)}elem.className=classes.join(\" \")};clickToAddress.prototype.tools.removeClass=function(elem,value){var classes=elem.className.split(\" \");for(var i=0;i<classes.length;i++){if(classes[i]==value){classes.splice(i,1);i--}}elem.className=classes.join(\" \")};clickToAddress.prototype.tools.hasClass=function(elem,value){var classes=elem.className.split(\" \");for(var i=0;i<classes.length;i++){if(classes[i]==value){return true}}return false};clickToAddress.prototype.tools.__$styleInject=function(css){css=css||\"\";var head=document.head||document.getElementsByTagName(\"head\")[0];var style=document.createElement(\"style\");style.type=\"text/css\";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}head.appendChild(style)};clickToAddress.prototype.addTransl=function(){var that=this;try{if(\"function\"==typeof define&&define.amd){var transl_url=\"https://cc-cdn.com/utils/transl/v1.6.2/transliteration.min\";requirejs.config({paths:{transliterate:[transl_url]}});require([\"transliterate\"],function(transl){that.transl=transl})}else{var transl_url=\"https://cc-cdn.com/utils/transl/v1.6.2/transliteration.min.js\";var jsId=\"crafty_transliterate\";if(document.getElementById(\"crafty_transliterate\")===null){if(!document.getElementById(jsId)){var head=document.getElementsByTagName(\"head\")[0];var link=document.createElement(\"script\");link.id=jsId;link.type=\"text/javascript\";link.src=transl_url;head.appendChild(link)}var waitForLib=function(){if(typeof transl==\"function\"){clearInterval(transl_loading);that.transl=transl}};var transl_loading=setInterval(waitForLib,250)}}}catch(e){}};clickToAddress.prototype.setPlaceholder=function(country,target){\"use strict\";if(this.activeInput!=\"init\"){target=this.activeInput}if(this.placeholders&&typeof target!=\"undefined\"){var text=this.texts.default_placeholder;if(country){text=this.texts.country_placeholder}target.setAttribute(\"placeholder\",text)}};clickToAddress.prototype.getFocus=function(){\"use strict\";if(this.activeInput!=\"init\"){this.activeInput.focus()}this.focused=true};clickToAddress.prototype.loseFocus=function(){\"use strict\";if(this.activeInput!=\"init\"){this.activeInput.blur()}this.focused=false};clickToAddress.prototype.clear=function(){\"use strict\";this.resultList.innerHTML=\"\";this.searchStatus={lastSearchId:0,lastResponseId:0,inCountryMode:0}};clickToAddress.prototype.show=function(){\"use strict\";this.searchObj.style.display=\"block\";this.visible=true;this.setHistoryStep();if(this.activeInput!=\"init\"){var cc_ac_stored=this.activeInput.getAttribute(\"autocomplete\");if(cc_ac_stored){this.activeInput.setAttribute(\"cc_ac_stored\",cc_ac_stored)}this.activeInput.setAttribute(\"autocomplete\",\"new-crafty-global-search\")}};clickToAddress.prototype.hide=function(force_it){\"use strict\";if(this.keyboardHideInProgress){this.keyboardHideInProgress=false;return}if(force_it||this.visible&&!this.focused&&!this.hover){this.searchObj.style.display=\"none\";this.visible=false;this.hover=false;if(this.searchStatus.inCountryMode&&typeof this.lastSearch!==\"undefined\"){this.activeInput.value=this.lastSearch}this.clear();this.cachePos=-1;this.resetSelector();this.setPlaceholder(0);if(this.activeInput!=\"init\"){this.activeInput.className=this.activeInput.className.replace(\" c2a_active\",\"\");var cc_ac_stored=this.activeInput.getAttribute(\"cc_ac_stored\");this.activeInput.setAttribute(\"autocomplete\",cc_ac_stored);this.activeInput.removeAttribute(\"cc_ac_stored\")}}this.hideErrors()};clickToAddress.prototype.attach=function(dom,cfg){\"use strict\";var cfg=cfg||{};var domElements={};var objectArray=[\"search\",\"postcode\",\"town\",\"line_1\",\"line_2\",\"company\",\"county\",\"country\"];var quickGet=null;switch(this.domMode){case\"id\":quickGet=function(dom,obj_name){if(typeof dom[obj_name]==\"string\"&&dom[obj_name]!==\"\"){return document.getElementById(dom[obj_name])}};break;case\"class\":quickGet=function(dom,obj_name){if(typeof dom[obj_name]==\"string\"&&dom[obj_name]!==\"\"){return document.getElementsByClassName(dom[obj_name])[0]}};break;case\"name\":quickGet=function(dom,obj_name){if(typeof dom[obj_name]==\"string\"&&dom[obj_name]!==\"\"){return document.getElementsByName(dom[obj_name])[0]}};break;case\"object\":quickGet=function(dom,obj_name){if(typeof dom[obj_name]==\"object\"&&dom[obj_name]!==null){return dom[obj_name]}};break;case\"jQuery\":quickGet=function(dom,obj_name){if(dom[obj_name]instanceof jQuery){return dom[obj_name][0]}};break}for(var i=0;i<objectArray.length;i++){domElements[objectArray[i]]=quickGet(dom,objectArray[i])}var target=domElements.search;if(target.getAttribute(\"cc_applied\")==\"true\"){throw\"ClickToAddress already applied to this element!\"}target.setAttribute(\"cc_applied\",\"true\");this.setPlaceholder(0,target);domElements.config=cfg;var domLibId=this.domLib.length;this.domLib.push(domElements);var that=this;this.tools.ccEvent(target,\"keydown\",function(e){if(that.serviceReady===0)return;if(e.keyCode==38||e.keyCode==40){e.preventDefault();if(!that.hasContent){return}that.moveSelector(e.keyCode==40);return}if(e.keyCode==13){e.preventDefault()}});this.tools.ccEvent(target,\"keyup\",function(e){if(that.serviceReady===0)return;if(e.keyCode==27){that.hide(true);that.loseFocus();that.resetSelector();return}var noActionKeys=[37,38,39,40,33,34,35,36,42,44,45,16,17,18,19,20];if(noActionKeys.indexOf(e.keyCode)!=-1){return}if(e.keyCode==13){e.preventDefault();if(!that.hasContent||that.selectorPos<0){return}var elem=that.searchObj.getElementsByTagName(\"LI\")[that.selectorPos];if(that.searchStatus.inCountryMode==1){that.selectCountry(elem.getAttribute(\"countryCode\"))}else{that.select(elem)}return}if(that.searchStatus.inCountryMode==1){that.changeCountry(this.value)}else{if(that.getCfg(\"disableAutoSearch\")){return}if(this.value.indexOf(that.lastSearch)!==0){that.activeId=\"\"}that.lastSearch=this.value;that.sequence++;that.searchStatus.lastSearchId=that.sequence;var current_sequence_number=that.sequence;var searchVal=this.value;setTimeout(function(){if(that.searchStatus.lastSearchId<=current_sequence_number){if(searchVal!==\"\"){that.cleanHistory();that.search(searchVal,that.activeId,current_sequence_number)}else{that.clear()}}},200);that.activeDom=that.domLib[domLibId];that.gfxModeTools.reposition(that,target)}});this.tools.ccEvent(target,\"focus\",function(){that.activeDom=that.domLib[domLibId];that.onFocus(target)});this.tools.ccEvent(target,\"blur\",function(){if(that.serviceReady===0)return;that.focused=false;that.hide()});this.tools.ccEvent(target,\"c2a-search\",function(){that.show();if(that.searchStatus.inCountryMode==1){that.changeCountry(this.value)}else{if(this.value.indexOf(that.lastSearch)!==0){that.activeId=\"\"}that.lastSearch=this.value;that.sequence++;that.searchStatus.lastSearchId=that.sequence;var current_sequence_number=that.sequence;var searchVal=this.value;setTimeout(function(){if(that.searchStatus.lastSearchId<=current_sequence_number){if(searchVal!==\"\"){that.cleanHistory();that.search(searchVal,that.activeId,current_sequence_number)}else{that.clear()}}},200);that.activeDom=that.domLib[domLibId];that.gfxModeTools.reposition(that,target)}});if(target===document.activeElement){this.onFocus(target)}if(!that.getCfg(\"preserveAutocompleteAttribute\")&&(typeof domElements.line_1==\"undefined\"||domElements.line_1.getAttribute(\"cc_applied\")!=\"true\")){target.setAttribute(\"autocomplete\",\"new-crafty-global-search\")}};clickToAddress.prototype.onFocus=function(target){\"use strict\";var that=this;if(that.serviceReady===0){setTimeout(function(){that.onFocus(target)},250);return}var prestate=that.visible;that.activeInput=target;that.focused=true;that.show();that.gfxModeTools.reposition(that,target);if(!prestate){if(typeof that.getCfg(\"onSearchFocus\")==\"function\"){that.getCfg(\"onSearchFocus\")(that,that.activeDom)}}if(target.value!==\"\"&&!prestate){that.sequence++;that.searchStatus.lastSearchId=that.sequence;var sequence=that.sequence;if(that.lastSearch==target.value){sequence=-1}that.lastSearch=target.value;that.search(target.value,that.activeId,sequence)}};clickToAddress.prototype.resetSelector=function(){\"use strict\";this.hasContent=false;this.selectorPos=-1};clickToAddress.prototype.moveSelector=function(goDown){\"use strict\";if(!this.visible){return}var elems=this.searchObj.getElementsByTagName(\"LI\");if(goDown&&this.selectorPos+1<elems.length){this.selectorPos++}if(!goDown&&this.selectorPos-1>=0){this.selectorPos--}for(var i=0;i<elems.length;i++){if(i!=this.selectorPos){elems[i].className=elems[i].className.replace(\" active\",\"\")}else{if(elems[i].className.indexOf(\"active\")==-1){elems[i].className=elems[i].className+\" active\"}}}var offset=30*(this.selectorPos+1);var list=this.searchObj.getElementsByTagName(\"UL\")[0];if(offset>list.offsetHeight+list.scrollTop){list.scrollTop=offset-list.offsetHeight}if(offset<=list.scrollTop){list.scrollTop=offset-30}};clickToAddress.prototype.showGeo=function(){\"use strict\";this.searchObj.getElementsByClassName(\"geo\")[0].style.display=\"block\"};clickToAddress.prototype.getStyleSheet=function(){\"use strict\";if(this.cssPath===false){return}var cssId=\"crafty_css\";if(!document.getElementById(cssId)){var head=document.getElementsByTagName(\"head\")[0];var link=document.createElement(\"link\");link.id=cssId;link.rel=\"stylesheet\";link.type=\"text/css\";link.href=this.cssPath;link.media=\"all\";head.appendChild(link)}};clickToAddress.prototype.setProgressBar=function(state){\"use strict\";var pgbar=this.searchObj.getElementsByClassName(\"progressBar\")[0];switch(state){case 0:pgbar.className=\"progressBar action\";pgbar.style.width=\"50%\";setTimeout(function(){if(pgbar.className==\"progressBar action\"){pgbar.className=\"progressBar\";pgbar.style.width=\"0%\"}},5e3);break;case 1:pgbar.className=\"progressBar finish\";pgbar.style.width=\"100%\";setTimeout(function(){pgbar.className=\"progressBar\";pgbar.style.width=\"0%\"},2e3);break}};clickToAddress.prototype.triggerSearch=function(target){\"use strict\";var that=this;if(that.serviceReady===0){setTimeout(function(){that.triggerSearch(target)},250);return}var event=document.createEvent(\"Event\");event.initEvent(\"c2a-search\",true,true);target.dispatchEvent(event)};\n","Craftyclicks_Clicktoaddress/form_integrations/cc_multishipping_address.js":"function cc_m2_c2a(){\n\t/**\n\t * wait for form to exist before continuing\n\t * (needed on sites that load page elements\n\t * via multiple ajax requests)\n\t */\n\tif (jQuery('[name=\"postcode\"]').length == 0) {\n\t\treturn;\n\t}\n\t\n\tjQuery('[name=\"postcode\"]').each(function(index,elem){\n\t\tif(jQuery(elem).data('cc_attach') != '1'){\n\t\t\tjQuery(elem).data('cc_attach','1');\n\t\t\tvar form = jQuery(elem).closest('form');\n\n\t\t\tvar custom_id = '';\n\t\t\tif(c2a_config.advanced.search_elem_id !== null){\n\t\t\t\tcustom_id = ' id=\"'+ c2a_config.advanced.search_elem_id +'\"'\n\t\t\t}\n\n\t\t\t// null fix for m2_1.1.16\n\t\t\tif (c2a_config.texts.search_label == null) c2a_config.texts.search_label = '';\n\n\t\t\tvar tmp_html = '<div class=\"field\"'+custom_id+'><label class=\"label\">' +\n\t\t\t\t\t\t\tc2a_config.texts.search_label+'</label>' +\n\t\t\t\t\t\t\t'<div class=\"control\"><input class=\"cc_search_input\" type=\"text\"/></div></div>';\n\t\t\tif(c2a_config.advanced.hide_fields){\n\t\t\t\tvar svg = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 305.67 179.25\">'+\n\t\t\t\t\t\t\t'<rect x=\"-22.85\" y=\"66.4\" width=\"226.32\" height=\"47.53\" rx=\"17.33\" ry=\"17.33\" transform=\"translate(89.52 -37.99) rotate(45)\"/>'+\n\t\t\t\t\t\t\t'<rect x=\"103.58\" y=\"66.4\" width=\"226.32\" height=\"47.53\" rx=\"17.33\" ry=\"17.33\" transform=\"translate(433.06 0.12) rotate(135)\"/>'+\n\t\t\t\t\t\t'</svg>';\n\t\t\t\ttmp_html += '<div class=\"field cc_hide_fields_action\"><label>'+c2a_config.texts.manual_entry_toggle+'</label>'+svg+'</div>';\n\t\t\t}\n\t\t\tif (!c2a_config.advanced.use_first_line || c2a_config.advanced.hide_fields) {\n\t\t\t\tform.find('#street_1').closest('div.street').before( tmp_html );\n\t\t\t} else {\n\t\t\t\tform.find('#street_1').addClass('cc_search_input');\n\t\t\t}\n\t\t\tif (c2a_config.advanced.lock_country_to_dropdown) {\n\t\t\t\t\tform.find('.cc_search_input').closest('div.field').before(form.find('[name=\"country_id\"]').closest('div.field'));\n\t\t\t}\n\n\t\t\tvar dom = {\n\t\t\t\tsearch:\t\tform.find('.cc_search_input'),\n\t\t\t\tcompany:\tform.find('[name=\"company\"]'),\n\t\t\t\tline_1:\t\tform.find('#street_1'),\n\t\t\t\tline_2:\t\tform.find('#street_2'),\n\t\t\t\tpostcode:\tform.find('[name=\"postcode\"]'),\n\t\t\t\ttown:\t\tform.find('[name=\"city\"]'),\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\t\t\tinput:\tform.find('[name=\"region\"]'),\n\t\t\t\t\t\t\tlist:\tform.find('[name=\"region_id\"]')\n\t\t\t\t},\n\t\t\t\tcountry:\tform.find('[name=\"country_id\"]')\n\t\t\t};\n\t\t\tcc_holder.attach({\n\t\t\t\tsearch:\t\tdom.search[0],\n\t\t\t\tcompany:\tdom.company[0],\n\t\t\t\tline_1:\t\tdom.line_1[0],\n\t\t\t\tline_2:\t\tdom.line_2[0],\n\t\t\t\tpostcode:\tdom.postcode[0],\n\t\t\t\ttown:\t\tdom.town[0],\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\tinput:\tdom.county.input,\n\t\t\t\t\tlist:\tdom.county.list\n\t\t\t\t},\n\t\t\t\tcountry:\tdom.country[0]\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').on('click',function(){\n\t\t\t\tcc_hide_fields(dom, 'manual-show')\n\t\t\t});\n\n\t\t\tcc_hide_fields(dom,'init');\n\t\t}\n\t});\n}\nvar cc_holder = null;\n\nfunction cc_hide_fields(dom, action){\n\tvar action = action || 'show';\n\tif(!c2a_config.advanced.hide_fields){\n\t\treturn;\n\t}\n\tswitch(action){\n\t\tcase 'init':\n\t\t\tvar elementsToHide = ['line_1', 'line_2', 'line_3', 'line_4', 'town', 'postcode', 'county'];\n\t\t\t// determine if we can hide by default\n\t\t\tvar formEmpty = true;\n\t\t\tfor(var i=0; i<elementsToHide.length - 1; i++){ // -1 is to skip County\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length && jQuery(dom[elementsToHide[i]]).val() !== ''){\n\t\t\t\t\tformEmpty = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\telementsToHide.push('country');\n\t\t\t}\n\t\t\tfor(var i=0; i<elementsToHide.length; i++){\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length){\n\t\t\t\t\tswitch(elementsToHide[i]){\n\t\t\t\t\t\tcase 'county':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].input).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].list).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'line_1':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('div.street').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('.field').addClass('cc_hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\t// store the checking loop in the DOM object\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(formEmpty){\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t}\n\t\t\tsetInterval(function(){cc_reveal_fields_on_error(dom);}, 250);\n\t\t\tbreak;\n\t\tcase 'hide':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).addClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').removeClass('cc_slider_on');\n\t\t\tform.data('cc_hidden',1);\n\t\t\tbreak;\n\t\tcase 'manual-show':\n\t\tcase 'show':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tjQuery(dom.country).trigger('change');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).removeClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').hide(200);\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(action == 'manual-show'){\n\t\t\t\tjQuery(dom.country).trigger('change');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'toggle':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tif(form.data('cc_hidden') == 1){\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n\nfunction cc_reveal_fields_on_error(dom){\n\tvar form = jQuery(dom.country).closest('form');\n\tvar errors_present = false;\n\tform.find('.cc_hide').each(function(index, item){\n\t\tif(jQuery(item).hasClass('_error')){\n\t\t\terrors_present = true;\n\t\t}\n\t});\n\tif(errors_present){\n\t\tcc_hide_fields(dom, 'show');\n\t\tform.find('.cc_hide_fields_action').hide(); // prevent the user from hiding the fields again\n\t}\n}\nrequirejs(['jquery'], function( $ ) {\n\tjQuery( document ).ready(function() {\n\t\tif(c2a_config.enabled && c2a_config.key != null){\n\t\t\tvar config = {\n\t\t\t\taccessToken: c2a_config.key,\n\t\t\t\tonSetCounty: function(c2a, elements, county){\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tdomMode: 'object',\n\t\t\t\tgfxMode: c2a_config.gfx_mode,\n\t\t\t\tstyle: {\n\t\t\t\t\tambient: c2a_config.gfx_ambient,\n\t\t\t\t\taccent: c2a_config.gfx_accent\n\t\t\t\t},\n\t\t\t\tshowLogo: false,\n\t\t\t\ttexts: c2a_config.texts,\n\t\t\t\tonResultSelected: function(c2a, elements, address){\n\t\t\t\t\tswitch(address.country_name) {\n\t\t\t\t\t\tcase 'Jersey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('JE')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Guernsey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('GG')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Isle of Man':\n\t\t\t\t\t\t\tjQuery(elements.country).val('IM')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(elements.country).val(address.country.iso_3166_1_alpha_2);\n\t\t\t\t\t}\n\t\t\t\t\tjQuery(elements.country).trigger('change');\n\n\t\t\t\t\tvar county = {\n\t\t\t\t\t\tpreferred: address.province,\n\t\t\t\t\t\tcode: address.province_code,\n\t\t\t\t\t\tname: address.province_name\n\t\t\t\t\t};\n\n\t\t\t\t\tif(elements.county.list.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.list[0], county);\n\t\t\t\t\t}\n\t\t\t\t\tif(elements.county.input.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.input[0], county);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar event = new Event('change')\n\t\t\t\t\telements.county.input[0].dispatchEvent(event);\n\t\t\t\t\telements.county.list[0].dispatchEvent(event);\n\t\t\t\t\telements.company.dispatchEvent(event);\n\t\t\t\t\telements.line_1.dispatchEvent(event);\n\t\t\t\t\telements.line_2.dispatchEvent(event);\n\t\t\t\t\telements.postcode.dispatchEvent(event);\n\t\t\t\t\telements.town.dispatchEvent(event);\n\n\t\t\t\t\tcc_hide_fields(elements,'show');\n\t\t\t\t},\n\t\t\t\tonError: function(){\n\t\t\t\t\tif(typeof this.activeDom.postcode !== 'undefined'){\n\t\t\t\t\t\tcc_hide_fields(this.activeDom,'show');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tc2a_config.advanced.hide_fields = false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttransliterate: c2a_config.advanced.transliterate,\n\t\t\t\tdebug: c2a_config.advanced.debug,\n\t\t\t\tcssPath: false,\n\t\t\t\ttag: 'Magento 2'\n\t\t\t};\n\t\t\tif(typeof c2a_config.enabled_countries !== 'undefined'){\n\t\t\t\tconfig.countryMatchWith = 'iso_2';\n\t\t\t\tconfig.enabledCountries = c2a_config.enabled_countries;\n\t\t\t}\n\t\t\tif(c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\tconfig.countrySelector = false;\n\t\t\t\tconfig.onSearchFocus = function(c2a, dom){\n\t\t\t\t\tvar currentCountry = dom.country.options[dom.country.selectedIndex].value;\n\t\t\t\t\tif(currentCountry !== ''){\n\t\t\t\t\t\tvar countryCode = getCountryCode(c2a, currentCountry, 'iso_2');\n\t\t\t\t\t\tc2a.selectCountry(countryCode);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcc_holder = new clickToAddress(config);\n\t\t\tsetInterval(cc_m2_c2a,200);\n\t\t}\n\n\t\tif(c2a_config.enabled && c2a_config.key == null){\n\t\t\tconsole.warn('ClickToAddress: Incorrect token format supplied');\n\t\t}\n\t});\n});\n","Craftyclicks_Clicktoaddress/form_integrations/cc_customer_address.js":"var cc_activate_flags = [];\nfunction cc_m2_c2a(){\n\t/**\n\t * wait for form to exist before continuing\n\t * (needed on sites that load page elements\n\t * via multiple ajax requests)\n\t */\n\tif (jQuery('[name=\"postcode\"]').length == 0) {\n\t\treturn;\n\t}\n\t\t\n\tjQuery('[name=\"postcode\"]').each(function(index,elem){\n\t\tif(jQuery(elem).data('cc_attach') != '1'){\n\t\t\tjQuery(elem).data('cc_attach','1');\n\t\t\tvar form = jQuery(elem).closest('form');\n\n\t\t\tvar custom_id = '';\n\t\t\tif(c2a_config.advanced.search_elem_id !== null){\n\t\t\t\tcustom_id = ' id=\"'+ c2a_config.advanced.search_elem_id +'\"'\n\t\t\t}\n\n\t\t\t// null fix for m2_1.1.16\n\t\t\tif (c2a_config.texts.search_label == null) c2a_config.texts.search_label = '';\n\n\t\t\tvar tmp_html = '<div class=\"field\"'+custom_id+'><label class=\"label\">' +\n\t\t\t\t\t\t\tc2a_config.texts.search_label+'</label>' +\n\t\t\t\t\t\t\t'<div class=\"control\"><input class=\"cc_search_input\" type=\"text\"/></div></div>';\n\n\t\t\tif (!c2a_config.advanced.use_first_line) {\n\t\t\t\tform.find('#street_1').closest('.field').before( tmp_html );\n\t\t\t} else {\n\t\t\t\tform.find('#street_1').addClass('cc_search_input');\n\t\t\t}\n\t\t\tif (c2a_config.advanced.lock_country_to_dropdown) {\n\t\t\t\tform.find('.cc_search_input').closest('div.field').before(form.find('[name=\"country_id\"]').closest('div.field'));\n\t\t\t}\n\n\t\t\tvar config = {\n\t\t\t\taccessToken: c2a_config.key,\n\t\t\t\tdom: {\n\t\t\t\t\tsearch:\t\tform.find('.cc_search_input')[0],\n\t\t\t\t\tcompany:\tform.find('[name=\"company\"]')[0],\n\t\t\t\t\tline_1:\t\tform.find('#street_1')[0],\n\t\t\t\t\tline_2:\t\tform.find('#street_2')[0],\n\t\t\t\t\tpostcode:\tform.find('[name=\"postcode\"]')[0],\n\t\t\t\t\ttown:\t\tform.find('[name=\"city\"]')[0],\n\t\t\t\t\tcounty:\t\t{\n\t\t\t\t\t\tinput:\tform.find('[name=\"region\"]'),\n\t\t\t\t\t\tlist:\tform.find('[name=\"region_id\"]')\n\t\t\t\t\t},\n\t\t\t\t\tcountry:\tform.find('[name=\"country_id\"]')[0]\n\t\t\t\t},\n\t\t\t\tonSetCounty: function(c2a, elements, county){\n\t\t\t\t\treturn\n\t\t\t\t},\n\t\t\t\tdomMode: 'object',\n\t\t\t\tgfxMode: c2a_config.gfx_mode,\n\t\t\t\tstyle: {\n\t\t\t\t\tambient: c2a_config.gfx_ambient,\n\t\t\t\t\taccent: c2a_config.gfx_accent\n\t\t\t\t},\n\t\t\t\tshowLogo: false,\n\t\t\t\ttexts: c2a_config.texts,\n\t\t\t\tonResultSelected: function(c2a, elements, address){\n\t\t\t\t\tswitch(address.country_name) {\n\t\t\t\t\t\tcase 'Jersey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('JE')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Guernsey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('GG')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Isle of Man':\n\t\t\t\t\t\t\tjQuery(elements.country).val('IM')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(elements.country).val(address.country.iso_3166_1_alpha_2);\n\t\t\t\t\t}\n\t\t\t\t\tjQuery(elements.country).trigger('change');\n\n\t\t\t\t\tvar county = {\n\t\t\t\t\t\tpreferred: address.province,\n\t\t\t\t\t\tcode: address.province_code,\n\t\t\t\t\t\tname: address.province_name\n\t\t\t\t\t};\n\n\t\t\t\t\tif(elements.county.list.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.list[0], county);\n\t\t\t\t\t}\n\t\t\t\t\tif(elements.county.input.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.input[0], county);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar event = new Event('change')\n\t\t\t\t\telements.county.input[0].dispatchEvent(event);\n\t\t\t\t\telements.county.list[0].dispatchEvent(event);\n\t\t\t\t\telements.company.dispatchEvent(event);\n\t\t\t\t\telements.line_1.dispatchEvent(event);\n\t\t\t\t\telements.line_2.dispatchEvent(event);\n\t\t\t\t\telements.postcode.dispatchEvent(event);\n\t\t\t\t\telements.town.dispatchEvent(event);\n\t\t\t\t},\n\t\t\t\ttransliterate: c2a_config.advanced.transliterate,\n\t\t\t\tdebug: c2a_config.advanced.debug,\n\t\t\t\tcssPath: false,\n\t\t\t\ttag: 'Magento 2'\n\t\t\t};\n\t\t\tif(typeof c2a_config.enabled_countries !== 'undefined'){\n\t\t\t\tconfig.countryMatchWith = 'iso_2';\n\t\t\t\tconfig.enabledCountries = c2a_config.enabled_countries;\n\t\t\t}\n\t\t\tif(c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\tconfig.countrySelector = false;\n\t\t\t\tconfig.onSearchFocus = function(c2a, dom){\n\t\t\t\t\tvar currentCountry = dom.country.options[dom.country.selectedIndex].value;\n\t\t\t\t\tif(currentCountry !== ''){\n\t\t\t\t\t\tvar countryCode = getCountryCode(c2a, currentCountry, 'iso_2');\n\t\t\t\t\t\tc2a.selectCountry(countryCode);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tnew clickToAddress(config);\n\t\t}\n\t});\n}\nrequirejs(['jquery'], function( $ ) {\n\tjQuery( document ).ready(function() {\n\t\tif(c2a_config.enabled && c2a_config.key != null){\n\t\t\tsetInterval(cc_m2_c2a,200);\n\t\t}\n\n\t\tif(c2a_config.enabled && c2a_config.key == null){\n\t\t\tconsole.warn('ClickToAddress: Incorrect token format supplied');\n\t\t}\n\t});\n});\n","Craftyclicks_Clicktoaddress/form_integrations/cc_default_checkout.js":"function cc_m2_c2a(){\n\t/**\n\t * wait for form to exist before continuing\n\t * (needed on sites that load page elements\n\t * via multiple ajax requests)\n\t */\n\tif (jQuery('[name=\"postcode\"]').length == 0) {\n\t\treturn;\n\t}\n\n\tjQuery('[name=\"postcode\"]').each(function(index,elem){\n\t\tif(jQuery(elem).data('cc_attach') != '1'){\n\t\t\tjQuery(elem).data('cc_attach','1');\n\t\t\tvar form = jQuery(elem).closest('form');\n\n\t\t\tvar custom_id = '';\n\t\t\tif(c2a_config.advanced.search_elem_id !== null){\n\t\t\t\tcustom_id = ' id=\"'+ c2a_config.advanced.search_elem_id +'\"'\n\t\t\t}\n\n\t\t\t// null fix for m2_1.1.16\n\t\t\tif (c2a_config.texts.search_label == null) c2a_config.texts.search_label = '';\n\n\t\t\tvar tmp_html = '<div class=\"field\"'+custom_id+'><label class=\"label\">' +\n\t\t\t\t\t\t\tc2a_config.texts.search_label+'</label>' +\n\t\t\t\t\t\t\t'<div class=\"control\"><input class=\"cc_search_input\" type=\"text\"/></div></div>';\n\t\t\tif(c2a_config.advanced.hide_fields){\n\t\t\t\tvar svg = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 305.67 179.25\">'+\n\t\t\t\t\t\t\t'<rect x=\"-22.85\" y=\"66.4\" width=\"226.32\" height=\"47.53\" rx=\"17.33\" ry=\"17.33\" transform=\"translate(89.52 -37.99) rotate(45)\"/>'+\n\t\t\t\t\t\t\t'<rect x=\"103.58\" y=\"66.4\" width=\"226.32\" height=\"47.53\" rx=\"17.33\" ry=\"17.33\" transform=\"translate(433.06 0.12) rotate(135)\"/>'+\n\t\t\t\t\t\t'</svg>';\n\t\t\t\ttmp_html += '<div class=\"field cc_hide_fields_action\"><label>'+c2a_config.texts.manual_entry_toggle+'</label>'+svg+'</div>';\n\t\t\t}\n\t\t\tif (!c2a_config.advanced.use_first_line || c2a_config.advanced.hide_fields) {\n\t\t\t\tform.find('[name=\"street[0]\"]').closest('fieldset').before( tmp_html );\n\t\t\t} else {\n\t\t\t\tform.find('[name=\"street[0]\"]').addClass('cc_search_input');\n\t\t\t}\n\t\t\tif (c2a_config.advanced.lock_country_to_dropdown) {\n\t\t\t\tif (c2a_config.advanced.use_first_line) {\n\t\t\t\t\tform.find('.cc_search_input').closest('fieldset').before(form.find('[name=\"country_id\"]').closest('div.field'));\n\t\t\t\t} else {\n\t\t\t\t\tform.find('.cc_search_input').closest('div.field').before(form.find('[name=\"country_id\"]').closest('div.field'));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dom = {\n\t\t\t\tsearch:\t\tform.find('.cc_search_input'),\n\t\t\t\tcompany:\tform.find('[name=\"company\"]'),\n\t\t\t\tline_1:\t\tform.find('[name=\"street[0]\"]'),\n\t\t\t\tline_2:\t\tform.find('[name=\"street[1]\"]'),\n\t\t\t\tpostcode:\tform.find('[name=\"postcode\"]'),\n\t\t\t\ttown:\t\tform.find('[name=\"city\"]'),\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\t\t\tinput:\tform.find('[name=\"region\"]'),\n\t\t\t\t\t\t\tlist:\tform.find('[name=\"region_id\"]')\n\t\t\t\t},\n\t\t\t\tcountry:\tform.find('[name=\"country_id\"]')\n\t\t\t};\n\t\t\tcc_holder.attach({\n\t\t\t\tsearch:\t\tdom.search[0],\n\t\t\t\tcompany:\tdom.company[0],\n\t\t\t\tline_1:\t\tdom.line_1[0],\n\t\t\t\tline_2:\t\tdom.line_2[0],\n\t\t\t\tpostcode:\tdom.postcode[0],\n\t\t\t\ttown:\t\tdom.town[0],\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\tinput:\tdom.county.input,\n\t\t\t\t\tlist:\tdom.county.list\n\t\t\t\t},\n\t\t\t\tcountry:\tdom.country[0]\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').on('click',function(){\n\t\t\t\tcc_hide_fields(dom, 'manual-show')\n\t\t\t});\n\n\t\t\tcc_hide_fields(dom,'init');\n\t\t}\n\t});\n}\nvar cc_holder = null;\n\nfunction cc_hide_fields(dom, action){\n\tvar action = action || 'show';\n\tif(!c2a_config.advanced.hide_fields){\n\t\treturn;\n\t}\n\tswitch(action){\n\t\tcase 'init':\n\t\t\tvar elementsToHide = ['line_1', 'line_2', 'line_3', 'line_4', 'town', 'postcode', 'county'];\n\t\t\t// determine if we can hide by default\n\t\t\tvar formEmpty = true;\n\t\t\tfor(var i=0; i<elementsToHide.length - 1; i++){ // -1 is to skip County\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length && jQuery(dom[elementsToHide[i]]).val() !== ''){\n\t\t\t\t\tformEmpty = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\telementsToHide.push('country');\n\t\t\t}\n\t\t\tfor(var i=0; i<elementsToHide.length; i++){\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length){\n\t\t\t\t\tswitch(elementsToHide[i]){\n\t\t\t\t\t\tcase 'county':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].input).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].list).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'line_1':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('fieldset.field').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('.field').addClass('cc_hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\t// store the checking loop in the DOM object\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(formEmpty){\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t}\n\t\t\tsetInterval(function(){cc_reveal_fields_on_error(dom);}, 250);\n\t\t\tbreak;\n\t\tcase 'hide':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).addClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').removeClass('cc_slider_on');\n\t\t\tform.data('cc_hidden',1);\n\t\t\tbreak;\n\t\tcase 'manual-show':\n\t\tcase 'show':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tjQuery(dom.country).trigger('change');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).removeClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').hide(200);\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(action == 'manual-show'){\n\t\t\t\tjQuery(dom.country).trigger('change');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'toggle':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tif(form.data('cc_hidden') == 1){\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n\nfunction cc_reveal_fields_on_error(dom){\n\tvar form = jQuery(dom.country).closest('form');\n\tvar errors_present = false;\n\tform.find('.cc_hide').each(function(index, item){\n\t\tif(jQuery(item).hasClass('_error')){\n\t\t\terrors_present = true;\n\t\t}\n\t});\n\tif(errors_present){\n\t\tcc_hide_fields(dom, 'show');\n\t\tform.find('.cc_hide_fields_action').hide(); // prevent the user from hiding the fields again\n\t}\n}\nrequirejs(['jquery'], function( $ ) {\n\tjQuery( document ).ready(function() {\n\t\tif(c2a_config.enabled && c2a_config.key != null){\n\t\t\tvar config = {\n\t\t\t\taccessToken: c2a_config.key,\n\t\t\t\tonSetCounty: function(c2a, elements, county){\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tdomMode: 'object',\n\t\t\t\tgfxMode: c2a_config.gfx_mode,\n\t\t\t\tstyle: {\n\t\t\t\t\tambient: c2a_config.gfx_ambient,\n\t\t\t\t\taccent: c2a_config.gfx_accent\n\t\t\t\t},\n\t\t\t\tshowLogo: false,\n\t\t\t\ttexts: c2a_config.texts,\n\t\t\t\tonResultSelected: function(c2a, elements, address){\n\t\t\t\t\tswitch(address.country_name) {\n\t\t\t\t\t\tcase 'Jersey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('JE')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Guernsey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('GG')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Isle of Man':\n\t\t\t\t\t\t\tjQuery(elements.country).val('IM')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(elements.country).val(address.country.iso_3166_1_alpha_2);\n\t\t\t\t\t}\n\t\t\t\t\tjQuery(elements.country).trigger('change');\n\n\t\t\t\t\tvar county = {\n\t\t\t\t\t\tpreferred: address.province,\n\t\t\t\t\t\tcode: address.province_code,\n\t\t\t\t\t\tname: address.province_name\n\t\t\t\t\t};\n\n\t\t\t\t\tif(elements.county.list.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.list[0], county);\n\t\t\t\t\t}\n\t\t\t\t\tif(elements.county.input.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.input[0], county);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar event = new Event('change')\n\t\t\t\t\tif (typeof elements.county.input[0] != 'undefined') elements.county.input[0].dispatchEvent(event)\n\t\t\t\t\tif (typeof elements.county.list[0] != 'undefined') elements.county.list[0].dispatchEvent(event)\n\t\t\t\t\telements.company.dispatchEvent(event);\n\t\t\t\t\telements.line_1.dispatchEvent(event);\n\t\t\t\t\telements.line_2.dispatchEvent(event);\n\t\t\t\t\telements.postcode.dispatchEvent(event);\n\t\t\t\t\telements.town.dispatchEvent(event);\n\n\t\t\t\t\tcc_hide_fields(elements,'show');\n\t\t\t\t},\n\t\t\t\tonError: function(){\n\t\t\t\t\tif(typeof this.activeDom.postcode !== 'undefined'){\n\t\t\t\t\t\tcc_hide_fields(this.activeDom,'show');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tc2a_config.advanced.hide_fields = false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttransliterate: c2a_config.advanced.transliterate,\n\t\t\t\tdebug: c2a_config.advanced.debug,\n\t\t\t\tcssPath: false,\n\t\t\t\ttag: 'Magento 2'\n\t\t\t};\n\t\t\tif(typeof c2a_config.enabled_countries !== 'undefined'){\n\t\t\t\tconfig.countryMatchWith = 'iso_2';\n\t\t\t\tconfig.enabledCountries = c2a_config.enabled_countries;\n\t\t\t}\n\t\t\tif(c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\tconfig.countrySelector = false;\n\t\t\t\tconfig.onSearchFocus = function(c2a, dom){\n\t\t\t\t\tvar currentCountry = dom.country.options[dom.country.selectedIndex].value;\n\t\t\t\t\tif(currentCountry !== ''){\n\t\t\t\t\t\tvar countryCode = getCountryCode(c2a, currentCountry, 'iso_2');\n\t\t\t\t\t\tc2a.selectCountry(countryCode);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcc_holder = new clickToAddress(config);\n\t\t\tsetInterval(cc_m2_c2a,200);\n\t\t}\n\n\t\tif(c2a_config.enabled && c2a_config.key == null){\n\t\t\tconsole.warn('ClickToAddress: Incorrect token format supplied');\n\t\t}\n\t});\n});\n","Craftyclicks_Clicktoaddress/form_integrations/cc_aheadworks_checkout.js":"function cc_m2_c2a(){\n\t/**\n\t * wait for form to exist before continuing\n\t * (needed on sites that load page elements\n\t * via multiple ajax requests)\n\t */\n\tif (jQuery('[name=\"postcode\"]').length == 0) {\n\t\treturn;\n\t}\n\n\tjQuery('[name=\"postcode\"]').each(function(index,elem){\n\t\tif(jQuery(elem).data('cc_attach') != '1' && jQuery(elem).closest('form').find('[name=\"street[0]\"]').length == 1){\n\t\t\tjQuery(elem).data('cc_attach','1');\n\t\t\tvar form = jQuery(elem).closest('form');\n\n\t\t\tvar custom_id = '';\n\t\t\tif(c2a_config.advanced.search_elem_id !== null){\n\t\t\t\tcustom_id = ' id=\"'+ c2a_config.advanced.search_elem_id +'\"'\n\t\t\t}\n\n\t\t\t// null fix for m2_1.1.16\n\t\t\tif (c2a_config.texts.search_label == null) c2a_config.texts.search_label = '';\n\n\t\t\tif (c2a_config.advanced.hide_fields) {\n\t\t\t\t//  if hide fields is enabled, always add our own search input\n\t\t\t\tvar tmp_html = `\n\t\t\t\t\t<div class=\"field-row\" ${custom_id}>\n\t\t\t\t\t\t<div class=\"field\">\n\t\t\t\t\t\t\t<div style=\"display: flex; flex-direction: row; justify-content: space-between\">\n\t\t\t\t\t\t\t\t<label style=\"color: #838383; cursor: default; max-width: 150px; margin-bottom: 5px;\">${c2a_config.texts.search_label}</label>\n\t\t\t\t\t\t\t\t<div class=\"field cc_hide_fields_action\" style=\"font-size: 0.75em; color: #838383; max-width: 125px;\">\n\t\t\t\t\t\t\t\t\t<label style=\"text-align: right;\">${c2a_config.texts.manual_entry_toggle}</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"control\"><input class=\"cc_search_input input-text\" type=\"text\"/></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t\tform.find('[name=\"street[0]\"]').closest('.field-row').before( tmp_html );\n\t\t\t} else if (!c2a_config.advanced.hide_fields && !c2a_config.advanced.use_first_line) {\n\t\t\t\tvar tmp_html = `\n\t\t\t\t\t<div class=\"field-row\" ${custom_id}>\n\t\t\t\t\t\t<div class=\"field\">\n\t\t\t\t\t\t\t<div style=\"display: flex; flex-direction: row; justify-content: space-between\">\n\t\t\t\t\t\t\t\t<label style=\"color: #838383; cursor: default; max-width: 150px; margin-bottom: 5px;\">${c2a_config.texts.search_label}</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"control\"><input class=\"cc_search_input input-text\" type=\"text\"/></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t\tform.find('[name=\"street[0]\"]').closest('.field-row').before( tmp_html );\n\t\t\t} else if (!c2a_config.advanced.hide_fields && c2a_config.advanced.use_first_line) {\n\t\t\t\tvar tmp_html = `\n\t\t\t\t\t<div class=\"field-row\">\n\t\t\t\t\t\t<div class=\"field\">\n\t\t\t\t\t\t\t<div style=\"display: flex; flex-direction: row; justify-content: space-between\">\n\t\t\t\t\t\t\t\t<label style=\"color: #838383; cursor: default; max-width: 150px; margin-bottom: 5px;\">${c2a_config.texts.search_label}</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t\tform.find('[name=\"street[0]\"]').closest('.field-row').before( tmp_html );\n\t\t\t\tform.find('[name=\"street[0]\"]').addClass('cc_search_input');\n\t\t\t}\n\n\t\t\tif (c2a_config.advanced.lock_country_to_dropdown) {\n\t\t\t\tform.find('[name=\"country_id\"]').closest('div.field').wrap('<div class=\"field-row\"></div>');\n\t\t\t\tif (c2a_config.advanced.use_first_line) {\n\t\t\t\t\tform.find('.cc_search_input').closest('div.field-row').prev('div.field-row').before(form.find('[name=\"country_id\"]').closest('div.field-row'));\n\t\t\t\t} else {\n\t\t\t\t\tform.find('.cc_search_input').closest('div.field-row').before(form.find('[name=\"country_id\"]').closest('div.field-row'));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dom = {\n\t\t\t\tsearch:\t\tform.find('.cc_search_input'),\n\t\t\t\tcompany:\tform.find('[name=\"company\"]'),\n\t\t\t\tline_1:\t\tform.find('[name=\"street[0]\"]'),\n\t\t\t\tline_2:\t\tform.find('[name=\"street[1]\"]'),\n\t\t\t\tpostcode:\tform.find('[name=\"postcode\"]'),\n\t\t\t\ttown:\t\tform.find('[name=\"city\"]'),\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\t\t\tinput:\tform.find('[name=\"region\"]'),\n\t\t\t\t\t\t\tlist:\tform.find('[name=\"region_id\"]')\n\t\t\t\t},\n\t\t\t\tcountry:\tform.find('[name=\"country_id\"]')\n\t\t\t};\n\t\t\tcc_holder.attach({\n\t\t\t\tsearch:\t\tdom.search[0],\n\t\t\t\tcompany:\tdom.company[0],\n\t\t\t\tline_1:\t\tdom.line_1[0],\n\t\t\t\tline_2:\t\tdom.line_2[0],\n\t\t\t\tpostcode:\tdom.postcode[0],\n\t\t\t\ttown:\t\tdom.town[0],\n\t\t\t\tcounty:\t\t{\n\t\t\t\t\tinput:\tdom.county.input,\n\t\t\t\t\tlist:\tdom.county.list\n\t\t\t\t},\n\t\t\t\tcountry:\tdom.country[0]\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').on('click',function(){\n\t\t\t\tcc_hide_fields(dom, 'manual-show')\n\t\t\t});\n\n\t\t\tcc_hide_fields(dom,'init');\n\t\t}\n\t});\n}\nvar cc_holder = null;\n\nfunction cc_hide_fields(dom, action){\n\tvar action = action || 'show';\n\tif(!c2a_config.advanced.hide_fields){\n\t\treturn;\n\t}\n\tswitch(action){\n\t\tcase 'init':\n\t\t\tvar elementsToHide = ['line_1', 'line_2', 'line_3', 'line_4', 'town', 'postcode', 'county'];\n\t\t\t// determine if we can hide by default\n\t\t\tvar formEmpty = true;\n\t\t\tfor(var i=0; i<elementsToHide.length - 1; i++){ // -1 is to skip County\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length && jQuery(dom[elementsToHide[i]]).val() !== ''){\n\t\t\t\t\tformEmpty = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\telementsToHide.push('country');\n\t\t\t}\n\t\t\tfor(var i=0; i<elementsToHide.length; i++){\n\t\t\t\tif(jQuery(dom[elementsToHide[i]]).length){\n\t\t\t\t\tswitch(elementsToHide[i]){\n\t\t\t\t\t\tcase 'county':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].input).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]].list).closest('.field').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'line_1':\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('fieldset.field').addClass('cc_hide');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(dom[elementsToHide[i]]).closest('.field').addClass('cc_hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\t// store the checking loop in the DOM object\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(formEmpty){\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t}\n\t\t\tsetInterval(function(){cc_reveal_fields_on_error(dom);}, 250);\n\t\t\tbreak;\n\t\tcase 'hide':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).addClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').removeClass('cc_slider_on');\n\t\t\tform.data('cc_hidden',1);\n\t\t\tbreak;\n\t\tcase 'manual-show':\n\t\tcase 'show':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tjQuery(dom.country).trigger('change');\n\t\t\tform.find('.cc_hide').each(function(index, item){\n\t\t\t\tjQuery(item).removeClass('cc_hidden');\n\t\t\t});\n\t\t\tform.find('.cc_hide_fields_action').hide(200);\n\t\t\tform.data('cc_hidden',0);\n\t\t\tif(action == 'manual-show'){\n\t\t\t\tjQuery(dom.country).trigger('change');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'toggle':\n\t\t\tvar form = jQuery(dom.country).closest('form');\n\t\t\tif(form.data('cc_hidden') == 1){\n\t\t\t\tcc_hide_fields(dom, 'show');\n\t\t\t} else {\n\t\t\t\tcc_hide_fields(dom, 'hide');\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n\nfunction cc_reveal_fields_on_error(dom){\n\tvar form = jQuery(dom.country).closest('form');\n\tvar errors_present = false;\n\tform.find('.cc_hide').each(function(index, item){\n\t\tif(jQuery(item).hasClass('_error')){\n\t\t\terrors_present = true;\n\t\t}\n\t});\n\tif(errors_present){\n\t\tcc_hide_fields(dom, 'show');\n\t\tform.find('.cc_hide_fields_action').hide(); // prevent the user from hiding the fields again\n\t}\n}\nrequirejs(['jquery'], function( $ ) {\n\tjQuery( document ).ready(function() {\n\t\tif(c2a_config.enabled && c2a_config.key != null){\n\t\t\tvar config = {\n\t\t\t\taccessToken: c2a_config.key,\n\t\t\t\tonSetCounty: function(c2a, elements, county){\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tdomMode: 'object',\n\t\t\t\tgfxMode: c2a_config.gfx_mode,\n\t\t\t\tstyle: {\n\t\t\t\t\tambient: c2a_config.gfx_ambient,\n\t\t\t\t\taccent: c2a_config.gfx_accent\n\t\t\t\t},\n\t\t\t\tshowLogo: false,\n\t\t\t\ttexts: c2a_config.texts,\n\t\t\t\tonResultSelected: function(c2a, elements, address){\n\t\t\t\t\tswitch(address.country_name) {\n\t\t\t\t\t\tcase 'Jersey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('JE')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Guernsey':\n\t\t\t\t\t\t\tjQuery(elements.country).val('GG')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Isle of Man':\n\t\t\t\t\t\t\tjQuery(elements.country).val('IM')\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tjQuery(elements.country).val(address.country.iso_3166_1_alpha_2);\n\t\t\t\t\t}\n\t\t\t\t\tjQuery(elements.country).trigger('change');\n\n\t\t\t\t\tvar county = {\n\t\t\t\t\t\tpreferred: address.province,\n\t\t\t\t\t\tcode: address.province_code,\n\t\t\t\t\t\tname: address.province_name\n\t\t\t\t\t};\n\n\t\t\t\t\tif(elements.county.list.length == 1){\n\t\t\t\t\t\tc2a.setCounty(elements.county.list[0], county);\n\t\t\t\t\t}\n\t\t\t\t\tif(elements.county.input.length == 2){\n\t\t\t\t\t\tc2a.setCounty(elements.county.input[1], county);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar event = new Event('change')\n\t\t\t\t\telements.county.input[0].dispatchEvent(event);\n\t\t\t\t\telements.county.list[0].dispatchEvent(event);\n\t\t\t\t\telements.company.dispatchEvent(event);\n\t\t\t\t\telements.line_1.dispatchEvent(event);\n\t\t\t\t\telements.line_2.dispatchEvent(event);\n\t\t\t\t\telements.postcode.dispatchEvent(event);\n\t\t\t\t\telements.town.dispatchEvent(event);\n\n\t\t\t\t\tcc_hide_fields(elements,'show');\n\t\t\t\t},\n\t\t\t\tonError: function(){\n\t\t\t\t\tif(typeof this.activeDom.postcode !== 'undefined'){\n\t\t\t\t\t\tcc_hide_fields(this.activeDom,'show');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tc2a_config.advanced.hide_fields = false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttransliterate: c2a_config.advanced.transliterate,\n\t\t\t\tdebug: c2a_config.advanced.debug,\n\t\t\t\tcssPath: false,\n\t\t\t\ttag: 'Magento 2'\n\t\t\t};\n\t\t\tif(typeof c2a_config.enabled_countries !== 'undefined'){\n\t\t\t\tconfig.countryMatchWith = 'iso_2';\n\t\t\t\tconfig.enabledCountries = c2a_config.enabled_countries;\n\t\t\t}\n\t\t\tif(c2a_config.advanced.lock_country_to_dropdown){\n\t\t\t\tconfig.countrySelector = false;\n\t\t\t\tconfig.onSearchFocus = function(c2a, dom){\n\t\t\t\t\tvar currentCountry = dom.country.options[dom.country.selectedIndex].value;\n\t\t\t\t\tif(currentCountry !== ''){\n\t\t\t\t\t\tvar countryCode = getCountryCode(c2a, currentCountry, 'iso_2');\n\t\t\t\t\t\tc2a.selectCountry(countryCode);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcc_holder = new clickToAddress(config);\n\t\t\tsetInterval(cc_m2_c2a,200);\n\t\t}\n\n\t\tif(c2a_config.enabled && c2a_config.key == null){\n\t\t\tconsole.warn('ClickToAddress: Incorrect token format supplied');\n\t\t}\n\t});\n});\n","Magepow_Ajaxcart/js/suggest.js":"define([\n\t'jquery',\n\t'slick'\n\t], function ($) {\n\t\t'use strict';\n\n\t\t$.widget('magepow.suggest', {\n\t\t\toptions: {\n\t\t\t\titemsNumber: 0\n\t\t\t},\n\n\t\t\t_create: function () {\n\t\t\t\tvar options = this.options,\n\t\t\t\t\titems0 = (1 > options.itemsNumber) ? options.itemsNumber : 1,\n\t\t\t\t\titems600 = (2 > options.itemsNumber) ? options.itemsNumber : 2,\n\t\t\t\t\titems1000 = (3 > options.itemsNumber) ? options.itemsNumber : 3;\n\t\t\t\tvar $this  = $(this),\n\t\t\t\t\tslider = $('.ajax-cart-owl-carousel');\n\t\t\t\tslider.on('init', function(event, slick){\n\t\t\t\t    $this._hideLoading();\n\t\t\t\t});\n\t\t\t\tslider.slick({\n\t\t\t\t\t'arrows'          : true,\n\t\t\t\t\t'dots'            : false,\n\t\t\t\t\t'infinite'        : true,\n\t\t\t\t\t'slidesToShow'    : items1000,\n\t\t\t\t\t'responsive'      : [{breakpoint: 999, settings: {slidesToShow: items600}}, {breakpoint: 599, settings: {slidesToShow: items0}}]\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\t_hideLoading: function () {\n\t\t\t\t$('.ajax-owl-loading').hide();\n\t\t\t}\n\t\t});\n\n\t\treturn $.magepow.suggest;\n\t});","Magepow_Ajaxcart/js/ajax.js":"define([\n    'jquery',\n    'mage/translate',\n    'Magento_Ui/js/modal/modal'\n    ], function ($, $t, modal) {\n        'use strict';\n\n        $.widget('magepow.ajaxcart', {\n            options: {\n                processStart: null,\n                processStop : null,\n                bindSubmit  : true,\n                countDown   : 0,\n                showLoader  : true,\n                minicartSelector: '[data-block=\"minicart\"]',\n                messagesSelector: '[data-placeholder=\"messages\"]',\n                productStatusSelector: '.stock.available',\n                addToCartButtonSelector: '.action.tocart',\n                addAllToCartButtonSelector: '.add-all-tocart',\n                addToCartButtonDisabledClass: 'disabled',\n                addToCartButtonTextWhileAdding: '',\n                addToCartButtonTextAdded: '',\n                addToCartButtonTextDefault: '',\n                addUrl: '',\n                quickview: false,\n                isProductView: false,\n                isSuggestPopup: false,\n                quickViewUrl: ''\n            },\n\n            productIdInputName: [\"product\", \"product-id\", \"data-product-id\", \"data-product\"],\n\n            _create: function () {\n                this._initAjaxcart();\n                window.ajaxCart = this;\n                $('body').on('ajaxcart:refresh', function () {\n                    window.ajaxCart._initAjaxcart();\n                });\n                this.getAppVersion('Magepow_Ajaxcart', 'https://magepow.com/magento-2-ajax-add-to-cart.html');\n            },\n\n            _initAjaxcart: function () {\n                var options = this.options;\n                var self = this;\n\n                self.addAllToCart();\n                self.element.off('click').on(\"click\",  options.addToCartButtonSelector, function(e){\n                    if($(this).attr('data-post')) return;// turn off add to cart for wishlist in category page\n                    var form = $(this).parents('form').get(0);\n                    if($(form).hasClass('reorder')) return;// turn off the recently ordered sidebar in category page\n                    e.preventDefault();\n     \n                    var form = $(this).parents('form').get(0);\n                    var data = '';\n                    if (form) {\n                        var isValid = true;\n                        if (options.isProductView || $('body').hasClass('open-quickview')) {\n                            try {\n                                isValid = $(form).valid();\n                            } catch(err) {\n                                isValid = true;\n                            }\n                        }\n\n                        if (isValid) {\n                            var oldAction = $(form).attr('action');\n                            var serialize = $(form).serialize();\n                            var id = self._findId(this, oldAction, form);\n\n                            if ($.isNumeric(id)) {\n                                data += 'id=' + id;\n                                if (serialize == '') {\n                                    $(form).find('input, select').each(function () {\n                                        data += \"&\" + $(this).attr('name') + \"=\" + $(this).val();\n                                    });\n                                } else {\n                                    data += \"&\" + serialize;\n                                }\n\n                                if (options.quickview) {\n                                    window.parent.ajaxCart._sendAjax(options.addUrl, data, oldAction, form);\n                                    return false;\n                                }\n\n                                self._sendAjax(options.addUrl, data, oldAction, form);\n                                return false;\n                            }\n\n                            window.location.href = oldAction;\n                        }\n                    } else {\n                        var dataPost = $.parseJSON($(this).attr('data-post'));\n                        if (dataPost) {\n                            var formKey = $(\"input[name='form_key']\").val();\n                            var oldAction = dataPost.action;\n                            data += 'id=' + dataPost.data.product + '&product=' + dataPost.data.product + '&form_key=' + formKey + '&uenc=' + dataPost.data.uenc;\n                            self._sendAjax(options.addUrl, data, oldAction);\n                            return false;\n                        } else {\n                            var id = self._findId(this);\n                            if (id) {\n                                e.stopImmediatePropagation();\n                                self.quickview(options.quickViewUrl + 'id/' + id);\n                                return false;\n                            }\n                        }\n                    }\n                });\n            },\n          \n            _findId: function (btn, oldAction, form) {\n                var self = this;\n                var id = $(btn).attr('data-product-id');\n                if($.isNumeric(id)) return id;\n                var item = $(btn).closest('li.product-item');\n                id = $(item).find('[data-product-id]').attr('data-product-id');\n                if ($.isNumeric(id)) return id;\n\n                if (oldAction) {\n                    var formData = oldAction.split('/');\n                    for (var i = 0; i < formData.length; i++) {\n                        if (self.productIdInputName.indexOf(formData[i]) >= 0) {\n                            if ($.isNumeric(formData[i + 1])) {\n                                id = formData[i + 1];\n                            }\n                        }\n                    }\n\n                    if ($.isNumeric(id)) return id;\n                }\n\n                if (form) {\n                    $(form).find('input').each(function () {\n                        if (self.productIdInputName.indexOf($(this).attr('name')) >= 0) {\n                            if ($.isNumeric($(this).val())) {\n                                id = $(this).val();\n                            }\n                        }\n                    });\n\n                    if ($.isNumeric(id)) return id;\n                }\n\n                var priceBox = $(btn).closest('.price-box.price-final_price');\n                id = $(priceBox).attr('data-product-id');\n\n                if ($.isNumeric(id)) return id;\n\n                return false;\n            },\n\n            _sendAjax: function (addUrl, data, oldAction, form=false) {\n                var body = $('body');\n                var options = this.options;\n                var self = this;\n                if(form){\n                    self.disableAddToCartButton(form);\n                    data = new FormData(form);\n                }\n                $.ajax({\n                    type: 'post',\n                    url: addUrl,\n                    data: data,\n                    showLoader: options.showLoader,\n                    dataType: 'json',\n                    cache: false,\n                    contentType: false,\n                    processData: false,\n                    success: function (data) {\n                        if(!$('#modals_ajaxcart').length) body.append('<div id=\"modals_ajaxcart\" style=\"display:none\"></div>');\n                        var _qsModal = $('#modals_ajaxcart');\n                        if (data.popup) {\n                            self._showPopup(_qsModal, '<div class=\"content-ajaxcart\">' + data.popup + '</div>');\n                        } else if (data.error && data.view) {\n                            /*show Quick View*/\n                            var quickView = true;\n                            if(form){\n                                var addToCartButtonMain = $(form).closest('#product_addtocart_form');\n                                if(addToCartButtonMain.length) quickView = false;\n                            }\n                            if(quickView && data.error_info.search(\"not available\") == -1){\n                                if ($.fn.quickview) {\n                                    $.fn.quickview({url:options.quickViewUrl  + 'id/' + data['id']});\n                                } else {\n                                    self.quickview({url:options.quickViewUrl  + 'id/' + data['id']});\n                                }\n                            } else {\n                                self._showPopup(_qsModal, data.error_info);\n                            }\n                        }\n\n                        if(form) self.enableAddToCartButton(form);\n                    },\n                    error: function () {\n                        window.location.href = oldAction;\n                    }\n                });\n            },\n\n            _showPopup: function (_qsModal, data) {\n                var body = $('body');\n                self = this;           \n                _qsModal.html(data);\n                if(!body.hasClass('open-ajaxcart')){\n                    self._closePopup();\n                    body.addClass('open-ajaxcart');\n                    var modals = body.find('.modals-ajaxcart');\n                    if(!modals.length){\n                        modal({\n                            type: 'popup',\n                            modalClass: 'modals-ajaxcart',\n                            responsive: true,\n                            innerScroll: true,\n                            buttons: false,\n                            closed: function(){\n                                body.removeClass('open-ajaxcart');                                       \n                            } \n                        }, _qsModal);\n                    }\n                    _qsModal.modal('openModal');\n                    _qsModal.trigger('contentUpdated');\n                }\n                _qsModal.find('.btn-continue').on('click', function() {\n                    self._closePopup();\n                });\n                /*Show count down*/\n                this._showCountdown(); \n            },\n\n            _closePopup: function(){\n                var $body = $('body');\n                $body.removeClass('open-minicart-modal open-ajaxcart open-quickview _has-modal');\n                $body.find('.modal-popup:not(.popup-authentication, .customer-popup-ajaxwishlist), .modals-overlay').remove();\n                $body.find('.modal-popup .action-close').trigger('click');\n                clearInterval(window.ajaxcart_countdown);\n            },\n\n            _showCountdown: function () {\n                self = this;\n                var options = this.options;\n                var countDown = options.countDown;\n                if(countDown > 0) {\n                    window.ajaxcart_countdown = setInterval(function () {\n                        countDown -= 1;\n                        $('.content-ajaxcart span.countdown').text(\"(\" + countDown + \")\");\n                        if (countDown <= 0) {\n                            self._closePopup();\n                        }\n                    }, 1000);\n                }\n            },\n            /**\n             * @param {String} form\n             */\n            disableAddToCartButton: function (form) {\n                var addToCartButtonTextWhileAdding = this.options.addToCartButtonTextWhileAdding || $t('Adding...'),\n                    addToCartButton = $(form).find(this.options.addToCartButtonSelector);\n\n                addToCartButton.addClass(this.options.addToCartButtonDisabledClass);\n                addToCartButton.find('span').text(addToCartButtonTextWhileAdding);\n                addToCartButton.attr('title', addToCartButtonTextWhileAdding);\n            },\n\n            /**\n             * @param {String} form\n             */\n            enableAddToCartButton: function (form) {\n                var addToCartButtonTextAdded = this.options.addToCartButtonTextAdded || $t('Added'),\n                    self = this,\n                    addToCartButton = $(form).find(this.options.addToCartButtonSelector);\n\n                addToCartButton.find('span').text(addToCartButtonTextAdded);\n                addToCartButton.attr('title', addToCartButtonTextAdded);\n\n                setTimeout(function () {\n                    var addToCartButtonTextDefault = self.options.addToCartButtonTextDefault || $t('Add to Cart');\n\n                    addToCartButton.removeClass(self.options.addToCartButtonDisabledClass);\n                    addToCartButton.find('span').text(addToCartButtonTextDefault);\n                    addToCartButton.attr('title', addToCartButtonTextDefault);\n                }, 1000);\n            },\n            \n            quickview: function () {\n                var obj = arguments[0];\n                var body = $('body');\n                if(!$('#modals_quickview').length) body.append('<div id=\"modals_quickview\" style=\"display:none\"></div>');\n                var _qsModal = $('#modals_quickview');\n                var quickajax= function(url){\n                    $.ajax({\n                        url:url,\n                        type:'POST',\n                        showLoader: true,\n                        cache:false,   \n                        success:function(data){\n                            _qsModal.html('<div class=\"content-quickview\">' + data + '</div>');\n                            if(!body.hasClass('open-quickview')){\n                                body.addClass('open-quickview');\n                                var modalsQuickview = body.find('.modals-quickview');\n                                if(!modalsQuickview.length){\n                                    modal({\n                                        type: 'popup',\n                                        modalClass: 'modals-quickview',\n                                        responsive: true,\n                                        innerScroll: true,\n                                        buttons: false,\n                                        closed: function(){\n                                            body.removeClass('open-quickview');                                       \n                                        } \n                                    }, _qsModal);\n                                }\n                                _qsModal.modal('openModal');\n                            }\n                            _qsModal.trigger('contentUpdated');                          \n                        }\n                    });\n                    _qsModal.on('fotorama:load', function(){\n                        _qsModal.find(\".product-view .product-info-main.product-shop\").height(_qsModal.find(\".product-img-box\").height());\n                    });\n                }\n                if(obj.url){\n                    quickajax(obj.url)\n                } else {\n                    $(document).on('click', obj.itemClass, function(e) {\n                        e.preventDefault();\n                        quickajax($(this).data('url'))\n                    });\n                }\n            },\n\n            addAllToCart: function() {\n                var self = this;\n                var options = this.options;\n                $(document).on(\"click\", options.addAllToCartButtonSelector, function(e){\n                    var searchIds = $(\"input[name='product']\").map(function(){return $(this).val();}).get();\n                    $.ajax({\n                        url: options.addUrl + 'index/allcart',\n                        type: 'POST',\n                        showLoader: true,\n                        cache: false,\n                        dataType: 'json',\n                        data: {productIds : searchIds.join()},\n                        success: function (data) {\n                            var _qsModalContent = '<div class=\"content-ajaxcart\">quickview placeholder</div>';\n                            if(!$('#modals_ajaxcart').length){\n                                $(document.body).append('<div id=\"modals_ajaxcart\" style=\"display:none\">' + _qsModalContent + '</div>');\n                            }\n\n                            var _qsModal = $('#modals_ajaxcart .content-ajaxcart');\n                            if (data.error) {\n                                window.location.replace(options.addUrl +'#scroll');\n                            }else{\n                                if (data.popup) {\n                                    self._showPopup(_qsModal, _qsModalContent, data.popup);\n                                }\n                            }\n                            \n                        }\n                    });\n                })                \n            },\n\n            getAppVersion: function (appName, href) {\n                // this expression is to get the version string\n                let regx = new RegExp('.*\\/(.*?)\\/assets\\/', 'i');\n                let result = regx.exec(href);\n                let version = result ? result[1].replace(/\\D/g, '') : '1.0.0';\n                console.log(`%c ${appName} %c v${version}  %c`, \"background: #555555; padding: 1px; margin-bottom: 2px; border-radius: 3px 0 0 3px; color: #fff\", \"background: #44cc11; padding: 1px; margin-bottom: 2px; border-radius: 0 3px 3px 0; color: #fff\", \"background:transparent\", `\ud83d\ude80 ${href}`);\n\n                return version;\n            }\n\n        });\n\n    return $.magepow.ajaxcart;\n});\n","Magepow_Ajaxcart/js/popup.js":"define([\n    'jquery',\n    ], function ($) {\n        'use strict';\n\n        $.widget('magepow.popup', {\n            options: {\n                countDown: 0\n            },\n\n            _create: function () {\n                var self = this;\n                var options = this.options;\n                var countDown = options.countDown;\n\n                if(countDown > 0) {\n                    window.ajaxcart_countdown = setInterval(function () {\n                        countDown -= 1;\n                        $('.content-ajaxcart span.countdown').text(\"(\" + countDown + \")\");\n                        if (countDown <= 0) {\n                            self._closePopup();\n                        }\n                    }, 1000);\n                }\n                \n                $('.content-ajaxcart .btn-continue').on('click', function() {\n                    self._closePopup();\n                });\n\n            },\n\n            _closePopup: function(){\n                // $('.modals-ajaxcart, .modals-overlay').remove();\n                // $('body').removeClass('_has-modal');\n                $('.modals-ajaxcart').find('.action-close').trigger('click');\n                clearInterval(window.ajaxcart_countdown);\n            }\n        });\n\n        return $.magepow.popup;\n    });","Magepow_Ajaxcart/js/goto.js":"define([\n    'jquery'\n    ], function ($) {\n        'use strict';\n\n        $.widget('magepow.gotoproduct', {\n            _create: function () {\n                var self = this;\n\n                self.element.find('a').on('click', function (e) {\n                    e.preventDefault();\n                    window.top.location.href = $(this).attr('href');\n\n                    return false;\n                });\n            }\n        });\n\n        return $.magepow.gotoproduct;\n    });\n","Magepow_Ajaxcart/js/mixin/configurable.js":"define([\n    'jquery'\n], function ($) {\n    'use strict';\n\n    return function (widget) {\n        $.widget('mage.configurable', widget, {\n            /**\n             * Initialize tax configuration, initial settings, and options values.\n             * @private\n             */\n            _initializeOptions: function () {\n                var element;\n\n                element = $(this.options.priceHolderSelector);\n                if (!element.data('magePriceBox')) {\n                    element.priceBox();\n                }\n\n                return this._super();\n            }\n        });\n\n        return $.mage.configurable;\n    };\n});","Magepow_Ajaxcart/js/view/minicartaddons.js":"define([\n       'ko',\n       'uiComponent',\n       'Magento_Customer/js/customer-data',\n   ], function (ko, Component, customerData) {\n       'use strict';\n       var subtotalAmount;\n       var maxPrice = maxpriceShipping;\n       var percentage;\n       return Component.extend({\n           displaySubtotal: ko.observable(true),\n           maxprice:maxPrice.toFixed(2),\n           /**\n            * @override\n            */\n           initialize: function () {\n               this._super();\n               this.cart = customerData.get('cart');\n           },\n           getTotalCartItems: function () {\n               return customerData.get('cart')().summary_count;\n           },\n           getpercentage: function () {\n               subtotalAmount = customerData.get('cart')().subtotalAmount;\n               if (subtotalAmount > maxPrice) {\n                   subtotalAmount = maxPrice;\n               }\n               percentage = ((subtotalAmount * 100) / maxPrice);\n               return percentage;\n           }\n       });\n   });","Magento_GroupedProduct/js/grouped-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'jquery',\n    'underscore',\n    'jquery-ui-modules/widget',\n    'jquery/jquery.parsequery'\n], function ($) {\n    'use strict';\n\n    $.widget('mage.groupedProduct', {\n        options: {\n            qtySelector: 'input.qty',\n            qtyNameSelector: 'super_group'\n        },\n\n        /**\n         * Creates widget\n         * @private\n         */\n        _create: function () {\n            // Override defaults with URL query parameters and/or inputs values\n            this._overrideDefaults();\n        },\n\n        /**\n         * Override default options values settings with either URL query parameters or\n         * initialized inputs values.\n         * @private\n         */\n        _overrideDefaults: function () {\n            var hashIndex = window.location.href.indexOf('#');\n\n            if (hashIndex !== -1) {\n                this._parseQueryParams(window.location.href.substr(hashIndex + 1));\n            }\n        },\n\n        /**\n         * Parse query parameters from a query string and set options values based on the\n         * key value pairs of the parameters.\n         * @param {*} queryString - URL query string containing query parameters.\n         * @private\n         */\n        _parseQueryParams: function (queryString) {\n            var queryParams = $.parseQuery({\n                    query: queryString\n                }),\n                form = this.element,\n                qtyNameSelector = this.options.qtyNameSelector,\n                qtys = $(this.options.qtySelector, form);\n\n            $.each(queryParams, $.proxy(function (key, value) {\n                qtys.each(function (index, qty) {\n                    var nameSelector = qtyNameSelector.concat('[', key, ']');\n\n                    if (qty.name === nameSelector) {\n                        $(qty).val(value);\n                    }\n                });\n            }, this));\n        }\n    });\n\n    return $.mage.groupedProduct;\n});\n","Magento_GroupedProduct/js/product-ids-resolver.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'jquery',\n    'Magento_Catalog/js/product/view/product-ids',\n    'Magento_Catalog/js/product/view/product-info'\n], function ($, productIds, productInfo) {\n    'use strict';\n\n    /**\n     * Returns id's of products in form.\n     *\n     * @param {Object} config\n     * @param {HTMLElement} element\n     * @return {Array}\n     */\n    return function (config, element) {\n        $(element).find('div[data-product-id]').each(function () {\n            productIds.push($(this).data('productId').toString());\n            productInfo.push(\n                {\n                    'id': $(this).data('productId').toString()\n                }\n            );\n        });\n\n        return productIds();\n    };\n});\n","Solwin_Applycoupon/js/fancybox/jquery.fancybox.pack.js":"/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */\ndefine([\n    'jquery'\n], function () {\n    (function (s, H, f, w) {\n        var K = f(\"html\"), q = f(s), p = f(H), b = f.fancybox = function () {\n            b.open.apply(this, arguments)\n        }, J = navigator.userAgent.match(/msie/i), C = null, t = H.createTouch !== w, u = function (a) {\n            return a && a.hasOwnProperty && a instanceof f\n        }, r = function (a) {\n            return a && \"string\" === f.type(a)\n        }, F = function (a) {\n            return r(a) && 0 < a.indexOf(\"%\")\n        }, m = function (a, d) {\n            var e = parseInt(a, 10) || 0;\n            d && F(a) && (e *= b.getViewport()[d] / 100);\n            return Math.ceil(e)\n        }, x = function (a, b) {\n            return m(a, b) + \"px\"\n        };\n        f.extend(b, {version: \"2.1.5\", defaults: {padding: 15, margin: 20,\n                width: 800, height: 600, minWidth: 100, minHeight: 100, maxWidth: 9999, maxHeight: 9999, pixelRatio: 1, autoSize: !0, autoHeight: !1, autoWidth: !1, autoResize: !0, autoCenter: !t, fitToView: !0, aspectRatio: !1, topRatio: 0.5, leftRatio: 0.5, scrolling: \"auto\", wrapCSS: \"\", arrows: !0, closeBtn: !0, closeClick: !1, nextClick: !1, mouseWheel: !0, autoPlay: !1, playSpeed: 3E3, preload: 3, modal: !1, loop: !0, ajax: {dataType: \"html\", headers: {\"X-fancyBox\": !0}}, iframe: {scrolling: \"auto\", preload: !0}, swf: {wmode: \"transparent\", allowfullscreen: \"true\", allowscriptaccess: \"always\"},\n                keys: {next: {13: \"left\", 34: \"up\", 39: \"left\", 40: \"up\"}, prev: {8: \"right\", 33: \"down\", 37: \"right\", 38: \"down\"}, close: [27], play: [32], toggle: [70]}, direction: {next: \"left\", prev: \"right\"}, scrollOutside: !0, index: 0, type: null, href: null, content: null, title: null, tpl: {wrap: '<div class=\"fancybox-wrap\" tabIndex=\"-1\"><div class=\"fancybox-skin\"><div class=\"fancybox-outer\"><div class=\"fancybox-inner\"></div></div></div></div>', image: '<img class=\"fancybox-image\" src=\"{href}\" alt=\"\" />', iframe: '<iframe id=\"fancybox-frame{rnd}\" name=\"fancybox-frame{rnd}\" class=\"fancybox-iframe\" frameborder=\"0\" vspace=\"0\" hspace=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen' +\n                            (J ? ' allowtransparency=\"true\"' : \"\") + \"></iframe>\", error: '<p class=\"fancybox-error\">The requested content cannot be loaded.<br/>Please try again later.</p>', closeBtn: '<a title=\"Close\" class=\"fancybox-item fancybox-close\" href=\"javascript:;\"></a>', next: '<a title=\"Next\" class=\"fancybox-nav fancybox-next\" href=\"javascript:;\"><span></span></a>', prev: '<a title=\"Previous\" class=\"fancybox-nav fancybox-prev\" href=\"javascript:;\"><span></span></a>'}, openEffect: \"fade\", openSpeed: 250, openEasing: \"swing\", openOpacity: !0,\n                openMethod: \"zoomIn\", closeEffect: \"fade\", closeSpeed: 250, closeEasing: \"swing\", closeOpacity: !0, closeMethod: \"zoomOut\", nextEffect: \"elastic\", nextSpeed: 250, nextEasing: \"swing\", nextMethod: \"changeIn\", prevEffect: \"elastic\", prevSpeed: 250, prevEasing: \"swing\", prevMethod: \"changeOut\", helpers: {overlay: !0, title: !0}, onCancel: f.noop, beforeLoad: f.noop, afterLoad: f.noop, beforeShow: f.noop, afterShow: f.noop, beforeChange: f.noop, beforeClose: f.noop, afterClose: f.noop}, group: {}, opts: {}, previous: null, coming: null, current: null, isActive: !1,\n            isOpen: !1, isOpened: !1, wrap: null, skin: null, outer: null, inner: null, player: {timer: null, isActive: !1}, ajaxLoad: null, imgPreload: null, transitions: {}, helpers: {}, open: function (a, d) {\n                if (a && (f.isPlainObject(d) || (d = {}), !1 !== b.close(!0)))\n                    return f.isArray(a) || (a = u(a) ? f(a).get() : [a]), f.each(a, function (e, c) {\n                        var l = {}, g, h, k, n, m;\n                        \"object\" === f.type(c) && (c.nodeType && (c = f(c)), u(c) ? (l = {href: c.data(\"fancybox-href\") || c.attr(\"href\"), title: f(\"<div/>\").text(c.data(\"fancybox-title\") || c.attr(\"title\")).html(), isDom: !0, element: c},\n                        f.metadata && f.extend(!0, l, c.metadata())) : l = c);\n                        g = d.href || l.href || (r(c) ? c : null);\n                        h = d.title !== w ? d.title : l.title || \"\";\n                        n = (k = d.content || l.content) ? \"html\" : d.type || l.type;\n                        !n && l.isDom && (n = c.data(\"fancybox-type\"), n || (n = (n = c.prop(\"class\").match(/fancybox\\.(\\w+)/)) ? n[1] : null));\n                        r(g) && (n || (b.isImage(g) ? n = \"image\" : b.isSWF(g) ? n = \"swf\" : \"#\" === g.charAt(0) ? n = \"inline\" : r(c) && (n = \"html\", k = c)), \"ajax\" === n && (m = g.split(/\\s+/, 2), g = m.shift(), m = m.shift()));\n                        k || (\"inline\" === n ? g ? k = f(r(g) ? g.replace(/.*(?=#[^\\s]+$)/, \"\") : g) : l.isDom && (k = c) :\n                                \"html\" === n ? k = g : n || g || !l.isDom || (n = \"inline\", k = c));\n                        f.extend(l, {href: g, type: n, content: k, title: h, selector: m});\n                        a[e] = l\n                    }), b.opts = f.extend(!0, {}, b.defaults, d), d.keys !== w && (b.opts.keys = d.keys ? f.extend({}, b.defaults.keys, d.keys) : !1), b.group = a, b._start(b.opts.index)\n            }, cancel: function () {\n                var a = b.coming;\n                a && !1 === b.trigger(\"onCancel\") || (b.hideLoading(), a && (b.ajaxLoad && b.ajaxLoad.abort(), b.ajaxLoad = null, b.imgPreload && (b.imgPreload.onload = b.imgPreload.onerror = null), a.wrap && a.wrap.stop(!0, !0).trigger(\"onReset\").remove(),\n                        b.coming = null, b.current || b._afterZoomOut(a)))\n            }, close: function (a) {\n                b.cancel();\n                !1 !== b.trigger(\"beforeClose\") && (b.unbindEvents(), b.isActive && (b.isOpen && !0 !== a ? (b.isOpen = b.isOpened = !1, b.isClosing = !0, f(\".fancybox-item, .fancybox-nav\").remove(), b.wrap.stop(!0, !0).removeClass(\"fancybox-opened\"), b.transitions[b.current.closeMethod]()) : (f(\".fancybox-wrap\").stop(!0).trigger(\"onReset\").remove(), b._afterZoomOut())))\n            }, play: function (a) {\n                var d = function () {\n                    clearTimeout(b.player.timer)\n                }, e = function () {\n                    d();\n                    b.current && b.player.isActive &&\n                            (b.player.timer = setTimeout(b.next, b.current.playSpeed))\n                }, c = function () {\n                    d();\n                    p.unbind(\".player\");\n                    b.player.isActive = !1;\n                    b.trigger(\"onPlayEnd\")\n                };\n                !0 === a || !b.player.isActive && !1 !== a ? b.current && (b.current.loop || b.current.index < b.group.length - 1) && (b.player.isActive = !0, p.bind({\"onCancel.player beforeClose.player\": c, \"onUpdate.player\": e, \"beforeLoad.player\": d}), e(), b.trigger(\"onPlayStart\")) : c()\n            }, next: function (a) {\n                var d = b.current;\n                d && (r(a) || (a = d.direction.next), b.jumpto(d.index + 1, a, \"next\"))\n            }, prev: function (a) {\n                var d =\n                        b.current;\n                d && (r(a) || (a = d.direction.prev), b.jumpto(d.index - 1, a, \"prev\"))\n            }, jumpto: function (a, d, e) {\n                var c = b.current;\n                c && (a = m(a), b.direction = d || c.direction[a >= c.index ? \"next\" : \"prev\"], b.router = e || \"jumpto\", c.loop && (0 > a && (a = c.group.length + a % c.group.length), a %= c.group.length), c.group[a] !== w && (b.cancel(), b._start(a)))\n            }, reposition: function (a, d) {\n                var e = b.current, c = e ? e.wrap : null, l;\n                c && (l = b._getPosition(d), a && \"scroll\" === a.type ? (delete l.position, c.stop(!0, !0).animate(l, 200)) : (c.css(l), e.pos = f.extend({}, e.dim, l)))\n            },\n            update: function (a) {\n                var d = a && a.originalEvent && a.originalEvent.type, e = !d || \"orientationchange\" === d;\n                e && (clearTimeout(C), C = null);\n                b.isOpen && !C && (C = setTimeout(function () {\n                    var c = b.current;\n                    c && !b.isClosing && (b.wrap.removeClass(\"fancybox-tmp\"), (e || \"load\" === d || \"resize\" === d && c.autoResize) && b._setDimension(), \"scroll\" === d && c.canShrink || b.reposition(a), b.trigger(\"onUpdate\"), C = null)\n                }, e && !t ? 0 : 300))\n            }, toggle: function (a) {\n                b.isOpen && (b.current.fitToView = \"boolean\" === f.type(a) ? a : !b.current.fitToView, t && (b.wrap.removeAttr(\"style\").addClass(\"fancybox-tmp\"),\n                        b.trigger(\"onUpdate\")), b.update())\n            }, hideLoading: function () {\n                p.unbind(\".loading\");\n                f(\"#fancybox-loading\").remove()\n            }, showLoading: function () {\n                var a, d;\n                b.hideLoading();\n                a = f('<div id=\"fancybox-loading\"><div></div></div>').click(b.cancel).appendTo(\"body\");\n                p.bind(\"keydown.loading\", function (a) {\n                    27 === (a.which || a.keyCode) && (a.preventDefault(), b.cancel())\n                });\n                b.defaults.fixed || (d = b.getViewport(), a.css({position: \"absolute\", top: 0.5 * d.h + d.y, left: 0.5 * d.w + d.x}));\n                b.trigger(\"onLoading\")\n            }, getViewport: function () {\n                var a = b.current &&\n                        b.current.locked || !1, d = {x: q.scrollLeft(), y: q.scrollTop()};\n                a && a.length ? (d.w = a[0].clientWidth, d.h = a[0].clientHeight) : (d.w = t && s.innerWidth ? s.innerWidth : q.width(), d.h = t && s.innerHeight ? s.innerHeight : q.height());\n                return d\n            }, unbindEvents: function () {\n                b.wrap && u(b.wrap) && b.wrap.unbind(\".fb\");\n                p.unbind(\".fb\");\n                q.unbind(\".fb\")\n            }, bindEvents: function () {\n                var a = b.current, d;\n                a && (q.bind(\"orientationchange.fb\" + (t ? \"\" : \" resize.fb\") + (a.autoCenter && !a.locked ? \" scroll.fb\" : \"\"), b.update), (d = a.keys) && p.bind(\"keydown.fb\", function (e) {\n                    var c =\n                            e.which || e.keyCode, l = e.target || e.srcElement;\n                    if (27 === c && b.coming)\n                        return!1;\n                    e.ctrlKey || e.altKey || e.shiftKey || e.metaKey || l && (l.type || f(l).is(\"[contenteditable]\")) || f.each(d, function (d, l) {\n                        if (1 < a.group.length && l[c] !== w)\n                            return b[d](l[c]), e.preventDefault(), !1;\n                        if (-1 < f.inArray(c, l))\n                            return b[d](), e.preventDefault(), !1\n                    })\n                }), f.fn.mousewheel && a.mouseWheel && b.wrap.bind(\"mousewheel.fb\", function (d, c, l, g) {\n                    for (var h = f(d.target || null), k = !1; h.length && !(k || h.is(\".fancybox-skin\") || h.is(\".fancybox-wrap\")); )\n                        k = h[0] && !(h[0].style.overflow &&\n                                \"hidden\" === h[0].style.overflow) && (h[0].clientWidth && h[0].scrollWidth > h[0].clientWidth || h[0].clientHeight && h[0].scrollHeight > h[0].clientHeight), h = f(h).parent();\n                    0 !== c && !k && 1 < b.group.length && !a.canShrink && (0 < g || 0 < l ? b.prev(0 < g ? \"down\" : \"left\") : (0 > g || 0 > l) && b.next(0 > g ? \"up\" : \"right\"), d.preventDefault())\n                }))\n            }, trigger: function (a, d) {\n                var e, c = d || b.coming || b.current;\n                if (c) {\n                    f.isFunction(c[a]) && (e = c[a].apply(c, Array.prototype.slice.call(arguments, 1)));\n                    if (!1 === e)\n                        return!1;\n                    c.helpers && f.each(c.helpers, function (d, e) {\n                        if (e &&\n                                b.helpers[d] && f.isFunction(b.helpers[d][a]))\n                            b.helpers[d][a](f.extend(!0, {}, b.helpers[d].defaults, e), c)\n                    })\n                }\n                p.trigger(a)\n            }, isImage: function (a) {\n                return r(a) && a.match(/(^data:image\\/.*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\\?|#).*)?$)/i)\n            }, isSWF: function (a) {\n                return r(a) && a.match(/\\.(swf)((\\?|#).*)?$/i)\n            }, _start: function (a) {\n                var d = {}, e, c;\n                a = m(a);\n                e = b.group[a] || null;\n                if (!e)\n                    return!1;\n                d = f.extend(!0, {}, b.opts, e);\n                e = d.margin;\n                c = d.padding;\n                \"number\" === f.type(e) && (d.margin = [e, e, e, e]);\n                \"number\" === f.type(c) && (d.padding = [c, c,\n                    c, c]);\n                d.modal && f.extend(!0, d, {closeBtn: !1, closeClick: !1, nextClick: !1, arrows: !1, mouseWheel: !1, keys: null, helpers: {overlay: {closeClick: !1}}});\n                d.autoSize && (d.autoWidth = d.autoHeight = !0);\n                \"auto\" === d.width && (d.autoWidth = !0);\n                \"auto\" === d.height && (d.autoHeight = !0);\n                d.group = b.group;\n                d.index = a;\n                b.coming = d;\n                if (!1 === b.trigger(\"beforeLoad\"))\n                    b.coming = null;\n                else {\n                    c = d.type;\n                    e = d.href;\n                    if (!c)\n                        return b.coming = null, b.current && b.router && \"jumpto\" !== b.router ? (b.current.index = a, b[b.router](b.direction)) : !1;\n                    b.isActive = !0;\n                    if (\"image\" ===\n                            c || \"swf\" === c)\n                        d.autoHeight = d.autoWidth = !1, d.scrolling = \"visible\";\n                    \"image\" === c && (d.aspectRatio = !0);\n                    \"iframe\" === c && t && (d.scrolling = \"scroll\");\n                    d.wrap = f(d.tpl.wrap).addClass(\"fancybox-\" + (t ? \"mobile\" : \"desktop\") + \" fancybox-type-\" + c + \" fancybox-tmp \" + d.wrapCSS).appendTo(d.parent || \"body\");\n                    f.extend(d, {skin: f(\".fancybox-skin\", d.wrap), outer: f(\".fancybox-outer\", d.wrap), inner: f(\".fancybox-inner\", d.wrap)});\n                    f.each([\"Top\", \"Right\", \"Bottom\", \"Left\"], function (a, b) {\n                        d.skin.css(\"padding\" + b, x(d.padding[a]))\n                    });\n                    b.trigger(\"onReady\");\n                    if (\"inline\" === c || \"html\" === c) {\n                        if (!d.content || !d.content.length)\n                            return b._error(\"content\")\n                    } else if (!e)\n                        return b._error(\"href\");\n                    \"image\" === c ? b._loadImage() : \"ajax\" === c ? b._loadAjax() : \"iframe\" === c ? b._loadIframe() : b._afterLoad()\n                }\n            }, _error: function (a) {\n                f.extend(b.coming, {type: \"html\", autoWidth: !0, autoHeight: !0, minWidth: 0, minHeight: 0, scrolling: \"no\", hasError: a, content: b.coming.tpl.error});\n                b._afterLoad()\n            }, _loadImage: function () {\n                var a = b.imgPreload = new Image;\n                a.onload = function () {\n                    this.onload = this.onerror = null;\n                    b.coming.width =\n                            this.width / b.opts.pixelRatio;\n                    b.coming.height = this.height / b.opts.pixelRatio;\n                    b._afterLoad()\n                };\n                a.onerror = function () {\n                    this.onload = this.onerror = null;\n                    b._error(\"image\")\n                };\n                a.src = b.coming.href;\n                !0 !== a.complete && b.showLoading()\n            }, _loadAjax: function () {\n                var a = b.coming;\n                b.showLoading();\n                b.ajaxLoad = f.ajax(f.extend({}, a.ajax, {url: a.href, error: function (a, e) {\n                        b.coming && \"abort\" !== e ? b._error(\"ajax\", a) : b.hideLoading()\n                    }, success: function (d, e) {\n                        \"success\" === e && (a.content = d, b._afterLoad())\n                    }}))\n            }, _loadIframe: function () {\n                var a = b.coming,\n                        d = f(a.tpl.iframe.replace(/\\{rnd\\}/g, (new Date).getTime())).attr(\"scrolling\", t ? \"auto\" : a.iframe.scrolling).attr(\"src\", a.href);\n                f(a.wrap).bind(\"onReset\", function () {\n                    try {\n                        f(this).find(\"iframe\").hide().attr(\"src\", \"//about:blank\").end().empty()\n                    } catch (a) {\n                    }\n                });\n                a.iframe.preload && (b.showLoading(), d.one(\"load\", function () {\n                    f(this).data(\"ready\", 1);\n                    t || f(this).bind(\"load.fb\", b.update);\n                    f(this).parents(\".fancybox-wrap\").width(\"100%\").removeClass(\"fancybox-tmp\").show();\n                    b._afterLoad()\n                }));\n                a.content = d.appendTo(a.inner);\n                a.iframe.preload ||\n                        b._afterLoad()\n            }, _preloadImages: function () {\n                var a = b.group, d = b.current, e = a.length, c = d.preload ? Math.min(d.preload, e - 1) : 0, f, g;\n                for (g = 1; g <= c; g += 1)\n                    f = a[(d.index + g) % e], \"image\" === f.type && f.href && ((new Image).src = f.href)\n            }, _afterLoad: function () {\n                var a = b.coming, d = b.current, e, c, l, g, h;\n                b.hideLoading();\n                if (a && !1 !== b.isActive)\n                    if (!1 === b.trigger(\"afterLoad\", a, d))\n                        a.wrap.stop(!0).trigger(\"onReset\").remove(), b.coming = null;\n                    else {\n                        d && (b.trigger(\"beforeChange\", d), d.wrap.stop(!0).removeClass(\"fancybox-opened\").find(\".fancybox-item, .fancybox-nav\").remove());\n                        b.unbindEvents();\n                        e = a.content;\n                        c = a.type;\n                        l = a.scrolling;\n                        f.extend(b, {wrap: a.wrap, skin: a.skin, outer: a.outer, inner: a.inner, current: a, previous: d});\n                        g = a.href;\n                        switch (c) {\n                            case \"inline\":\n                            case \"ajax\":\n                            case \"html\":\n                                a.selector ? e = f(\"<div>\").html(e).find(a.selector) : u(e) && (e.data(\"fancybox-placeholder\") || e.data(\"fancybox-placeholder\", f('<div class=\"fancybox-placeholder\"></div>').insertAfter(e).hide()), e = e.show().detach(), a.wrap.bind(\"onReset\", function () {\n                                    f(this).find(e).length && e.hide().replaceAll(e.data(\"fancybox-placeholder\")).data(\"fancybox-placeholder\",\n                                            !1)\n                                }));\n                                break;\n                            case \"image\":\n                                e = a.tpl.image.replace(/\\{href\\}/g, g);\n                                break;\n                            case \"swf\":\n                                e = '<object id=\"fancybox-swf\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"100%\" height=\"100%\"><param name=\"movie\" value=\"' + g + '\"></param>', h = \"\", f.each(a.swf, function (a, b) {\n                                    e += '<param name=\"' + a + '\" value=\"' + b + '\"></param>';\n                                    h += \" \" + a + '=\"' + b + '\"'\n                                }), e += '<embed src=\"' + g + '\" type=\"application/x-shockwave-flash\" width=\"100%\" height=\"100%\"' + h + \"></embed></object>\"\n                        }\n                        u(e) && e.parent().is(a.inner) || a.inner.append(e);\n                        b.trigger(\"beforeShow\");\n                        a.inner.css(\"overflow\", \"yes\" === l ? \"scroll\" : \"no\" === l ? \"hidden\" : l);\n                        b._setDimension();\n                        b.reposition();\n                        b.isOpen = !1;\n                        b.coming = null;\n                        b.bindEvents();\n                        if (!b.isOpened)\n                            f(\".fancybox-wrap\").not(a.wrap).stop(!0).trigger(\"onReset\").remove();\n                        else if (d.prevMethod)\n                            b.transitions[d.prevMethod]();\n                        b.transitions[b.isOpened ? a.nextMethod : a.openMethod]();\n                        b._preloadImages()\n                    }\n            }, _setDimension: function () {\n                var a = b.getViewport(), d = 0, e = !1, c = !1, e = b.wrap, l = b.skin, g = b.inner, h = b.current, c = h.width, k = h.height, n = h.minWidth, v = h.minHeight, p = h.maxWidth,\n                        q = h.maxHeight, t = h.scrolling, r = h.scrollOutside ? h.scrollbarWidth : 0, y = h.margin, z = m(y[1] + y[3]), s = m(y[0] + y[2]), w, A, u, D, B, G, C, E, I;\n                e.add(l).add(g).width(\"auto\").height(\"auto\").removeClass(\"fancybox-tmp\");\n                y = m(l.outerWidth(!0) - l.width());\n                w = m(l.outerHeight(!0) - l.height());\n                A = z + y;\n                u = s + w;\n                D = F(c) ? (a.w - A) * m(c) / 100 : c;\n                B = F(k) ? (a.h - u) * m(k) / 100 : k;\n                if (\"iframe\" === h.type) {\n                    if (I = h.content, h.autoHeight && 1 === I.data(\"ready\"))\n                        try {\n                            I[0].contentWindow.document.location && (g.width(D).height(9999), G = I.contents().find(\"body\"), r && G.css(\"overflow-x\",\n                                    \"hidden\"), B = G.outerHeight(!0))\n                        } catch (H) {\n                        }\n                } else if (h.autoWidth || h.autoHeight)\n                    g.addClass(\"fancybox-tmp\"), h.autoWidth || g.width(D), h.autoHeight || g.height(B), h.autoWidth && (D = g.width()), h.autoHeight && (B = g.height()), g.removeClass(\"fancybox-tmp\");\n                c = m(D);\n                k = m(B);\n                E = D / B;\n                n = m(F(n) ? m(n, \"w\") - A : n);\n                p = m(F(p) ? m(p, \"w\") - A : p);\n                v = m(F(v) ? m(v, \"h\") - u : v);\n                q = m(F(q) ? m(q, \"h\") - u : q);\n                G = p;\n                C = q;\n                h.fitToView && (p = Math.min(a.w - A, p), q = Math.min(a.h - u, q));\n                A = a.w - z;\n                s = a.h - s;\n                h.aspectRatio ? (c > p && (c = p, k = m(c / E)), k > q && (k = q, c = m(k * E)), c < n && (c = n, k = m(c /\n                        E)), k < v && (k = v, c = m(k * E))) : (c = Math.max(n, Math.min(c, p)), h.autoHeight && \"iframe\" !== h.type && (g.width(c), k = g.height()), k = Math.max(v, Math.min(k, q)));\n                if (h.fitToView)\n                    if (g.width(c).height(k), e.width(c + y), a = e.width(), z = e.height(), h.aspectRatio)\n                        for (; (a > A || z > s) && c > n && k > v && !(19 < d++); )\n                            k = Math.max(v, Math.min(q, k - 10)), c = m(k * E), c < n && (c = n, k = m(c / E)), c > p && (c = p, k = m(c / E)), g.width(c).height(k), e.width(c + y), a = e.width(), z = e.height();\n                    else\n                        c = Math.max(n, Math.min(c, c - (a - A))), k = Math.max(v, Math.min(k, k - (z - s)));\n                r && \"auto\" === t && k < B &&\n                        c + y + r < A && (c += r);\n                g.width(c).height(k);\n                e.width(c + y);\n                a = e.width();\n                z = e.height();\n                e = (a > A || z > s) && c > n && k > v;\n                c = h.aspectRatio ? c < G && k < C && c < D && k < B : (c < G || k < C) && (c < D || k < B);\n                f.extend(h, {dim: {width: x(a), height: x(z)}, origWidth: D, origHeight: B, canShrink: e, canExpand: c, wPadding: y, hPadding: w, wrapSpace: z - l.outerHeight(!0), skinSpace: l.height() - k});\n                !I && h.autoHeight && k > v && k < q && !c && g.height(\"auto\")\n            }, _getPosition: function (a) {\n                var d = b.current, e = b.getViewport(), c = d.margin, f = b.wrap.width() + c[1] + c[3], g = b.wrap.height() + c[0] + c[2], c = {position: \"absolute\",\n                    top: c[0], left: c[3]};\n                d.autoCenter && d.fixed && !a && g <= e.h && f <= e.w ? c.position = \"fixed\" : d.locked || (c.top += e.y, c.left += e.x);\n                c.top = x(Math.max(c.top, c.top + (e.h - g) * d.topRatio));\n                c.left = x(Math.max(c.left, c.left + (e.w - f) * d.leftRatio));\n                return c\n            }, _afterZoomIn: function () {\n                var a = b.current;\n                a && ((b.isOpen = b.isOpened = !0, b.wrap.css(\"overflow\", \"visible\").addClass(\"fancybox-opened\"), b.update(), (a.closeClick || a.nextClick && 1 < b.group.length) && b.inner.css(\"cursor\", \"pointer\").bind(\"click.fb\", function (d) {\n                    f(d.target).is(\"a\") || f(d.target).parent().is(\"a\") ||\n                            (d.preventDefault(), b[a.closeClick ? \"close\" : \"next\"]())\n                }), a.closeBtn && f(a.tpl.closeBtn).appendTo(b.skin).bind(\"click.fb\", function (a) {\n                    a.preventDefault();\n                    b.close()\n                }), a.arrows && 1 < b.group.length && ((a.loop || 0 < a.index) && f(a.tpl.prev).appendTo(b.outer).bind(\"click.fb\", b.prev), (a.loop || a.index < b.group.length - 1) && f(a.tpl.next).appendTo(b.outer).bind(\"click.fb\", b.next)), b.trigger(\"afterShow\"), a.loop || a.index !== a.group.length - 1) ? b.opts.autoPlay && !b.player.isActive && (b.opts.autoPlay = !1, b.play(!0)) : b.play(!1))\n            },\n            _afterZoomOut: function (a) {\n                a = a || b.current;\n                f(\".fancybox-wrap\").trigger(\"onReset\").remove();\n                f.extend(b, {group: {}, opts: {}, router: !1, current: null, isActive: !1, isOpened: !1, isOpen: !1, isClosing: !1, wrap: null, skin: null, outer: null, inner: null});\n                b.trigger(\"afterClose\", a)\n            }});\n        b.transitions = {getOrigPosition: function () {\n                var a = b.current, d = a.element, e = a.orig, c = {}, f = 50, g = 50, h = a.hPadding, k = a.wPadding, n = b.getViewport();\n                !e && a.isDom && d.is(\":visible\") && (e = d.find(\"img:first\"), e.length || (e = d));\n                u(e) ? (c = e.offset(), e.is(\"img\") &&\n                        (f = e.outerWidth(), g = e.outerHeight())) : (c.top = n.y + (n.h - g) * a.topRatio, c.left = n.x + (n.w - f) * a.leftRatio);\n                if (\"fixed\" === b.wrap.css(\"position\") || a.locked)\n                    c.top -= n.y, c.left -= n.x;\n                return c = {top: x(c.top - h * a.topRatio), left: x(c.left - k * a.leftRatio), width: x(f + k), height: x(g + h)}\n            }, step: function (a, d) {\n                var e, c, f = d.prop;\n                c = b.current;\n                var g = c.wrapSpace, h = c.skinSpace;\n                if (\"width\" === f || \"height\" === f)\n                    e = d.end === d.start ? 1 : (a - d.start) / (d.end - d.start), b.isClosing && (e = 1 - e), c = \"width\" === f ? c.wPadding : c.hPadding, c = a - c, b.skin[f](m(\"width\" ===\n                            f ? c : c - g * e)), b.inner[f](m(\"width\" === f ? c : c - g * e - h * e))\n            }, zoomIn: function () {\n                var a = b.current, d = a.pos, e = a.openEffect, c = \"elastic\" === e, l = f.extend({opacity: 1}, d);\n                delete l.position;\n                c ? (d = this.getOrigPosition(), a.openOpacity && (d.opacity = 0.1)) : \"fade\" === e && (d.opacity = 0.1);\n                b.wrap.css(d).animate(l, {duration: \"none\" === e ? 0 : a.openSpeed, easing: a.openEasing, step: c ? this.step : null, complete: b._afterZoomIn})\n            }, zoomOut: function () {\n                var a = b.current, d = a.closeEffect, e = \"elastic\" === d, c = {opacity: 0.1};\n                e && (c = this.getOrigPosition(), a.closeOpacity &&\n                        (c.opacity = 0.1));\n                b.wrap.animate(c, {duration: \"none\" === d ? 0 : a.closeSpeed, easing: a.closeEasing, step: e ? this.step : null, complete: b._afterZoomOut})\n            }, changeIn: function () {\n                var a = b.current, d = a.nextEffect, e = a.pos, c = {opacity: 1}, f = b.direction, g;\n                e.opacity = 0.1;\n                \"elastic\" === d && (g = \"down\" === f || \"up\" === f ? \"top\" : \"left\", \"down\" === f || \"right\" === f ? (e[g] = x(m(e[g]) - 200), c[g] = \"+=200px\") : (e[g] = x(m(e[g]) + 200), c[g] = \"-=200px\"));\n                \"none\" === d ? b._afterZoomIn() : b.wrap.css(e).animate(c, {duration: a.nextSpeed, easing: a.nextEasing, complete: b._afterZoomIn})\n            },\n            changeOut: function () {\n                var a = b.previous, d = a.prevEffect, e = {opacity: 0.1}, c = b.direction;\n                \"elastic\" === d && (e[\"down\" === c || \"up\" === c ? \"top\" : \"left\"] = (\"up\" === c || \"left\" === c ? \"-\" : \"+\") + \"=200px\");\n                a.wrap.animate(e, {duration: \"none\" === d ? 0 : a.prevSpeed, easing: a.prevEasing, complete: function () {\n                        f(this).trigger(\"onReset\").remove()\n                    }})\n            }};\n        b.helpers.overlay = {defaults: {closeClick: !0, speedOut: 200, showEarly: !0, css: {}, locked: !t, fixed: !0}, overlay: null, fixed: !1, el: f(\"html\"), create: function (a) {\n                var d;\n                a = f.extend({}, this.defaults, a);\n                this.overlay &&\n                        this.close();\n                d = b.coming ? b.coming.parent : a.parent;\n                this.overlay = f('<div class=\"fancybox-overlay\"></div>').appendTo(d && d.lenth ? d : \"body\");\n                this.fixed = !1;\n                a.fixed && b.defaults.fixed && (this.overlay.addClass(\"fancybox-overlay-fixed\"), this.fixed = !0)\n            }, open: function (a) {\n                var d = this;\n                a = f.extend({}, this.defaults, a);\n                this.overlay ? this.overlay.unbind(\".overlay\").width(\"auto\").height(\"auto\") : this.create(a);\n                this.fixed || (q.bind(\"resize.overlay\", f.proxy(this.update, this)), this.update());\n                a.closeClick && this.overlay.bind(\"click.overlay\",\n                        function (a) {\n                            if (f(a.target).hasClass(\"fancybox-overlay\"))\n                                return b.isActive ? b.close() : d.close(), !1\n                        });\n                this.overlay.css(a.css).show()\n            }, close: function () {\n                q.unbind(\"resize.overlay\");\n                this.el.hasClass(\"fancybox-lock\") && (f(\".fancybox-margin\").removeClass(\"fancybox-margin\"), this.el.removeClass(\"fancybox-lock\"), q.scrollTop(this.scrollV).scrollLeft(this.scrollH));\n                f(\".fancybox-overlay\").remove().hide();\n                f.extend(this, {overlay: null, fixed: !1})\n            }, update: function () {\n                var a = \"100%\", b;\n                this.overlay.width(a).height(\"100%\");\n                J ? (b = Math.max(H.documentElement.offsetWidth, H.body.offsetWidth), p.width() > b && (a = p.width())) : p.width() > q.width() && (a = p.width());\n                this.overlay.width(a).height(p.height())\n            }, onReady: function (a, b) {\n                var e = this.overlay;\n                f(\".fancybox-overlay\").stop(!0, !0);\n                e || this.create(a);\n                a.locked && this.fixed && b.fixed && (b.locked = this.overlay.append(b.wrap), b.fixed = !1);\n                !0 === a.showEarly && this.beforeShow.apply(this, arguments)\n            }, beforeShow: function (a, b) {\n                b.locked && !this.el.hasClass(\"fancybox-lock\") && (!1 !== this.fixPosition && f(\"*\").filter(function () {\n                    return\"fixed\" ===\n                            f(this).css(\"position\") && !f(this).hasClass(\"fancybox-overlay\") && !f(this).hasClass(\"fancybox-wrap\")\n                }).addClass(\"fancybox-margin\"), this.el.addClass(\"fancybox-margin\"), this.scrollV = q.scrollTop(), this.scrollH = q.scrollLeft(), this.el.addClass(\"fancybox-lock\"), q.scrollTop(this.scrollV).scrollLeft(this.scrollH));\n                this.open(a)\n            }, onUpdate: function () {\n                this.fixed || this.update()\n            }, afterClose: function (a) {\n                this.overlay && !b.coming && this.overlay.fadeOut(a.speedOut, f.proxy(this.close, this))\n            }};\n        b.helpers.title = {defaults: {type: \"float\",\n                position: \"bottom\"}, beforeShow: function (a) {\n                var d = b.current, e = d.title, c = a.type;\n                f.isFunction(e) && (e = e.call(d.element, d));\n                if (r(e) && \"\" !== f.trim(e)) {\n                    d = f('<div class=\"fancybox-title fancybox-title-' + c + '-wrap\">' + e + \"</div>\");\n                    switch (c) {\n                        case \"inside\":\n                            c = b.skin;\n                            break;\n                        case \"outside\":\n                            c = b.wrap;\n                            break;\n                        case \"over\":\n                            c = b.inner;\n                            break;\n                        default:\n                            c = b.skin, d.appendTo(\"body\"), J && d.width(d.width()), d.wrapInner('<span class=\"child\"></span>'), b.current.margin[2] += Math.abs(m(d.css(\"margin-bottom\")))\n                    }\n                    d[\"top\" === a.position ? \"prependTo\" :\n                            \"appendTo\"](c)\n                }\n            }};\n        f.fn.fancybox = function (a) {\n            var d, e = f(this), c = this.selector || \"\", l = function (g) {\n                var h = f(this).blur(), k = d, l, m;\n                g.ctrlKey || g.altKey || g.shiftKey || g.metaKey || h.is(\".fancybox-wrap\") || (l = a.groupAttr || \"data-fancybox-group\", m = h.attr(l), m || (l = \"rel\", m = h.get(0)[l]), m && \"\" !== m && \"nofollow\" !== m && (h = c.length ? f(c) : e, h = h.filter(\"[\" + l + '=\"' + m + '\"]'), k = h.index(this)), a.index = k, !1 !== b.open(h, a) && g.preventDefault())\n            };\n            a = a || {};\n            d = a.index || 0;\n            c && !1 !== a.live ? p.undelegate(c, \"click.fb-start\").delegate(c + \":not('.fancybox-item, .fancybox-nav')\",\n                    \"click.fb-start\", l) : e.unbind(\"click.fb-start\").bind(\"click.fb-start\", l);\n            this.filter(\"[data-fancybox-start=1]\").trigger(\"click\");\n            return this\n        };\n        p.ready(function () {\n            var a, d;\n            f.scrollbarWidth === w && (f.scrollbarWidth = function () {\n                var a = f('<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>').appendTo(\"body\"), b = a.children(), b = b.innerWidth() - b.height(99).innerWidth();\n                a.remove();\n                return b\n            });\n            f.support.fixedPosition === w && (f.support.fixedPosition = function () {\n                var a = f('<div style=\"position:fixed;top:20px;\"></div>').appendTo(\"body\"),\n                        b = 20 === a[0].offsetTop || 15 === a[0].offsetTop;\n                a.remove();\n                return b\n            }());\n            f.extend(b.defaults, {scrollbarWidth: f.scrollbarWidth(), fixed: f.support.fixedPosition, parent: f(\"body\")});\n            a = f(s).width();\n            K.addClass(\"fancybox-lock-test\");\n            d = f(s).width();\n            K.removeClass(\"fancybox-lock-test\");\n            f(\"<style type='text/css'>.fancybox-margin{margin-right:\" + (d - a) + \"px !important;}</style>\").appendTo(\"head\")\n        })\n    })(window, document, jQuery);\n});","Amasty_CheckoutStyleSwitcher/js/model/amalert.js":"define([\n    'jquery',\n    'underscore',\n    'mage/translate',\n    'Magento_Ui/js/modal/confirm'\n], function ($, _, $t) {\n    'use strict'\n\n    $.widget('mage.alert', $.mage.confirm, {\n        options: {\n            modalClass: 'confirm',\n            title: $.mage.__('Attention'),\n            actions: {\n\n                /**\n                 * Callback always - called on all actions.\n                 */\n                always: function () {}\n            },\n            buttons: [{\n                text: $.mage.__('OK'),\n                class: 'action-primary action-accept',\n\n                /**\n                 * Click handler.\n                 */\n                click: function () {\n                    this.closeModal(true);\n                }\n            }]\n        },\n\n        /**\n         * Close modal window.\n         */\n        closeModal: function () {\n            this.options.actions.always();\n            this.element.bind('alertclosed', _.bind(this._remove, this));\n\n            return this._super();\n        }\n    });\n\n    return function (config) {\n        return $('<div></div>').html(config.content).alert(config);\n    };\n});\n","Amasty_CheckoutStyleSwitcher/js/view/place-button.js":"define(\n    [\n        'ko',\n        'jquery',\n        'uiElement',\n        'uiRegistry',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Checkout/js/model/shipping-service',\n        'Amasty_CheckoutCore/js/model/payment/payment-loading',\n        'Amasty_CheckoutStyleSwitcher/js/action/start-place-order',\n        'Amasty_CheckoutStyleSwitcher/js/model/amalert',\n        'Amasty_CheckoutCore/js/action/focus-first-error',\n        'Amasty_CheckoutCore/js/model/payment-validators/login-form-validator',\n        'Amasty_CheckoutCore/js/model/address-form-state',\n        'Amasty_CheckoutCore/js/model/one-step-layout',\n        'Amasty_CheckoutCore/js/model/payment/place-order-state',\n        'Magento_Ui/js/lib/knockout/extender/bound-nodes',\n        'Magento_Ui/js/lib/view/utils/dom-observer',\n        'Magento_Ui/js/lib/view/utils/async',\n        'mage/translate'\n    ],\n    function (\n        ko,\n        $,\n        Component,\n        registry,\n        quote,\n        shippingService,\n        paymentLoader,\n        startPlaceOrderAction,\n        alert,\n        focusFirstError,\n        loginFormValidator,\n        addressFormState,\n        oneStepLayout,\n        placeOrderState,\n        boundNodes,\n        domObserver\n    ) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                template: 'Amasty_CheckoutStyleSwitcher/onepage/place-order',\n                defaultLabel: $.mage.__('Place Order'),\n                customLabel: '',\n                onBillingVisibleText: $.mage.__('Please update or cancel Billing Address Form.'),\n                onShippingVisibleText: $.mage.__('Please update or cancel Shipping Address Form.'),\n                visible: true,\n                warn: '',\n                isOriginButtonDisabled: false,\n                paymentsNamePrefix: 'checkout.steps.billing-step.payment.payments-list.',\n                toolbarSelector: '.actions-toolbar',\n                placeButtonSelector: '.action.primary',\n                originalToolbarPayments: ['braintree_paypal'],\n                listens: {\n                    'visible': 'onVisibilityChange'\n                }\n            },\n\n            checkoutRootNode: null,\n\n            previousPaymentMethod: null,\n\n            /**\n             * @private\n             */\n            _asyncCallbackFunction: function () {},\n\n            /**\n             * @property {MutationObserver}\n             */\n            _activePaymentDomObserver: null,\n\n            isPlaceOrderActionAllowed: ko.pureComputed(function () {\n                return !paymentLoader()\n                    && !addressFormState.isBillingFormVisible()\n                    && !addressFormState.isShippingFormVisible()\n                    && !shippingService.isLoading()\n                    && placeOrderState();\n            }),\n\n            initObservable: function () {\n                this._super()\n                    .observe({ label: this.customLabel ? this.customLabel : this.defaultLabel })\n                    .observe('visible warn isOriginButtonDisabled');\n\n                if (typeof MutationObserver !== 'undefined') {\n                    this._activePaymentDomObserver = new MutationObserver(this.mutationCallback.bind(this));\n                }\n\n                if (quote.paymentMethod()) {\n                    this.paymentMethodSubscriber(quote.paymentMethod());\n                }\n\n                quote.paymentMethod.subscribe(this.paymentMethodSubscriber, this);\n\n                addressFormState.isBillingFormVisible.subscribe(this.updateWarning, this);\n\n                if (quote.isVirtual()) {\n                    quote.paymentMethod.subscribe(this.updateWarning, this);\n                } else {\n                    addressFormState.isShippingFormVisible.subscribe(this.updateWarning, this);\n                }\n\n                return this;\n            },\n\n            mutationCallback: function () {\n                this.updatePlaceOrderButton(quote.paymentMethod());\n            },\n\n            /**\n             * When our place button is not visible then original should be\n             *\n             * @param {Boolean} isVisible\n             */\n            onVisibilityChange: function (isVisible) {\n                this.toggleOriginalToolbar(isVisible);\n            },\n\n            /**\n             * @param {Boolean} state - is original toolbar (with place order button) should be hided\n             */\n            toggleOriginalToolbar: function (state) {\n                var classNames = oneStepLayout.containerClassNames().replace(' am-submit-summary', '');\n\n                if (state) {\n                    classNames += ' am-submit-summary';\n                }\n\n                oneStepLayout.containerClassNames(classNames);\n            },\n\n            /**\n             * @param {Object|null} paymentMethod\n             */\n            paymentMethodSubscriber: function (paymentMethod) {\n                var paymentToolbar,\n                    paymentComponentName;\n\n                if (paymentMethod) {\n                    if (this.previousPaymentMethod === paymentMethod.method) {\n                        return;\n                    }\n\n                    this.previousPaymentMethod = paymentMethod.method;\n                }\n\n                if (!this._activePaymentDomObserver) {\n                    this.updatePlaceOrderButton(paymentMethod);\n                    return;\n                }\n\n                this.removePaymentDomObservers();\n                this.updatePlaceOrderButton(paymentMethod);\n\n                if (!paymentMethod || this.originalToolbarPayments.indexOf(paymentMethod.method) !== -1) {\n                    return;\n                }\n\n                paymentToolbar = this.getPaymentToolbar(paymentMethod);\n\n                if (paymentToolbar.length) {\n                    paymentToolbar.each(function (index, element) {\n                        this.registerPaymentObserver(element);\n                    }.bind(this));\n                } else {\n                    paymentComponentName = this.paymentsNamePrefix + paymentMethod.method;\n\n                    this._asyncCallbackFunction = function (element) {\n                        if (quote.paymentMethod() === null || quote.paymentMethod().method !== paymentMethod.method) {\n                            this.removePaymentDomObservers(paymentComponentName);\n\n                            return false;\n                        }\n                        this.updatePlaceOrderButton(paymentMethod);\n\n                        // element - is not a payment method component\n                        if (!$(element).find(this.placeButtonSelector).get(0)) {\n                            return false;\n                        }\n\n                        this.removePaymentDomObservers(paymentComponentName);\n                        this.registerPaymentObserver(element);\n                    }.bind(this);\n\n                    $.async({\n                        component: paymentComponentName,\n                        selector: this.toolbarSelector\n                    }, this._asyncCallbackFunction);\n                }\n            },\n\n            /**\n             * @param {String|null} paymentComponentName\n             */\n            removePaymentDomObservers: function (paymentComponentName = null) {\n                if (paymentComponentName) {\n                    boundNodes.off(registry.get(paymentComponentName));\n                }\n                this._activePaymentDomObserver.disconnect();\n                domObserver.off(this.toolbarSelector, this._asyncCallbackFunction);\n            },\n\n            /**\n             * observe all active toolbars and update button label (or change visibility) on change\n             *\n             * @param {HTMLElement} element\n             */\n            registerPaymentObserver: function (element) {\n                var button = $(element).find(this.placeButtonSelector).get(0);\n\n                this._activePaymentDomObserver.observe(\n                    element,\n                    {\n                        attributes: true,\n                        attributeFilter: ['style', 'class'],\n                        characterData: true\n                    }\n                );\n\n                if (button) {\n                    // observe button text and disabled attribute\n                    this._activePaymentDomObserver.observe(\n                        button,\n                        {\n                            attributes: true,\n                            attributeFilter: ['disabled'],\n                            subtree: true,\n                            characterData: true\n                        }\n                    );\n                }\n            },\n\n            /**\n             * @param {Object|null} paymentMethod\n             */\n            updatePlaceOrderButton: function (paymentMethod) {\n                var paymentToolbar,\n                    button;\n\n                if (!paymentMethod) {\n                    this.visible(true);\n\n                    return;\n                }\n\n                if (quote.paymentMethod() === null || quote.paymentMethod().method !== paymentMethod.method) {\n                    return;\n                }\n\n                paymentToolbar = this.getPaymentToolbar(paymentMethod);\n\n                if (paymentToolbar.length === 0 || this.originalToolbarPayments.indexOf(paymentMethod.method) !== -1) {\n                    this.visible(false);\n\n                    return;\n                }\n\n                if (paymentToolbar.length > 1) {\n                    // selector by attribute style should be used instread of :visible,\n                    // because some paypal payments can render 2 buttons and thay are both hidden by our css\n                    // but not active is hidden by js with attribute style\n                    paymentToolbar = paymentToolbar.filter(':not([style*=\"display: none\"])');\n                }\n\n                button = paymentToolbar.find(this.placeButtonSelector);\n\n                if (button.length) {\n                    this.visible(true);\n                    this.updateLabel(button);\n                    this.isOriginButtonDisabled(!!button.attr('disabled'));\n                } else {\n                    if (!this.visible()) {\n                        this.visible.notifySubscribers();\n                    } else {\n                        this.visible(false);\n                    }\n                }\n            },\n\n            /**\n             * Selected payment isn't have class `_active` yet\n             *\n             * @param {Object} paymentMethod\n             *\n             * @returns {jQuery}\n             */\n            getPaymentToolbar: function (paymentMethod) {\n                return $('#' + paymentMethod.method).parents('.payment-method')\n                    .find(this.toolbarSelector);\n            },\n\n            /**\n             * @param {JQuery|Element} button\n             */\n            updateLabel: function (button) {\n                var buttonText = button.text();\n\n                if (this.customLabel) {\n                    this.label(this.customLabel);\n\n                    return;\n                }\n\n                if (buttonText && buttonText.trim() !== '') {\n                    this.label(buttonText);\n\n                    return;\n                }\n\n                if (button.attr('title')) {\n                    this.label(button.attr('title'));\n\n                    return;\n                }\n\n                this.label(this.defaultLabel);\n            },\n\n            /**\n             * Reassemble warning messages\n             */\n            updateWarning: function () {\n                var warningMessage = '';\n\n                if (quote.paymentMethod() && addressFormState.isBillingFormVisible()) {\n                    warningMessage += this.onBillingVisibleText + ' ';\n                }\n\n                if (addressFormState.isShippingFormVisible()) {\n                    warningMessage += this.onShippingVisibleText + ' ';\n                }\n\n                this.warn(warningMessage);\n            },\n\n            placeOrder: function () {\n                var errorMessage = '';\n\n                if (!quote.paymentMethod()) {\n                    errorMessage = $.mage.__('No payment method selected');\n                    alert({ content: errorMessage });\n\n                    return;\n                }\n\n                if (!quote.shippingMethod() && !quote.isVirtual()) {\n                    errorMessage = $.mage.__('No shipping method selected');\n                    alert({ content: errorMessage });\n\n                    return;\n                }\n\n                startPlaceOrderAction();\n            }\n        });\n    }\n);\n","Amasty_CheckoutStyleSwitcher/js/view/payment/checkout-express-mixin.js":"define([\n    'jquery',\n    'Magento_Checkout/js/model/quote',\n    'Amasty_CheckoutStyleSwitcher/js/model/amalert',\n    'mage/translate'\n], function ($, quote, alert) {\n    'use strict';\n\n    return function (Component) {\n        return Component.extend({\n            /**\n             * Execute additional logic on Paypal button click\n             */\n            onClick: function () {\n                this._super();\n\n                if (!quote.shippingMethod() && !quote.isVirtual()) {\n                    alert({ content: $.mage.__('No shipping method selected') });\n                }\n            }\n        });\n    };\n});\n","Amasty_CheckoutStyleSwitcher/js/action/start-place-order.js":"define(\n    [\n        'jquery',\n        'underscore'\n    ],\n    function ($, _) {\n        'use strict';\n\n        var startPlaceOrder = function (selector) {\n            var toolBar;\n\n            if (selector) {\n                $(selector).click();\n            } else {\n                toolBar = $('.payment-method._active .actions-toolbar:has(.action.primary)');\n\n                if (toolBar.length > 1) {\n                    _.find(toolBar, function (element) {\n                        if (element.style.display !== 'none') {\n                            toolBar = $(element);\n\n                            return true; // break\n                        }\n\n                        return false;\n                    });\n                }\n\n                toolBar.find('.action.primary').click();\n            }\n        };\n\n        return function (selector) {\n            startPlaceOrder(selector);\n        };\n    }\n);\n","MageWorx_SearchSuiteAutocomplete/js/dataProvider.js":"define([\n    'jquery',\n    'uiComponent',\n    'uiRegistry',\n    'underscore',\n    'jquery/jquery-storageapi'\n], function ($, Component, registry, _) {\n    'use strict';\n\n    $.Suggestion = function (data) {\n        this.url = data.url;\n        this.title = data.title;\n        this.num_results = data.num_results;\n    };\n\n    $.Product = function (data) {\n        this.name = data.name;\n        this.sku = data.sku;\n        this.image = data.image;\n        this.reviews_rating = data.reviews_rating;\n        this.short_description = data.short_description;\n        this.description = data.description;\n        this.price = data.price;\n        this.url = data.url;\n        this.add_to_cart = data.add_to_cart;\n    };\n\n    return Component.extend({\n        defaults: {\n            localStorage: $.initNamespaceStorage('searchsuiteautocomplete').localStorage,\n            searchText: ''\n        },\n\n        load: function () {\n            var self = this;\n\n            if (this.xhr) {\n                this.xhr.abort();\n            }\n\n            this.xhr = $.ajax({\n                method: \"get\",\n                dataType: \"json\",\n                url: this.url,\n                data: {q: this.searchText},\n                beforeSend: function () {\n                    self.spinnerShow();\n                    if (self.loadFromLocalSorage(self.searchText)) {\n                        self.showPopup();\n                    }\n                },\n                success: $.proxy(function (response) {\n                    self.parseData(response);\n                    self.saveToLocalSorage(response, self.searchText);\n                    self.spinnerHide();\n                    self.showPopup();\n                })\n            });\n        },\n\n        showPopup: function () {\n            registry.get('searchsuiteautocompleteBindEvents', function (binder) {\n                binder.showPopup();\n            });\n        },\n\n        spinnerShow: function () {\n            registry.get('searchsuiteautocompleteBindEvents', function (binder) {\n                binder.spinnerShow();\n            });\n        },\n\n        spinnerHide: function () {\n            registry.get('searchsuiteautocompleteBindEvents', function (binder) {\n                binder.spinnerHide();\n            });\n        },\n\n        parseData: function (response) {\n            this.setSuggested(this.getResponseData(response, 'suggest'));\n            this.setProducts(this.getResponseData(response, 'product'));\n        },\n\n        getResponseData: function (response, code) {\n            var data = []\n\n            if (_.isUndefined(response.result)) {\n                return data;\n            }\n\n            $.each(response.result, function (index, obj) {\n                if (obj.code == code) {\n                    data = obj;\n                }\n            });\n\n            return data;\n        },\n\n        setSuggested: function (suggestedData) {\n            var suggested = [];\n\n            if (!_.isUndefined(suggestedData.data)) {\n                suggested = $.map(suggestedData.data, function (suggestion) {\n                    return new $.Suggestion(suggestion) });\n            }\n\n            registry.get('searchsuiteautocomplete_form', function (autocomplete) {\n                autocomplete.result.suggest.data(suggested);\n            });\n        },\n\n        setProducts: function (productsData) {\n            var products = [];\n\n            if (!_.isUndefined(productsData.data)) {\n                products = $.map(productsData.data, function (product) {\n                    return new $.Product(product)\n                });\n            }\n\n            registry.get('searchsuiteautocomplete_form', function (autocomplete) {\n                autocomplete.result.product.data(products);\n                autocomplete.result.product.size(productsData.size);\n                autocomplete.result.product.url(productsData.url);\n            });\n        },\n\n        loadFromLocalSorage: function (queryText) {\n            if (!this.localStorage) {\n                return;\n            }\n\n            var hash = this._hash(queryText);\n            var data = this.localStorage.get(hash);\n\n            if (!data) {\n                return false;\n            }\n\n            this.parseData(data);\n\n            return true;\n        },\n\n        saveToLocalSorage: function (data, queryText) {\n            if (!this.localStorage) {\n                return;\n            }\n\n            var hash = this._hash(queryText);\n\n            this.localStorage.remove(hash);\n            this.localStorage.set(hash, data);\n        },\n\n        _hash: function (object) {\n            var string = JSON.stringify(object) + \"\";\n\n            var hash = 0, i, chr, len;\n            if (string.length == 0) {\n                return hash;\n            }\n            for (i = 0, len = string.length; i < len; i++) {\n                chr = string.charCodeAt(i);\n                hash = ((hash << 5) - hash) + chr;\n                hash |= 0;\n            }\n            return 'h' + hash;\n        }\n\n    });\n});\n","MageWorx_SearchSuiteAutocomplete/js/autocomplete.js":"define([\n    'jquery',\n    'uiComponent',\n    'ko'\n], function ($, Component, ko) {\n    'use strict';\n\n\n    return Component.extend({\n        defaults: {\n            template: 'MageWorx_SearchSuiteAutocomplete/autocomplete',\n            addToCartFormSelector: '[data-role=searchsuiteautocomplete-tocart-form]',\n            showPopup: ko.observable(false),\n            result: {\n                suggest: {\n                    data: ko.observableArray([])\n                },\n                product: {\n                    data: ko.observableArray([]),\n                    size: ko.observable(0),\n                    url: ko.observable('')\n                }\n            },\n            anyResultCount: false\n        },\n\n\n        initialize: function () {\n            var self = this;\n            this._super();\n\n            this.anyResultCount = ko.computed(function () {\n                var sum = self.result.suggest.data().length + self.result.product.data().length;\n\n                return sum > 0;\n            }, this);\n        },\n\n    });\n});\n","MageWorx_SearchSuiteAutocomplete/js/bindEvents.js":"define([\n    'jquery',\n    'uiComponent',\n    'uiRegistry',\n    'mageUtils'\n], function ($, Component, registry, utils) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            minSearchLength: 2\n        },\n\n        initialize: function () {\n            this._super();\n\n            utils.limit(this, 'load', this.searchDelay); // execute 'load' after delay\n\n            $(this.inputSelector)\n                .unbind('input') // unbind all magento events\n                .on('input', $.proxy(this.load, this)) // bind searchsuiteautocomplete load event\n                .on('input', $.proxy(this.searchButtonStatus, this)) // bind show/hide search button event\n                .on('focus', $.proxy(this.showPopup, this)); // bind show popup event\n            $(document).on('click', $.proxy(this.hidePopup, this)); // bind hide popup event\n\n            $(document).ready($.proxy(this.searchButtonStatus, this));\n        },\n\n        load: function (event) {\n            var self = this;\n            var searchText = $(self.inputSelector).val();\n\n            if (searchText.length < self.minSearchLength) {\n                return false;\n            }\n\n            registry.get('searchsuiteautocompleteDataProvider', function (dataProvider) {\n                dataProvider.searchText = searchText;\n                dataProvider.load();\n            });\n        },\n\n        showPopup: function (event) {\n            var self = this,\n                searchField = $(self.inputSelector),\n                searchFieldHasFocus = searchField.is(':focus') && searchField.val().length >= self.minSearchLength;\n\n            registry.get('searchsuiteautocomplete_form', function (autocomplete) {\n                autocomplete.showPopup(searchFieldHasFocus);\n            });\n        },\n\n        hidePopup: function (event) {\n            if ($(this.searchFormSelector).has($(event.target)).length <= 0) {\n                registry.get('searchsuiteautocomplete_form', function (autocomplete) {\n                    autocomplete.showPopup(false);\n                });\n            }\n        },\n\n        searchButtonStatus: function (event) {\n            var self = this,\n                searchField = $(self.inputSelector),\n                searchButton = $(self.searchFormSelector + ' ' + self.searchButtonSelector),\n                searchButtonDisabled = (searchField.val().length <= 0);\n\n            searchButton.attr('disabled', searchButtonDisabled);\n        },\n\n        spinnerShow: function () {\n            var spinner = $(this.searchFormSelector);\n            spinner.addClass('loading');\n        },\n\n        spinnerHide: function () {\n            var spinner = $(this.searchFormSelector);\n            spinner.removeClass('loading');\n        }\n\n    });\n});\n","Magento_Persistent/js/remember-me-config.js":"/**\n * Copyright 2024 Adobe\n * All Rights Reserved.\n */\n\ndefine(\n    [\n        'ko',\n        'uiComponent'\n    ],\n    function (ko, Component) {\n        'use strict';\n\n        return Component.extend({\n            dataScope: 'global',\n            config: {},\n\n            /** @inheritdoc */\n            initialize: function () {\n                this._super();\n\n                window.rememberMeConfig = this.config;\n            }\n        });\n    }\n);\n","Magento_Persistent/js/view/customer-data-mixin.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\ndefine([\n    'jquery',\n    'mage/utils/wrapper'\n], function ($, wrapper) {\n    'use strict';\n\n    var mixin = {\n\n        /**\n         * Check if persistent section is expired due to lifetime.\n         *\n         * @param {Function} originFn - Original method.\n         * @return {Array}\n         */\n        getExpiredSectionNames: function (originFn) {\n            var expiredSections = originFn(),\n                storage = $.initNamespaceStorage('mage-cache-storage').localStorage,\n                currentTimestamp = Math.floor(Date.now() / 1000),\n                persistentIndex = expiredSections.indexOf('persistent'),\n                persistentLifeTime = 0,\n                sectionData;\n\n            if (window.persistent !== undefined && window.persistent.expirationLifetime !== undefined) {\n                persistentLifeTime = window.persistent.expirationLifetime;\n            }\n\n            if (persistentIndex !== -1) {\n                sectionData = storage.get('persistent');\n\n                if (typeof sectionData === 'object' &&\n                    sectionData['data_id'] + persistentLifeTime >= currentTimestamp\n                ) {\n                    expiredSections.splice(persistentIndex, 1);\n                }\n            }\n\n            return expiredSections;\n        },\n\n        /**\n         * @param {Object} settings\n         * @constructor\n         */\n        'Magento_Customer/js/customer-data': function (originFn) {\n            let mageCacheTimeout = new Date($.localStorage.get('mage-cache-timeout')),\n                mageCacheSessId = $.cookieStorage.isSet('mage-cache-sessid');\n\n            originFn();\n            if (window.persistent !== undefined && (mageCacheTimeout < new Date() || !mageCacheSessId)) {\n                this.reload(['persistent','cart'],true);\n            }\n        }\n    };\n\n    /**\n     * Override default customer-data.getExpiredSectionNames().\n     */\n    return function (target) {\n        return wrapper.extend(target, mixin);\n    };\n});\n","Magento_Persistent/js/view/remember-me.js":"/**\n * Copyright 2024 Adobe\n * All Rights Reserved.\n */\n\ndefine(\n    [\n        'ko',\n        'uiComponent'\n    ],\n    function (ko, Component) {\n        'use strict';\n\n        let persistenceConfig = window.checkoutConfig.persistenceConfig;\n\n        return Component.extend({\n            defaults: {\n                template: 'Magento_Persistent/remember-me'\n            },\n            isRememberMeCheckboxVisible: ko.observable(persistenceConfig.isRememberMeCheckboxVisible),\n            isRememberMeCheckboxChecked: ko.observable(persistenceConfig.isRememberMeCheckboxChecked)\n        });\n    }\n);\n","Magento_Persistent/js/view/remember-me-default.js":"/**\n * Copyright 2024 Adobe\n * All Rights Reserved.\n */\n\ndefine(\n    [\n        'ko',\n        'uiComponent',\n        'Magento_Customer/js/customer-data'\n    ],\n    function (ko, Component, customerData) {\n        'use strict';\n\n        return Component.extend({\n            defaults: {\n                template: 'Magento_Persistent/remember-me'\n            },\n            dataScope: 'global',\n            isRememberMeCheckboxVisible: ko.observable(false),\n            isRememberMeCheckboxChecked: ko.observable(false),\n\n            /** @inheritdoc */\n            initialize: function () {\n                this._super();\n\n                this.showElement();\n            },\n\n            /**\n             * Show remember me checkbox on certain conditions\n             */\n            showElement: function () {\n                let cart = customerData.get('cart'),\n                    persistenceConfig = window.rememberMeConfig.persistenceConfig;\n\n                if (cart().isGuestCheckoutAllowed !== false) {\n                    persistenceConfig.isRememberMeCheckboxVisible = false;\n                } else {\n                    cart.subscribe(function (cartData) {\n                        if (cartData.isGuestCheckoutAllowed !== false) {\n                            persistenceConfig.isRememberMeCheckboxVisible = false;\n                        }\n                    }, this);\n                }\n\n                this.isRememberMeCheckboxChecked = ko.observable(persistenceConfig.isRememberMeCheckboxChecked);\n                this.isRememberMeCheckboxVisible = ko.observable(persistenceConfig.isRememberMeCheckboxVisible);\n            }\n        });\n    }\n);\n","Magento_Persistent/js/view/additional-welcome.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'mage/translate',\n    'Magento_Customer/js/customer-data'\n], function ($, $t, customerData) {\n    'use strict';\n\n    return {\n        /**\n         * Init.\n         */\n        init: function () {\n            var persistent = customerData.get('persistent');\n\n            if (persistent().fullname === undefined) {\n                customerData.get('persistent').subscribe(this.replacePersistentWelcome);\n            } else {\n                this.replacePersistentWelcome();\n            }\n        },\n\n        /**\n         * Replace welcome message for customer with persistent cookie.\n         */\n        replacePersistentWelcome: function () {\n            var persistent = customerData.get('persistent'),\n                welcomeElems;\n\n            if (persistent().fullname !== undefined) {\n                welcomeElems = $('li.greet.welcome > span.not-logged-in');\n\n                if (welcomeElems.length) {\n                    $(welcomeElems).each(function () {\n                        var html = $t('Welcome, %1!').replace('%1', persistent().fullname);\n\n                        $(this).attr('data-bind', html);\n                        $(this).html(html);\n                    });\n                    $(welcomeElems).append(' <span><a ' + window.notYouLink + '>' + $t('Not you?') + '</a>');\n                }\n            }\n        },\n\n        /**\n         * @constructor\n         */\n        'Magento_Persistent/js/view/additional-welcome': function () {\n            this.init();\n        }\n    };\n});\n","Magepow_OnestepCheckout/js/action/set-payment-method-mixin.js":"define([\n    'uiRegistry',\n    'Magento_Checkout/js/model/quote',\n    'mage/utils/wrapper',\n    'Magento_CheckoutAgreements/js/model/agreements-assigner'\n], function (registry, quote, wrapper, agreementsAssigner) {\n    'use strict';\n\n    return function (setPaymentMethodAction) {\n        return wrapper.wrap(setPaymentMethodAction, function (originalAction, messageContainer) {\n            agreementsAssigner(quote.paymentMethod());\n\n            return originalAction(messageContainer);\n        });\n    };\n});\n","Magepow_OnestepCheckout/js/action/payment-total-information.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/quote',\n        'Magepow_OnestepCheckout/js/model/resource-url-manager',\n        'mage/storage',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Customer/js/model/customer',\n        'Magento_Checkout/js/model/payment/method-converter',\n        'Magento_Checkout/js/model/payment-service',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-loader'\n    ],\n    function ($,\n              quote,\n              resourceUrlManager,\n              storage,\n              errorProcessor,\n              customer,\n              methodConverter,\n              paymentService,\n              shippingService,\n              OneStepCheckoutLoader) {\n        'use strict';\n\n        return function () {\n            OneStepCheckoutLoader.startLoader();\n\n            return storage.post(\n                resourceUrlManager.getUrlForUpdatePaymentTotalInformation(quote)\n            ).done(\n                function (response) {\n                    if (response.redirect_url) {\n                        window.location.href = response.redirect_url;\n                        return;\n                    }\n                    quote.setTotals(response.totals);\n                    paymentService.setPaymentMethods(methodConverter(response.payment_methods));\n                }\n            ).fail(\n                function (response) {\n                    errorProcessor.process(response);\n                }\n            ).always(\n                function () {\n                    OneStepCheckoutLoader.stopLoader();\n                }\n            );\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/action/place-order-mixins.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'jquery',\n    'mage/utils/wrapper',\n    'Magepow_OnestepCheckout/js/action/set-checkout-information',\n], function ($, wrapper, setCheckoutInformationAction) {\n    'use strict';\n\n    return function (placeOrderAction) {\n        return wrapper.wrap(placeOrderAction, function (originalAction, paymentData, messageContainer) {\n            var deferred = $.Deferred();\n\n            var url = window.checkoutConfig.checkoutUrl+'index/save';\n            var deliveryComment = $('#comments').val();\n            var orderCommment = $('[name=\"order_comment\"]').val();\n            var deliveryTime = $('#onestepcheckout-delivery-time').val();\n            var is_subscribed = $('#place-order-newsletter').val();\n\n            var payload = {\n                'order_comment': (orderCommment != undefined ) ? orderCommment : '',\n                'deliveryTime': (deliveryTime != undefined ) ? deliveryTime : '',\n                'deliveryComment': (deliveryComment != undefined ) ? deliveryComment : '',\n                'is_subscribed': (is_subscribed != undefined ) ? is_subscribed : '',\n            };\n            \n            $.ajax({\n                url: url,\n                data: payload,\n                dataType: 'json',\n                type: 'POST',\n            }).done(\n                function (response) {\n                    console.log(response);\n                }\n            ).fail(\n                function (response) {\n                    console.log(response);\n                }\n            );\n\n            if (paymentData && paymentData.method === 'braintree_paypal') {\n                setCheckoutInformationAction().done(function () {\n                    originalAction(paymentData, messageContainer).done(function (response) {\n                        deferred.resolve(response);\n                    }).fail(function (response) {\n                        deferred.reject(response);\n                    })\n                }).fail(function (response) {\n                    deferred.reject(response);\n                })\n            } else {\n                return originalAction(paymentData, messageContainer).fail(function (response) {\n                    if ($('.message-error').length) {\n                        $('html, body').scrollTop(\n                            $('.message-error:visible:first').closest('div').offset().top - $(window).height() / 2\n                        );\n                    }\n                });\n            }\n\n            return deferred;\n        });\n    };\n});\n","Magepow_OnestepCheckout/js/action/gift-message-item.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/quote',\n        'Magepow_OnestepCheckout/js/model/resource-url-manager',\n        'Magepow_OnestepCheckout/js/model/gift-message',\n        'mage/storage'\n    ],\n    function ($,\n              quote,\n              resourceUrlManager,\n              giftMessageModel,\n              storage) {\n        'use strict';\n\n        var giftMessageItems = window.checkoutConfig.mageConfig.giftMessageOptions.giftMessage.itemLevel,\n            giftMessageModel = new giftMessageModel();\n\n        return function (data, itemId, remove) {\n            return storage.post(\n                resourceUrlManager.getUrlForGiftMessageItemInformation(quote, itemId),\n                JSON.stringify(data)\n            ).done(\n                function (response) {\n                    if (response == true) {\n                        if (remove) {\n                            delete giftMessageItems[itemId].message;\n                            giftMessageModel.showMessage('success', 'Delete gift message item success.');\n                            return this;\n                        }\n                        giftMessageItems[itemId]['message'] = data.gift_message;\n                        giftMessageModel.showMessage('success', 'Update gift message item success.');\n                    }\n                }\n            ).fail(\n                function () {\n                    if (remove) {\n                        giftMessageModel.showMessage('error', 'Can not delete gift message item. Please try again!');\n                    }\n                    giftMessageModel.showMessage('error', 'Can not update gift message item. Please try again!');\n                }\n            )\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/action/select-payment-method.js":" define([\n    'Magento_Checkout/js/model/quote'\n], function (quote) {\n    'use strict';\n\n    return function (paymentMethod) {\n        /*if (paymentMethod) {\n            paymentMethod.__disableTmpl = {\n                title: true\n            };\n        }*/\n        quote.paymentMethod(paymentMethod);\n    };\n});","Magepow_OnestepCheckout/js/action/set-payment-method.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'underscore',\n    'jquery',\n    'Magento_Checkout/js/model/quote',\n    'Magento_Checkout/js/model/url-builder',\n    'mage/storage',\n    'Magento_Checkout/js/model/error-processor',\n    'Magento_Customer/js/model/customer',\n    'Magento_Checkout/js/model/full-screen-loader',\n    'Magento_CheckoutAgreements/js/model/agreements-assigner'\n], function ($, _, quote, urlBuilder, storage, errorProcessor, customer, fullScreenLoader, agreementsAssigner) {\n    'use strict';\n\n    return function (messageContainer) {\n        var serviceUrl,\n            payload,\n            paymentData = _.extend({}, quote.paymentMethod());\n\n        agreementsAssigner(paymentData);\n        /**\n         * Checkout for guest and registered customer.\n         */\n        if (!customer.isLoggedIn()) {\n            serviceUrl = urlBuilder.createUrl('/guest-carts/:cartId/set-payment-information', {\n                cartId: quote.getQuoteId()\n            });\n            payload = {\n                cartId: quote.getQuoteId(),\n                email: quote.guestEmail,\n                paymentMethod: paymentData\n            };\n        } else {\n            serviceUrl = urlBuilder.createUrl('/carts/mine/set-payment-information', {});\n            payload = {\n                cartId: quote.getQuoteId(),\n                paymentMethod: paymentData\n            };\n        }\n        fullScreenLoader.startLoader();\n\n        return storage.post(\n            serviceUrl, JSON.stringify(payload)\n        ).fail(function (response) {\n            errorProcessor.process(response, messageContainer);\n        }).always(function () {\n            fullScreenLoader.stopLoader();\n        });\n    };\n});\n","Magepow_OnestepCheckout/js/action/set-checkout-information.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'Magento_Checkout/js/model/shipping-save-processor',\n        'Magepow_OnestepCheckout/js/model/checkout'\n    ],\n    function (shippingSaveProcessor, Processor) {\n        'use strict';\n\n        shippingSaveProcessor.registerProcessor('onestepcheckout', Processor);\n\n        return function () {\n            return shippingSaveProcessor.saveShippingInformation('onestepcheckout');\n        }\n    }\n);\n","Magepow_OnestepCheckout/js/action/validate-shipping-information.js":"define([\n    'Magepow_OnestepCheckout/js/model/shipping-save-processor/validate'\n], function (validateProcessor) {\n    'use strict';\n\n    return function () {\n        return validateProcessor.saveShippingInformation();\n    };\n});","Magepow_OnestepCheckout/js/action/update-item.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'Magento_Checkout/js/model/quote',\n        'Magepow_OnestepCheckout/js/model/resource-url-manager',\n        'mage/storage',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Customer/js/model/customer',\n        'Magento_Checkout/js/model/payment/method-converter',\n        'Magento_Checkout/js/model/payment-service',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-loader',\n        'Magento_Customer/js/customer-data'\n    ],\n    function (quote,\n              resourceUrlManager,\n              storage,\n              errorProcessor,\n              customer,\n              methodConverter,\n              paymentService,\n              shippingService,\n              OneStepCheckoutLoader,\n              customerData) {\n        'use strict';\n\n        var itemUpdateLoader = ['shipping', 'payment', 'total'];\n\n        return function (payload) {\n            var isRemove = !('item_qty' in payload);\n\n            if (!customer.isLoggedIn()) {\n                payload.cart_id = quote.getQuoteId();\n            }\n\n            OneStepCheckoutLoader.startLoader(itemUpdateLoader);\n\n            return storage.post(\n                resourceUrlManager.getUrlForUpdateItemInformation(quote, isRemove),\n                JSON.stringify(payload)\n            ).done(\n                function (response) {\n                    if (response.redirect_url) {\n                        window.location.href = response.redirect_url;\n                        return;\n                    }\n                    quote.setTotals(response.totals);\n                    paymentService.setPaymentMethods(methodConverter(response.payment_methods));\n                    if (response.shipping_methods && !quote.isVirtual()) {\n                        shippingService.setShippingRates(response.shipping_methods);\n                    }\n                    customerData.reload(['cart'], true);\n                }\n            ).fail(\n                function (response) {\n                    errorProcessor.process(response);\n                }\n            ).always(\n                function () {\n                    OneStepCheckoutLoader.stopLoader(itemUpdateLoader);\n                }\n            );\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/action/check-email-availability.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'mage/storage',\n    'Magepow_OnestepCheckout/js/model/resource-url-manager',\n    'Magento_Checkout/js/model/quote'\n], function (storage, resourceUrlManager, quote) {\n    'use strict';\n\n    return function (email) {\n        return storage.post(\n            resourceUrlManager.getUrlForCheckIsEmailAvailable(quote),\n            JSON.stringify({\n                customerEmail: email\n            }),\n            true\n        );\n    };\n\n});\n","Magepow_OnestepCheckout/js/model/form-popup-state.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n\t    'ko'\n\t], function (ko) {\n\t    'use strict';\n\n\t    return {\n\t\tisVisible: ko.observable(false)\n\t    };\n\t});\n","Magepow_OnestepCheckout/js/model/braintree-paypal.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(['ko'], function (ko) {\n    'use strict';\n    return {\n        isReviewRequired: ko.observable(false),\n        customerEmail: ko.observable(null),\n        active: ko.observable(false)\n    }\n});\n","Magepow_OnestepCheckout/js/model/one-step-checkout-loader.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\n\ndefine(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magento_Checkout/js/model/totals',\n        'Magepow_OnestepCheckout/js/model/payment-service'\n    ],\n    function ($, shippingService, totalService, paymentService) {\n        'use strict';\n\n        var blockLoader = {\n            shipping: {\n                queue: 0,\n                service: shippingService\n            },\n            payment: {\n                queue: 0,\n                service: paymentService\n            },\n            total: {\n                queue: 0,\n                service: totalService\n            }\n        };\n\n        return {\n            getServices: function (blocks) {\n                var services = {\n                    payment: blockLoader.payment.service,\n                    total: blockLoader.total.service\n                };\n\n                if (typeof blocks !== 'undefined') {\n                    services = {};\n                    $.each(blocks, function (index, block) {\n                        if (blockLoader.hasOwnProperty(block)) {\n                            services[block] = blockLoader[block].service;\n                        }\n                    });\n                }\n\n                return services;\n            },\n\n            /**\n             * Start full page loader action\n             */\n            startLoader: function (blocks) {\n                var services = this.getServices(blocks);\n                $.each(services, function (index, service) {\n                    blockLoader[index].queue += 1;\n                    service.isLoading(true);\n                });\n            },\n\n            /**\n             * Stop full page loader action\n             */\n            stopLoader: function (blocks) {\n                var services = this.getServices(blocks);\n                $.each(services, function (index, service) {\n                    blockLoader[index].queue -= 1;\n                    if (blockLoader[index].queue == 0) {\n                        service.isLoading(false);\n                    }\n                });\n            }\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/model/one-step-checkout-data.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'jquery',\n    'Magento_Customer/js/customer-data'\n], function ($, storage) {\n    'use strict';\n\n    var cacheKey = 'one-step-checkout-data';\n\n    var getData = function () {\n        return storage.get(cacheKey)();\n    };\n\n    var saveData = function (checkoutData) {\n        storage.set(cacheKey, checkoutData);\n    };\n    return {\n        setData: function (key, data) {\n            var obj = getData();\n            obj[key] = data;\n            saveData(obj);\n        },\n        getData: function (key) {\n            if (typeof key === 'undefined') {\n                return getData();\n            }\n            return getData()[key];\n        }\n    }\n});\n","Magepow_OnestepCheckout/js/model/gift-message.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(['jquery', 'ko', 'uiElement', 'underscore', 'mage/translate'],\n    function ($, ko, uiElement, _, $t) {\n        'use strict';\n\n        var provider = uiElement();\n\n        return function () {\n            var model = {\n                observables: {},\n                initialize: function () {\n                    this.getObservable('alreadyAdded')(false);\n                    var message = window.checkoutConfig.mageConfig.giftMessageOptions.giftMessage.hasOwnProperty('orderLevel')\n                        ? window.checkoutConfig.mageConfig.giftMessageOptions.giftMessage['orderLevel']\n                        : null;\n                    if (_.isObject(message)) {\n                        this.getObservable('recipient')(message.recipient);\n                        this.getObservable('sender')(message.sender);\n                        this.getObservable('message')(message.message);\n                        this.getObservable('alreadyAdded')(true);\n                    }\n                },\n                getObservable: function (key) {\n                    this.initObservable('message-orderLevel', key);\n                    return provider[this.getUniqueKey('message-orderLevel', key)];\n                },\n                initObservable: function (node, key) {\n                    if (node && !this.observables.hasOwnProperty(node)) {\n                        this.observables[node] = [];\n                    }\n                    if (key && this.observables[node].indexOf(key) == -1) {\n                        this.observables[node].push(key);\n                        provider.observe(this.getUniqueKey(node, key));\n                    }\n                },\n                getUniqueKey: function (node, key) {\n                    return node + '-' + key;\n                },\n                getConfigValue: function (key) {\n                    return window.checkoutConfig.mageConfig.giftMessageOptions.hasOwnProperty(key) ?\n                        window.checkoutConfig.mageConfig.giftMessageOptions[key]\n                        : null;\n                },\n\n                /**\n                 * Check if gift message can be displayed\n                 *\n                 * @returns {Boolean}\n                 */\n                isGiftMessageAvailable: function () {\n                    return this.getConfigValue('isOrderLevelGiftOptionsEnabled');\n                },\n                /**\n                 * show message below order summary\n                 * @param type\n                 * @param message\n                 */\n                showMessage: function (type, message) {\n                    var classElement = 'message ' + type;\n                    $('#opc-sidebar .block.items-in-cart').before('<div class=\" ' + classElement + '\"> <span>' + $t(message) + '</span></div>');\n                    setTimeout(function () {\n                        $('#opc-sidebar .opc-block-summary .message.' + type).remove();\n                    }, 3000);\n                }\n            };\n            model.initialize();\n            return model;\n        }\n    }\n);\n","Magepow_OnestepCheckout/js/model/payment-service.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko'\n    ],\n    function (ko) {\n        'use strict';\n\n        return {\n            isLoading: ko.observable(false)\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/model/set-payment-method-mixin.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'jquery',\n    'mage/utils/wrapper',\n    'Magepow_OnestepCheckout/js/action/set-payment-method'\n], function ($, wrapper, setPaymentMethodAction) {\n    'use strict';\n\n    return function (originalSetPaymentMethodAction) {\n        /** Override place-order-mixin for set-payment-information action as they differs only by method signature */\n        return wrapper.wrap(originalSetPaymentMethodAction, function (originalAction, messageContainer) {\n            return setPaymentMethodAction(messageContainer);\n        });\n    };\n});\n","Magepow_OnestepCheckout/js/model/resource-url-manager.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'Magento_Checkout/js/model/resource-url-manager'\n    ],\n    function ($, resourceUrlManager) {\n        \"use strict\";\n\n        return $.extend({\n            /** Get url for saving email to quote */\n            getUrlForSaveEmailToQuote: function (quote) {\n                var params = {cartId: quote.getQuoteId()};\n                var urls = {\n                    'guest': '/guest-carts/:cartId/save-email-to-quote',\n                };\n                return this.getUrl(urls, params);\n            },\n\n            // /** Get url for checking email */\n            getUrlForCheckIsEmailAvailable: function (quote) {\n                var params = {cartId: quote.getQuoteId()};\n                var urls = {\n                    'guest': '/guest-carts/:cartId/isEmailAvailable',\n                };\n                return this.getUrl(urls, params);\n            },\n\n            /** Get url for update item qty and remove item */\n            getUrlForUpdateItemInformation: function (quote, isRemove) {\n                var params = (this.getCheckoutMethod() == 'guest') ? {cartId: quote.getQuoteId()} : {};\n                var urlPath = (isRemove == true) ? 'remove-item' : 'update-item';\n                var urls = {\n                    'guest': '/guest-carts/:cartId/' + urlPath,\n                    'customer': '/carts/mine/' + urlPath\n                };\n                return this.getUrl(urls, params);\n            },\n\n            /** Get url for saving checkout information */\n            getUrlForSetCheckoutInformation: function (quote) {\n                var params = (this.getCheckoutMethod() == 'guest') ? {cartId: quote.getQuoteId()} : {};\n                var urls = {\n                    'guest': '/guest-carts/:cartId/checkout-information',\n                    'customer': '/carts/mine/checkout-information'\n                };\n                return this.getUrl(urls, params);\n            },\n\n            /** Get url for update item qty and remove item */\n            getUrlForUpdatePaymentTotalInformation: function (quote) {\n                var params = (this.getCheckoutMethod() == 'guest') ? {cartId: quote.getQuoteId()} : {};\n                var urls = {\n                    'guest': '/guest-carts/:cartId/payment-total-information',\n                    'customer': '/carts/mine/payment-total-information'\n                };\n                return this.getUrl(urls, params);\n            },\n            getUrlForGiftMessageItemInformation: function (quote, itemId) {\n                var params = (this.getCheckoutMethod() == 'guest') ? {cartId: quote.getQuoteId()} : {};\n                var urls = {\n                    'guest': '/guest-carts/:cartId/gift-message/' + itemId,\n                    'customer': '/carts/mine/gift-message/' + itemId\n                };\n                return this.getUrl(urls, params);\n            }\n        }, resourceUrlManager);\n    }\n);\n","Magepow_OnestepCheckout/js/model/checkout.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\n\ndefine(\n    [\n        'ko',\n        'jquery',\n        'underscore',\n        'Magento_Checkout/js/model/quote',\n        'Magepow_OnestepCheckout/js/model/resource-url-manager',\n        'mage/storage',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data',\n        'Magento_Checkout/js/model/payment-service',\n        'Magento_Checkout/js/model/payment/method-converter',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Checkout/js/model/full-screen-loader',\n        'Magento_Checkout/js/action/select-billing-address'\n    ],\n    function (ko,\n              $,\n              _,\n              quote,\n              resourceUrlManager,\n              storage,\n              OneStepCheckoutData,\n              paymentService,\n              methodConverter,\n              errorProcessor,\n              fullScreenLoader,\n              selectBillingAddressAction) {\n        'use strict';\n\n        return {\n            saveShippingInformation: function () {\n                var payload,\n                    addressInformation = {},\n                    additionInformation = OneStepCheckoutData.getData();\n                if (window.checkoutConfig.mageConfig.giftMessageOptions.isOrderLevelGiftOptionsEnabled) {\n                    additionInformation.giftMessage = this.saveGiftMessage();\n                }\n                if (!quote.billingAddress()) {\n                    selectBillingAddressAction(quote.shippingAddress());\n                }\n\n                if (!quote.isVirtual()) {\n                    addressInformation = {\n                        shipping_address: quote.shippingAddress(),\n                        billing_address: quote.billingAddress(),\n                        shipping_method_code: quote.shippingMethod().method_code,\n                        shipping_carrier_code: quote.shippingMethod().carrier_code\n                    };\n                } else if ($.isEmptyObject(additionInformation)) {\n                    return $.Deferred().resolve();\n                }\n\n                var customAttributes = {};\n                if (_.isObject(quote.billingAddress().customAttributes)) {\n                    _.each(quote.billingAddress().customAttributes, function (attribute, key) {\n                        if (_.isObject(attribute)) {\n                            customAttributes[attribute.attribute_code] = attribute.value\n                        } else if (_.isString(attribute)) {\n                            customAttributes[key] = attribute\n                        }\n                    });\n                }\n\n                payload = {\n                    addressInformation: addressInformation,\n                    customerAttributes: customAttributes,\n                    additionInformation: additionInformation\n                };\n\n                fullScreenLoader.startLoader();\n\n                return storage.post(\n                    resourceUrlManager.getUrlForSetCheckoutInformation(quote),\n                    JSON.stringify(payload)\n                ).fail(\n                    function (response) {\n                        errorProcessor.process(response);\n                    }\n                ).always(\n                    function () {\n                        fullScreenLoader.stopLoader();\n                    }\n                );\n            },\n            saveGiftMessage: function () {\n                var giftMessage = {};\n                if (!$(\"#onestepcheckout-gift-message\").is(\":checked\")) $('.gift-options-content').find('input:text,textarea').val('');\n                giftMessage.sender = $(\"#gift-message-whole-from\").val();\n                giftMessage.recipient = $(\"#gift-message-whole-to\").val();\n                giftMessage.message = $(\"#gift-message-whole-message\").val();\n                return JSON.stringify(giftMessage);\n            }\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/model/checkout-data-resolver.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'Magento_Checkout/js/checkout-data'\n    ],\n    function (checkoutData) {\n        'use strict';\n\n        return {\n\n            /**\n             * Set default shipping method to local storage\n             */\n            resolveDefaultShippingMethod: function () {\n                if (!checkoutData.getSelectedShippingRate() && window.checkoutConfig.selectedShippingRate) {\n                    checkoutData.setSelectedShippingRate(window.checkoutConfig.selectedShippingRate);\n                }\n            },\n\n            /**\n             * Set default payment method to local storage\n             */\n            resolveDefaultPaymentMethod: function () {\n                if (!checkoutData.getSelectedPaymentMethod() && window.checkoutConfig.selectedPaymentMethod) {\n                    checkoutData.setSelectedPaymentMethod(window.checkoutConfig.selectedPaymentMethod);\n                }\n            }\n        }\n    }\n);\n","Magepow_OnestepCheckout/js/model/shipping/shipping-rate-service.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\n define(\n    [\n        'Magento_Checkout/js/model/quote',\n        'Magento_Checkout/js/model/shipping-rate-processor/new-address',\n        'Magento_Checkout/js/model/shipping-rate-processor/customer-address',\n        'Magento_Checkout/js/model/resource-url-manager',\n        'mage/storage',\n        'Magento_Checkout/js/model/shipping-rate-registry',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magento_Checkout/js/model/error-processor'\n    ],\n    function (quote, defaultProcessor, customerAddressProcessor, resourceUrlManager, storage, rateRegistry, shippingService, errorProcessor) {\n        'use strict';\n\n        var processors = [];\n\n        processors.default = defaultProcessor;\n        processors['customer-address'] = customerAddressProcessor;\n\n        return {\n            isAddressChange: false,\n            registerProcessor: function (type, processor) {\n                processors[type] = processor;\n            },\n            estimateShippingMethod: function () {\n                var type = quote.shippingAddress().getType();\n                var cache;\n                cache = rateRegistry.get(quote.shippingAddress().getKey());\n                if(cache){\n                    storage.post(\n                        resourceUrlManager.getUrlForEstimationShippingMethodsByAddressId(),\n                        JSON.stringify({\n                            addressId: quote.shippingAddress()['customerAddressId']\n                        }),\n                        false\n                    ).done(function (result) {\n                        rateRegistry.set(quote.shippingAddress().getKey(), result);\n                        shippingService.setShippingRates(result);\n                    }).fail(function (response) {\n                        shippingService.setShippingRates([]);\n                        errorProcessor.process(response);\n                    }).always(function () {\n                        shippingService.isLoading(false);\n                    });\n                }\n\n                if (processors[type]) {\n                    processors[type].getRates(quote.shippingAddress());\n                } else {\n                    processors.default.getRates(quote.shippingAddress());\n                }\n            }\n        }\n    }\n);\n\n","Magepow_OnestepCheckout/js/model/shipping/shipping-rates-validator.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\n\ndefine(\n    [\n        'underscore',\n        'jquery',\n        'mageUtils',\n        'Magento_Customer/js/model/address-list',\n        'Magento_Checkout/js/model/shipping-rates-validator',\n        'Magento_Checkout/js/model/shipping-rates-validation-rules',\n        'Magento_Checkout/js/model/address-converter',\n        'Magento_Checkout/js/action/select-shipping-address',\n        'Magento_Checkout/js/model/shipping-rate-service',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magento_Checkout/js/model/postcode-validator',\n        'mage/translate',\n        'uiRegistry'\n    ],\n    function (_,\n              $,\n              utils,\n              addressList,\n              Validator,\n              shippingRatesValidationRules,\n              addressConverter,\n              selectShippingAddress,\n              shippingRateService,\n              shippingService,\n              postcodeValidator,\n              $t,\n              uiRegistry) {\n        'use strict';\n\n        var countryElement = null,\n            postcodeElement = null,\n            postcodeElementName = 'postcode',\n            observedElements = [],\n            observableElements,\n            defaultRules = {'rate': {'postcode': {'required': true}, 'country_id': {'required': true}}},\n            addressFields = window.checkoutConfig.mageConfig.addressFields;\n\n        return _.extend(Validator, {\n            isFormInline: function () {\n                return addressList().length === 0;\n            },\n\n            getValidationRules: function () {\n                var rules = shippingRatesValidationRules.getRules();\n\n                return _.isEmpty(rules) ? defaultRules : rules;\n            },\n\n            ValidateAddressData: function (field, address) {\n                var self = this,\n                    canLoad = false;\n\n                $.each(self.getValidationRules(), function (carrier, fields) {\n                    if (fields.hasOwnProperty(field)) {\n                        var missingValue = false;\n                        $.each(fields, function (key, rule) {\n                            if (self.isFieldExisted(key) && address.hasOwnProperty(key) && rule.required && utils.isEmpty(address[key])) {\n                                var regionFields = ['region', 'region_id', 'region_id_input'];\n                                if ($.inArray(key, regionFields) === -1\n                                    || utils.isEmpty(address['region']) && utils.isEmpty(address['region_id'])\n                                ) {\n                                    missingValue = true;\n\n                                    return false;\n                                }\n                            }\n                        });\n                        if (!missingValue) {\n                            canLoad = true;\n\n                            return false;\n                        }\n                    }\n                });\n\n                return canLoad;\n            },\n\n            isFieldExisted: function (field) {\n                var result = false;\n                $.each(observedElements, function (key, element) {\n                    if (field === element.index) {\n                        result = true;\n                        return false;\n                    }\n                });\n\n                return result;\n            },\n\n            /**\n             * Perform postponed binding for fieldset elements\n             *\n             * @param {String} formPath\n             */\n            initFields: function (formPath) {\n                var self = this;\n\n                observableElements = shippingRatesValidationRules.getObservableFields();\n                if (_.isEmpty(observableElements)) {\n                    observableElements.push('country_id');\n                }\n\n                if ($.inArray(postcodeElementName, observableElements) === -1) {\n                    // Add postcode field to observables if not exist for zip code validation support\n                    observableElements.push(postcodeElementName);\n                }\n\n                $.each(addressFields, function (index, field) {\n                    uiRegistry.async(formPath + '.' + field)(self.BindHandler.bind(self));\n                });\n            },\n\n            BindHandler: function (element) {\n                var self = this;\n\n                if (element.component.indexOf('/group') !== -1) {\n                    $.each(element.elems(), function (index, elem) {\n                        uiRegistry.async(elem.name)(function () {\n                            self.BindHandler(elem);\n                        });\n                    });\n                } else if (element && element.hasOwnProperty('value')) {\n                    element.on('value', function () {\n                        self.PostcodeValidation();\n\n                        if (self.isFormInline()) {\n                            var addressFlat = addressConverter.formDataProviderToFlatData(\n                                self.CollectObservedData(),\n                                'shippingAddress'\n                                ),\n                                address;\n\n                            address = addressConverter.formAddressDataToQuoteAddress(addressFlat);\n                            selectShippingAddress(address);\n\n                            if ($.inArray(element.index, observableElements) !== -1 && self.ValidateAddressData(element.index, addressFlat)) {\n                                shippingRateService.isAddressChange = true;\n\n                                clearTimeout(self.validateAddressTimeout);\n                                self.validateAddressTimeout = setTimeout(function () {\n                                    shippingRateService.estimateShippingMethod();\n                                }, 200);\n                            }\n                        }\n                    });\n                    observedElements.push(element);\n                    if (element.index === postcodeElementName) {\n                        postcodeElement = element;\n                    }\n                    if (element.index === 'country_id') {\n                        countryElement = element;\n                    }\n                }\n            },\n            CollectObservedData: function () {\n                var observedValues = {};\n\n                $.each(observedElements, function (index, field) {\n                    var value = field.value();\n                    if ($.type(value) === 'undefined') {\n                        value = '';\n                    }\n                    observedValues[field.dataScope] = value;\n                });\n\n                return observedValues;\n            },\n\n            PostcodeValidation: function () {\n                var countryId = countryElement.value(),\n                    validationResult,\n                    warnMessage;\n\n                if (postcodeElement === null || postcodeElement.value() === null) {\n                    return true;\n                }\n\n                postcodeElement.warn(null);\n                validationResult = postcodeValidator.validate(postcodeElement.value(), countryId);\n\n                if (!validationResult) {\n                    warnMessage = $t('Provided Zip/Postal Code seems to be invalid.');\n\n                    if (postcodeValidator.validatedPostCodeExample.length) {\n                        warnMessage += $t(' Example: ') + postcodeValidator.validatedPostCodeExample.join('; ') + '. ';\n                    }\n                    warnMessage += $t('If you believe it is the right one you can ignore this notice.');\n                    postcodeElement.warn(warnMessage);\n                }\n\n                return validationResult;\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/model/onestepcheckout-loader/discount.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko',\n        'Magento_Checkout/js/model/quote'\n    ],\n    function (ko, quote) {\n        'use strict';\n        var totals = quote.getTotals(),\n        couponCode = ko.observable(null);\n        if (totals()) {\n            couponCode(totals()['coupon_code']);\n        }\n        return {\n            isLoading: ko.observable(false),\n            isAppliedCoupon: ko.observable(couponCode() != null),\n            /**\n             * Start full page loader action\n             */\n            startLoader: function () {\n                this.isLoading(true);\n            },\n            /**\n             * Stop full page loader action\n             */\n            stopLoader: function () {\n                this.isLoading(false);\n            }\n        };\n    }\n);\n","Magepow_OnestepCheckout/js/model/shipping-save-processor/validate.js":"\ndefine([\n    'ko',\n    'underscore',\n    'Magento_Checkout/js/model/quote',\n    'mage/storage',\n    'Magento_Checkout/js/model/error-processor',\n    'Magento_Checkout/js/action/select-billing-address',\n    'Magento_Checkout/js/model/resource-url-manager',\n    'Magento_Customer/js/model/customer' // fix 2.1.x\n], function (\n    ko,\n    _,\n    quote,\n    storage,\n    errorProcessor,\n    selectBillingAddressAction,\n    resourceUrlManager,\n    payloadExtender,\n    customer\n) {\n    'use strict';\n\n    return {\n        /**\n         * @return {jQuery.Deferred}\n         */\n        saveShippingInformation: function () {\n            var payload;\n\n            if (!quote.billingAddress()) {\n                selectBillingAddressAction(quote.shippingAddress());\n            }\n\n            var billingAddress = quote.billingAddress();\n\n            if (!customer.isLoggedIn()) {\n                if (billingAddress) {\n                    if (!_.isUndefined(billingAddress.street)) {\n                        if (billingAddress.street.length == 0) {\n                            delete billingAddress.street;\n                        }\n                    } else {\n                        delete billingAddress.street;\n                    }\n                }\n            }\n\n            payload = {\n                addressInformation: {\n                    'shipping_address': quote.shippingAddress(),\n                    'billing_address': quote.billingAddress(),\n                    'shipping_method_code': quote.shippingMethod()['method_code'],\n                    'shipping_carrier_code': quote.shippingMethod()['carrier_code']\n                }\n            };\n            return storage.post(\n                resourceUrlManager.getUrlForSetShippingInformation(quote),\n                JSON.stringify(payload)\n            ).fail(\n                function (response) {\n                    errorProcessor.process(response);\n                }\n            );\n        }\n    };\n});\n","Magepow_OnestepCheckout/js/model/agreement/agreements-assigner.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'jquery'\n], function ($) {\n    'use strict';\n\n    var agreementsConfig = window.checkoutConfig.checkoutAgreements;\n    var show_toc = window.checkoutConfig.mageConfig.show_toc;\n    var SHOW_IN_PAYMENT = '1';\n\n    /** Override default place order action and add agreement_ids to request */\n    return function (paymentData) {\n        var agreementForm,\n            agreementFormContainer,\n            agreementData,\n            agreementIds;\n\n        if (!agreementsConfig.isEnabled) {\n            return;\n        }\n        agreementFormContainer = (show_toc == SHOW_IN_PAYMENT) ? $('.payment-method._active') : $('#co-place-order-agreement');\n        agreementForm = agreementFormContainer.find('div[data-role=checkout-agreements] input');\n\n        agreementData = agreementForm.serializeArray();\n        agreementIds = [];\n\n        agreementData.forEach(function (item) {\n            agreementIds.push(item.value);\n        });\n\n        if (paymentData['extension_attributes'] === undefined) {\n            paymentData['extension_attributes'] = {};\n        }\n\n        paymentData['extension_attributes']['agreement_ids'] = agreementIds;\n    };\n});\n","Magepow_OnestepCheckout/js/model/agreement/agreement-validator.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'mage/validation'\n    ],\n    function ($) {\n        'use strict';\n        var checkoutConfig = window.checkoutConfig,\n            agreementsConfig = checkoutConfig ? checkoutConfig.checkoutAgreements : {};\n\n        var agreementsInputPath = 'div.onestepcheckout-place-order-wrapper div.checkout-agreements input';\n\n        return {\n            /**\n             * Validate checkout agreements\n             *\n             * @returns {boolean}\n             */\n            validate: function () {\n                if (!agreementsConfig.isEnabled) {\n                    return true;\n                }\n\n                if ($(agreementsInputPath).length == 0) {\n                    return true;\n                }\n\n                return $('#co-place-order-agreement').validate({\n                    errorClass: 'mage-error',\n                    errorElement: 'div',\n                    meta: 'validate',\n                    errorPlacement: function (error, element) {\n                        var errorPlacement = element;\n                        if (element.is(':checkbox') || element.is(':radio')) {\n                            errorPlacement = element.siblings('label').last();\n                        }\n                        errorPlacement.after(error);\n                    }\n                }).form();\n            }\n        }\n    }\n);\n","Magepow_OnestepCheckout/js/model/address/auto-complete.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'Magepow_OnestepCheckout/js/model/address/type/google'\n], function (googleAutoComplete) {\n    'use strict';\n\n    var addressType = {\n        billing: 'checkout.steps.billing-step.billingAddress.billing-address-fieldset',\n        shipping: 'checkout.steps.shipping-step.shippingAddress.shipping-address-fieldset'\n    };\n\n    return {\n        register: function (type) {\n            if (addressType.hasOwnProperty(type)) {\n                switch (window.checkoutConfig.mageConfig.autocomplete.type) {\n                    case 'google':\n                        new googleAutoComplete(addressType[type]);\n                        break;\n                    case 'pca':\n                        break;\n                    default :\n                        break;\n                }\n            }\n        }\n    };\n});\n\n\n","Magepow_OnestepCheckout/js/model/address/type/google.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'jquery',\n    'uiClass',\n    'uiRegistry'\n], function ($, Class, registry) {\n    'use strict';\n\n    var specificCountry = window.checkoutConfig.mageConfig.autocomplete.google_default_country,\n        elementFields = ['street', 'country_id', 'city', 'region', 'region_id', 'region_id_input', 'postcode'];\n    var componentForm = {\n        street_number: 'short_name',\n        route: 'long_name',\n        neighborhood: 'long_name',\n        administrative_area_level_2: 'short_name',\n        locality: 'long_name',\n        administrative_area_level_1: 'long_name',\n        country: 'short_name',\n        postal_code: 'short_name'\n    };\n    var isUsedMaterialDesign = window.checkoutConfig.mageConfig.isUsedMaterialDesign;\n\n    return Class.extend({\n        initialize: function (fieldsetName) {\n            this._super();\n\n            this.initAddressElements(fieldsetName)\n                .initAutoComplete();\n\n            return this;\n        },\n        initAddressElements: function (fieldsetName) {\n            var self = this;\n\n            this.addressElements = {};\n\n            $.each(elementFields, function (index, field) {\n                var fieldElement = registry.async(fieldsetName + '.' + field)();\n                if (field == 'street') {\n                    $.each(fieldElement.elems(), function (key, elem) {\n                        if (key == 0) {\n                            fieldElement = elem;\n                            self.inputSelector = document.getElementById(elem.uid);\n                            self.geolocateSelector = $('#' + elem.uid + '-geolocation');\n                            return false;\n                        }\n                    });\n                }\n                if (typeof fieldElement !== 'undefined') {\n                    self.addressElements[field] = fieldElement;\n                }\n            });\n\n            return this;\n        },\n        initAutoComplete: function () {\n            if (this.inputSelector) {\n                var options = {\n                    types: ['geocode']\n                };\n                if (specificCountry) {\n                    options.componentRestrictions = {country: specificCountry};\n                }\n\n                this.autoComplete = new google.maps.places.Autocomplete(this.inputSelector, options);\n                if (isUsedMaterialDesign) {\n                    $(this.inputSelector).attr('placeholder', '');\n                }\n\n                this.autoComplete.addListener('place_changed', this.placeChangedListener.bind(this));\n\n                if (this.geolocateSelector.length) {\n                    this.geolocateSelector.on('click', this.getCurrentLocation.bind(this));\n                }\n            }\n\n            return this;\n        },\n        placeChangedListener: function () {\n            var place = this.autoComplete.getPlace();\n\n            this.unserializeAddress(place);\n        },\n\n        unserializeAddress: function (place) {\n            var responseComponents = this.initResponseComponents();\n\n            for (var i = 0; i < place.address_components.length; i++) {\n                var addressType = place.address_components[i].types[0];\n                if (componentForm.hasOwnProperty(addressType)) {\n                    var addressValue = place.address_components[i][componentForm[addressType]];\n\n                    if ($.inArray(addressType, ['street_number', 'route', 'administrative_area_level_2']) !== -1) {\n                        if (responseComponents.street != '') {\n                            responseComponents.street += ', ';\n                        }\n                        responseComponents.street += addressValue;\n                    }\n                    if (addressType == 'locality') {\n                        responseComponents.city = addressValue;\n                    }\n                    if (addressType == 'administrative_area_level_1') {\n                        responseComponents.region = addressValue;\n                        responseComponents.region_id = addressValue;\n                        responseComponents.region_id_input = addressValue;\n                    }\n                    if (addressType == 'country') {\n                        responseComponents.country_id = addressValue;\n                    }\n                    if (addressType == 'postal_code') {\n                        responseComponents.postcode = addressValue;\n                    }\n                }\n            }\n            if (place.hasOwnProperty('name')) {\n                responseComponents.street = place.name;\n            }\n\n            this.fillInAddress(responseComponents);\n        },\n\n        fillInAddress: function (components) {\n            var self = this;\n            $.each(this.addressElements, function (index, element) {\n                if (element.visible() && components.hasOwnProperty(index)) {\n                    if (index == 'region_id') {\n                        $.each(element.options(), function (key, option) {\n                            if (components[index] == option.label) {\n                                element.value(option.value);\n                                return false;\n                            }\n                        });\n                    } else {\n                        element.value(components[index]);\n                        if (index == 'street') {\n                            self.inputSelector.value = components[index];\n                        }\n                    }\n                }\n            });\n        },\n\n        geolocate: function () {\n            var self = this;\n\n            if (navigator.geolocation) {\n                navigator.geolocation.getCurrentPosition(function (position) {\n                    var geolocation = {\n                        lat: position.coords.latitude,\n                        lng: position.coords.longitude\n                    };\n                    var circle = new google.maps.Circle({\n                        center: geolocation,\n                        radius: position.coords.accuracy\n                    });\n                    self.autoComplete.setBounds(circle.getBounds());\n                });\n            }\n        },\n\n        getCurrentLocation: function () {\n            var self = this;\n            if (navigator.geolocation) {\n                navigator.geolocation.getCurrentPosition(function (position) {\n                    var geocoder = new google.maps.Geocoder();\n                    var location = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n                    geocoder.geocode({'latLng': location}, function (results, status) {\n                        if (status == google.maps.GeocoderStatus.OK) {\n                            self.unserializeAddress(results[0]);\n                        } else {\n                            return false;\n                        }\n                    });\n                });\n            }\n        },\n\n        initResponseComponents: function () {\n            return {\n                street: '',\n                country_id: '',\n                region: '',\n                region_id: '',\n                region_id_input: '',\n                city: '',\n                postcode: ''\n            };\n        }\n    });\n});\n","Magepow_OnestepCheckout/js/view/edit-billing-address.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'ko',\n    'Magento_Customer/js/model/address-list'\n], function (ko, addressList) {\n    'use strict';\n\n    return function (address) {\n        addressList().some(function (currentAddress, index, addresses) {\n            if (currentAddress.getKey() === address.getKey()) {\n                addressList.replace(currentAddress, address);\n            }\n        });\n\n        addressList.valueHasMutated();\n\n        return address;\n    };\n});\n","Magepow_OnestepCheckout/js/view/list.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n\t    'underscore',\n\t    'ko',\n\t    'mageUtils',\n\t    'uiComponent',\n\t    'uiLayout',\n\t    'Magento_Customer/js/model/address-list'\n\t], function (_, ko, utils, Component, layout, addressList) {\n\t    'use strict';\n\t    return Component.extend({\n\t\tdefaults: {\n\t\t    template: 'Magepow_OnestepCheckout/address/billing/list',\n\t\t    visible: addressList().length > 0,\n\t\t    rendererTemplates: []\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tinitialize: function () {\n\t\t    this._super()\n\t\t        .initChildren();\n\n\t\t    addressList.subscribe(function (changes) {\n\t\t            var self = this;\n\n\t\t            changes.forEach(function (change) {\n\t\t                if (change.status === 'added') {\n\t\t                    self.createRendererComponent(change.value, change.index);\n\t\t                }\n\t\t            });\n\t\t        },\n\t\t        this,\n\t\t        'arrayChange'\n\t\t    );\n\n\t\t    return this;\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tinitConfig: function () {\n\t\t    this._super();\n\t\t    // the list of child components that are responsible for address rendering\n\t\t    this.rendererComponents = [];\n\n\t\t    return this;\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tinitChildren: function () {\n\t\t    _.each(addressList(), this.createRendererComponent, this);\n\n\t\t    return this;\n\t\t},\n\n\t\tcreateRendererComponent: function (address, index) {\n\t\t    var rendererTemplate, templateData, rendererComponent;\n\n\t\t    if (index in this.rendererComponents) {\n\t\t        this.rendererComponents[index].address(address);\n\t\t    } else {\n\t\t        // rendererTemplates are provided via layout\n\t\t        rendererTemplate = address.getType() != undefined && this.rendererTemplates[address.getType()] != undefined ? //eslint-disable-line\n\t\t            utils.extend({}, defaultRendererTemplate, this.rendererTemplates[address.getType()]) :\n\t\t            defaultRendererTemplate;\n\t\t        templateData = {\n\t\t            parentName: this.name,\n\t\t            name: index\n\t\t        };\n\t\t        rendererComponent = utils.template(rendererTemplate, templateData);\n\t\t        utils.extend(rendererComponent, {\n\t\t            address: ko.observable(address)\n\t\t        });\n\t\t        layout([rendererComponent]);\n\t\t        this.rendererComponents[index] = rendererComponent;\n\t\t    }\n\t\t}\n\t    });\n\t});\n","Magepow_OnestepCheckout/js/view/removelocal.js":"define([\n    'jquery'\n], function ($){\n    'use strict';\n    $.widget('mage.removelocal', {\n\n        _init: function () {\n            window.localStorage.removeItem('mage-cache-storage');    \n        }\n    });\n    return $.mage.removelocal;\n});","Magepow_OnestepCheckout/js/view/delivery_date.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'ko',\n        'uiComponent',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data',\n        'jquery-ui-modules/widget',\n        'jquery/jquery-ui-timepicker-addon'\n    ],\n    function ($, ko, Component, OneStepCheckoutData ) {\n        'use strict';\n        var cacheKey = 'deliveryTime',\n            isVisible = OneStepCheckoutData.getData(cacheKey) ? true : false;\n        var cacheKeyHouseSecurityCode = 'houseSecurityCode';\n\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/delivery-time'\n            },\n            houseSecurityCodeValue: ko.observable(),\n            deliveryTimeValue: ko.observable(),\n            isVisible: ko.observable(isVisible),\n            initialize: function () {\n                this._super();\n                var self = this;\n                ko.bindingHandlers.datepicker = {\n                    init: function (element) {\n                        var dateFormat = window.checkoutConfig.mageConfig.deliveryTimeOptions.deliveryTimeFormat,\n                            daysOff = window.checkoutConfig.mageConfig.deliveryTimeOptions.deliveryTimeOff,\n                            options = {\n                                minDate: 0,\n                                showButtonPanel: false,\n                                dateFormat: dateFormat,\n                                showOn: 'both',\n                                buttonText: '',\n                                beforeShowDay: function (date) {\n                                    if (!daysOff)\n                                        return [true];\n\n                                    return [daysOff.indexOf(date.getDay()) === -1];\n                                }\n                            };\n                        $(element).datetimepicker(options);\n                    }\n                };\n                this.deliveryTimeValue(OneStepCheckoutData.getData(cacheKey));\n                this.deliveryTimeValue.subscribe(function (newValue) {\n                    OneStepCheckoutData.setData(cacheKey, newValue);\n                    self.isVisible(true);\n                });\n                //House Security Code\n                this.houseSecurityCodeValue(OneStepCheckoutData.getData(cacheKeyHouseSecurityCode));\n                this.houseSecurityCodeValue.subscribe(function (newValue) {\n                    OneStepCheckoutData.setData(cacheKeyHouseSecurityCode, newValue);\n                });\n                return this;\n            },\n            removeDeliveryTime: function () {\n                if (OneStepCheckoutData.getData(cacheKey) && OneStepCheckoutData.getData(cacheKey) != null) {\n                    OneStepCheckoutData.setData(cacheKey, '');\n                    $(\"#onestepcheckout-delivery-time\").attr('value', '');\n                    this.isVisible(false);\n                }\n            },\n            canUseHouseSecurityCode: function () {\n                if (!window.checkoutConfig.mageConfig.deliveryTimeOptions.houseSecurityCode) {\n                    return true;\n                }\n                return false;\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/billing-address.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'jquery',\n        'ko',\n        'underscore',\n        'Magento_Checkout/js/view/billing-address',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Checkout/js/checkout-data',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data',\n        'Magento_Checkout/js/action/create-billing-address',\n        'Magento_Checkout/js/action/select-billing-address',\n        'Magento_Customer/js/model/customer',\n        'Magento_Checkout/js/action/set-billing-address',\n        'Magento_Checkout/js/model/address-converter',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Ui/js/model/messageList',\n        'Magento_Checkout/js/model/checkout-data-resolver',\n        'Magepow_OnestepCheckout/js/model/address/auto-complete',\n        'uiRegistry',\n        'mage/translate',\n        'rjsResolver'\n    ],\n    function ($,\n              ko,\n              _,\n              Component,\n              quote,\n              checkoutData,\n              OneStepCheckoutData,\n              createBillingAddress,\n              selectBillingAddress,\n              customer,\n              setBillingAddressAction,\n              addressConverter,\n              additionalValidators,\n              globalMessageList,\n              checkoutDataResolver,\n              addressAutoComplete,\n              registry,\n              $t,\n              resolver) {\n        'use strict';\n\n        var observedElements = [],\n            canShowBillingAddress = window.checkoutConfig.mageConfig.showBillingAddress;\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/address/billing/form',\n                actionsTemplate: 'Magepow_OnestepCheckout/address/billing/actions',\n                 formTemplate: 'Magepow_OnestepCheckout/address/billing/form',\n                 detailsTemplate: 'Magepow_OnestepCheckout/address/billing/details',\n                 links: {\n                     isAddressFormVisible: '${$.billingAddressListProvider}:isNewAddressSelected'\n                 }\n            },\n            isCustomerLoggedIn: customer.isLoggedIn,\n            quoteIsVirtual: quote.isVirtual(),\n            isAddressSameAsShipping: ko.observable(true),\n            isAddressSameAsShipping: ko.observableArray([\"billingAddress\"]),\n\n            canUseShippingAddress: ko.computed(function () {\n                return !quote.isVirtual() && quote.shippingAddress() &&\n                    quote.shippingAddress().canUseForBilling() && canShowBillingAddress;\n            }),\n            \n\n            /**\n             * @return {exports}\n             */\n            initialize: function () {\n                var self = this;\n\n                this._super();\n                this.observe({\n                    isAddressSameAsShipping: true,\n                });\n\n                this.initFields();\n\n                additionalValidators.registerValidator(this);\n\n                registry.async('checkoutProvider')(function (checkoutProvider) {\n                    var billingAddressData = checkoutData.getBillingAddressFromData();\n\n                    if (billingAddressData) {\n                        checkoutProvider.set(\n                            'billingAddress',\n                            $.extend({}, checkoutProvider.get('billingAddress'), billingAddressData)\n                        );\n                    }\n                    checkoutProvider.on('billingAddress', function (billingAddressData) {\n                        checkoutData.setBillingAddressFromData(billingAddressData);\n                    });\n                });\n\n                quote.shippingAddress.subscribe(function (newAddress) {\n                    if (self.isAddressSameAsShipping()) {\n                        selectBillingAddress(newAddress);\n                    }\n                });\n\n                resolver(this.afterResolveDocument.bind(this));\n\n                return this;\n            },\n\n\n\n            useShippingAddress: function () {\n                if (this.isAddressSameAsShipping()) {\n                    selectBillingAddress(quote.shippingAddress());\n                    checkoutData.setSelectedBillingAddress(null);\n                    if (window.checkoutConfig.reloadOnBillingAddress) {\n                        setBillingAddressAction(globalMessageList);\n                    }\n                } else {\n                    this.updateAddress();\n                }\n\n                return true;\n            },\n            afterResolveDocument: function () {\n                this.saveBillingAddress();\n\n                addressAutoComplete.register('billing');\n            },\n\n            onAddressChange: function (address) {\n                this._super(address);\n\n                if (!this.isAddressSameAsShipping() && canShowBillingAddress) {\n                    this.updateAddress();\n                }\n            },\n\n            updateAddress: function () {\n                var mgpDetailsBilling = $('.billing-address-details-mgp'),\n                    formBillingaddress = $('.form-mgp-billing-address');\n                if (this.selectedAddress() && !this.isAddressFormVisible()) {\n                    newBillingAddress = createBillingAddress(this.selectedAddress());\n                    selectBillingAddress(newBillingAddress);\n                    checkoutData.setSelectedBillingAddress(this.selectedAddress().getKey());\n                } else {\n                    var addressData = this.source.get('billingAddress'),\n                        newBillingAddress;\n                    \n                    newBillingAddress = createBillingAddress(addressData);\n                    selectBillingAddress(newBillingAddress);\n                    checkoutData.setSelectedBillingAddress(newBillingAddress.getKey());\n                    checkoutData.setNewCustomerBillingAddress(addressData);\n                     if (addressData.firstname != '' && addressData.lastname != '' && addressData.street['0'] != '' && addressData.city != '' && addressData.telephone != '') {\n                        let addressDatastreet1 = (addressData.street['1'] != undefined) ? addressData.street['1'] : '';\n                        let addressDatastreet2 = (addressData.street['2'] != undefined) ? addressData.street['2'] : '';\n                        mgpDetailsBilling.find('.billing-address-detail-child').html(\n                            addressData.firstname+' '+addressData.lastname+'<br><br>'+\n                            addressData.street['0']+' '+addressDatastreet1+' '+addressDatastreet2+'<br><br>'+\n                            addressData.city+', '+addressData.postcode+'<br><br>'+\n                            '<a href=\"tel:'+addressData.telephone+'\">'+addressData.telephone+'</a>');\n                        formBillingaddress.hide();\n                        mgpDetailsBilling.show();\n                    }  \n                        \n                }\n                \n                if (window.checkoutConfig.reloadOnBillingAddress) {\n                    setBillingAddressAction(globalMessageList);\n                }\n            },\n\n            editAddressBilling: function(){\n                var mgpDetailsBilling = $('.billing-address-details-mgp'),\n                    formBillingaddress = $('.form-mgp-billing-address');\n                    formBillingaddress.show();\n                    mgpDetailsBilling.hide();\n                    $(this).parent().hide();\n            },\n            cancelAddressEdit: function () {\n                var checkBox = $('#billing-address-same-as-shipping-shared');\n                $(document).find(checkBox).trigger('click');\n                this.restoreBillingAddress();\n            },\n\n\n\n            initFields: function () {\n                var self = this,\n                    addressFields = window.checkoutConfig.mageConfig.addressFields,\n                    fieldsetName = 'checkout.steps.shipping-step.billingAddress.billing-address-fieldset';\n\n                $.each(addressFields, function (index, field) {\n                    registry.async(fieldsetName + '.' + field)(self.bindHandler.bind(self));\n                });\n\n                return this;\n            },\n\n            bindHandler: function (element) {\n                var self = this;\n\n                if (element.component.indexOf('/group') !== -1) {\n                    $.each(element.elems(), function (index, elem) {\n                        registry.async(elem.name)(function () {\n                            self.bindHandler(elem);\n                        });\n                    });\n                } else {\n                    element.on('value', this.saveBillingAddress.bind(this, element.index));\n                    observedElements.push(element);\n                }\n            },\n\n            saveBillingAddress: function (fieldName) {\n                if (!this.isAddressSameAsShipping()) {\n                    if (!canShowBillingAddress && !this.quoteIsVirtual) {\n                        selectBillingAddress(quote.shippingAddress());\n                    } else if (this.isAddressFormVisible()) {\n                        var addressFlat = addressConverter.formDataProviderToFlatData(\n                            this.collectObservedData(),\n                            'billingAddress'\n                        ), newBillingAddress;\n\n                       \n                        newBillingAddress = createBillingAddress(addressFlat);\n                        selectBillingAddress(newBillingAddress);\n                        checkoutData.setSelectedBillingAddress(newBillingAddress.getKey());\n                        checkoutData.setNewCustomerBillingAddress(addressFlat);\n\n                        if (window.checkoutConfig.reloadOnBillingAddress && (fieldName == 'country_id')) {\n                            setBillingAddressAction(globalMessageList);\n                        }\n                    }\n                }\n            },\n\n\n            collectObservedData: function () {\n                var observedValues = {};\n\n                $.each(observedElements, function (index, field) {\n                    observedValues[field.dataScope] = field.value();\n                });\n\n                return observedValues;\n            },\n\n            validate: function () {\n\n                if (this.isAddressSameAsShipping()) {\n                    OneStepCheckoutData.setData('same_as_shipping', true);\n                    return true;\n                }\n\n                if (!this.isAddressFormVisible()) {\n                    return true;\n                }\n\n                this.source.set('params.invalid', false);\n                this.source.trigger('billingAddress.data.validate');\n\n                if (this.source.get('billingAddress.custom_attributes')) {\n                    this.source.trigger('billingAddress.custom_attributes.data.validate');\n                }\n\n                OneStepCheckoutData.setData('same_as_shipping', false);\n                return !this.source.get('params.invalid');\n            },\n            getAddressTemplate: function () {\n                return 'Magepow_OnestepCheckout/address/billing/form';\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/shipping-method.js":"/**\n * @copyright Copyright \u00c2\u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\n define(\n    [\n        'jquery',\n        'underscore',\n        'mage/storage',\n        'Magento_Checkout/js/view/shipping',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Customer/js/model/customer',\n        'Magento_Checkout/js/model/resource-url-manager',\n        'Magento_Checkout/js/action/set-shipping-information',\n        'Magepow_OnestepCheckout/js/action/payment-total-information',\n        'Magento_Checkout/js/model/step-navigator',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magento_Checkout/js/checkout-data',\n        'Magento_Checkout/js/action/select-billing-address',\n        'Magento_Checkout/js/action/select-shipping-address',\n        'Magento_Checkout/js/model/address-converter',\n        'Magento_Checkout/js/model/shipping-rate-service',\n        'Magento_Checkout/js/model/shipping-service',\n        'Magepow_OnestepCheckout/js/model/checkout-data-resolver',\n        'Magepow_OnestepCheckout/js/model/address/auto-complete',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data',\n        'Magento_Checkout/js/model/payment-service',\n        'Magento_Checkout/js/model/payment/method-converter',\n        'Magento_Checkout/js/model/error-processor',\n        'Magento_Checkout/js/model/full-screen-loader',\n        'Magento_Customer/js/model/address-list',\n        'Magento_Checkout/js/action/create-shipping-address',\n        'rjsResolver',\n        'mage/translate'\n    ],\n    function ($,\n              _,\n              storage,\n              Component,\n              quote,\n              customer,\n              resourceUrlManager,\n              setShippingInformationAction,\n              getPaymentTotalInformation,\n              stepNavigator,\n              additionalValidators,\n              checkoutData,\n              selectBillingAddress,\n              selectShippingAddress,\n              addressConverter,\n              shippingRateService,\n              shippingService,\n              dataResolver,\n              addressAutoComplete,\n              oneStepCheckoutData,\n              paymentService,\n              methodConverter,\n              errorProcessor,\n              fullScreenLoader,\n              addressList,\n              createShippingAddress,\n              resolver) {\n        'use strict';\n\n        dataResolver.resolveDefaultShippingMethod();\n\n        /** Set shipping methods to collection */\n        /*shippingService.setShippingRates(window.checkoutConfig.shippingMethods); */\n\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/shipping-method',\n                shippingFormTemplate: 'Magento_Checkout/shipping-address/form',\n            },\n            currentMethod: null,\n            saveInAddressBook: 1,\n            initialize: function () {\n                this._super();\n                if (!quote.shippingAddress() && addressList().length >= 1) {\n                    selectShippingAddress(addressList()[0]);\n                }\n\n                stepNavigator.steps.removeAll();\n\n                //shippingRateService.estimateShippingMethod();\n                additionalValidators.registerValidator(this);\n\n                resolver(this.afterResolveDocument.bind(this));\n\n                return this;\n            },\n\n            initObservable: function () {\n                this._super();\n\n                quote.shippingMethod.subscribe(function (oldValue) {\n                    this.currentMethod = oldValue;\n                }, this, 'beforeChange');\n\n                quote.shippingMethod.subscribe(function (newValue) {\n                    var isMethodChange = ($.type(this.currentMethod) !== 'object') ? true : this.currentMethod.method_code;\n                    if ($.type(newValue) === 'object' && (isMethodChange !== newValue.method_code)) {\n                        setShippingInformationAction();\n                    } else if (shippingRateService.isAddressChange) {\n                        shippingRateService.isAddressChange = false;\n                        getPaymentTotalInformation();\n                    }\n                }, this);\n\n                return this;\n            },\n\n            afterResolveDocument: function () {\n                addressAutoComplete.register('shipping');\n                if(!quote.isVirtual() && quote.shippingAddress() && quote.shippingAddress().countryId){\n                    shippingRateService.estimateShippingMethod();\n                }\n            },\n\n            validate: function () {\n                if (quote.isVirtual()) {\n                    return true;\n                }\n\n                var shippingMethodValidationResult = true,\n                    shippingAddressValidationResult = true,\n                    loginFormSelector = 'form[data-role=email-with-possible-login]',\n                    emailValidationResult = customer.isLoggedIn();\n\n                if (!quote.shippingMethod()) {\n                    this.errorValidationMessage($.mage.__('Please specify a shipping method.'));\n\n                    shippingMethodValidationResult = false;\n                }\n\n                if (!customer.isLoggedIn()) {\n                    $(loginFormSelector).validation();\n                    emailValidationResult = Boolean($(loginFormSelector + ' input[name=username]').valid());\n                }\n\n                if (this.isFormInline) {\n                    this.source.set('params.invalid', false);\n                    this.source.trigger('shippingAddress.data.validate');\n\n                    if (this.source.get('shippingAddress.custom_attributes')) {\n                        this.source.trigger('shippingAddress.custom_attributes.data.validate');\n                    }\n\n                    if (this.source.get('params.invalid')) {\n                        shippingAddressValidationResult = false;\n                    }\n\n                    this.saveShippingAddress();\n                }\n\n                return shippingMethodValidationResult && shippingAddressValidationResult && emailValidationResult;\n            },\n            saveShippingAddress: function () {\n\n                var shippingAddress = quote.shippingAddress(),\n                    addressData = addressConverter.formAddressDataToQuoteAddress(\n                        this.source.get('shippingAddress')\n                    );\n                var self = this;\n\n                //Copy form data to quote shipping address object\n                for (var field in addressData) {\n                    if (addressData.hasOwnProperty(field) &&\n                        shippingAddress.hasOwnProperty(field) &&\n                        typeof addressData[field] != 'function' &&\n                        _.isEqual(shippingAddress[field], addressData[field])\n                    ) {\n                        shippingAddress[field] = addressData[field];\n                    } else if (typeof addressData[field] != 'function' && !_.isEqual(shippingAddress[field], addressData[field])) {\n                        shippingAddress = addressData;\n                        break;\n                    }\n                }\n\n                if (customer.isLoggedIn()) {\n                    shippingAddress.save_in_address_book = 1;\n                }\n                selectShippingAddress(shippingAddress);\n\n                if (!quote.billingAddress() && quote.shippingAddress().canUseForBilling()) {\n                    selectBillingAddressAction(quote.shippingAddress());\n                }\n                self.savaDataAdded(shippingAddress);\n            },\n\n            savaDataAdded: function(shippingAddress){\n                var payload,\n                    additionInformation = oneStepCheckoutData.getData();\n                if (window.checkoutConfig.mageConfig.giftMessageOptions.isOrderLevelGiftOptionsEnabled) {\n                    additionInformation.giftMessage = this.saveGiftMessage();\n                }\n                var customAttributes = {};\n                if (_.isObject(quote.billingAddress().customAttributes)) {\n                    _.each(quote.billingAddress().customAttributes, function (attribute, key) {\n                        if (_.isObject(attribute)) {\n                            customAttributes[attribute.attribute_code] = attribute.value\n                        } else if (_.isString(attribute)) {\n                            customAttributes[key] = attribute\n                        }\n                    });\n                }\n\n                payload = {\n                    addressInformation: {\n                        'shipping_address': shippingAddress,\n                        'billing_address': quote.billingAddress(),\n                        'shipping_method_code': quote.shippingMethod()['method_code'],\n                        'shipping_carrier_code': quote.shippingMethod()['carrier_code']\n                    },\n                    customerAttributes: customAttributes,\n                    additionInformation: additionInformation\n                };\n                storage.post(\n                    resourceUrlManager.getUrlForSetShippingInformation(quote),\n                    JSON.stringify(payload)\n                ).done(\n                    function (response) {\n                        quote.setTotals(response.totals);\n                        paymentService.setPaymentMethods(methodConverter(response['payment_methods']));\n                        fullScreenLoader.stopLoader();\n                    }\n                ).fail(\n                    function (response) {\n                        errorProcessor.process(response);\n                        fullScreenLoader.stopLoader();\n                    }\n                );\n            },\n\n            saveGiftMessage: function () {\n                var giftMessage = {};\n                if (!$(\"#onestepcheckout-gift-message\").is(\":checked\")) $('.gift-options-content').find('input:text,textarea').val('');\n                giftMessage.sender = $(\"#gift-message-whole-from\").val();\n                giftMessage.recipient = $(\"#gift-message-whole-to\").val();\n                giftMessage.message = $(\"#gift-message-whole-message\").val();\n                return JSON.stringify(giftMessage);\n            },\n\n            saveNewAddress: function () {\n                var self = this;\n                this.source.set('params.invalid', false);\n                var addressData,\n                newShippingAddress;\n                \n                this.source.trigger('shippingAddress.data.validate');\n\n                if (this.source.get('shippingAddress.custom_attributes')) {\n                    this.source.trigger('shippingAddress.custom_attributes.data.validate');\n                }\n                if (!this.source.get('params.invalid')) {\n                    this._super();\n                    shippingRateService.isAddressChange = true;\n                    shippingRateService.estimateShippingMethod();\n                \n                    addressData = this.source.get('shippingAddress');\n                    // if user clicked the checkbox, its value is true or false. Need to convert.\n                    addressData['save_in_address_book'] = this.saveInAddressBook ? 1 : 0;\n\n                    // New address must be selected as a shipping address\n                    newShippingAddress = createShippingAddress(addressData);\n                    selectShippingAddress(newShippingAddress);\n                    checkoutData.setSelectedShippingAddress(newShippingAddress.getKey());\n                    checkoutData.setNewCustomerShippingAddress($.extend(true, {}, addressData));\n                    self.savaDataAdded(addressData);\n                }\n            },\n\n            getAddressTemplate: function () {\n                return 'Magepow_OnestepCheckout/address/shipping-address';\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/payment.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko',\n        'jquery',\n        'Magento_Checkout/js/view/payment',\n        'Magento_Checkout/js/model/quote',\n        'Magento_Checkout/js/model/step-navigator',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magepow_OnestepCheckout/js/model/checkout-data-resolver',\n        'Magepow_OnestepCheckout/js/model/payment-service',\n        'mage/translate'\n    ],\n    function (ko,\n              $,\n              Component,\n              quote,\n              stepNavigator,\n              additionalValidators,\n              DataResolver,\n              PaymentService) {\n        'use strict';\n\n        DataResolver.resolveDefaultPaymentMethod();\n\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/payment'\n            },\n            isLoading: PaymentService.isLoading,\n            errorValidationMessage: ko.observable(false),\n\n            initialize: function () {\n                var self = this;\n\n                this._super();\n\n                stepNavigator.steps.removeAll();\n\n                additionalValidators.registerValidator(this);\n\n                quote.paymentMethod.subscribe(function () {\n                    self.errorValidationMessage(false);\n                });\n\n                return this;\n            },\n\n            validate: function () {\n                if (!quote.paymentMethod()) {\n                    this.errorValidationMessage($.mage.__('Please specify a payment method.'));\n\n                    return false;\n                }\n\n                return true;\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/comments.js":"    \ndefine([ \"jquery\", \n        \"ko\", \n        \"uiComponent\", \n        \"uiRegistry\", \n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data',\n\n ], function ($, ko, Component, uiRegistry, OneStepCheckoutData) {\n    \"use strict\";\n     var cacheKey = 'order_comment',\n        isVisible = OneStepCheckoutData.getData(cacheKey) ? true : false;\n    return Component.extend({\n         defaults: {\n            template: 'Magepow_OnestepCheckout/order-comment'\n        },\n        orderCommentValue: ko.observable(),\n        isVisible: ko.observable(isVisible),\n\n        initialize : function () {\n            var self = this;\n            this.customerNote = null;\n            this._super();\n\n            uiRegistry.async(\"checkout.sidebar.summary.comment.\")(\n                    function (customerNote) {\n                        this.customerNote = customerNote;\n                        uiRegistry.async('checkout.osc.ajax')(\n                                function (ajax) {\n                                    ajax.addMethod(\n                                        'params',\n                                        'customerNote',\n                                        this.paramsHandler.bind(this)\n                                    );\n                                }.bind(this));\n\n                    }.bind(this));\n\n            this.orderCommentValue(OneStepCheckoutData.getData(cacheKey));\n            this.orderCommentValue.subscribe(function (newValue) {\n                OneStepCheckoutData.setData(cacheKey, newValue);\n                self.isVisible(true);\n            });\n           \n            return this;\n\n\n        },\n\n        paramsHandler : function () {\n            var response = false;\n\n            if (this.customerNote.value().length > 0) {\n                response = {\n                    \"customerNote\" : this.customerNote.value()\n                };\n            }\n\n            return response;\n        }\n\n    });\n\n});\n\n","Magepow_OnestepCheckout/js/view/shipping-address/address-renderer/default.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine([\n    'Magento_Checkout/js/view/shipping-address/address-renderer/default',\n    'Magento_Checkout/js/model/shipping-rate-service'\n], function (Component, shippingRateService) {\n    'use strict';\n\n    return Component.extend({\n        defaults: {\n            template: 'Magepow_OnestepCheckout/address/shipping/address-renderer/default'\n        },\n\n        /** Set selected customer shipping address  */\n        selectAddress: function () {\n            if (!this.isSelected()) {\n                this._super();\n\n                shippingRateService.estimateShippingMethod();\n            }\n        }\n    });\n});\n","Magepow_OnestepCheckout/js/view/function/addition.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko',\n        'uiComponent'\n    ],\n    function (ko, Component) {\n        \"use strict\";\n\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/review/addition'\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/function/checkout-agreements.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'Magento_CheckoutAgreements/js/view/checkout-agreements',\n        'Magento_Checkout/js/model/payment/additional-validators',\n        'Magepow_OnestepCheckout/js/model/agreement/agreement-validator'\n    ],\n    function (Component, additionalValidators, agreementValidator) {\n        'use strict';\n\n        additionalValidators.registerValidator(agreementValidator);\n        return Component.extend({\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/function/comment.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko',\n        'uiComponent',\n        'Magepow_OnestepCheckout/js/model/one-step-checkout-data'\n    ],\n    function (ko, Component, OneStepCheckoutData) {\n        \"use strict\";\n\n        var cacheKey = 'deliveryComment';\n\n        return Component.extend({\n            defaults: {\n                template: 'Magepow_OnestepCheckout/review/comment'\n            },\n            commentValue: ko.observable(),\n            initialize: function () {\n                this._super();\n\n                this.commentValue(OneStepCheckoutData.getData(cacheKey));\n\n                this.commentValue.subscribe(function (newValue) {\n                    OneStepCheckoutData.setData(cacheKey, newValue);\n                });\n\n                return this;\n            }\n        });\n    }\n);\n","Magepow_OnestepCheckout/js/view/function/gift-message.js":"/**\n * @copyright Copyright \u00a9 2020 Magepow. All rights reserved.\n * @author    @copyright Copyright (c) 2014 Magepow (<https://www.magepow.com>)\n * @license <https://www.magepow.com/license-agreement.html>\n * @Author: magepow<support@magepow.com>\n * @github: <https://github.com/magepow>\n */\ndefine(\n    [\n        'ko',\n        'jquery',\n        'uiComponent',\n        'Magepow_OnestepCheckout/js/model/gift-message'\n    ],\n    function (ko, $, Component, giftMessageModel) {\n        'use strict';\n        return Component.extend({\n\n            defaults: {\n                template: 'Magepow_OnestepCheckout/review/gift-message'\n            },\n            formBlockVisibility: null,\n            resultBlockVisibility: null,\n            model: {},\n\n            /**\n             * Component init\n             */\n            initialize: function () {\n                this._super()\n                    .observe('formBlockVisibility')\n                    .observe({\n                        'resultBlockVisibility': false\n                    });\n                this.model = new giftMessageModel();\n                this.isResultBlockVisible();\n                this.isUseGiftMessage();\n            },\n\n            /**\n             *\n             * @returns {boolean}\n             */\n            isUseGiftMessage: function () {\n                return !!window.checkoutConfig.mageConfig.giftMessageOptions.giftMessage.orderLevel.hasOwnProperty(\"gift_message_id\");\n            },\n\n            /**\n             * Is reslt block visible\n             */\n            isResultBlockVisible: function () {\n                var self = this;\n\n                if (this.model.getObservable('alreadyAdded')()) {\n                    this.resultBlockVisibility(true);\n                }\n                this.model.getObservable('additionalOptionsApplied').subscribe(function (value) {\n                    if (value == true) {\n                        self.resultBlockVisibility(true);\n                    }\n                });\n            },\n\n            /**\n             * @param {String} key\n             * @return {*}\n             */\n            getObservable: function (key) {\n                return this.model.getObservable(key);\n            },\n\n            /**\n             * Hide\\Show form block\n             */\n            toggleFormBlockVisibility: function () {\n                if (!this.model.getObservable('alreadyAdded')()) {\n                    this.formBlockVisibility(!this.formBlockVisibility());\n                } else {\n                    this.resultBlockVisibility(!this.resultBlockVisibility());\n                }\n                return true;\n            },\n\n            /**\n             * @return {Boolean}\n             */\n            isActive: function () {\n                return this.model.isGiftMessageAvailable();\n            }\n        });\n    }\n);\n"}
}});
