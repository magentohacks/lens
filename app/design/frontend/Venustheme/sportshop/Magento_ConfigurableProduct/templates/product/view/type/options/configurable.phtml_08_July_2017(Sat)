<?php
/**
 * Copyright Â© 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile

?>

<?php
/** @var $block \Magento\ConfigurableProduct\Block\Product\View\Type\Configurable*/
$_product    = $block->getProduct();
$_attributes = $block->decorateArray($block->getAllowAttributes());
?>

<?php
/*Code to Fetch the Attribute set Id & Name*/
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
$attributeSet = $objectManager->create('Magento\Eav\Api\AttributeSetRepositoryInterface');
$attributeSetRepository = $attributeSet->get($_product->getAttributeSetId());
$attribute_set_name = $attributeSetRepository->getAttributeSetName();
/*code ends here*/
?>
<?php if($attribute_set_name == 'Contact_Lens' || $attribute_set_name == 'Contact_Lens_Coloured' || $attribute_set_name == 'Contact_Lens_Multifocal' || $attribute_set_name == 'Contact_Lens_Multifocal_Dominance' || $attribute_set_name == 'Contact_Lens_Toric'):?>
<div style="width:100%; float:left;">
	<div style="font-weight: bold;font-size: 20px;border-bottom:1px solid #00adef;height: 35px;padding: 5px 0px 0px 0px;"><?php echo __('Enter Your Prescription');?></div>
	<div style="float: left;margin-top: 20px;margin-bottom: 10px;">
		<ul>
			<li style="padding-top: 5px;"><?php echo __('Eye');?></li>
			<?php foreach ($_attributes as $_attribute): ?>
			<li style="padding-top: 10px;"><?php echo $block->escapeHtml($_attribute->getProductAttribute()->getStoreLabel()) ?></li>
			<?php endforeach;?>
			<li style="padding-top: 5px;"><?php echo __('Qty');?></li>
		</ul>
	</div>
	<div style="float: left;margin-left: 15%;margin-top: 20px;margin-bottom: 10px;" id="right_main">
		<ul>
			<li><input type="checkbox" checked="checked" id="right_checked"><label style="font-weight: normal;font-size: 15px;padding-left: 10px;"><?php echo __('Right Eye');?></label></li>
			<?php foreach ($_attributes as $_attribute): ?>
			<li>
				<select style="border: 1px solid #00adef;color: #00adef;" name="right[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
				        data-selector="right[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
				        data-validate="{required:true}"
				        id="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>"
				        class="super-attribute-select-right">
				    <option value=""><?php /* @escapeNotVerified */ echo __('Select') ?></option>
				</select>
			</li>
			<?php endforeach;?>
			<li>
				
			        <div class="quantity-adder">
			            <div class="quantity-number pull-left">
			                <input style="width:100px; height:40px; border: 1px solid #00adef;color: #00adef;" type="number"
			                name="right[qty]"
			                id="qty"
			                maxlength="12"
			                value="<?php /* @escapeNotVerified */ echo 1;//echo $block->getProductDefaultQty() * 1 ?>"
			                title="<?php /* @escapeNotVerified */ echo __('Quantity') ?>" class="input-text qty"
			                data-validate="<?php echo $block->escapeHtml(json_encode($block->getQuantityValidators())) ?>"
			                />
			            </div>
			            <div class="quantity-wrapper pull-left">
			                <span class="add-up add-action fa fa-plus" data-parentqty="true" style="border: 1px solid #00adef;color: #00adef;"></span>  
			                <span class="add-down add-action fa fa-minus" data-parentqty="true" style="border: 1px solid #00adef;color: #00adef;"></span>
			            </div>
			        </div>
			        <script type="text/javascript">
			            require(["jquery"], function(){
			                jQuery(window).ready( function(){
			                   jQuery(".quantity-adder .add-action").click( function(){
			                    if( jQuery(this).hasClass('add-up') ) {  
			                        jQuery(".quantity-adder .qty").val( parseInt(jQuery(".quantity-adder .qty").val()) + 1 );
			                    }else {
			                        if( parseInt(jQuery(".quantity-adder .qty").val())  > 1 ) {
			                            jQuery(".quantity-adder .qty").val( parseInt(jQuery(".quantity-adder .qty").val()) - 1 );
			                        }
			                    }
			                } );
			               })
			            });
			        </script>    
			</li>
		</ul>
	</div>
	<div style="float: left;margin-left: 10%;margin-top: 20px;margin-bottom: 10px;" id="left_main">
		<ul>
			<li><input type="checkbox" checked="checked" id="left_checked"><label style="font-weight: normal;font-size: 15px;padding-left: 10px;"><?php echo __('Left Eye');?></label></li>
			<?php foreach ($_attributes as $_attribute): ?>
			<li>
				<select style="border: 1px solid #00adef;color: #00adef;" name="left[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
				        data-selector="left[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
				        data-validate="{required:true}"
				        id="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>"
				        class="super-attribute-select">
				    <option value=""><?php /* @escapeNotVerified */ echo __('Select') ?></option>
				</select>
			</li>
			<?php endforeach;?>
			<li>
			        <div class="quantity-adder1">
			            <div class="quantity-number pull-left">
			                <input style="width:100px; height:40px; border: 1px solid #00adef;color: #00adef;" type="number"
			                name="left[qty]"
			                id="qty"
			                maxlength="12"
			                value="<?php /* @escapeNotVerified */ echo 1;//echo $block->getProductDefaultQty() * 1 ?>"
			                title="<?php /* @escapeNotVerified */ echo __('Quantity') ?>" class="input-text qty"
			                data-validate="<?php echo $block->escapeHtml(json_encode($block->getQuantityValidators())) ?>"
			                />
			            </div>
			            <div class="quantity-wrapper pull-left">
			                <span class="add-up add-action fa fa-plus" data-parentqty="true" style="border: 1px solid #00adef;color: #00adef;"></span>  
			                <span class="add-down add-action fa fa-minus" data-parentqty="true" style="border: 1px solid #00adef;color: #00adef;"></span>
			            </div>
			        </div>
			        <script type="text/javascript">
			            require(["jquery"], function(){
			                jQuery(window).ready( function(){
			                   jQuery(".quantity-adder1 .add-action").click( function(){
			                    if( jQuery(this).hasClass('add-up') ) {  
			                        jQuery(".quantity-adder1 .qty").val( parseInt(jQuery(".quantity-adder1 .qty").val()) + 1 );
			                    }else {
			                        if( parseInt(jQuery(".quantity-adder1 .qty").val())  > 1 ) {
			                            jQuery(".quantity-adder1 .qty").val( parseInt(jQuery(".quantity-adder1 .qty").val()) - 1 );
			                        }
			                    }
			                } );
			               })
			            });
			        </script>
				   
			</li>
		</ul>
	</div>
	
</div>
<div style="clear:both;">&nbsp;</div>
<script type="text/x-magento-init">
        {
            "#product_addtocart_form": {
                "configurable": {
                    "spConfig": <?php /* @escapeNotVerified */ echo $block->getJsonConfig() ?>,
                    "onlyMainImg": <?php /* @escapeNotVerified */ echo $block->getVar('change_only_base_image', 'Magento_ConfigurableProduct') ?: 'false'; ?>
                },
		"customconfigurable": {
                    "spConfig": <?php /* @escapeNotVerified */ echo $block->getJsonConfig() ?>,
                    "onlyMainImg": <?php /* @escapeNotVerified */ echo $block->getVar('change_only_base_image', 'Magento_ConfigurableProduct') ?: 'false'; ?>
                }
            }
        }

    </script>
    <script>
	jQuery(document).ready(function(){

	 	jQuery('#right_checked').click(function () {
			isChecked = jQuery(this).is(':checked');
			if(isChecked){
				jQuery('#right_main').find('select').removeAttr('disabled');
				jQuery('#right_main').find('.qty').removeAttr('disabled');
			}else{
			//	jQuery('#right_main').find('select').prop('disabled','disabled');
			//	jQuery('#right_main').find('.qty').prop('disabled','disabled');	
			}

		});
		jQuery('#left_checked').click(function () {
			isChecked = jQuery(this).is(':checked');
			if(isChecked){
				jQuery('#left_main').find('select').removeAttr('disabled');
				jQuery('#left_main').find('.qty').removeAttr('disabled');
			}else{
			//	jQuery('#left_main').find('select').prop('disabled','disabled');
			//	jQuery('#left_main').find('.qty').prop('disabled','disabled');	
			}

		});
		
    var diameter = jQuery('#attribute163 > option').length;   
 
    if(diameter==2)
    {
        	jQuery('#left_main').find('select #attribute163').removeAttr('disabled');
        	jQuery('#right_main').find('select #attribute163').removeAttr('disabled');
          console.log('diameter'+diameter+jQuery("#attribute162 option").eq(2).val());
        jQuery("#attribute162").val(jQuery("#attribute162 option").eq(2).val());
        // jQuery("#attribute163").val(jQuery("select  #attribute163 option:eq(1)").val());
    }
	});
    </script>	
<?php else:?>
<?php if ($_product->isSaleable() && count($_attributes)):?>
   <?php foreach ($_attributes as $_attribute): ?>
        <div class="field configurable required">
            <label class="label" for="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>">
                <span><?php echo $block->escapeHtml($_attribute->getProductAttribute()->getStoreLabel()) ?></span>
            </label>
            <div class="control">
                <select name="left[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
                        data-selector="left[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
                        data-validate="{required:true}"
                        id="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>"
                        class="super-attribute-select">
                    <option value=""><?php /* @escapeNotVerified */ echo __('Choose an Option...') ?></option>
                </select>
            </div>
        </div>
    <?php endforeach; ?>
    <?php foreach ($_attributes as $_attribute): ?>
        <div class="field configurable required">
            <label class="label" for="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>">
                <span><?php echo $block->escapeHtml($_attribute->getProductAttribute()->getStoreLabel()) ?></span>
            </label>
            <div class="control">
                <select name="right[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
                        data-selector="right[super_attribute][<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>]"
                        data-validate="{required:true}"
                        id="attribute<?php /* @escapeNotVerified */ echo $_attribute->getAttributeId() ?>"
                        class="super-attribute-select-right">
                    <option value=""><?php /* @escapeNotVerified */ echo __('Choose an Option...') ?></option>
                </select>
            </div>
        </div>
    <?php endforeach; ?>


     <script type="text/x-magento-init">
        {
            "#product_addtocart_form": {
                "configurable": {
                    "spConfig": <?php /* @escapeNotVerified */ echo $block->getJsonConfig() ?>,
                    "onlyMainImg": <?php /* @escapeNotVerified */ echo $block->getVar('change_only_base_image', 'Magento_ConfigurableProduct') ?: 'false'; ?>
                }
            }
        }
    </script>	
<?php endif;?>
<?php endif;?>	
    


