<?php
/**
 * Mageplaza
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the mageplaza.com license that is
 * available through the world-wide-web at this URL:
 * https://www.mageplaza.com/LICENSE.txt
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Mageplaza
 * @package     Mageplaza_RewardPoints
 * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)
 * @license     https://www.mageplaza.com/LICENSE.txt
 */

/** @var \Mageplaza\RewardPoints\Block\Account\Dashboard\Transaction $block */

/** @var \Mageplaza\RewardPoints\Model\ResourceModel\Transaction\Collection $transactions */
$transactions = $block->getTransactions();
?>
<div class="block block-reward-dashboard-transaction">
    <?php if ($block->getIsRecent()): ?>
        <div class="block-title order">
            <strong><?php echo __('Recent Transactions') ?></strong>
            <?php if ($transactions->getSize()): ?>
                <a class="action view" href="<?php echo $block->getUrl('customer/rewards/transaction') ?>">
                    <span><?php echo __('View All') ?></span>
                </a>
            <?php endif; ?>
        </div>
    <?php endif; ?>
    <div class="block-content">
        <?php if ($transactions->getSize()): ?>
            <div class="table-wrapper transactions-recent">
                <table class="data table table-transaction-items recent" id="rewards-transaction-table">
                    <caption class="table-caption"><?php echo __('Recent Transactions') ?></caption>
                    <thead>
                    <tr>
                        <th scope="col" class="col id"><?php echo __('Transaction #') ?></th>
                        <th scope="col" class="col created"><?php echo __('Date') ?></th>
                        <th scope="col" class="col comment"><?php echo __('Comment') ?></th>
                        <th scope="col" class="col amount"><?php echo __('Amount') ?></th>
                        <th scope="col" class="col status"><?php echo __('Status') ?></th>
                        <th scope="col" class="col expire"><?php echo __('Expire Date') ?></th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php foreach ($transactions as $transaction): ?>
                        <tr>
                            <td data-th="<?php echo $block->escapeHtml(__('Transaction #')) ?>"
                                class="col id"><?php echo $transaction->getId() ?></td>
                            <td data-th="<?php echo $block->escapeHtml(__('Date')) ?>"
                                class="col created"><?php echo $block->formatDate($transaction->getCreatedAt()) ?></td>
                            <td data-th="<?php echo $block->escapeHtml(__('Comment')) ?>"
                                class="col comment"><?php echo $transaction->getTitle() ?></td>
                            <td data-th="<?php echo $block->escapeHtml(__('Amount')) ?>"
                                class="col amount"><?php echo $transaction->getPointAmount() ?></td>
                            <td data-th="<?php echo $block->escapeHtml(__('Status')) ?>"
                                class="col status"><?php echo $transaction->getStatusLabel() ?></td>
                            <td data-th="<?php echo $block->escapeHtml(__('Expire Date')) ?>"
                                class="col expire"><?php echo $transaction->getExpirationDate() ? $block->formatDate($transaction->getExpirationDate()) : __('N/A') ?></td>
                        </tr>
                    <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
            <?php if ($block->getPagerHtml()): ?>
                <div class="reward-transactions-toolbar toolbar bottom"><?php echo $block->getPagerHtml(); ?></div>
            <?php endif ?>
        <?php else: ?>
            <div class="message info empty"><span><?php echo __('You have created no transactions.'); ?></span></div>
        <?php endif; ?>
    </div>
</div>